# å½¢å¼å’ŒåŠŸèƒ½

> åŸæ–‡:[https://dev.to/rowan_m/form-and-function-emm](https://dev.to/rowan_m/form-and-function-emm)

è¿™æ˜¯æˆ‘å¦‚ä½•å»ºé€  [ç³»åˆ—æ–‡ç« çš„ç¬¬äºŒç¯‡ğŸ¥‘ *Rotavo PWA*](https://bit.ly/rotavo-pwa) *ã€‚è¯•ä¸€è¯•ï¼Œçœ‹çœ‹ä½ èƒ½ç”»å‡ºä»€ä¹ˆï¼*

åœ¨[çš„ä¸Šä¸€æœŸ](https://dev.to/rowan_m/you-spin-me-right-r-und-k32)ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†è§¦æ‘¸æ§åˆ¶çš„`<input-knob>`ç»„ä»¶ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ä¸å…¶è§’åº¦å¯¹åº”çš„`value`å±æ€§çš„æ—‹é’®ã€‚ç„¶è€Œï¼Œ[ä¹è¶£](https://paul-spinlan.glitch.me)å°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»ç„¶ç¼ºå°‘ä¸€äº›å®ç”¨çš„åŠŸèƒ½ã€‚

## [](#contents)ç›®å½•

*   [â™»ï¸æ¢³æ´—å®Œæ¯•](#freshen-up)
*   [ğŸ‘‚ç›¸å½“å¤§çš„äº‹ä»¶](#quite-the-event)
*   [ğŸ”’å¼ºåˆ¶é™åˆ¶](#enforcing-limits)
*   è®¡æ•°æ—‹è½¬
*   [ğŸå¥–åŠ±å†…å®¹](#bonus-content)

## [](#freshen-up)â™»ï¸æ¢³æ´—ä¸€ç•ª

ä¸è¿‡ï¼Œé¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ä¸€äº›å¤–è§‚ä¸Šçš„æ”¹è¿›æ¥åˆ·æ–°ä¹‹å‰çš„æ¼”ç¤ºã€‚æˆ‘è¯´æˆ‘ä»¬è¦åšä¸€ä¸ªç±»ä¼¼äºç«‹ä½“å£°éŸ³é‡æ§åˆ¶æ—‹é’®çš„ä¸œè¥¿ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†æ—‹è½¬è¡Œä¸ºï¼Œä½†æ˜¯æˆ‘ä»¬çš„æ—‹é’®æ˜¯æ–¹å½¢çš„...ä¼ ç»Ÿä¸Šå®ƒä»¬æ˜¯åœ†çš„ã€‚ä½ ä»¬éƒ½å¾ˆå‹å¥½ï¼Œæ²¡æœ‰æåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘ä»¬åº”è¯¥åœ¨ç»§ç»­å‰è¿›ä¹‹å‰è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªæŒ‡ç¤ºå™¨æ¥æŒ‡ç¤ºæ—‹é’®ä¸Šçš„â€œå‘ä¸Šâ€æ–¹å‘ã€‚æ­£å¦‚æˆ‘ä»¬ä¸Šæ¬¡åœ¨[æœ€ç»ˆæ¼”ç¤º](https://paul-spinlan.glitch.me)ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…ƒç´ ä¸­æ·»åŠ ä»»ä½•æˆ‘ä»¬éœ€è¦çš„å†…å®¹ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šåœ¨é‚£é‡Œæ”¾ä¸€ä¸ªå°ä¸‰è§’æŒ‡ç¤ºå™¨:

```
<input-knob value="2.5"><div class="mark">â–²</div></input-knob> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡å®ƒçš„æ ·å¼ï¼Œä½¿å®ƒä½äºä¸­å¿ƒ:

```
.mark {
  display: inline-block;
  width: 100%;
  text-align: center;
  font: bold 200% monospace;
  color: #356211;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ§ä»¶çš„ä¸»è¦å˜åŒ–æ˜¯ä½¿ç”¨`border-radius`æ¥åœ†è§’ã€‚æˆ‘ä»¬è¿˜å°†æŠŠé˜´å½±æ”¾åœ¨å¤–éƒ¨çš„`input-knob`å…ƒç´ ä¸Šï¼Œå› ä¸ºå®ƒä¸ä¼šæ—‹è½¬ã€‚å¦‚æœæˆ‘ä»¬åœ¨å†…éƒ¨`::part(container)`ä¸Šæœ‰é˜´å½±ï¼Œçœ‹èµ·æ¥å¥½åƒé˜´å½±åœ¨å…ƒç´ å‘¨å›´ç§»åŠ¨ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚

```
input-knob {
  border-radius: 100%;
  box-shadow: 0 0.3rem 0.3rem rgba(0, 0, 0, 0.5);
}

input-knob::part(container) {
  box-sizing: border-box;
  background: #cadbbc;
  border: 1rem double #356211;
  border-bottom: 1rem solid #356211;
  border-radius: 100%;
  width: 8rem;
  height: 8rem;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ†è§’ï¼æœ€åˆçš„ CSS åœ£æ¯-é™¶é†‰äºå…¶ä¸­ã€‚

[https://glitch.com/embed/#!/embed/building-rotavo-04?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/building-rotavo-04?previewSize=100&path=index.html)

æˆ‘ä»¬è¿˜å¯ä»¥å¯¹å½±å­ DOM æ¨¡æ¿ä¸Šçš„`:host`çš„æ ·å¼åšä¸€ç‚¹æ”¹è¿›ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å…‰æ ‡å˜æˆå°çš„ğŸ‘†å‘ç”¨æˆ·æŒ‡ç¤ºä»–ä»¬å¯ä»¥ä¸ä¹‹äº¤äº’çš„æŒ‡é’ˆã€‚

```
:host {
  display: inline-block;
  user-select: none;
  touch-action: none;
  cursor: pointer;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#quite-the-event)ğŸ‘‚ç›¸å½“å¤§çš„äº‹ä»¶

ç°åœ¨æˆ‘ä»¬ç»™æˆ‘ä»¬çš„å…ƒç´ æ·»åŠ äº†ä¸€äº›ä¿®é¥°ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€äº›è§†è§‰ä¸Šä»¤äººæ„‰æ‚¦çš„ä¸œè¥¿ï¼Œä½†æ˜¯å½“ç”¨æˆ·ä¸å…ƒç´ äº¤äº’æ—¶ï¼Œå¾ˆéš¾å¯¹ä»»ä½•å˜åŒ–åšå‡ºååº”ã€‚å°±åƒæˆ‘ä»¬ç›‘å¬å…ƒç´ å†…éƒ¨çš„æŒ‡é’ˆäº‹ä»¶ä¸€æ ·ï¼Œæˆ‘ä»¬æƒ³è¦å‘å‡ºæˆ‘ä»¬è‡ªå·±çš„äº‹ä»¶ï¼Œä»¥ä¾¿åœ¨æ›´å¹¿æ³›çš„åº”ç”¨ç¨‹åºä¸­å“åº”å®ƒä»¬ã€‚

ä¸æŒ‡é’ˆäº‹ä»¶éå¸¸ç›¸ä¼¼ï¼Œæˆ‘ä»¬å¸Œæœ›è·Ÿè¸ªäº¤äº’çš„å¼€å§‹ã€ä¸­é—´å’Œç»“æŸã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°†[åˆ›å»ºä¸‰ç§`Event`](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events) ç±»å‹:

*   `knob-move-start`:è§¦æ‘¸/ç‚¹å‡»å…ƒç´ æ—¶
*   `knob-move-change`:ç§»åŠ¨å…ƒç´ æ—¶
*   `knob-move-end`:é‡Šæ”¾å…ƒç´ æ—¶

æˆ‘ä»¬å°†åœ¨å…ƒç´ å†…éƒ¨çš„æ¯ä¸ªå¤„ç†ç¨‹åºçš„æœ«å°¾å‘å‡ºè¿™äº›äº‹ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›ç¡®ä¿åœ¨ä»»ä½•è¯•å›¾å¤„ç†äº‹ä»¶çš„æ“ä½œä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»åœ¨å…ƒç´ å†…éƒ¨å®Œæˆäº†æ‰€æœ‰å¿…è¦çš„å·¥ä½œã€‚

```
// class InputKnob
_rotationStart() {
  // âœ‚ï¸ existing code hidden 
  const evt = new Event('knob-move-start', { bubbles: true });
  this.dispatchEvent(evt);
}

_rotationChange() {
  // âœ‚ï¸ existing code hidden 
  const evt = new Event('knob-move-change', { bubbles: true });
  this.dispatchEvent(evt);
}

_rotationEnd() {
  // âœ‚ï¸ existing code hidden
  const evt = new Event('knob-move-end', { bubbles: true });
  this.dispatchEvent(evt);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬æŒ‡å®šäº†`bubbles: true`ï¼Œå› ä¸ºæˆ‘ä»¬çš„[ä¾¦å¬å™¨å°†æˆä¸ºçˆ¶å…ƒç´ ](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture)ã€‚æ‚¨å¯ä»¥å°è¯•åˆ é™¤å®ƒï¼Œæ‚¨å°†çœ‹åˆ°äº‹ä»¶æ°¸è¿œä¸ä¼šâ€œå†’æ³¡â€åˆ°çˆ¶èŠ‚ç‚¹ã€‚

éšç€è¿™äº›äº‹ä»¶çš„è§¦å‘ï¼Œæˆ‘ä»¬å¯ä»¥åƒç›‘å¬å…¶ä»–äº‹ä»¶ä¸€æ ·ç›‘å¬å®ƒä»¬:

```
document.addEventListener('knob-move-start', logEvent); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çœ‹ä¸€ä¸‹ä¸‹é¢çš„æ¼”ç¤ºï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨`logEvent()`å‡½æ•°åœ¨äº‹ä»¶è§¦å‘æ—¶ç…§äº®ä¸€äº›`<span>`å…ƒç´ ã€‚

[https://glitch.com/embed/#!/embed/building-rotavo-05?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/building-rotavo-05?previewSize=100&path=index.html)

## [](#have-some-sense-of-proportion)âš–ï¸æœ‰ä¸€äº›åˆ†å¯¸æ„Ÿ

ç›®å‰ï¼Œå…ƒç´ çš„`value`ç›´æ¥æ˜ å°„åˆ°å®ƒçš„è§’åº¦ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªä» 0 åˆ° 11 çš„éŸ³é‡æ§åˆ¶ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦åŒ¹é…çš„å€¼ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬å°±åœ¨å¼ºè¿«æˆ‘ä»¬çš„å¼€å‘äººå‘˜è‡ªå·±è¿›è¡Œä»è§’åº¦åˆ°å€¼çš„è½¬æ¢ï¼Œè¿™æ˜¯éå¸¸ä¸ç¤¼è²Œçš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ª`scale`å±æ€§ï¼Œå¼€å‘äººå‘˜å¯ä»¥åœ¨å…¶ä¸­æŒ‡å®šå®Œæ•´æ—‹è½¬çš„å€¼ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°†æ–°å±æ€§æ·»åŠ åˆ°å…ƒç´ ä¸­ã€‚æˆ‘ä»¬æƒ³è¦é€šå¸¸çš„å±æ€§åˆ°å±æ€§çš„é•œåƒï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„â€”â€”æˆ‘ä»¬çš„ç¼ºçœå€¼æ˜¯`1`,å› ä¸º`scale`å°†æ˜¯ä¸€ä¸ªä¹˜æ•°ï¼Œä¹˜ä»¥`0`å°†æ€»æ˜¯ç»™æˆ‘ä»¬...å—¯ï¼Œåˆæ˜¯`0`ã€‚è®©æˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨:

```
// class InputKnob
static get observedAttributes() {
  return ['value', 'scale'];
}

get scale() {
  return this.hasAttribute('scale') ? this.getAttribute('scale') :1;
}

set scale(scale) {
  this.setAttribute('scale', scale);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶è€Œç°åœ¨`value`å’Œ`_angle`ä¾èµ–äº`scale`ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä¸€ç‚¹è¿æ¥è¦åšã€‚æ¯å½“æˆ‘ä»¬çš„ä¸€ä¸ªå±æ€§æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬é‡æ–°è®¡ç®—:

```
attributeChangedCallback(attrName, oldVal, newVal) {
  this._angle = (TWO_PI / this.scale) * (this.value % this.scale);
  this._drawState();
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬çš„`scale`æ˜¯ 10ï¼Œæˆ‘ä»¬çš„`value`æ˜¯ 5ï¼Œé‚£ä¹ˆè¿™åº”è¯¥æ˜¯æ—‹é’®ä¸Šçš„åŠåœˆâ€”â€”æˆ–è€…Ï€çš„`_angle`â€”â€”æˆ–è€…æŒ‡å‘æ­£ä¸‹æ–¹ã€‚

åŒ¹é…çš„éƒ¨åˆ†ç°åœ¨æ˜¯å½“`_angle`æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°`value`ã€‚

```
// _rotationChange()
this.value = this._angle / (TWO_PI / this.scale); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› æ­¤ï¼Œå¦‚æœè§’åº¦ä¸ºÏ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æœŸå¾…å€¼ä¸º 5ã€‚é‚£æ˜¯...å—¯ï¼Œè¿™å®é™…ä¸Šæ˜¯å¢åŠ è§„æ¨¡ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨ä¸‹é¢çš„æ¼”ç¤ºä¸­éªŒè¯è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬å°†ç­‰çº§è®¾ä¸º 10ï¼Œå› æ­¤â¬†ï¸ = 0ï¼Œâ¡ï¸ = 2.5ï¼Œâ¬‡ï¸ = 5ï¼Œâ¬…ï¸ = 7.5ã€‚ç»™å®ƒä¸€ä¸ªğŸ”ƒä¸‹é¢ï¼

[https://glitch.com/embed/#!/embed/building-rotavo-06?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/building-rotavo-06?previewSize=100&path=index.html)

ä½œä¸ºä¸€ä¸ªå°å¥–åŠ±ï¼Œçœ‹çœ‹è¿™ä¸ªæ¼”ç¤ºä¸­çš„ CSSã€‚å¸ƒå±€ä½¿ç”¨äº†å¸¦æœ‰`grid-template-areas`çš„ CSS ç½‘æ ¼å¸ƒå±€ï¼Œåœ¨è¿™é‡Œä½ åŸºæœ¬ä¸Šç»˜åˆ¶äº†ä¸€ä¸ªä½ æƒ³è¦çš„å¸ƒå±€çš„å°æ–‡æœ¬å›¾ã€‚æ‰€ä»¥ï¼Œä¸Šé¢å„é¡¹çš„æ’åˆ—å°±æ˜¯å­—é¢ä¸Šçš„:

```
grid-template-areas: 
  ".  â¬†ï¸ . "
  "â¬…ï¸ ğŸ›ï¸ â¡ï¸"
  ".  â¬‡ï¸ . "; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä¼šåœ¨ç”Ÿäº§ä¸­æ¨èè¿™ä¸ªå—ï¼Ÿè°çŸ¥é“å‘¢...æˆ‘æ˜¯è¯´ï¼Œæˆ‘è§è¿‡æ›´ç³Ÿçš„ã€‚

## [](#enforcing-limits)ğŸ”’å¼ºåˆ¶é™åˆ¶

è™½ç„¶èƒ½å¤Ÿæ— é™æ—‹è½¬æ—‹é’®æœ‰ä¸€å®šçš„å¼‚æƒ³å¤©å¼€çš„è‡ªç”±ï¼Œä½†æˆ‘ä»¬ç»å¸¸éœ€è¦è®¾ç½®ä¸€äº›é™åˆ¶ã€‚å¦‚æœéŸ³é‡æ§åˆ¶å…è®¸ä½äº 0 çš„å€¼ï¼Œé‚£ä¹ˆå®ƒå°±æ²¡æœ‰æ„ä¹‰ï¼Œå¦‚æœéŸ³é‡å¯ä»¥é«˜äº 11ï¼Œè°çŸ¥é“ä¼šæœ‰ä»€ä¹ˆåæœã€‚

è®©æˆ‘ä»¬è®¾ç½®ä¸€äº›å±æ€§æ¥ä¿å­˜å…ƒç´ çš„æœ€å°å’Œæœ€å¤§é™åˆ¶ï¼Œé€‚å½“åœ°å‘½åä¸º`min`å’Œ`max`ã€‚è¿™ä¸æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„`scale`å±æ€§æ˜¯ä¸€æ ·çš„ï¼Œå¸Œæœ›ä¸ä¼šè®©äººæ„Ÿåˆ°æ„å¤–ã€‚

```
// class InputKnob
static get observedAttributes() {
  return ['value', 'scale', 'min', 'max'];
}

get min() {
  return this.hasAttribute('min') ? this.getAttribute('min') : null;
}

set min(min) {
  this.setAttribute('min', parseFloat(min));
}

get max() {
  return this.hasAttribute('max') ? this.getAttribute('max') : null;
}

set max(max) {
  this.setAttribute('max', parseFloat(max));
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é»˜è®¤å€¼æ˜¯`null`,å› ä¸ºå¦‚æœæ²¡æœ‰è®¾ç½®é™åˆ¶ï¼Œæˆ‘ä»¬ä¸æƒ³å¼ºåˆ¶æ‰§è¡Œã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå±æ€§æ˜¯`null` : [![the limit does not exist](../Images/7b689897f8791fed325e1ecdb58ba5c4.png "The limit does not exist.")](https://i.giphy.com/media/7JvlHfd7C2GDr7zfZF/giphy.gif)

è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦é¦–å…ˆæ£€æŸ¥å®ƒä»¬æ˜¯å¦åœ¨ç•Œé™å†…ï¼Œè€Œä¸æ˜¯ä»…ä»…è®¡ç®—å’Œè®¾ç½®`_angle`å’Œ`value`ã€‚è®¡ç®—ä¿æŒä¸å˜ï¼Œæˆ‘ä»¬åªæ˜¯é‡å‘½åä¸º`_attemptedAngle`å’Œ`_attemptedValue`ã€‚ç„¶åï¼Œæˆ‘ä»¬æ£€æŸ¥æ˜¯å¦è®¾ç½®äº†æé™ï¼Œåœ¨æˆ‘ä»¬ä¼ é€’å€¼ä¹‹å‰ï¼Œæˆ‘ä»¬å°è¯•çš„å€¼åœ¨å®ƒçš„å³è¾¹ã€‚

```
// _rotationChange()
this._attemptedAngle =
  this._initialAngle
  - this._initialTouchAngle
  + Math.atan2(this._touchY - this._centerY, this._touchX - this._centerX);
this._attemptedAngle = (this._attemptedAngle + TWO_PI) % TWO_PI;
this._attemptedValue = this._attemptedAngle / (TWO_PI / this.scale);

if (
  (this.min === null || this._attemptedValue >= this.min) &&
  (this.max === null || this._attemptedValue <= this.max)
) {
  this._angle = this._attemptedAngle;
  this.value = this._attemptedValue;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ‰äº†è¿™ä¸ªé€»è¾‘ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªæ—‹é’®æ¥é™åˆ¶å®ƒåœ¨ä¸¤ä¸ªå€¼ä¹‹é—´çš„ç§»åŠ¨:

```
<input-knob value="5" scale="10" min="2.5" max="7.5"> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨æ¼”ç¤ºä¸­å°è¯•ä¸€ä¸‹ã€‚æƒ³æ€ä¹ˆè½¬å°±æ€ä¹ˆè½¬ï¼Œä½†æ˜¯é‚£äº›ä¸Šé™éƒ½æ˜¯ç¦åŒºï¼â›”

[https://glitch.com/embed/#!/embed/building-rotavo-07?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/building-rotavo-07?previewSize=100&path=index.html)

## [](#count-rotations)è®¡æ•°æ—‹è½¬

å¦‚æœä½ æ˜¯é‚£ç§å¤©ç”Ÿå€¾å‘äºç«‹å³ç ´è§£ä½ é¢å‰ç²¾å¿ƒç¼–å†™çš„ä»£ç çš„å·¥ç¨‹å¸ˆï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šæƒ³ï¼Œâ€œå¦‚æœ`max`é«˜äº`scale`ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿâ€å¹¸è¿çš„æ˜¯ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰ä»»ä½•ä¸œè¥¿è¢«ç ´åï¼Œä½†è¿™ç¡®å®è®©é‚£ä¸ª`max`å€¼å˜å¾—æœ‰ç‚¹æ— æ„ä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬æ°¸è¿œæ— æ³•è¾¾åˆ°å®ƒã€‚è‰¯å¥½çš„...é™¤éæˆ‘ä»¬èƒ½è®¡ç®—å‡ºæ—‹è½¬çš„æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œä¸€æ•´åœˆè®©æˆ‘ä»¬åˆ° 10ï¼Œå¦ä¸€æ•´åœˆè®©æˆ‘ä»¬åˆ° 20ï¼Œç­‰ç­‰ã€‚æŠŠå®ƒæƒ³è±¡æˆä¸€å°ç»è½¦æˆ–ä¸€ä¸ªä»äº•é‡Œæ‹‰å‡ºæ°´æ¡¶çš„æ›²æŸ„â€”â€”å½“ä½ è½¬åŠ¨æ›²æŸ„æ—¶ï¼Œç»³å­ä¼šå·è¿›æˆ–å·å‡ºï¼Œç›´åˆ°å®ƒåˆ°è¾¾é¡¶éƒ¨æˆ–åº•éƒ¨ã€‚

æˆ‘ä»¬ä¸ä¼šå°†`_rotations`ä½œä¸ºå±æ€§å…¬å¼€ï¼Œå› ä¸ºå®ƒæ˜¯`value`å’Œ`scale`çš„ç»“æœã€‚å¦‚æœæˆ‘ä»¬çœŸçš„æœ‰å®ƒï¼Œæˆ‘ä»¬å°†éœ€è¦å¼•å…¥ä¸€äº›æ··ä¹±çš„ä¼˜å…ˆè§„åˆ™ï¼Œå¦‚æœä½ è®¾ç½®äº†å†²çªå’Œ...å‘ƒï¼Œæˆ‘ä¸ç¢°é‚£ä¸ªã€‚æ— è®ºå¦‚ä½•ï¼Œè®©æˆ‘ä»¬åœ¨è¿æ¥å…ƒä»¶æ—¶åˆå§‹åŒ–å¯¼å‡ºçš„`_rotations`å€¼ã€‚

```
attributeChangedCallback(attrName, oldVal, newVal) {
  this._angle = (TWO_PI / this.scale) * (this.value % this.scale);
  this._rotations = Math.floor(this.value / this.scale);
  this._drawState();
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ å¯ä»¥çœ‹åˆ°è§’åº¦æ˜¯å¦‚ä½•è®¾ç½®çš„:`_angle`æ˜¯`value`é™¤ä»¥`scale`çš„ä½™æ•°(æˆ–æ¨¡æ•°)ã€‚`_rotations`çš„ä¸ªæ•°æ˜¯`value`é™¤ä»¥`scale`çš„æ•´æ•°å€¼(æˆ–å•†)ã€‚è¿™æ˜¯ç¬¬ä¸€æ ¹æ£‰ç»’ä¸Šçš„`a % b`å’Œç¬¬äºŒæ ¹æ£‰ç»’ä¸Šçš„`Math.floor(a / b)`çš„é…å¯¹ã€‚

ä¸ºäº†è·Ÿè¸ªæ—‹è½¬çš„å˜åŒ–ï¼Œæˆ‘ä»¬è¦æŠŠå…ƒç´ åˆ†æˆå››ä¸ªè±¡é™ã€‚ä»»ä½•ä¸€ä¸ªé¡¶éƒ¨è±¡é™ä¹‹é—´çš„ç§»åŠ¨éƒ½å°†è¢«è§†ä¸ºæ—‹è½¬çš„å˜åŒ–ã€‚

[![A round element with quadrants overlaid. A circular path indicates a touch going from the top-left to the top-right quadrant resulting in an increment to the rotation.](../Images/e52390a8e6c58d8e73ba6cf04c2bba47.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--kSyQdBdA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/35mw7wcsbhby9g6nih32.png)

ç§»å…¥æˆ–ç§»å‡ºè¾ƒä½çš„è±¡é™åªæ˜¯åœ¨åŒä¸€ä¸ªæ—‹è½¬ä¸­çš„è¿åŠ¨ã€‚è¿™ç§å˜åŒ–æ„å‘³ç€æˆ‘ä»¬éœ€è¦è·Ÿè¸ªä»¥å‰çš„è§’åº¦ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨è®¡ç®—æ–°çš„è§’åº¦æ—¶å°±æœ‰äº†æ¯”è¾ƒçš„å¯¹è±¡ã€‚

åœ¨æˆ‘ä»¬çœ‹ä»£ç ä¹‹å‰è¦è€ƒè™‘çš„æœ€åä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬çš„å…ƒç´ ç°åœ¨å®é™…ä¸Šæœ‰ä¸¤ç§æ“ä½œæ¨¡å¼ã€‚ç¬¬ä¸€ä¸ªæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†â€”â€”æ—‹è½¬æ—‹é’®ï¼Œä¸€æ—¦ä½ è¶Šè¿‡ä¸Šé¢çš„`scale`,ç„¶åä½ ç»•åˆ°`0`ã€‚ç„¶è€Œï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨è·Ÿè¸ªæ—‹è½¬ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª`value`ï¼Œå®ƒåœ¨æ¯æ¬¡æ—‹è½¬æ—¶éƒ½ä¼šå¢åŠ ã€‚æ‹¥æœ‰ä¸€ä¸ªè®©ç”¨æˆ·å°†å€¼å¢åŠ åˆ°æ— ç©·å¤§çš„æ§ä»¶å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç¡®ä¿å®ƒä»¥æŸç§æ–¹å¼æœ‰ç•Œã€‚è¿™æ„å‘³ç€æˆ‘ä»¬è¦æ·»åŠ çš„æ£€æŸ¥æ˜¯ï¼Œå¦‚æœè®¾ç½®äº†`min`å’Œ`max`å€¼ï¼Œæˆ‘ä»¬å°†åªè·Ÿè¸ª`_rotations`ã€‚æˆ‘çŸ¥é“ï¼Œæˆ‘çŸ¥é“â€”â€”æˆ‘ä»¬ç›®å‰æ ¹æœ¬æ²¡æœ‰éªŒè¯è¿™äº›å±æ€§...ä½†æ˜¯ï¼Œæˆ‘å¿…é¡»ä¸ºä¸‹ä¸€ç¯‡æ–‡ç« ä¿ç•™ä¸€äº›å†…å®¹ï¼

å¥½ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°è·Ÿè¸ªæ—‹è½¬çš„å˜åŒ–:

```
// _rotationChange()
// Grab the previous angle for comparison
this._previousAttemptedAngle = this._attemptedAngle;
this._attemptedAngle = // âœ‚ï¸ calculate attempted angle

// Track rotations if max and min are set
if (this.max !== null && this.min !== null) {
  // +1 rotation if:
  // new angle is in the top-right quadrant, e.g. < Â½Ï€
  // old angle is in the top-left quadrant, e.g. > 1Â½Ï€
  if (this._attemptedAngle < 1.57 && this._previousAttemptedAngle > 4.71) {
    this._attemptedRotations++;
  }
  // -1 rotation if:
  // old angle is in the top-right quadrant, e.g. < Â½Ï€
  // new angle is in the top-left quadrant, e.g. > 1Â½Ï€
  else if (this._previousAttemptedAngle < 1.57 && this._attemptedAngle > 4.71) {
    this._attemptedRotations--;
  }
}

// New value now includes the rotations
this._attemptedValue =
    (this._attemptedAngle / (TWO_PI / this.scale))
  + (this.scale * this._attemptedRotations);

// Update everything if the value is within bounds
if (
  (this.min === null || this._attemptedValue >= this.min) &&
  (this.max === null || this._attemptedValue <= this.max)
) {
  this._angle = this._attemptedAngle;
  this._rotations = this._attemptedRotations;
  this.value = this._attemptedValue;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¼”ç¤ºæ—¶é—´ï¼è®©æˆ‘ä»¬å¸¦ç€å®ƒå…œä¸€åœˆ(aaayï¼ğŸ¥)åœ¨æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ§åˆ¶ T1 çš„ T0ã€‚å°†å®ƒå‘åç¿»è½¬ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ª`<input-knob>`æ§åˆ¶ä¸€ä¸ª`<input type="range">`ã€‚

æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾ç½®æ ‡ç­¾:

```
<input-knob value="50" scale="10" min="0" max="100">...</input-knob>
<input type="range" class="progress" min="0" max="100"> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åå¯¹`knob-move-change`ä½¿ç”¨åŒä¸€ä¸ªç›‘å¬å™¨ï¼Œæˆ‘ä»¬æ›´æ–°è¿™äº›å€¼:

```
// logEvent()
const curValue = Number.parseFloat(knob.value).toFixed(3);
showValue.textContent = curValue;
range.value = curValue; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œå…ƒç´ æ—‹è½¬ 10 æ¬¡ï¼Œåº”è¯¥å¯ä»¥ä» 0 åˆ°ğŸ’¯ã€‚æˆ‘æƒ³è¿™æ˜¯ä¸ºè¿™æ¬¡å‚èµ›åšå‡†å¤‡çš„ç†æƒ³åœºæ‰€ã€‚

[https://glitch.com/embed/#!/embed/building-rotavo-08?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/building-rotavo-08?previewSize=100&path=index.html)

ä¸‹ä¸€æ¬¡æˆ‘ä»¬å°†ç¡®ä¿æˆ‘ä»¬çš„ç»„ä»¶æ˜¯å¯è®¿é—®çš„ï¼Œå› ä¸ºå°½ç®¡è§¦æ‘¸è¾“å…¥å¾ˆæœ‰è¶£ï¼Œä½†å®ƒå¹¶ä¸æ˜¯æ¯ä¸ªäººéƒ½å¯ä»¥é€‰æ‹©çš„ã€‚

## [](#bonus-content)ğŸé¢å¤–å†…å®¹

å“¦å“¦ï¼Œæˆ‘ä¸èƒ½ç¦»å¼€ä½ ï¼Œæ²¡æœ‰ä¸€ç‚¹å¥–åŠ±ï¼Œæˆ‘èƒ½å—ï¼Ÿæ‰€ä»¥ï¼Œç»§ç»­å€Ÿç”¨æˆ‘åŒäº‹çš„è„¸è¿™ä¸ªæœ‰ç‚¹å¯ç–‘çš„ä¼ ç»Ÿ(è°¢è°¢/å‘æ°å…‹Â·é˜¿å¥‡åšå°”å¾·é“æ­‰)è¯·éšæ„å‘ç°å½“ä½ ç»“æŸè¿™ä¸ªçš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆ...ã€Šç›’å­é‡Œçš„æ°å…‹ã€‹ã€‚

[https://glitch.com/embed/#!/embed/jake-in-the-box?previewSize=100&path=index.html](https://glitch.com/embed/#!/embed/jake-in-the-box?previewSize=100&path=index.html)