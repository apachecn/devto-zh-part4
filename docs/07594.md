# å¦‚ä½•ç”¨ AJAX å‘é€ Django è¡¨å•

> åŸæ–‡:[https://dev . to/the pylot/how-to-send-django-form-with-Ajax-4 BPO](https://dev.to/thepylot/how-to-send-django-form-with-ajax-4bpo)

æ€ä¹ˆäº† **DEV** Networkï¼Ÿ

åœ¨è¿™ä¸ªå¿«é€Ÿæ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ AJAX åœ¨ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹å‘å¸ƒ Django è¡¨å•ã€‚

æˆ‘å‡è®¾æ‚¨å·²ç»åˆ›å»ºäº†æ‚¨çš„é¡¹ç›®ã€‚è®©æˆ‘ä»¬ä»åœ¨ **models.py** ä¸­åˆ›å»ºéå¸¸ç®€å•çš„ Post æ¨¡å‹å¼€å§‹

```
from django.db import models

class Post (models.Model):
    title = models.CharField(max_length=50)
    description = models.TextField()

    def __str__(self):
        return self.title 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€æ—¦åˆ›å»ºäº† open **views.py** å¹¶æ’å…¥ä»¥ä¸‹ä»£ç :

```
from django.shortcuts import render
from django.http import JsonResponse
from .models import Post

def create_post(request):
    posts = Post.objects.all()
    response_data = {}

    if request.POST.get('action') == 'post':
        title = request.POST.get('title')
        description = request.POST.get('description')

        response_data['title'] = title
        response_data['description'] = description

        Post.objects.create(
            title = title,
            description = description,
            )
        return JsonResponse(response_data)

    return render(request, 'create_post.html', {'posts':posts}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬å¯¼å…¥äº† **JsonResponse** ï¼Œè¿™æ˜¯ä¸€ä¸ª HttpResponse å­ç±»ï¼Œæœ‰åŠ©äºåˆ›å»º JSON ç¼–ç çš„å“åº”ã€‚é»˜è®¤çš„å†…å®¹ç±»å‹å¤´è®¾ç½®ä¸º application/jsonã€‚ç¬¬ä¸€ä¸ªå‚æ•° data åº”è¯¥æ˜¯ä¸€ä¸ª dict å®ä¾‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ JSON æ•°æ®ç«‹å³æ˜¾ç¤ºåˆ›å»ºçš„å¸–å­ã€‚

æˆ‘å¼ºçƒˆå»ºè®®æ‚¨çœ‹çœ‹ä¸‹é¢çš„ StackOverflow é—®é¢˜ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£**è¯·æ±‚ä¹‹é—´çš„å·®å¼‚ã€‚å‘å¸ƒ[]** å’Œ**è¯·æ±‚ã€‚POST.get()**

<header>![](../Images/540c2ba90e5a347bd57c676bb96dfee0.png) [request.POST.get('sth') vs request.POST['sth'] - difference?](https://stackoverflow.com/questions/12518517/request-post-getsth-vs-request-poststh-difference) Sep 20 '12 Comments: 1 Answers: 3[![](../Images/83f13d376e6608cc602ae93b1cdbae4e.png)99![](../Images/fd423aaf5fec73c645f97544689ea934.png)](https://stackoverflow.com/questions/12518517/request-post-getsth-vs-request-poststh-difference) </header>

æœ‰ä»€ä¹ˆåŒºåˆ«

```
request.POST.get('sth') 
```

å’Œ

```
request.POST['sth'] 
```

æ²¡æœ‰æ‰¾åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œä¸¤è€…å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€æ ·çš„ï¼Œå‡è®¾æˆ‘å¯ä»¥åˆ†åˆ«ä½¿ç”¨å®ƒä»¬ï¼Œä½†ä¹Ÿè®¸æˆ‘é”™äº†ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘é—®ã€‚æœ‰ä»€ä¹ˆæƒ³æ³•å—ï¼Ÿ

[Open Full Question](https://stackoverflow.com/questions/12518517/request-post-getsth-vs-request-poststh-difference)

å¦‚æœæ‚¨çš„é¡µé¢ä¸­æœ‰å¤šä¸ªè¡¨å•ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨**åŠ¨ä½œ**å°†å®ƒä»¬åˆ†å¼€ï¼Œè¿™æ ·æ‚¨çš„è§†å›¾å°±ä¸ä¼šåŒæ—¶æ”¶åˆ°å¤šä¸ªè¯·æ±‚ã€‚

ä¸ºäº†åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­åˆ›å»ºå¹¶ä¿å­˜ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† **create()** æ–¹æ³•ã€‚

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„ html è¡¨å•

```
<form method="POST" id="post-form">
  {% csrf_token %}
  <div class="form-group">
    <label>Title</label>
    <input type="text" class="form-control" id="title" placeholder="Title">
  </div>
   <div class="form-group">
     <label>Description</label>
     <textarea class="form-control" id="description" placeholder="Description"></textarea>
   </div>
   <button type="submit" class="btn btn-primary">Submit</button>
</form> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚ä½ æ‰€çŸ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ csrf_token æ¥å‘å‡º post è¯·æ±‚ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„å¼•å¯¼è¡¨å•ã€‚æˆ‘ä»¬ç»™æ¯ä¸ªè¾“å…¥ä¸€ä¸ª idï¼Œç”¨ AJAX é€šè¿‡ id è·å–å€¼ã€‚

```
$(document).on('submit', '#post-form',function(e){
    $.ajax({
        type:'POST',
        url:'{% url "create" %}',
        data:{
            title:$('#title').val(),
            description:$('#description').val(),
            csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
            action: 'post'
        },
        success:function(json){
            document.getElementById("post-form").reset();
            $(".posts").prepend('<div class="col-md-6">'+
                '<div class="row no-gutters border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">' +
                    '<div class="col p-4 d-flex flex-column position-static">' +
                        '<h3 class="mb-0">' + json.title + '</h3>' +
                        '<p class="mb-auto">' + json.description + '</p>' +
                    '</div>' +
                '</div>' +
            '</div>' 
            )
        },
        error : function(xhr,errmsg,err) {
        console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
    }
    });
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯·æ³¨æ„ï¼Œæ‚¨å¿…é¡»å°† jquery-2.2.4.min.js åŒ…å«åˆ°æ‚¨çš„é™æ€æ–‡ä»¶ä¸­ï¼Œæ‚¨å¯ä»¥ä»æˆ‘çš„ [git å­˜å‚¨åº“](https://github.com/raszidzie/django-form-with-ajax)ä¸­è·å–å®ƒã€‚

å¥½å§ï¼è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæœ€åˆï¼Œå‘è¡¨å•æ·»åŠ  id å±æ€§å¾ˆé‡è¦ï¼Œè¿™æ · jQuery å°±å¯ä»¥æ£€æµ‹è¡¨å•æäº¤ã€‚AJAX **type** æŒ‡å®š post è¯·æ±‚çš„ç±»å‹ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å‘æ•°æ®åº“å‘é€æ•°æ®ï¼Œè€Œ **url** æŒ‡å®šå‘é€è¯·æ±‚çš„ urlã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ val()æ–¹æ³•é€šè¿‡ id è·å–è¡¨å•å…ƒç´ çš„å€¼ï¼Œå¹¶å°†å…¶ä¸æŒ‡å®šè¦å‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®çš„**æ•°æ®**å‚æ•°ä¸€èµ·å‘é€ã€‚å¿…é¡»è·å– csrf_token çš„å€¼ï¼Œå¦åˆ™å°†å¯¼è‡´ 403 ç¦æ­¢é”™è¯¯ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªåŠ¨ä½œï¼Œè®©è§†å›¾æ£€æµ‹å“ªä¸ªè¡¨å•æ­£åœ¨æäº¤ã€‚

ä¸€æ—¦è¯·æ±‚æˆåŠŸå‘é€ï¼Œæˆ‘ä»¬å°†æ¸…ç†è¡¨å•ï¼Œå¹¶å°†æˆ‘ä»¬çš„æ–°å¸–å­æ·»åŠ åˆ°å¸–å­è¡Œä¸­ã€‚

> çš„ã€‚prepend()æ–¹æ³•å°†æŒ‡å®šçš„å†…å®¹ä½œä¸º jQuery é›†åˆä¸­æ¯ä¸ªå…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ æ’å…¥(è¦å°†å…¶ä½œä¸ºæœ€åä¸€ä¸ªå­å…ƒç´ æ’å…¥ï¼Œè¯·ä½¿ç”¨ã€‚append())ã€‚

å¦‚æœå‘é€è¯·æ±‚æ—¶å‡ºç°é”™è¯¯(æˆ‘å¸Œæœ›ä¸æ˜¯ğŸ˜…)ç„¶åæœ€åä¸€ä¸ªå‡½æ•°ä¼šå°†è¿™ä¸ªé”™è¯¯ä¿¡æ¯æ·»åŠ åˆ°æ§åˆ¶å°ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥çœ‹åˆ°æ˜¯ä»€ä¹ˆå¯¼è‡´äº†è¿™ä¸ªä»¤äººè®¨åŒçš„é”™è¯¯ã€‚æˆ‘çŒœä½ å·²ç»çŸ¥é“å¦‚ä½•å¾ˆå¥½åœ°å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯ã€‚

æœ€åä½ ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœ

[![](../Images/32cb86baa6fa41c36cab0e6be26baee6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Na9XwbDG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/c1zafuarla7lhtg8a99g.gif)

#### ä»»åŠ¡å®Œæˆï¼

æ‚¨åˆšåˆšå­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ AJAX å‘å¸ƒ Django è¡¨å•ğŸš€ğŸš€

ä½ å¯ä»¥ä»æˆ‘çš„ [git åº“](https://github.com/raszidzie/django-form-with-ajax)å…‹éš†æˆ–ä¸‹è½½è¿™ä¸ªé¡¹ç›®ï¼Œåˆ«å¿˜äº†åœ¨ **twitter** å’Œ **instagram** ä¸Šå…³æ³¨å’Œæ”¯æŒæˆ‘ï¼ŒåŠ å…¥é€†å‘å®‡èˆªå‘˜ç¤¾åŒºï¼ğŸ‘¨â€ğŸš€ä¸‹æ¬¡æ•™ç¨‹è§ï¼

## # [å§œæˆˆ](https://dev.to/t/django) <button name="button" type="button" data-info="{&quot;className&quot;:&quot;Tag&quot;,&quot;style&quot;:&quot;full&quot;,&quot;id&quot;:446,&quot;name&quot;:&quot;django&quot;}" class="crayons-btn follow-action-button whitespace-nowrap c-btn--secondary fs-base " aria-label="Follow tag: django" aria-pressed="false">è·Ÿéš</button>

Django is a high-level Python Web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of Web development, so you can focus on writing your app without needing to reinvent the wheel. Itâ€™s free and open source.