# ååº”å…¥å£äº®äº†ğŸ”¥

> åŸæ–‡:[https://dev.to/theaswathprabhu/portals-are-lit-31l8](https://dev.to/theaswathprabhu/portals-are-lit-31l8)

æœ€è¿‘ï¼Œæœ‰äººå‘æˆ‘ä»‹ç»äº† Reacts çš„ createPortal APIï¼Œè¿™ç®€ç›´å¤ªæ£’äº†ã€‚

æˆ‘æ¥å’Œå®ƒåˆ†äº«ä¸€ä¸‹æˆ‘çš„ç»å†å§ï¼

ä½œä¸ºä¸€åä¸“ä¸šçš„ Ember å¼€å‘è€…ï¼Œæˆ‘å¯¹ React çš„çƒ­çˆ±ä»æœªæ¶ˆé€€ã€‚React çš„é¢å‘ç»„ä»¶çš„æ¶æ„æé«˜äº†ç”Ÿäº§ç‡ï¼Œç¡®ä¿äº†ä»£ç çš„ç¨³å®šæ€§ï¼Œå¹¶å¾—åˆ°äº†å¼ºå¤§ç¤¾åŒºçš„æ”¯æŒã€‚

æˆ‘ä¸æƒ³è®©ä½ åŒçƒ¦ï¼Œä½ (å¯èƒ½æ˜¯è®¸å¤šç½‘ç»œå¼€å‘è€…)åœ¨**ä¾‹è¡Œç¨‹åº**ä¸­å¬åˆ°çš„è¿™ç±»äº‹æƒ…ã€‚

æˆ‘æƒ³ï¼Œæ˜¯æ—¶å€™ç”¨é—¨æˆ·ç½‘ç«™å¼„è„æˆ‘ä»¬çš„æ‰‹äº†ğŸ”¥

**'é—¨æˆ·æä¾›äº†ä¸€ç§ä¸€æµçš„æ–¹å¼æ¥å°†å­ç»„ä»¶å‘ˆç°åˆ°ä¸€ä¸ª DOM èŠ‚ç‚¹ä¸­ï¼Œè¯¥èŠ‚ç‚¹å­˜åœ¨äºçˆ¶ç»„ä»¶'**'çš„ DOM å±‚æ¬¡ç»“æ„ä¹‹å¤–

ä¸€èˆ¬æ¥è¯´ï¼Œä¸–ç•Œä¸Šä¸æ˜¯æ¯ä¸ªäººéƒ½èƒ½ä¸€çœ¼å°±ç†è§£å®˜æ–¹æ–‡ä»¶ä¸­çš„å®šä¹‰ï¼è‡³å°‘ä¸æ˜¯æˆ‘ï¼(å¼€ä¸ªç©ç¬‘ï¼Œé—¨æˆ·ç½‘ç«™ä¸Šçš„ Reacts æ–‡æ¡£æ›´é€‚åˆåˆå­¦è€…ï¼Œ[å»çœ‹çœ‹](https://reactjs.org/docs/portals.html))

æ‰€ä»¥æˆ‘å†³å®šé‡‡ç”¨ä¸€ç§å®ç”¨çš„æ–¹æ³•:

å¦‚å®šä¹‰ä¸­æ‰€è¿°ï¼Œé—¨æˆ·æä¾›äº†ä¸€ç§åœ¨ DOM ä¸­çš„å…¶ä»–åœ°æ–¹å‘ˆç° react ç»„ä»¶**çš„å­ç»„ä»¶çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯åœ¨åŒä¸€ä¸ªå±‚æ¬¡ç»“æ„ä¸­ï¼**

å½“æˆ‘æ„è¯†åˆ°è¿™ä¸€ç‚¹æ—¶ï¼Œæˆ‘é™¤äº†é—®é¢˜ä»€ä¹ˆéƒ½æ²¡æœ‰äº†ã€‚

OMG äº‹ä»¶å†’æ³¡æ€ä¹ˆåŠï¼Ÿå’Œè®¸å¤š...

ä½œä¸ºä¸€åä¸“ä¸šçš„ ember å¼€å‘è€…ï¼Œæˆ‘ä½¿ç”¨è¿‡ [Ember è™«æ´](https://github.com/yapplabs/ember-wormhole)ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ’ä»¶ï¼Œå¯èƒ½åœ¨ Ember ä¸­åšç±»ä¼¼çš„å·¥ä½œã€‚

æˆ‘ç»§ç»­æ·±å…¥ç ”ç©¶ä¼ é€é—¨ã€‚æˆ‘æ¢ç´¢çš„ä¸€ä»¶äº‹æ˜¯å®ƒåœ¨[æ¨¡æ€å¯¹è¯æ¡†](https://www.w3.org/TR/wai-aria-practices-1.1/#dialog_modal)ä¸­çš„ç”¨ä¾‹ã€‚

æˆ‘åœ¨ react ä¸­ç”¨ bootstrap æ„å»ºäº†ä¸€ä¸ªæ¨¡æ€ç»„ä»¶(è¦†ç›–äº†ä¸€äº› bootstrap æ ·å¼),å¦‚ä¸‹æ‰€ç¤ºğŸ‘‡

```
//Modal.js
import React from "react";
import ReactDOM from "react-dom";
export default class Modal extends React.Component {
  onClose = e => {
    this.props.onClose && this.props.onClose(e);
  };
  render() {
    let modal = (<div
      class="modal fade"
      id="exampleModalCenter"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">
              Modal title
            </h5>
            <button
              type="button"
              class="close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">...</div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary">
              Save changes
            </button>
          </div>
        </div>
      </div>
    </div>
    );
    return (modal);
  }
} 
```

æˆ‘å°æ—¶å€™åœ¨ App ä¸Šæ¸²æŸ“è¿‡ğŸ‘‡

```
//App.js 
import React from "react";
import Modal from "./Modal-Compo";

export default class App extends React.Component {
  onClose = e => {
    this.props.onClose && this.props.onClose(e);
  };

  render() {
    let alignCenter = {
      display: "flex",
      alignItems: "center",
      justifyCenter: "center",
      height: "200px",
      overflow: "hidden",
      width: "50%",
      margin: "auto",
      marginTop: "10%"
    };
    return (
    <div style={alignCenter}>
      <p style={{ height: "100%", margin: "0" }}>
        //some random 100 lines
      </p>
      <Modal onClose={this.onClose}/>
    </div>
  )
 }
} 
```

æœ€ååœ¨æ ¹å…ƒç´ ä¸­å‘ˆç° App ç»„ä»¶ğŸ‘‡

```
//Index.js
import React from "react";
import ReactDOM from "react-dom";
import "bootstrap/dist/css/bootstrap.min.css";
import "jquery/dist/jquery.min.js";
import "bootstrap/dist/js/bootstrap.min.js";
import App from "./components/App";
import "./styles.css";

function WhatAreModals() {
  return (
    <div style={{ height: "100vh" }} className="App">
      <App />
      <button
        type="button"
        className="btn btn-primary"
        data-toggle="modal"
        data-target="#exampleModalCenter"
      >
        Launch demo modal
      </button>
    </div>
  );
}

const rootElement = document.getElementById("root");
ReactDOM.render(<WhatAreModals />, rootElement); 
```

æˆ‘çš„åŸå‹ç»ˆäºåšå¥½äº†ğŸ˜„

å½“æˆ‘å•å‡»å¯åŠ¨æ¼”ç¤ºæ¨¡å¼ CTA æ—¶ï¼Œå‡ºç°äº†è¿™ç§æƒ…å†µ(oopsy)ğŸ˜•

[![](../Images/87a2c995c789879d7e5848658507b7ad.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ojg5cDd9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://i.imgur.com/3PFoAgv.gif)

ç½ªé­ç¥¸é¦–æ˜¯æ ·å¼ä¸º **'overflow:hidden'** çš„åº”ç”¨ç¨‹åºç»„ä»¶ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ¨¡æ€ç»„ä»¶è¢«å‘ˆç°ä¸ºæº¢å‡ºè¢«éšè—çš„åº”ç”¨ç¨‹åºçš„å­ç»„ä»¶ï¼Œæˆ‘ä»¬çš„æ¨¡æ€æ°¸è¿œä¸ä¼šå‡ºç°ğŸ˜©

è¿™å°±æ˜¯æ•‘ç”Ÿé—¨æˆ·çš„ç”¨æ­¦ä¹‹åœ°ğŸ”¥

æˆ‘åªæ˜¯åœ¨æˆ‘çš„æ¨¡æ€ç»„ä»¶å’Œ index.html ä¸­åšäº†ä¸€ä¸ªè°ƒæ•´(ä¸ºè¦å‘ˆç°çš„æ¨¡æ€åˆ›å»ºäº†å¦ä¸€ä¸ªæ ¹å…ƒç´ )

```
//index.html
<div id="root"></div> <div id="modal-root"></div> 
```

åœ¨é—¨æˆ·ä¸­å‘ˆç°æ¨¡å¼ï¼Œé€šè¿‡å®ç° **createPortal**
æ›´æ”¹è¿”å›è¯­å¥

```
//Modal.js
ReactDOM.createPortal(modal, document.getElementById("modal-root")); 
```

å®ƒæ— ç¼è¿è¡Œï¼Œ

[![](../Images/55a198c80ab71f60dc3a29915984d6fe.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Ua4ckzet--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://i.imgur.com/UIzQ4zs.gif)

è¿™ä¸ªé—®é¢˜é€šè¿‡å°†æ¨¡æ€ç»„ä»¶ä»å®¹å™¨å’Œå±‚æ¬¡ç»“æ„ä¸­åˆ†ç¦»å‡ºæ¥å¾—åˆ°äº†è§£å†³ã€‚

ä½†çªç„¶æˆ‘é™·å…¥äº†å›°æƒ‘ï¼Œå› ä¸ºç­‰çº§åˆ¶åº¦è¢«æ‰“ç ´äº†ï¼Œæˆ‘æ€€ç–‘äº‹ä»¶å†’æ³¡æ˜¯å¦ä¼šå‘ç”Ÿï¼Ÿ(æˆ‘æƒ³ï¼Œå¾ˆå¤šäººä¼šè´¨ç–‘è¿™ä¸€ç‚¹ï¼).

æˆ‘ç»§ç»­**æ·±å…¥æŒ–æ˜**ğŸ˜

æœ¬æœº DOM å¿«ç…§:

[![](../Images/c6e056e72e35c5e075f3fda1a0ea1224.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--GaFvBfFW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/8H0KGDq.png)

ååº” DOM:

[![](../Images/08b5ded243d329ebe2c84cff480aa4bb.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--JQpo49QB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i.imgur.com/UPk7x6D.png)

æœ€åï¼Œæˆ‘å¾ˆæ»¡æ„çœ‹åˆ°è¿™ä¸€ç‚¹ï¼Œå¯èƒ½å¾ˆå¤šäººä¼šğŸ˜Œä»å¿«ç…§ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ Reacts çš„è™šæ‹Ÿ DOM ä¸­çš„å±‚æ¬¡ç»“æ„æ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥äº‹ä»¶å†’æ³¡å¾ˆå®¹æ˜“å‘ç”Ÿã€‚

å½“çˆ¶ç»„ä»¶æœ‰ä¸€ä¸ª**æº¢å‡º:éšè—**æˆ– **z ç´¢å¼•æ ·å¼**æ—¶ï¼Œé—¨æˆ·å¯ä»¥è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†æ˜¯ä½ éœ€è¦å­ç»„ä»¶åœ¨è§†è§‰ä¸Šâ€œçªç ´â€å®ƒçš„å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œå¯¹è¯æ¡†ã€æ‚¬åœå¡å’Œå·¥å…·æç¤ºã€‚

æˆ‘è§‰å¾—è¿™ç¯‡æ–‡ç« ä¼šè®©ä½ å¯¹ Reacts çš„ createPortal API æ„Ÿåˆ°æ»¡æ„ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œä¹Ÿå¯ä»¥å’Œä½ çš„åŒäº‹åˆ†äº«ã€‚