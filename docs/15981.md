# JavaScript ä¸­çš„ååº”å¼ç¼–ç¨‹ç®€ä»‹

> åŸæ–‡:[https://dev . to/daslaf/an-introduction-to-reactive-programming-in-JavaScript-140 a](https://dev.to/daslaf/an-introduction-to-reactive-programming-in-javascript-140a)

> æœ¬æ–‡åŸè½½è¥¿ç­ç‰™æ–‡[æ­¤å¤„](https://medium.com/@osmancea/programaci%C3%B3n-reactiva-en-javascript-997478d45bfb)ã€‚

ååº”å¼ç¼–ç¨‹æ˜¯ä¸€ç§å£°æ˜å¼ç¼–ç¨‹èŒƒä¾‹ï¼Œä¸»è¦å…³æ³¨(1)æ•°æ®æµçš„ä½¿ç”¨å’Œ(2)å˜åŒ–ä¼ æ’­ã€‚ååº”å¼ç¼–ç¨‹çš„åŸåˆ™æ˜¯ä¸€åˆ‡éƒ½æ˜¯ä¸€ä¸ªæµã€‚

ä½†æ˜¯å¥¥æ–¯æ›¼ï¼Œä»€ä¹ˆæ˜¯æºªæµï¼Ÿ

[![Yeah, Osman. What is a stream?](../Images/2d34a2880c368db3ab9eee6457296539.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--C-nOqlNS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2400/1%2AicV5kXGwDQnTKgVBY7Ourg.jpeg)

<figcaption>Yeah, Osman. What is a stream?</figcaption>

### [](#about-streams)å…³äºæºªæµ

#### [](#according-to-wikipedia)æ®ç»´åŸºç™¾ç§‘:

> åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæµæ˜¯ä¸€æ®µæ—¶é—´å†…å¯ç”¨çš„æ•°æ®å…ƒç´ åºåˆ—ã€‚ä¸€ä¸ªæµå¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¼ é€å¸¦ä¸Šçš„é¡¹ç›®ï¼Œä¸€æ¬¡å¤„ç†ä¸€ä¸ªï¼Œè€Œä¸æ˜¯æˆæ‰¹å¤„ç†ã€‚

åº”ç”¨ååº”å¼ç¼–ç¨‹çš„*ç¦…*:åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­è§¦å‘çš„æ‰€æœ‰æ•°æ®å’Œäº‹ä»¶éƒ½å¯ä»¥è¡¨ç¤ºä¸ºéšæ—¶é—´å˜åŒ–çš„æ•°æ®æµï¼›å½“æˆ‘ä»¬å¯¹è¿™äº›å˜åŒ–åšå‡ºååº”æ—¶ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ˜¯è¢«åŠ¨çš„ã€‚

æˆ‘èƒ½æƒ³åˆ°çš„æœ€å¸¸è§çš„ååº”æ€§ä¾‹å­å¦‚ä¸‹:

```
const $increment = document.querySelector('#increment');
let counter = 0;

$increment.addEventListener('click', onIncrement);

function onIncrement(event) {
  counter += 1;
} 
```

æ˜¯çš„ï¼Œå½“æ³¨å†Œ`onIncrement`ä¸ºç‚¹å‡»äº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ååº”å¼ç¼–ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸€æ¬¡ç‚¹å‡»`$increment`æŒ‰é’®çœ‹ä½œä¸€æ®µæ—¶é—´å†…çš„äº‹ä»¶é›†åˆï¼Œå¯¹äºæ¯ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬è¿è¡Œ`onIncrement`æ¥ä½œå‡ºååº”ã€‚

ä½†æ˜¯ä¸ä»…ç‚¹å‡»å¯ä»¥è¡¨ç¤ºä¸ºæµã€‚æ¯æ¬¡æ‰§è¡Œ`onIncrement`æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¹å˜`counter`çš„å€¼ï¼Œå› æ­¤`counter`çš„å€¼ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæµã€‚

è®©æˆ‘ä»¬åœ¨ç¤ºä¾‹ä¸­å†æ·»åŠ å‡ ä¸ªå‡½æ•°:

```
const $increment = document.querySelector('#increment');
const $decrement = document.querySelector('#decrement');
const $double = document.querySelector('#double');
const $halve = document.querySelector('#halve');

let counter = 0;

$increment.addEventListener('click', onIncrement);
$decrement.addEventListener('click', onDecrement);
$double.addEventListener('click', onDouble);
$halve.addEventListener('click', onHalve);

function onIncrement(e) {
  counter += 1;
}
function onDecrement(e) {
  counter -= 1;
}
function onDouble(e) {
  counter *= 2;
}
function onHalve(e) {
  counter /= 2;
} 
```

æ¯æ¬¡æˆ‘ä»¬ç‚¹å‡»ä»»ä½•æŒ‰é’®æ—¶,`counter`çš„å€¼éƒ½ä¼šæ”¹å˜ï¼Œå¹¶è¢«è®°å½•åˆ°æ§åˆ¶å°ä¸­ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨æˆ‘ä»¬çš„äº‹ä»¶ç›‘å¬å™¨å›è°ƒä¸­æ”¹å˜`counter`çš„å€¼å¹¶ä¸æ˜¯æœ€å¥½çš„åšæ³•:å³ä½¿æˆ‘ä»¬è¡¨è¾¾äº†ä»¥æŸç§æ–¹å¼æ”¹å˜`counter`çš„æ„å›¾ï¼Œä¹Ÿä¸æ¸…æ¥š`counter`çš„å€¼æ˜¯ä¸€ç»„ç‰¹å®šæ“ä½œçš„ç»“æœã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥åƒè¿™æ ·è¡¨è¾¾å‰é¢çš„ä»£ç ï¼Œé‚£ä¼šå¥½å¾—å¤š(æˆ–è€…æ›´å…·å£°æ˜æ€§):

```
let counter = 0;

combine(
  onIncrementClick,
  onDecrementClick,
  onDoubleClick,
  onHalveClick,
).observe(result => {
  counter = result;
  console.log(result);
}); 
```

æˆ‘æ•¢è¯´ï¼Œå³ä½¿ä¸çŸ¥é“`combine`å’Œ`observe`å‡½æ•°çš„å®ç°ç»†èŠ‚ï¼Œä¹Ÿèƒ½æ›´æ¸…æ¥šã€æ›´å®¹æ˜“åœ°ç†è§£ç¨‹åºçš„æ„å›¾:ä»ä¸€ä¸ªåˆå§‹å€¼å¹¶ç»“åˆä¸€ç»„å‡½æ•°ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ–°çš„ counter å€¼ã€‚

è®©æˆ‘ä»¬å›åˆ°ä¸€åˆ‡éƒ½æ˜¯æµçš„è§‚ç‚¹ã€‚

[![A stream of clicks](../Images/7a69cb20ab17d5d1093f6319684a2390.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--YkXdu4bh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1600/1%2AB57bZMoQuDVdREkpjVcwKg.jpeg)

<figcaption>Representation of clicks on $increment over time</figcaption>

ä¸Šé¢çš„å¤§ç†çŸ³å›¾æ˜¯ä¸€æ®µæ—¶é—´å†…æŒ‰é’®`$increment`ä¸Šçš„ç‚¹å‡»äº‹ä»¶çš„è¡¨ç¤ºï¼Œæˆ–è€…ç”¨æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€å­¦çš„æ¦‚å¿µæ¥è¡¨è¿°ï¼Œä¸€ç³»åˆ—çš„ç‚¹å‡»ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ºæ¯ä¸ªæŒ‰é’®è®¾å®šä¸€ä¸ªæ—¶é—´çº¿:

[![More streams](../Images/63bf8093bd55bc25f5ce5772425c5f9e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--LvJqeZDo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1600/1%2AKBK96fR2xSAmvYw1Y1TRtQ.jpeg)

å½“åˆå¹¶æˆ‘ä»¬çš„æµæ—¶ï¼Œæˆ‘ä»¬äº§ç”Ÿäº†å¦ä¸€ä¸ªæµï¼Œç§°ä¸º`clicks`ã€‚è¯¥æµè¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´å†…ç‚¹å‡»äº†å“ªäº›æŒ‰é’®ã€‚å¦‚æœæˆ‘ä»¬å°†æ¯ä¸ªç‚¹å‡»æµä¸ä¸€ä¸ªæ›´æ–°`counter`å€¼çš„å‡½æ•°ç›¸å…³è”ï¼Œæˆ‘ä»¬çš„`clicks`æµä¹Ÿå¯ä»¥ä»£è¡¨`counter`éšæ—¶é—´çš„å€¼ã€‚

ç¨åæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å°†æˆ‘ä»¬çš„äº‹ä»¶ç»„åˆæˆä¸€ä¸ªå•ç‹¬çš„æµã€‚

æ¾„æ¸…äº†æµçš„æœ¬è´¨ä¹‹åï¼Œè®©æˆ‘ä»¬æ¥è°ˆè°ˆååº”å¼ç¼–ç¨‹ä¸­çš„ç¬¬äºŒä¸ªé‡è¦æ¦‚å¿µï¼Œå³å˜æ›´ä¼ æ’­ã€‚

### [](#what-is-change-propagation)ä»€ä¹ˆæ˜¯å˜åŒ–ä¼ æ’­ï¼Ÿ

å˜åŒ–ä¼ æ’­åŸºæœ¬ä¸Šæ˜¯æˆ‘ä»¬å¦‚ä½•é€šçŸ¥ç¨‹åºçš„ä¸€ä¸ªæ¨¡å—å®ƒçš„ä¸€äº›ä¾èµ–å…³ç³»å·²ç»æ”¹å˜(æˆ–è€…ä¸€äº›äº‹ä»¶å·²ç»å‘ç”Ÿ)å¹¶ä¸”å®ƒå¿…é¡»ç›¸åº”åœ°ä½œå‡ºååº”ã€‚

åœ¨ååº”å¼ç³»ç»Ÿä¸­ï¼Œå˜é©å‘èµ·è€…å’Œå¯¹è¿™äº›å˜é©åšå‡ºååº”çš„äººä¹‹é—´çš„å·¥æ•ˆå­¦ä¸ä¸»åŠ¨å¼ç³»ç»Ÿæœ‰ç€ä¸åŒçš„æ„æˆã€‚

[AndrÃ© Staltz](https://twitter.com/andrestaltz) åœ¨[è¿™ä¸ªæ¼”è®²](https://www.youtube.com/watch?v=49dMGC1hM1o&feature=youtu.be&t=2m46s)ä¸­ç²¾å½©åœ°è§£é‡Šäº†è¿™ç§å…³ç³»ã€‚

æ€»ä¹‹ï¼Œåœ¨å‰æ‘„ç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸€ä¸ªæ¨¡å—è§¦å‘äº†å¦ä¸€ä¸ªæ¨¡å—ä¸Šçš„å˜åŒ–ï¼Œåˆ™å‰è€…ä¾èµ–åè€…ã€‚åœ¨ååº”ç³»ç»Ÿä¸­ï¼Œå…³ç³»æ˜¯ç›¸åçš„ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä»£ç ç¤ºä¾‹æ¥çœ‹çœ‹è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„:

```
class Cart {
  constructor(invoice) {
    this.items = [];
    this.invoice = invoice;
  }

  addItem(item) {
    this.items.push(item);
  }

  checkout() {
    const total = this.items.reduce(
      (acc, item) => acc + item.price,
      0
    );

    this.invoice.update(total);
  }
}

class Invoice {
  constructor() {
    this.total = 0;  
  }

  update(total) {
    this.total = total;
  }
}

const invoice = new Invoice();
const cart = new Cart(invoice);

cart.addItem({ name: 'Miller Lite', price: 1.99 });
cart.addItem({ name: 'Chips', price: 1.50 });
cart.checkout();

console.log(invoice.total); // 3.49 
```

`Cart`ç±»ä¾èµ–`Invoice`(æˆ‘ä»¬å°†`Invoice`çš„ä¸€ä¸ªå®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°å‚æ•°ä¼ é€’ç»™`Cart`)ã€‚å½“æˆ‘ä»¬è°ƒç”¨`checkout`æ–¹æ³•æ—¶ï¼Œ`Invoice`ä¸Šçš„`update`æ–¹æ³•è¢«ç›´æ¥è°ƒç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è§¦å‘äº†ä»`Cart`ç±»åˆ°`Invoice`ç±»çš„å˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬çš„ç³»ç»Ÿæ˜¯ä¸»åŠ¨çš„ã€‚

æˆ‘ä»¬æ¥çœ‹çœ‹ååº”å‹çš„:

```
const EventEmitter = require('events');

class Cart {
  constructor() {
    this.items = [];
    this.emitter = new EventEmitter();
  }

  addItem(item) {
    this.items.push(item);
  }

  checkout() {
    const total = this.items.reduce(
      (_total, item) => _total + item.price,
      0
    );

    this.emitter.emit('checkout', total);
  }
}

class Invoice {
  constructor(cart) {
    this.total = 0;
    this.cart = cart;

    this.cart.emitter.on('checkout', this.update.bind(this));
  }

  update(total) {
    this.total = total;
  }
}

const cart = new Cart();
const invoice = new Invoice(cart);

cart.addItem({ name: 'Miller Lite', price: 1.99 });
cart.addItem({ name: 'Chips', price: 1.50 });
cart.checkout();

console.log(invoice.total); // 3.49 
```

è¿™é‡Œçš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œç°åœ¨`Invoice`å°†`Cart`ä½œä¸ºä¾èµ–é¡¹ï¼Œä¸å‰é¢çš„ä¾‹å­æ­£å¥½ç›¸åã€‚ç°åœ¨ï¼Œå½“æˆ‘ä»¬è°ƒç”¨`checkout`æ–¹æ³•æ—¶ï¼Œä¼šå‘å‡ºä¸€ä¸ªåä¸º`checkout`çš„äº‹ä»¶ï¼Œæ€»è´¹ç”¨ä½œä¸ºæœ‰æ•ˆè½½è·ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰æ›´æ–°`Invoice`å®ä¾‹ä¸­çš„æ€»å€¼ï¼Œæˆ‘ä»¬åªæ˜¯å‘å‡ºäº†ä¸€æ¡æ¶ˆæ¯ï¼Œè¡¨æ˜`checkout`äº‹ä»¶å·²ç»å‘ç”Ÿã€‚`Invoice`å®ä¾‹æ­£åœ¨ç›‘å¬ç±»å‹ä¸º`checkout`çš„äº‹ä»¶ï¼Œæ¯å½“è¯¥äº‹ä»¶è¢«å‘å‡ºæ—¶ï¼Œå®ƒå°±è°ƒç”¨`update`æ–¹æ³•æ¥å¤„ç†å®ƒã€‚

å¥³å£«ä»¬å…ˆç”Ÿä»¬ï¼Œè¿™å°±æ˜¯ååº”æ€§ã€‚

### [](#the-observer-pattern%C2%A0)è§‚å¯Ÿè€…æ¨¡å¼ğŸ‘€

æˆ‘ä»¬å·²ç»çŸ¥é“äº†ååº”å¼ç¼–ç¨‹çš„åŸç†ï¼Œä½†æ˜¯æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ä¹‹é—´çš„äº¤äº’è¿›è¡Œå»ºæ¨¡:è§‚å¯Ÿè€…æ¨¡å¼ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªä¸é”™çš„æƒ³æ³•ã€‚

#### [](#according-to-wikipedia)æ®ç»´åŸºç™¾ç§‘:

> è§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ç§è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªåä¸º subject çš„å¯¹è±¡ç»´æŠ¤ä¸€ä¸ªåä¸º observer çš„ä¾èµ–è€…åˆ—è¡¨ï¼Œå¹¶è‡ªåŠ¨é€šçŸ¥å®ƒä»¬ä»»ä½•çŠ¶æ€å˜åŒ–ï¼Œé€šå¸¸æ˜¯é€šè¿‡è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ä¹‹ä¸€ã€‚

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­:

```
const $increment = document.querySelector('#increment');
let counter = 0;

$increment.addEventListener('click', onIncrement);

function onIncrement(event) {
  counter += 1;
} 
```

å‡è®¾æˆ‘ä»¬å¸Œæœ›æœ‰å¤šä¸ªè®¡æ•°å™¨ï¼Œè€Œä¸æ˜¯åªæœ‰ä¸€ä¸ªã€‚æˆ‘ä»¬åº”è¯¥å¦‚ä½•é‡æ„æˆ‘ä»¬çš„ç¨‹åºï¼Ÿæˆ‘ä»¬å¯ä»¥(a)ä¿®æ”¹`onIncrement`å‡½æ•°æ¥æ›´æ–°å®ƒä½“å†…çš„è®¡æ•°å™¨ï¼Œæˆ–è€…(b)æ³¨å†Œæ›´å¤šçš„å‡½æ•°æ¥ç›‘å¬åŒä¸€ä¸ªäº‹ä»¶ã€‚

è§£å†³æ–¹æ¡ˆ(a)æ²¡æœ‰é‚£ä¹ˆçµæ´»ã€‚å¦‚æœæˆ‘ä»¬åˆ é™¤äº‹ä»¶ä¾¦å¬å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¤±å»æ›´æ–°ä»»ä½•è®¡æ•°å™¨çš„èƒ½åŠ›ã€‚æˆ‘ä»¬ä¸èƒ½åŒæ—¶æ›´æ–°ä¸€ä¸ªè®¡æ•°å™¨:

```
const $increment = document.querySelector('#increment');
let counterA = 0;
let counterB = 0;

$increment.addEventListener('click', onIncrement);

function onIncrement(event) {
  counterA += 1;
  counterB += 1;
}

// After 3 seconds no counter will receive updates
setTimeout(() => {
  $increment.removeEventListener('click', onIncrement);
}, 3000); 
```

ä¸ºäº†å®ç°è§£å†³æ–¹æ¡ˆ(b ),è®©æˆ‘ä»¬åº”ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåä¸º`FromEvent`çš„ç±»ä½œä¸ºä¸»é¢˜:

```
class FromEvent {
  constructor(target, name) {
    this.observers = [];

    target.addEventListener(name, this.next.bind(this));
  }

  observe(observer) {
    this.observers.push(observer);
  }

  remove(observer) {
    this.observers = this.observers.filter(
      obs => obs !== observer
    );
  }

  next(e) {
    this.observers.forEach(obs => obs.next(e));
  } 
} 
```

æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„ç±»`FromEvent`æ¥æ³¨å†Œç‚¹å‡»äº‹ä»¶çš„è§‚å¯Ÿè€…:

```
const $increment = document.querySelector('#increment');
let counterA = 0;
let counterB = 0;

const fromEvent = new FromEvent($increment, "click");

const updateCounter = (counter, callback) => (event) => {
  counter = callback(counter);
  console.log(counter);
};

const observerA = {
  next: updateCounter(counterA, value => value + 1)
};
const observerB = {
  next: updateCounter(counterB, value => value + 2)
};

fromEvent.observe(observerA);
fromEvent.observe(observerB);

// After 3 seconds only counterA will receive updates
setTimeout(() => {
  fromEvent.remove(observerB);
}, 3000); 
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªé«˜é˜¶å‡½æ•°(`updateCounter`)åˆ†é…ç»™æ¯ä¸ªè§‚å¯Ÿå™¨çš„`next`æ–¹æ³•ï¼Œå®ƒè´Ÿè´£æ›´æ–°æ¯ä¸ªè®¡æ•°å™¨çš„å€¼ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨`observe`å‡½æ•°å°†æ¯ä¸ªè§‚å¯Ÿè€…æ³¨å†Œåˆ°`fromEvent`ä¸»é¢˜ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°å°†æˆ‘ä»¬çš„ç¨‹åºå»ºæ¨¡ä¸ºå…·æœ‰å˜æ›´æº(ä¸»ä½“)å’Œå¤šä¸ªæ¶ˆè´¹è€…(è§‚å¯Ÿè€…)ã€‚

### [](#back-to-the-beginning)å›åˆ°å¼€å§‹

åˆ©ç”¨æˆ‘ä»¬å·²ç»è·å¾—çš„çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬å®ç°æœ¬æ–‡å¼€å¤´æå‡ºçš„ç†æƒ³ API:

```
let counter = 0;

combine(
  onIncrementClick,
  onDecrementClick,
  onDoubleClick,
  onHalveClick,
).observe(result => {
  counter = result;
  console.log(result);
}); 
```

æˆ‘ä»¬å°†å¼€å§‹å®ç°`combine`ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»¥ä¸¤ä¸ªæˆ–å¤šä¸ªä¸»é¢˜ä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°ä¸»é¢˜çš„å‡½æ•°ã€‚å…¶æ€æƒ³æ˜¯ï¼Œæ— è®ºä½•æ—¶ä»»ä½•ä¸»é¢˜å‘å‡ºä¸€ä¸ªäº‹ä»¶ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»é€šçŸ¥è§‚å¯Ÿè€…ç”±`combine`è¿”å›çš„ä¸»é¢˜ã€‚å½“æˆ‘ä»¬åœ¨`combine`ä¸Šæ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå°†åœ¨æˆ‘ä»¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™`combine`çš„æ¯ä¸ªä¸»é¢˜ä¸Šæ³¨å†Œä¸€äº›è§‚å¯Ÿè€…ã€‚

```
const combine = (...subjects) => ({
  observe: observer => {
    subjects.forEach(subject => {
      subject.observe(observer)
    })
  }, 
}); 
```

æˆ‘ä»¬å¯ä»¥ä¼ é€’å¤šä¸ªæµä½œä¸ºå‚æ•°:

```
const onIncrementClick = new FromEvent($increment, "click");
const onDecrementClick = new FromEvent($decrement, "click");

const clicks = combine(
  onIncrementClick,
  onDecrementClick
);

const clicksObserver = {
  next: e => console.log('click', e.target.id)
}

clicks.observe(clicksObserver); 
```

å¤ªå¥½äº†ï¼ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ç§æ–¹æ³•æ¥ç»„åˆå¤šä¸ªæ•°æ®æµã€‚

### [](#homework)ä½œä¸š

å› æ­¤ï¼Œæˆ‘ä»¬æ¶µç›–äº†å…³äºå¦‚ä½•ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œååº”å¼ç¼–ç¨‹çš„æ‰€æœ‰åŸºç¡€ã€‚ç°åœ¨å”¯ä¸€è¦åšçš„å°±æ˜¯å°†æ¯ä¸ªäº‹ä»¶æµæ˜ å°„åˆ°å¯ä»¥ç›¸åº”ä¿®æ”¹è®¡æ•°å™¨å€¼çš„å‡½æ•°ã€‚å¦‚æœæ‚¨ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼Œæ‚¨å¯ä»¥å‘`FromEvent`ç±»æ·»åŠ ä¸€ä¸ª`map`æ–¹æ³•ï¼Œä»¥ä¾¿å°†æ¯ä¸ªäº‹ä»¶æ˜ å°„åˆ°ä¸€ä¸ªæœ‰ç”¨çš„å€¼ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æˆ‘çš„è§£å†³æ–¹æ¡ˆ[çš„å®ç°ã€‚](https://codesandbox.io/s/qqj3zp4zj6)

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œåˆ«å¿˜äº†åˆ†äº«å®ƒï¼Œå¹¶åœ¨ Twitter ä¸Šå…³æ³¨æˆ‘ï¼Œä»¥è·å¾—æ›´å¤šå…³äº JavaScriptã€ååº”å¼ç¼–ç¨‹ã€å‡½æ•°å¼ç¼–ç¨‹ã€å‰ç«¯å¼€å‘ç­‰çš„è§è§£ã€‚

å¹²æ¯ï¼