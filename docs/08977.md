# ç±»å‹å®‰å…¨çš„ GraphQL æœåŠ¡å™¨ğŸ”

> åŸæ–‡:[https://dev.to/swcarlosrj/type-safe-graphql-servers-1336](https://dev.to/swcarlosrj/type-safe-graphql-servers-1336)

è¿™ç¯‡æ–‡ç« å±•ç¤ºäº†åœ¨ GraphQL æœåŠ¡å™¨ä¸­æ·»åŠ ç±»å‹å®‰å…¨çš„åŠ¨æœºå’Œæ­¥éª¤ğŸ†

[![](../Images/df354cb1bb6bb96abf15b0fcff5389f6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VP4wJH0S--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/3200/1%2ARu_buRxF7Cyk_RdJ5frVSg.png)

## TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

> # [](#the-repo-amp-the-api-amp-the-docs-amp-the-everything)[Buy back [T6ã€‘ API ã€T7] documents & everything](https://codesandbox.io/s/yv004pqnq9)

[https://codesandbox.io/embed/yv004pqnq9](https://codesandbox.io/embed/yv004pqnq9)

### ä¸ºä»€ä¹ˆæˆ‘è¦åœ¨æˆ‘çš„ä»£ç åº“ä¸­æ·»åŠ ç±»å‹å®‰å…¨ï¼Ÿ

ç±»å‹ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿåœ¨å¼€å‘ JavaScript é¡¹ç›®æ—¶ä½¿ç”¨é«˜æ•ˆçš„å¼€å‘å·¥å…·å’Œå®è·µï¼Œå¦‚**é™æ€**æ£€æŸ¥å’Œä»£ç é‡æ„ã€‚

æ„å»ºå¤§å‹åº”ç”¨ç¨‹åºæ—¶ï¼Œé™æ€ç±»å‹æ£€æŸ¥å™¨å¯ä»¥å¸®åŠ©ä¿æŠ¤æ‚¨çš„ç¨‹åºï¼Œå¹¶å¸®åŠ©æ‚¨æ¶ˆé™¤ç°æœ‰çš„é”™è¯¯(æ‰“å­—é”™è¯¯ã€æ‹¼å†™é”™è¯¯ç­‰)ã€‚TypeScript å’Œ Flow éƒ½æ˜¯é™åˆ¶ JavaScript ä»£ç åº“ä¸­æŠ€æœ¯å€ºåŠ¡çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºäººä»¬ï¼Œ

> # [](#javascript-is-difficult)JavaScript å¾ˆéš¾ğŸ”¥

åŒæ—¶ï¼Œå®ƒå¯èƒ½æ˜¯æœ€å¥½çš„ç¼–ç¨‹è¯­è¨€ï¼Œ*å¼€å§‹ï¼Œ*å› ä¸ºå®ƒä¸éœ€è¦å®‰è£…å’Œé…ç½®ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€å®ƒçœŸçš„**éš¾**æŒæ¡å’Œæ˜ç¡®ï¼Œ**å®¹æ˜“å‡ºé”™**ï¼

JavaScript è¢«**å¼±**ç±»å‹åŒ–(é™¤äº†è¢«*åŠ¨æ€*ç±»å‹åŒ–)ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚æ³¨æ„ï¼Œä¸€ç§è¯­è¨€è¦ä¹ˆæ˜¯é™æ€ç±»å‹çš„ï¼Œè¦ä¹ˆæ˜¯åŠ¨æ€ç±»å‹çš„ï¼Œè®©æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ã€‚

### [](#static-dynamic-typed)é™æ€ğŸ’¥åŠ¨æ€ç±»å‹

**é™æ€**
å¦‚æœå˜é‡çš„ç±»å‹åœ¨**ç¼–è¯‘æ—¶**å·²çŸ¥ï¼Œé‚£ä¹ˆè¯­è¨€å°±æ˜¯**é™æ€ç±»å‹åŒ–çš„**ã€‚å¯¹äºæŸäº›è¯­è¨€ï¼Œè¿™æ„å‘³ç€ä½ ä½œä¸ºç¨‹åºå‘˜å¿…é¡»æŒ‡å®šæ¯ä¸ªå˜é‡çš„ç±»å‹(ä¾‹å¦‚:Javaï¼ŒCï¼ŒC++)ã€‚

**åŠ¨æ€**
å¦‚æœä¸€ç§è¯­è¨€çš„ç±»å‹ä¸**è¿è¡Œæ—¶**å€¼ç›¸å…³è”ï¼Œé‚£ä¹ˆè¿™ç§è¯­è¨€å°±æ˜¯**åŠ¨æ€ç±»å‹åŒ–çš„**ã€‚è¿™æ„å‘³ç€ä½ ä½œä¸ºç¨‹åºå‘˜å¯ä»¥å†™å¾—æ›´å¿«ä¸€ç‚¹ï¼Œå› ä¸ºä½ ä¸å¿…æ¯æ¬¡éƒ½æŒ‡å®šç±»å‹(ä¾‹å¦‚:JavaScriptã€Pythonã€Perl)

> # [](#remember%EF%B8%8F)Remember
> 
> # [](#static-compiletime-java)Static compile-time Java language (a computer language, especially used to create websites)
> 
> # [](#dynamic-runtime-javascript)Dynamic run-time Java Script language

è¯´åˆ°è¿™äº›è¯­è¨€ï¼Œä¸ºäº†é˜æ˜å®ƒä»¬çš„ç›¸ä¼¼ä¹‹å¤„ï¼Œæˆ‘ä¸å¾—ä¸æåˆ°æˆ‘æœ€å–œæ¬¢çš„ JavaScript å¼•è¨€ä¹‹ä¸€ï¼Œå®ƒå‡ºè‡ªã€Šä½ ä¸çŸ¥é“çš„ JSã€‹çš„ä½œè€…ä¹‹æ‰‹ğŸ’¯æ¨èé˜…è¯»):

> " JavaScript ä¸ Java çš„å…³ç³»å°±åƒå˜‰å¹´åä¸æ±½è½¦çš„å…³ç³»ä¸€æ ·."å‡¯å°”è¾›æ™®æ£®

æ¯«æ— ç–‘é—®ï¼Œä»–ä»¬çœ‹èµ·æ¥ä¸åƒã€‚è®©æˆ‘ä»¬æŠŠç„¦ç‚¹æ”¾åœ¨æœ€æµè¡Œçš„åŠ¨æ€ç±»å‹è¯­è¨€ä¸Šâ€¦

[![Your ğŸ˜‘when youâ€™re trying for 1st time JS coming from statically typed languages](../Images/47b663ecb7e2a8e6344aa769bcb68c82.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--tIZJXKdj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2000/1%2AyerQrnhxecQaJNQ1EIrXmg.png) *è´µğŸ˜‘å½“ä½ ç¬¬ä¸€æ¬¡å°è¯•æ¥è‡ªé™æ€ç±»å‹è¯­è¨€çš„ JS æ—¶*

è¯·æ³¨æ„ï¼Œä¸€ç§è¯­è¨€å¯ä»¥è¢«åŠ¨æ€ç±»å‹åŒ–ï¼Œä¹Ÿå¯ä»¥è¢«å¼ºç±»å‹åŒ–ï¼Œä»è€Œäº§ç”Ÿä¸€ç§æ›´å¥½çš„è¯­è¨€ã€‚æˆ‘ä»¬å¦‚ä½•ç”¨ JavaScript åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿ

## JavaScript ä¸­çš„ç±»å‹å®‰å…¨

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å°†é™æ€ç±»å‹æ·»åŠ åˆ°æˆ‘ä»¬çš„ JS ä»£ç åº“ä¸­çš„æœ€è‘—åçš„å·¥å…·ï¼

### [](#typescript)æ‰“å­—ç¨¿

***JavaScript çš„ç±»å‹åŒ–è¶…é›†*** å¯åœ¨ä»»ä½•æµè§ˆå™¨ã€ä»»ä½•ä¸»æœº&ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šç¼–è¯‘æˆæ™®é€š JavaScriptã€‚
[**å¾®è½¯/TypeScript**
*TypeScript æ˜¯ JavaScript çš„ä¸€ä¸ªè¶…é›†ï¼Œç¼–è¯‘åæ¸…ç† JavaScript è¾“å‡ºã€‚-Microsoft/TypeScript * github . com](https://github.com/Microsoft/TypeScript)

**ä¼˜ç‚¹&ç¼ºç‚¹**
ğŸ‘Œç¤¾åŒº&å·¥è£…
ğŸ‘äºšç§’çº§å“åº”æ—¶é—´
ğŸ‘å­¦ä¹ æ›²çº¿

### [](#flow)æµé‡

é™æ€ ***ç±»å‹æ£€æŸ¥å™¨*** ç”¨äºæ‚¨çš„ JavaScript ä»£ç ã€‚å®ƒåšäº†å¤§é‡çš„å·¥ä½œæ¥ä½¿ä½ æ›´æœ‰ç”Ÿäº§åŠ›ï¼Œä½¿ä½ æ›´å¿«ã€æ›´èªæ˜ã€æ›´è‡ªä¿¡åœ°ç¼–ç ï¼Œå¹¶ä¸”è¾¾åˆ°æ›´å¤§çš„è§„æ¨¡ã€‚
[**è„¸ä¹¦/Flow**
*åœ¨ JavaScript ä¸­åŠ å…¥é™æ€ç±»å‹ï¼Œæé«˜å¼€å‘è€…ç”Ÿäº§åŠ›å’Œä»£ç è´¨é‡ã€‚â€”â€”è„¸ä¹¦/Flow*github.com](https://github.com/facebook/flow)

**ä¼˜ç‚¹&ç¼ºç‚¹**
ğŸ‘Œç°æˆçš„å®ç”¨ç¨‹åº
ğŸ‘é›¶é…ç½®
ğŸ‘æ›´æ…¢æ›´ç¬¨é‡

### [](#typescript-vs-flow)æ‰“å­—ç¨¿ vs æµ

æ— è®ºä½ ä½¿ç”¨çš„æ˜¯ TypeScript è¿˜æ˜¯ Flowï¼Œéƒ½è¦æ³¨æ„* *ä½ å†™çš„ä¸æ˜¯æ™®é€šçš„ JavaScriptã€‚**TypeScript å®ç°äº†*ç±»å‹æ£€æŸ¥å™¨*å’Œå‘å‡ºæ™®é€š JavaScript çš„*ä¼ è¾“å™¨*ã€‚Flow åªåš*ç±»å‹æ£€æŸ¥*ï¼Œå¹¶ä¾é  [*Babel](https://babeljs.io/) *(æˆ–å…¶ä»–å·¥å…·)ç§»é™¤ç±»å‹æ³¨é‡Šã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºè¯­æ³•å’Œå¯ç”¨æ€§çš„åŒºåˆ«ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ é˜…è¯»[è¿™ä¸ªæ¯”è¾ƒ](https://github.com/niieani/typescript-vs-flowtype)ï¼

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [**TypeScript](https://github.com/Microsoft/TypeScript) **åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒå¯¹æˆ‘ä»¬ç¨åéœ€è¦çš„ç±»å‹ç”Ÿæˆæœ‰æ›´å¥½çš„æ”¯æŒã€‚

## [](#graphql-as-api)å›¾ QL ä½œä¸º API

ä¼—æ‰€å‘¨çŸ¥ï¼ŒGraphQL æ˜¯æ„å»º API çš„å¼ºç±»å‹è§„èŒƒï¼Œå®ƒæœ‰å¾ˆå¤šå¥½å¤„ï¼Œæˆ‘ä»¬åº”è¯¥å¥½å¥½åˆ©ç”¨ã€‚

æ— è®ºæ‚¨æ˜¯éµå¾ª*æ¨¡å¼ä¼˜å…ˆ*è¿˜æ˜¯*è§£æå™¨ä¼˜å…ˆ*çš„æ–¹æ³•ï¼Œæ‚¨éƒ½å¸Œæœ›æœ€ç»ˆæ‹¥æœ‰* *å•ä¸€çš„äº‹å®æ¥æº* *æ¥å¼€å‘*ç«¯åˆ°ç«¯ç±»å‹å®‰å…¨çš„åº”ç”¨*ã€‚

é¿å…æ‰‹åŠ¨é™æ€è¾“å…¥ï¼Œå› ä¸ºå®ƒå¤ªè´¹æ—¶é—´ï¼Œè€Œä¸”å¾ˆéš¾åœ¨ä¸åŒç‰ˆæœ¬ä¸­ä¿æŒåŒæ­¥ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›**åŸºäº*å•ä¸€æ¥æºçš„äº‹å®*è‡ªåŠ¨ç”Ÿæˆ**æˆ‘ä»¬æ‰€æœ‰çš„ç±»å‹ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨**æ¨¡å¼ä¼˜å…ˆ**æ–¹æ³•ï¼Œå› æ­¤é™æ€ç±»å‹å°†åŸºäºæˆ‘ä»¬çš„*GraphQL æ¨¡å¼*è€Œä¸æ˜¯ä»æˆ‘ä»¬çš„è§£æå™¨ç”Ÿæˆï¼

ä¸ºäº†æ¶ˆé™¤ç±»å‹å®šä¹‰ä¹‹é—´çš„å†²çªï¼Œæˆ‘ä»¬å¯ä»¥å¼•å…¥è‡ªåŠ¨åŒ–ã€‚è¿™å°±æ˜¯ **GraphQL ç±»å‹ç”Ÿæˆå™¨**çš„ç”¨æ­¦ä¹‹åœ°ï¼

## [](#graphql-types-generators)GraphQL ç±»å‹ç”Ÿæˆå™¨

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹åŸºäº GraphQL æ¨¡å¼çš„æœ€å¸¸è§çš„è‡ªåŠ¨ç”Ÿæˆç±»å‹çš„å·¥å…·ã€‚

### [](#graphql-code-generator)GraphQL ä»£ç ç”Ÿæˆå™¨

è¿™ä¸ªå·¥å…·å¯ä»¥ä¸ºä½ çš„ GraphQL æ¨¡å¼ç”Ÿæˆä¸åŒç±»å‹çš„ä»£ç è¾“å‡ºï¼Œå¹¶è®°å½•ä½ æ˜¯åœ¨å¼€å‘å®¢æˆ·ç«¯ã€æœåŠ¡å™¨è¿˜æ˜¯æ•°æ®åº“ã€‚
[ã€graphql-code-generator.comã€‘**GraphQL ä»£ç ç”Ÿæˆå™¨*ç”¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä»ä½ çš„ graph QL æ¨¡å¼ç”Ÿæˆä»£ç ***](https://graphql-code-generator.com/) 

**ä¼˜ç‚¹&ç¼ºç‚¹**
ğŸ‘Œå®¢æˆ·ç«¯ã€æœåŠ¡å™¨&æ•°æ®åº“æ”¯æŒ
ğŸ‘æ–‡æ¡£&ç¤¾åŒº
ğŸ‘æ—©æœŸå‘å±•é˜¶æ®µ

### [](#graphqlgen)**GraphQLGen**

åŸºäº TypeScriptã€Flow & Reason ä¸­çš„ GraphQL æ¨¡å¼ç”Ÿæˆ& scaffold ç±»å‹å®‰å…¨è§£æå™¨ã€‚
[](https://oss.prisma.io/graphqlgen/)

 ****ä¼˜ç‚¹&ç¼ºç‚¹**
ğŸ‘Œé»˜è®¤è§£æå™¨ç”Ÿæˆ
ğŸ‘å¯ä¸ Prisma æ•´åˆ
ğŸ‘ä»…æœåŠ¡å™¨æ”¯æŒ

### **ã€graph QL code generator vs graph qlgenã€‘**

ä¸¤è€…éƒ½éå¸¸é€‚åˆç”Ÿæˆ*ç±»å‹è„šæœ¬* & *æµ*ç±»å‹ï¼Œå°½ç®¡ **GraphQLGen** ä¸æä¾›ä¸ºå®¢æˆ·ç«¯ç”Ÿæˆå®ƒä»¬çš„èƒ½åŠ›ã€‚ç›¸åï¼Œ **GraphQL ä»£ç ç”Ÿæˆå™¨**å¯ä»¥ï¼Œå®ƒä¹Ÿä¸ºä½ æä¾›äº†å¤§é‡çš„æ’ä»¶/é…ç½®&æ¥åˆ›å»ºä½ è‡ªå®šä¹‰çš„ç±»å‹ç”Ÿæˆæ¨¡æ¿ã€‚æˆ‘å‘ç°è¿™çœŸçš„å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥æŒ‰ç…§ä½ çš„æ„æ„¿é…ç½®ä¸€ä¸ªæ¨¡å—åŒ–çš„ GraphQL æ¨¡å¼ï¼

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [**GraphQL ä»£ç ç”Ÿæˆå™¨](https://graphql-code-generator.com)* *åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæœ‰æ›´å¥½çš„å®šåˆ¶ï¼Œæˆ‘ä»¬ç¨åå°†éœ€è¦ã€‚

> # [](#ok-i-know-too-much-theory)Okay, I know, there are too many theories â€¦

[![](../Images/4b01d5cb421cd9b28890e956106da4a1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pc9LaCKx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/2000/1%2AlBgPeLa4sfAqKw8Bj9OpKA.gif)

> # [](#-lets-set-this-up)â€¦ Let's set

## [](#setup-typescript)è®¾ç½®[æ’ç‰ˆ](https://github.com/Microsoft/TypeScript)

[![[TypeScript](https://typescriptlang.org) main features](../Images/1548a062cf2e38e41a44eaabc025e95e.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--Uts5kvgB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2552/1%2AF9SdgWKARE5TFVwZQ2JZSw.png) * [æ‰“å­—ç¨¿](https://typescriptlang.org)ä¸»è¦ç‰¹ç‚¹*

### [](#install-it)**å®‰è£…å®ƒ**

```
yarn add -D typescript 
```

### [](#install-run-libraries)**å®‰è£…è¿è¡Œåº“**

ä¸ºäº†ç”¨ Node æ‰§è¡Œ TypeScriptï¼Œæ‚¨å¿…é¡»æ·»åŠ ä»¥ä¸‹å·¥å…·:

[* TS-Node](https://github.com/TypeStrong/ts-node)*:Node . js çš„ TypeScript æ‰§è¡Œå’Œ REPLï¼Œæœ‰æºç å›¾æ”¯æŒã€‚
[*Nodemon](https://github.com/remy/nodemon)* :ç›‘æ§ Node.js åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•å˜åŒ–ï¼Œè‡ªåŠ¨é‡å¯æœåŠ¡å™¨ã€‚

```
yarn add -D ts-node nodemon 
```

ä½ å¯èƒ½æƒ³ä½¿ç”¨å…¶ä»–é…ç½®ï¼Œè®¾ç½®æ›´é€‚åˆä½ çš„åº”ç”¨ç¨‹åºï¼

### [](#include-types)åŒ…å«@ç±»å‹

æ·»åŠ æ‚¨å½“å‰åœ¨ä»£ç åº“ä¸Šä½¿ç”¨çš„åº“çš„*é«˜è´¨é‡*ç±»å‹å®šä¹‰ï¼Œå¦‚ graphqlã€lodash ç­‰ã€‚å¦‚æœä½ æ˜¯ğŸ¤¨å…³äºè¿™ä¸ªï¼ŒæŸ¥ä¸€ä¸‹[*ç¡®å®šç±»å‹çš„æ–‡æ¡£](http://definitelytyped.org/) *ï¼

```
yarn add -D @types/graphql 
```

### [](#create-typescript-config)**åˆ›å»ºæ‰“å­—ç¨¿é…ç½®**

è¿™æ ·ï¼ŒTypeScript å°†åŒ…å«æ‰€æœ‰çš„ã€‚ts æ–‡ä»¶ä½œä¸ºç¼–è¯‘ä¸Šä¸‹æ–‡çš„ä¸€éƒ¨åˆ†ã€‚å®ƒè¿˜ä¼šé€‰æ‹©ä¸€äº›é»˜è®¤çš„ç¼–è¯‘å™¨é€‰é¡¹ï¼Œä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼

```
**// tsconfig.json
**{
  "compilerOptions": {
    "target": "esnext",
    "module": "commonjs",
    "moduleResolution": "node",
    "sourceMap": true,
    "experimentalDecorators": true,
    "emitDecoratorMetadata": true,
    "esModuleInterop": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "**/*.spec.ts"]
} 
```

### [](#create-run-config)**åˆ›å»ºè¿è¡Œé…ç½®**

*Nodemon* æ”¯æŒä½äºå½“å‰å·¥ä½œç›®å½•ä¸­çš„æœ¬åœ°é…ç½®æ–‡ä»¶ï¼Œåœ¨é‚£é‡Œä½ å¿…é¡»æŒ‡å®šè¯¸å¦‚å“ªä¸ª**è·¯å¾„æ¥ç›‘è§†** &å‘½ä»¤åœ¨ä»»ä½•é‡æ–°åŠ è½½åæ‰§è¡Œï¼Œè¿™å°±æ˜¯ä½ çš„æœåŠ¡å™¨ã€‚æ£€æŸ¥[æ ·æœ¬é…ç½®](https://github.com/remy/nodemon/blob/master/doc/sample-nodemon.md)ï¼

```
**// nodemon.json
**{
  "watch": ["src"],
  "ext": "ts",
  "ignore": ["src/**/*.spec.ts", "src/types/**/*.d.ts"],
  "exec": "ts-node ./src/index.ts"
} 
```

### [](#add-run-config)**æ·»åŠ è¿è¡Œé…ç½®**

```
**// package.json
**{
  ...
  "scripts": {
    ...
    "start": "nodemon",
    ...
  }
  ...
} 
```

## [](#rename-js-files-ts)**æ”¹åã€‚js æ–‡ä»¶ğŸ‘‰ã€‚ts**

å°†æ‰€æœ‰ JavaScript æ–‡ä»¶æ‰©å±•åä¿®æ”¹ä¸ºã€‚tsï¼Œå®ƒå°†å…è®¸æ‚¨åˆ©ç”¨æ‰€æœ‰çš„ç±»å‹è„šæœ¬åŠŸèƒ½

### [](#test-your-app)æµ‹è¯•ä½ çš„åº”ç”¨

è¿è¡Œä½ çš„ *GraphQL æœåŠ¡å™¨*ï¼Œç”±äº JavaScript å’Œ TypeScript æ˜¯ 100%å…¼å®¹çš„(ä¸æ˜¯ç›¸åï¼ŒJS ç¼–è¯‘å™¨ä¸Šä¸å…è®¸ TS ç±»å‹)ï¼Œåº”è¯¥å¯ä»¥ç”¨ï¼

```
yarn start 
```

### [](#weeding-out-errors)å‰”é™¤é”™è¯¯

è½¬æ¢åå¾—åˆ°é”™è¯¯æ¶ˆæ¯å¹¶ä¸æ„å¤–ã€‚é‡è¦çš„æ˜¯å®é™…ä¸Šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ£€æŸ¥è¿™äº›ï¼Œå¹¶å†³å®šå¦‚ä½•å¤„ç†é”™è¯¯ã€‚é€šå¸¸è¿™äº›éƒ½æ˜¯åˆç†çš„é”™è¯¯ï¼Œä½†æ˜¯æœ‰æ—¶ä½ å¿…é¡»è§£é‡Šä½ è¯•å›¾åšçš„æ¯” TypeScript æ›´å¥½çš„äº‹æƒ…ã€‚è¯·ä¸è¦çŠ¹è±«ï¼ŒæŸ¥çœ‹æœ¬[è¿ç§»æŒ‡å—](http://www.typescriptlang.org/docs/handbook/migrating-from-javascript.html)ä»¥å¸®åŠ©ä¿®å¤å¯èƒ½çš„é”™è¯¯ï¼

## [](#setup-graphql-code-generator)**è®¾ç½® [GraphQL ä»£ç ç”Ÿæˆå™¨](https://graphql-code-generator.com)T5ã€‘**

[![[GraphQL Code Generator](https://graphql-code-generator.com) main features](../Images/21b9cb17e192d635c374d0702e36a189.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--mO4nR1Zx--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2876/1%2AJw_S5yw_Jsi7cMIXXD8B4Q.png) * [ GraphQL ä»£ç ç”Ÿæˆå™¨](https://graphql-code-generator.com)ä¸»è¦ç‰¹æ€§*

### [](#install-it)**å®‰è£…å®ƒ**

```
yarn add -D graphql-code-generator 
```

### [](#install-plugins)**å®‰è£…æ’ä»¶**

æˆ‘ä»¬å°†è®¾ç½®*å…¬å…±*ï¼Œ*æœåŠ¡å™¨*&* resolvers TypeScript *æ’ä»¶ï¼Œä½ å¯èƒ½æƒ³ä½¿ç”¨å…¶ä»–çš„ï¼ŒæŸ¥çœ‹å¯ç”¨çš„[æ’ä»¶](https://graphql-code-generator.com/docs/plugins/)ï¼

```
yarn add -D graphql-codegen-typescript-common graphql-codegen-typescript-server graphql-codegen-typescript-resolvers 
```

### [](#create-context-type)åˆ›å»ºä¸Šä¸‹æ–‡ç±»å‹

å¦‚æœæ‚¨å¸Œæœ›ä¸º GraphQL *ä¸Šä¸‹æ–‡*å’Œ* *ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹ï¼Œå¹¶ä¸”ä¸å¸Œæœ›åœ¨æ¯æ¬¡å£°æ˜è§£æå™¨æ—¶éƒ½æŒ‡å®šå®ƒï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨åˆ›å»ºå®ƒï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°*è¿è¡Œé…ç½®*æ–‡ä»¶ä¸­(æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥ä¸­è¿™æ ·åš):

```
**// types/context.d.ts
**export type MyContext = {
  db: any;
  find: any;
  limit: any;
  order: any;
  project: any;
  sort: any;
}; 
```

**åˆ›å»ºè¿è¡Œé…ç½®**

CLI å°†è‡ªåŠ¨æ£€æµ‹å·²å®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ç›¸åº”åœ°ç”Ÿæˆä»£ç ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ£€æŸ¥å¯ç”¨é€‰é¡¹ï¼

```
**// codegen.yml***
*schema: src/schema/**/*.ts
overwrite: true
watch: true
require:
  - ts-node/register
generates:
  ./src/types/types.d.ts:
    config:
      contextType: ./context#MyContext
    plugins:
      - typescript-common
      - typescript-server
      - typescript-resolvers 
```

### [](#add-run-config)æ·»åŠ è¿è¡Œé…ç½®

```
**// package.json
**{
  ...
  "scripts": {
    ...
    "generate": "gql-gen",
    ...
  }
  ...
} 
```

## [](#generate-types)ç”Ÿæˆç±»å‹âš™ï¸

ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„é™æ€ç±»å‹ğŸ˜ï¼Œè®©æˆ‘ä»¬å®ç°å®ƒå§ï¼

```
yarn generate 
```

## [](#add-resolver-types)æ·»åŠ è§£æå™¨ç±»å‹ï¼

ç°åœ¨ï¼Œæ‚¨åªéœ€å°†* TypeScript *ç”Ÿæˆçš„é™æ€ç±»å‹åŒ…å«åˆ°*GraphQL è§£æå™¨*ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º

[![Adding TypeScript types into GraphQL Resolvers & ğŸ”the Resolvers Data Types](../Images/2a7e14d1428bb882812369b78e628cec.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--GyyPwce1--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/2000/1%2AYDeNWttazokA3eh4sYhwHg.gif) *å‘ GraphQL è§£æå™¨ä¸­æ·»åŠ æ‰“å­—ç¨¿ç±»å‹&ğŸ”è§£æå™¨æ•°æ®ç±»å‹*

[![Itâ€™s not ğŸ˜‚, take a look to your types.d.ts generated!](../Images/d4ecabe9355791ac5f9058ba9b2b20dd.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--DhPJEAqb--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/2000/1%2AmPUc2fU1VPbW6gjbw1DjeQ.gif)T3ã€‘è¿™ä¸ğŸ˜‚ï¼Œçœ‹çœ‹ä½ çš„ type . d . t ç”Ÿæˆçš„ï¼

## [](#recapping)åŠ ç›–

ä¸ºäº†ä½¿ç”¨*æ¨¡å¼ä¼˜å…ˆ*æ–¹æ³•å°†*ç±»å‹å®‰å…¨*æ·»åŠ åˆ°æ‚¨çš„ GraphQL æœåŠ¡å™¨ä¸­ï¼Œæ‚¨å¯ä»¥:

âš«å®‰è£… TypeScript
â†³å®‰è£… TypeScriptï¼Œè¿è¡Œåº“& @types
â†³åˆ›å»º TypeScript é…ç½®&è¿è¡Œé…ç½®
â†³æ·»åŠ è¿è¡Œé…ç½®
âš«ï¸é‡å‘½åã€‚å°„æµç ”ç©¶â€¦ğŸ‘‰ã€‚ts æ–‡ä»¶
âš«ï¸å®‰è£… GraphQL ä»£ç ç”Ÿæˆå™¨
â†³å®‰è£… GraphQL ä»£ç ç”Ÿæˆå™¨&æ’ä»¶
â†³åˆ›å»ºä¸Šä¸‹æ–‡ç±»å‹&è¿è¡Œé…ç½®
â†³æ·»åŠ è¿è¡Œé…ç½®
âš«ï¸ç”Ÿæˆç±»å‹âš™ï¸
âš«ï¸æ·»åŠ è§£æå™¨ç±»å‹ï¼

## [](#the-benefits)ğŸ‘€å¥½å¤„

å‘ç°ä¸€äº›ç»“åˆä½¿ç”¨*TypeScript *å’Œ*GraphQL* çš„ä½¿ç”¨æ¡ˆä¾‹ï¼

### [](#evolve-your-schema)è¿›åŒ–ä½ çš„å›¾å¼

> ![unknown tweet media content](../Images/a88e5d42266dab2fb7fca5b1f978b5b6.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/Dv1mR8fXQAEHeRv.mp4" type="video/mp4"></video>![Carlos Rufo profile image](../Images/1d119cd95d32914c89080fc8721e353d.png)å¡æ´›æ–¯é²ç¦[@ swcarlosrj](https://dev.to/swcarlosrj)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)è¿›åŒ–ä½ çš„å›¾å¼è€Œä¸ç”¨æ‹…å¿ƒå˜åŒ–ï¼Œåšä¸€ä¸ªå›é€†è€…ğŸ¤˜ï¼Œæ‹‰ä½ æ‰€æœ‰çš„æ–°æäº¤ï¼åŸºäºæ‚¨çš„ [#GraphQL](https://twitter.com/hashtag/GraphQL) ç±»å‹å®šä¹‰&è§£æå™¨ç”Ÿæˆçš„ [#TypeScript](https://twitter.com/hashtag/TypeScript) ç±»å‹å°†ğŸ”å¯¹ä½ æ¥è¯´æ‰€æœ‰å¯èƒ½çš„é”™è¯¯ï¼2019 å¹´ 1 æœˆ 16:23PM-01[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080137523190468608)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080137523190468608)1[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080137523190468608)3

### [](#the-arguments)ğŸ”äº‰è®º

> ![unknown tweet media content](../Images/760b13b866f5f8bb502f5692799b3bae.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/Dv1moipWkAA4595.mp4" type="video/mp4"></video>![Carlos Rufo profile image](../Images/1d119cd95d32914c89080fc8721e353d.png)å¡æ´›æ–¯é²ç¦[@ swcarlosrj](https://dev.to/swcarlosrj)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)åˆ«æµªè´¹ä½ çš„â³æŸ¥çœ‹æ‚¨è‡ªå·±è®°å½•çš„ APIï¼Œä¸è¦ç¦»å¼€ IDEğŸ™Œï¼Œä¸è¦ç¦»å¼€ [@vscode](https://twitter.com/vscode) ã€‚ä½¿ç”¨ç”Ÿæˆçš„ [#TypeScript](https://twitter.com/hashtag/TypeScript) è§£æå™¨ç±»å‹æ¢ç´¢æ‰€æœ‰çš„ [#GraphQL](https://twitter.com/hashtag/GraphQL) å‚æ•°ï¼2019 å¹´ 1 æœˆ 16:23PM-01[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080137527439314944)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080137527439314944)0[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080137527439314944)1

### [](#catch-misspellings)æ•æ‰æ‹¼å†™é”™è¯¯

> ![unknown tweet media content](../Images/885851fc645564b1594ce06a41864ea8.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/Dv1nfUKXcAMK-5h.mp4" type="video/mp4"></video>![Carlos Rufo profile image](../Images/1d119cd95d32914c89080fc8721e353d.png)å¡æ´›æ–¯Â·é²ç¦[@ swcarlosrj](https://dev.to/swcarlosrj)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)â€œæˆ‘åˆšåˆšèŠ±äº†å¤§æ¦‚ 30 åˆ†é’Ÿçš„æ—¶é—´è¯•å›¾å¼„æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘å†™çš„ä¸œè¥¿ä¼šå‡ºç°åœ¨ catch è¯­å¥ä¸­ï¼Œç»“æœæ˜¯æˆ‘å†™é”™äº†` . toLowerCase()`ğŸ¤¦â€â™€ï¸" by[@ nikkitaftw](https://twitter.com/NikkitaFTW)
> 
> å³ä½¿ä¼Ÿå¤§çš„å¼€å‘è€…ä¹Ÿä¼šæ‹¼é”™ï¼Œ é¿å…ä»–ä»¬åœ¨ä½ çš„ [#GraphQL](https://twitter.com/hashtag/GraphQL) è§£æå™¨ä¸­ä½¿ç”¨ [#TypeScript](https://twitter.com/hashtag/TypeScript) ğŸš€2019 å¹´ 1 æœˆ 16:23PM-01[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080137530320797696)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080137530320797696)0[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080137530320797696)2

### [](#the-context)ğŸ”èƒŒæ™¯

> ![unknown tweet media content](../Images/75c99fb55a1f276cc10b98005f17e223.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/Dv1ns7DXcAAgv_y.mp4" type="video/mp4"></video>![Carlos Rufo profile image](../Images/1d119cd95d32914c89080fc8721e353d.png)å¡æ´›æ–¯é²ç¦[@ swcarlosrj](https://dev.to/swcarlosrj)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)å¦‚æœä½ ä¸çŸ¥é“ï¼Œå¹²â™»ï¸ï¼Œç”¨ä¸Šä¸‹æ–‡ï¼åœ¨æ‚¨çš„ [#GraphQL](https://twitter.com/hashtag/GraphQL) è§£æå™¨ä¸­è®¿é—®æ‚¨éœ€è¦çš„å‡½æ•°ã€‚ç”Ÿæˆçš„ [#TypeScript](https://twitter.com/hashtag/TypeScript) ç±»å‹å°†å¸®åŠ©æ‚¨äº†è§£å“ªäº›æ˜¯å¯ç”¨çš„ä»¥åŠå®ƒä»¬å„è‡ªçš„ç±»å‹âœ¨16:23pm-01 2019 å¹´ 1 æœˆ[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080137533319720962)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080137533319720962)0[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080137533319720962)1

### [](#discover-your-data)å‘ç°æ‚¨çš„æ•°æ®

> ![unknown tweet media content](../Images/229579304688a88edb56fc45d27fc8e1.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/Dv1qJeqWoAMN8wH.mp4" type="video/mp4"></video>![Carlos Rufo profile image](../Images/1d119cd95d32914c89080fc8721e353d.png)å¡æ´›æ–¯é²ç¦[@ swcarlosrj](https://dev.to/swcarlosrj)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)ä¸ç¡®å®šğŸ¤¨å…³äºè§£æå™¨è¿”å›çš„æ•°æ®ï¼Ÿæ‘§æ¯å®ƒï¼Œå˜²ç¬‘å®ƒï¼Œæ”¹å˜å®ƒğŸ˜²ï¼Œç”±äºåŸºäºæ‚¨çš„ [#GraphQL](https://twitter.com/hashtag/GraphQL) æ¨¡å¼ç”Ÿæˆçš„ [#TypeScript](https://twitter.com/hashtag/TypeScript) ç±»å‹ï¼Œæ‚¨å°†èƒ½å¤Ÿè¿™æ ·åšğŸ˜2019 å¹´ 1 æœˆ 16:23PM-01[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080137536507465729)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080137536507465729)0[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080137536507465729)1

## [](#the-future)æœªæ¥

ä¸ºäº†è®¨è®ºæ–°æ—¶ä»£ä¼šæœ‰ä»€ä¹ˆğŸ˜¬ï¼Œä½ ä¸ä¼šé”™è¿‡ GraphQL çš„åˆ›å»ºåŠ¨æœºï¼Œ[ä¸¹Â·æ–¯æŸ¥è´¹](https://dev.toundefined)å®Œç¾åœ°å†ç°äº†å®ƒä»¬ğŸ‘‡

[https://www.youtube.com/embed/6NYC-k2Abow](https://www.youtube.com/embed/6NYC-k2Abow)

(è®¡åˆ’æˆ–ç†è®ºçš„)çº²è¦ğŸ’¥
è§£æå™¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œç±»å‹ğŸ’¥ç±»/è£…é¥°ç”Ÿæˆå™¨ï¼Œ
å¯è¯»æ€§ğŸ’¥å¯ç»„åˆæ€§ï¼Œ

â€¦ 2019 å¹´çš„ç›®æ ‡æ˜¯ä¸º GraphQL è€Œå¿™ç¢ŒğŸ˜…ï¼Œ
çœ‹äº†å…³äºå®ƒæœªæ¥çš„ç¬¬ä¸€å°è±¡ï¼Œ
å®ƒçš„ç²¾å½©ä¸äºšäºé“ºå¤©ç›–åœ°ï¼Œ
ä½†æ˜¯çœŸçš„ï¼Œä¸è¦é”™è¿‡ğŸ’¯çº¿ç¨‹ï¼

> ![Johannes Schickling profile image](../Images/622b5b3509dbec6f202946be7d86c34d.png)çº¦ç¿°å†…æ–¯Â·å¸­å…‹æ—[@å¸­å…‹æ—](https://dev.to/schickling)![twitter logo](../Images/65e26e35707d96169ec8af6b3cbf2003.png)ğŸ”®2019 å¹´ GraphQL é¢„æµ‹:è§£æå™¨ä¼˜å…ˆçš„æœåŠ¡å™¨æ¡†æ¶å°†å¼€å§‹å–ä»£å½“å‰æµè¡Œçš„æ¨¡å¼ä¼˜å…ˆçš„æ–¹æ³•ã€‚
> 
> ä¸»è¦åŸå› :
> â—†æ— ä»£ç å†—ä½™(å³è§£æå™¨å’Œç±»å‹å®šä¹‰å•ä¸€)
> â—†æ›´å¥½çš„ä»£ç é‡ç”¨&ç±»å‹å®‰å…¨
> â—†ä¸Šçº§ DX09:49AM-02 2019[![Twitter reply action](../Images/269095962147c28351274afdd5486a48.png)](https://twitter.com/intent/tweet?in_reply_to=1080400713770024960)[![Twitter retweet action](../Images/771160ecf06ae3d4d7a7815c29c819c2.png)](https://twitter.com/intent/retweet?tweet_id=1080400713770024960)110[![Twitter like action](../Images/c077611ab2a5e0b4cd0c826ee7ae1e48.png)](https://twitter.com/intent/like?tweet_id=1080400713770024960)510

[![](../Images/c5ce5801aec5c7d14617a1b50036d15b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--3M8UvU2v--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/3840/1%2Af6IMUipNmjSrEp9iEAX4sw.jpeg)

æˆ‘ä¼šç»§ç»­å…³æ³¨è¿™ä¸ªå¸–å­ğŸ”œä¸å„è‡ªçš„**ç±»å‹å®‰å…¨ GraphQL å®¢æˆ·ç«¯**ğŸ”å¸–å­ï¼Œæ•¬è¯·å…³æ³¨ï¼

è¯·è€ƒè™‘ä¸€ä¸‹ğŸ™ğŸ»è·å…°ã€contributâ™»ï¸ing å’Œæ²™å°”ğŸ’œè¯¥æ­»çš„ã€‚**