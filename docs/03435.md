# ç”¨ç½‘æ ¼åˆ†ç±»æ³•å¯åŠ¨é™æ€ç«™ç‚¹

> åŸæ–‡:[https://dev . to/codegram/power-up-static-sites-with-grid some-taxonomies-3 Hoa](https://dev.to/codegram/powering-up-static-sites-with-gridsome-taxonomies-3hoa)

*æœ€åˆå‘è¡¨äº [Codegram çš„åšå®¢](https://www.codegram.com/blog/powering-up-static-sites-with-gridsome-taxonomies)T3ã€‘*

åœ¨ Codegramï¼Œæˆ‘ä»¬å·²ç»éå¸¸å–œæ¬¢ jam stack(T2)ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨ Gridsomeï¼Œä¸€ä¸ª Vue.js æ¡†æ¶(å¯¹äº React devsï¼Œå®ƒç›¸å½“äº Gatsby)ã€‚å°½ç®¡åœ¨æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™è¿˜åªæ˜¯ç‰ˆæœ¬`v0.6.9`ï¼Œä½†å®ƒå·²ç»åŸºæœ¬ä¸Šå¯ä»¥æŠ•å…¥ç”Ÿäº§äº†(é™¤éä½ éœ€è¦ [i18n](https://github.com/gridsome/gridsome/issues/23) ï¼Œå¹¶ä¸”æä¾›äº†**å‡ºè‰²çš„å¼€å‘è€…ä½“éªŒ**ã€‚æˆ‘ä»¬ç”¨å®ƒå»ºç«‹äº†å‡ ä¸ªç½‘ç«™ï¼Œæœ€è‘—åçš„æ˜¯ [Full Stack Fest çš„](https://2019.fullstackfest.com)å’Œä½ æ­£åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« çš„ç½‘ç«™ã€‚

ä¸ç®€å•çš„é™æ€ç”Ÿæˆçš„ Nuxt ç«™ç‚¹ç›¸æ¯”ï¼ŒGridsome æœ€å‡ºè‰²çš„åœ°æ–¹æ˜¯æ·»åŠ ä¸€ä¸ª **GraphQL æ•°æ®å±‚**çš„èƒ½åŠ›ï¼Œåªéœ€è¦å‡ è¡Œä»£ç ï¼Œè€Œä¸”æ²¡æœ‰åˆ›å»º API çš„ç»éªŒã€‚æˆ‘ä»¬ç½‘ç«™çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€æ˜æ˜¾çš„éœ€æ±‚å°±æ˜¯åšå®¢ã€‚é‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ç”¨ Gridsome åˆ›å»ºä¸€ä¸ªåšå®¢å§ï¼

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å‡ ä¸ªæ’ä»¶:[@ grid some/source-file system](https://gridsome.org/plugins/@gridsome/source-filesystem)å’Œ[@ grid some/transformer-remark](https://gridsome.org/plugins/@gridsome/transformer-remark)ã€‚è¿™å°†å…è®¸æˆ‘ä»¬è¯»å– markdown æ–‡ä»¶å¹¶å°†å®ƒä»¬è½¬æ¢æˆ GraphQL é›†åˆã€‚

å› æ­¤ï¼Œåœ¨`gridsome.config.js`æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†æ’ä»¶çš„é…ç½®:

```
module.exports = {
  plugins: [
    {
      use: '@gridsome/source-filesystem',
      options: {
        path: 'src/blog/*.md',
        typeName: 'BlogPost',
        route: '/blog/:slug'
      }
    }
  ],
  transformers: {
    remark: {
      // we can add options here
    }
  }
} 
```

ç„¶åï¼Œæˆ‘ä»¬åœ¨`src/pages`ä¸­åˆ›å»ºä¸€ä¸ª`blog.vue`æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥è¯¢æˆ‘ä»¬çš„ blogpostsã€‚å°±è¿™ä¹ˆç®€å•ï¼

```
<template>
  <Layout>
    <BlogPost
      v-for="post in $page.blogPosts.edges"
      :key="post.node.id"
      :post="post"
    />
  </Layout>
</template>

<static-query>
  query BlogPost {
    blogPosts: allBlogPost(sortBy: "published_at", order: DESC) {
      edges {
        node {
          title
          path
          image(width:640, quality: 75)
        }
      }
    }
  }
</static-query> 
```

å€ŸåŠ© GraphQL çš„å¼ºå¤§åŠŸèƒ½ï¼Œæˆ‘ä»¬åªéœ€è¦æŸ¥è¯¢æˆ‘ä»¬éœ€è¦çš„å­—æ®µã€‚æ—¢ç„¶æ˜¯ä¸»åšå®¢é¡µé¢ï¼Œæˆ‘ä»¬ä¸å…³å¿ƒå†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ±‚`title`ã€`path`å’Œ`image`(æˆ‘ä»¬ç”šè‡³å¯ä»¥è¦æ±‚å…·ä½“çš„å¤§å°å’Œè´¨é‡ï¼ğŸ¤¯).

æ¯ä¸ªå¸–å­é¡µå‘¢ï¼Ÿä½¿ç”¨ plain Vue æˆ– Nuxtï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå¸¦æœ‰`id`å‚æ•°çš„è·¯ç”±ï¼Œç„¶åä»`$route`å¯¹è±¡ä¸­è·å–è¯¥å‚æ•°ï¼Œç„¶åæŸ¥è¯¢ postï¼Œå°†æˆ‘ä»¬è·å–çš„æ•°æ®è®¾ç½®ä¸ºç»„ä»¶çŠ¶æ€ï¼Œåœ¨å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œæ—¶ï¼Œå¯èƒ½éœ€è¦æ·»åŠ ä¸€ä¸ªåŠ è½½å¾®è°ƒå™¨â€¦

[![](img/4c839c64db6b4f24a3e81061a7fab641.png)T2ã€‘](https://i.giphy.com/media/njAjh98E1PUha/source.gif)

æœ‰äº† Gridsome å°±ç®€å•å¤šäº†ï¼æˆ‘ä»¬åªéœ€è¦åœ¨`templates`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª`BlogPost.vue`(è®°ä½`BlogPost`æ˜¯æˆ‘ä»¬åœ¨é…ç½® app æ—¶ä½¿ç”¨çš„`typeName`ï¼Œå¹¶ç¼–å†™æŸ¥è¯¢:

```
<template>
  <section>
    <h1>{{ $page.blogPost.title }}</h1>
    <!-- ... -->
  </section>
</template>

<page-query>
  query BlogPost ($path: String!) {
    blogPost: blogPost (path: $path) {
      title
      published_at
      author
      image(width:1024, quality: 75)
      content
    }
  }
</page-query> 
```

å¦‚æ‚¨æ‰€è§ï¼Œè¯¥æŸ¥è¯¢è·å¾—äº†ä¸€ä¸ªæˆ‘ä»¬ä¼ é€’çš„`$path`å˜é‡ã€‚ä½†è¿™ä¸€åˆ‡éƒ½æ˜¯ä¸ºä½ åšçš„ï¼Œä¸éœ€è¦å¾—åˆ°`$route.params.id`æˆ–ä»»ä½•ä¸œè¥¿ï¼

ä¸è¿‡ï¼Œè¿™åªæ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ Gridsome åšçš„äº‹æƒ…çš„å¼€å§‹ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œæ²¡æœ‰æ ‡ç­¾çš„åšå®¢æœ‰ä»€ä¹ˆç”¨ï¼Ÿæ¥è¡¥å……ä¸€ä¸‹å§ï¼

æˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ª GraphQL é›†åˆï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æƒ³ä¸ºæ¯ä¸ªæ ‡ç­¾åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¯¹å—ï¼Ÿå¹¸è¿çš„æ˜¯æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼åœ¨`gridsome.config.js`ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ å¯¹å¦ä¸€ä¸ª`typeName`çš„å¼•ç”¨ã€‚`create`é€‰é¡¹å°†åˆ›å»ºæ²¡æœ‰æ–‡ä»¶çš„æ”¶è—:

```
 {
      use: '@gridsome/source-filesystem',
      options: {
        path: 'src/blog/*.md',
        typeName: 'BlogPost',
        route: '/blog/:slug',
        refs: {
          typeName: 'Tag',
          route: '/blog/tag/:slug',
          create: true
        }
      }
    } 
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æŸ¥è¯¢æ ‡ç­¾æ¥åˆ›å»ºæˆ‘ä»¬çš„æ ‡ç­¾åˆ—è¡¨:

```
<page-query>
  query Tags {
    tags: allTag {
      edges {
        node {
          id
          path
        }
      }
    }
  }
</page-query> 
```

ä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªæ ‡ç­¾åˆ›å»ºä¸€ä¸ªè§†å›¾ï¼Œåˆ—å‡ºå¸¦æœ‰è¯¥æ ‡ç­¾çš„æ–‡ç« ï¼Œå¯¹å—ï¼Ÿæˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªæ¨¡æ¿`Tag.vue`ï¼Œå¯ä»¥å¾—åˆ°æ ‡ç­¾æ‰€å±çš„å¸–å­ï¼

```
<page-query>
  query Tag($id: String!) {
    tag(id: $id) {
      id
      belongsTo(sortBy: "published_at", order: DESC) {
        edges {
          node {
            ... on BlogPost {
              title
              path
              image(width:640, quality: 75)
            }
          }
        }
      }
    }
  }
</page-query> 
```

*å¦‚æœä½ ä¸ç†Ÿæ‚‰ GraphQLï¼Œ`... on BlogPost`ä½å¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œå®ƒè¢«ç§°ä¸º[å†…è”ç‰‡æ®µ](https://graphql.org/learn/queries/#inline-fragments)ã€‚*

èƒ½å¤Ÿå¦‚æ­¤å®¹æ˜“åœ°å»ºç«‹å…³ç³»æ˜¯ä¸æ˜¯å¾ˆæ£’ï¼Ÿæ²¡æœ‰åç«¯ï¼ä¸ºäº†æ›´å®¹æ˜“åœ°è®¿é—®å¸–å­ï¼Œæˆ‘å–œæ¬¢åˆ›å»ºè®¡ç®—å±æ€§ï¼Œè¿™æ ·ä»£ç æ›´æ˜“è¯»:

```
 computed: {
    posts() {
      return this.$page.tag.belongsTo.edges
    }
  } 
```

è¿™å¯èƒ½æ„Ÿè§‰ä¸åˆ°ä»€ä¹ˆï¼Œä½†æ˜¯è¿™ç¡®å®å°†é™æ€ç«™ç‚¹å¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ„æˆç½‘ç«™çš„æ‰€æœ‰éƒ¨åˆ†ä¹‹é—´å»ºç«‹å¤æ‚çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨æˆ‘ä»¬çš„ä¸€äº›[æœåŠ¡](https://www.codegram.com/services/)ä¸­æ·»åŠ äº†ç›¸å…³çš„å¸–å­ã€‚æ€ä¹ˆä¼šï¼ŸåŒæ—¶æ·»åŠ æ ‡ç­¾ï¼

```
 // gridsome.config.js
    {
      use: '@gridsome/source-filesystem',
      options: {
        path: 'src/services/*.json',
        route: '/services/:id',
        typeName: 'Service',
        refs: {
          tags: {
            typeName: 'Tag',
            route: '/blog/tag/:slug'
          }
        }
      }
    }, 
```

å› ä¸ºæˆ‘ä»¬å·²ç»ä¸ºæˆ‘ä»¬çš„åšå®¢æ–‡ç« åˆ›å»ºäº†æ ‡ç­¾ï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦å†æ¬¡æ·»åŠ `create: true`ï¼Œå®ƒå°†åŒ¹é…å½“å‰å·²æœ‰çš„æ ‡ç­¾ã€‚

åœ¨æˆ‘ä»¬çš„æœåŠ¡æŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†æ ‡ç­¾å’Œå®ƒä»¬çš„å¸–å­:

```
<page-query>
  query Service($path: String!) {
    service(path: $path) {
      title
      description
      tags {
        id
        belongsTo(
          sortBy: "published_at",
          order: DESC,
          limit: 3,
          filter: {
            typeName: { eq: BlogPost }
          }) {
          edges {
            node {
              ... on BlogPost {
                title
                path
                image(width: 640, quality: 75)
              }
            }
          }
        }
      }
    }
  }
</page-query> 
```

*æ³¨æ„ï¼Œç”±äºç°åœ¨æ ‡ç­¾åŒæ—¶å¼•ç”¨äº†åšå®¢å¸–å­å’ŒæœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡`typeName`è¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬åªå¾—åˆ°å¸–å­ã€‚*

å¾ˆå®¹æ˜“ï¼Œæ¯æ¬¡æˆ‘ä»¬æ·»åŠ å…³äº Vue çš„å¸–å­ï¼Œå®ƒéƒ½ä¼šæ˜¾ç¤ºåœ¨ Vue æœåŠ¡é¡µé¢ä¸Šã€‚åä¹‹äº¦ç„¶ï¼æˆ‘ä»¬å¯ä»¥ä»å¸–å­é¡µé¢æŸ¥è¯¢ç›¸å…³æœåŠ¡ï¼Œä½ å¯ä»¥åœ¨è¿™ç¯‡å¸–å­çš„æœ«å°¾çœ‹åˆ°ã€‚æˆ‘ä»¬å¯¹æ¡ˆä¾‹ç ”ç©¶ä¹Ÿåšäº†åŒæ ·çš„äº‹æƒ…ï¼å¦‚æœä½ è¯»äº†ä¸€ç¯‡å…³äº [Decidim](https://www.codegram.com/blog/decidim-open-source-participatory-democracy-framework) çš„å¸–å­ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæ¡ˆä¾‹ç ”ç©¶çš„é“¾æ¥ã€‚å¼ è´´æ ‡ç­¾ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ˜¾ç¤ºæ•´ä¸ªç½‘ç«™çš„å…³ç³»ã€‚

[![](img/8bdadf8d227a97254f9017c40e7a75b4.png)T2ã€‘](https://i.giphy.com/media/XkDyB1jCZMxUs/source.gif)

<small>æƒ³è±¡å„ç§å¯èƒ½æ€§</small>

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒJAMStack å¹¶ä¸å±€é™äºåªæœ‰å‡ é¡µçš„ç®€å•ç½‘ç«™ï¼Œæˆ–è€…æœ€å¤šæ˜¯åšå®¢ã€‚æˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“åœ°åˆ›å»ºå¤æ‚çš„å…³ç³»å’Œè¿‡æ»¤å™¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»¥å¤šç§æ–¹å¼(ç±»åˆ«ã€ç³»åˆ—ã€æ ‡ç­¾ç­‰)å¯¹æˆ‘ä»¬çš„äº§å“è¿›è¡Œåˆ†ç±»ï¼Œæ·»åŠ ç›¸å…³äº§å“ï¼Œå°†å®ƒä»¬é“¾æ¥åˆ°ä¸åŒçš„å†…å®¹ç±»å‹â€¦ä½ èƒ½æƒ³åˆ°çš„ï¼åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨æ–‡ä»¶åŠ è½½å™¨ï¼Œä½† Gridsome æ”¯æŒå¤šç§æ¥æº:ä½ å¯ä»¥ä½¿ç”¨æµè¡Œçš„æ— å¤´ CMSï¼Œå¦‚ [Contentful](https://gridsome.org/plugins/@gridsome/source-contentful) æˆ– [Netlify CMS](https://gridsome.org/plugins/gridsome-plugin-netlify-cms) ã€ [Wordpress](https://gridsome.org/plugins/@gridsome/source-wordpress) ï¼Œç”šè‡³ç›´æ¥æ’å…¥åˆ° [MySQL æ•°æ®åº“](https://gridsome.org/plugins/gridsome-source-mysql)ã€‚æ‰€ä»¥å³ä½¿ä½ çš„ç½‘ç«™æœ‰å¾ˆå¤šå†…å®¹ï¼Œç”¨ JAMStack ä¹Ÿå¾ˆå®¹æ˜“ç®¡ç†ã€‚

æ˜¾ç„¶ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨æ˜Ÿçƒå¤§æˆ˜ API ä½œä¸ºèµ„æºã€‚æ‰€ä»¥ä»Šå¤©è¯•è¯• Gridsomeï¼Œ *it **å°±æ˜¯**ä½ è¦æ‰¾çš„æ¡†æ¶ã€‚*

[![](img/242e34aa8f7ddbbfdfc3cd1552df3aec.png)T2ã€‘](https://i.giphy.com/media/fZyssFynWmQSc/source.gif)