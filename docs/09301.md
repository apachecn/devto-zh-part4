# ç”¨æ— æœåŠ¡å™¨æ¡†æ¶è®©ä½ çš„ç½‘ç«™æ´»èµ·æ¥â€”â€”ä¸€ç‚¹ç‚¹

> åŸæ–‡ï¼š<https://dev.to/maciekgrzybek/make-your-website-live-with-serverless-framework-little-bits-16gj>

[![Little Bits](img/b3bfc6e068d752ad6c48ddffbf9cc41b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--LYltK6hi--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://res.cloudinary.com/practicaldev/image/fetch/s--kDnOm6Tc--/c_imagga_scale%2Cf_auto%2Cfl_progressive%2Ch_420%2Cq_auto%2Cw_1000/https://thepracticaldev.s3.amazonaws.com/i/ktl98648vzd366rxgst6.jpg)

##### Little Bits æ˜¯ä¸€ç³»åˆ—çŸ­æ–‡ï¼Œè§£é‡Šå¸¸è§å¼€å‘é—®é¢˜çš„å¿«é€Ÿè§£å†³æ–¹æ¡ˆã€‚æ²¡æœ‰ä¸å¿…è¦çš„æè¿°æˆ–ä»£ç ç‰‡æ®µã€‚ä¸åºŸè¯ã€‚

#### æˆ‘ä»¬è¦åšä»€ä¹ˆï¼Ÿ

å°† [GatsbyJS](https://www.gatsbyjs.org/) é¡¹ç›®éƒ¨ç½²åˆ° [AWS S3](https://aws.amazon.com/s3/) æ¡¶ä¸­ï¼Œä½¿ç”¨å®æ—¶ URL æŸ¥çœ‹ç½‘ç«™ã€‚

#### æˆ‘ä»¬è¦ç”¨ä»€ä¹ˆå·¥å…·ï¼Ÿ

*   [ç›–èŒ¨æ¯”](https://www.gatsbyjs.org/)
*   [æ— æœåŠ¡å™¨](https://serverless.com/)
*   [æ— æœåŠ¡å™¨ finch æ’ä»¶](https://github.com/fernando-mc/serverless-finch)

#### è®¡åˆ’

1.  åˆ›å»º AWS å¸æˆ·ã€‚
2.  è®¾ç½®å‡­æ®
    *   å…¨å±€å®‰è£…æ— æœåŠ¡å™¨æ¡†æ¶ã€‚
    *   åˆ›å»º IAM ç”¨æˆ·å’Œè®¿é—®å¯†é’¥
    *   åœ¨æ‚¨çš„è®¡ç®—æœºä¸Šè®¾ç½® AWS å‡­æ®ã€‚
3.  åˆ›å»º GatsbyJS å¯åŠ¨é¡¹ç›®ã€‚
4.  å®‰è£…æ— æœåŠ¡å™¨é¡¹ç›®å’Œæ— æœåŠ¡å™¨ finch æ’ä»¶ã€‚
5.  æ’ä»¶çš„è®¾ç½®é…ç½®ã€‚
6.  éƒ¨ç½²ç½‘ç«™ã€‚

### 1ã€‚åˆ›å»º AWS å¸æˆ·ã€‚

ä¸è¨€è‡ªæ˜ã€‚è¦å¼€å§‹ä½¿ç”¨ AWSï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªå¸æˆ·ã€‚æ³¨æ„:ä½ å¿…é¡»æ·»åŠ ä½ çš„ä¿¡ç”¨å¡è¯¦ç»†ä¿¡æ¯ï¼Œä½†æ˜¯ä¸è¦æ‹…å¿ƒï¼ŒAWS æœ‰å…è´¹çš„ç­‰çº§ï¼Œä½ å¯èƒ½ä¸ä¼šæ£€æŸ¥å®ƒä»¬ã€‚é™¤éä½ ä¼šä½¿ç”¨ä¸€äº›å¤§è§„æ¨¡çš„äººå·¥æ™ºèƒ½è®¡ç®—ï¼Œå¹¶åšæŒ S3ï¼Œä½ æ˜¯æ’åºã€‚
[![AWS Web console](img/b7cc99948f30a712c63eb024c2e8752d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--swH1Mwqu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://articles-images-123123123898989.s3-eu-west-1.amazonaws.com/Screen%2BShot%2B2019-08-05%2Bat%2B13.13.45.png)

### 2ã€‚è®¾ç½®å‡­æ®

##### å…¨å±€å®‰è£…æ— æœåŠ¡å™¨æ¡†æ¶ã€‚

ä»æ‚¨çš„ç»ˆç«¯è¿è¡Œ:

```
npm install -g serverless 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ–è€…ï¼Œå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Mac:

```
sudo npm install -g serverless 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

##### åˆ›å»ºä¸€ä¸ª IAM ç”¨æˆ·å’Œè®¿é—®å¯†é’¥

ç™»å½•æ‚¨çš„ AWS å¸æˆ·ï¼Œå¹¶è½¬åˆ°èº«ä»½å’Œè®¿é—®ç®¡ç†(IAM)éƒ¨åˆ†ã€‚åˆ›å»ºå…·æœ‰ç®¡ç†å‘˜æƒé™çš„æ–°ç”¨æˆ·ã€‚

##### åœ¨æ‚¨çš„æœºå™¨ä¸Šè®¾ç½® AWS å‡­è¯

ä» IAM å¸æˆ·è·å–è®¿é—®å¯†é’¥å’Œç§˜å¯†å¯†é’¥ï¼Œå¹¶ä»ç»ˆç«¯è¿è¡Œå‘½ä»¤:

```
serverless config credentials --provider aws --key <your-access-key> --secret <your-secret-key> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ è¢«å›°ä½äº†ï¼Œå¯ä»¥çœ‹çœ‹è¿™ä¸ªæ¥è‡ªæ— æœåŠ¡å™¨çš„å¾ˆæ£’çš„çŸ­ç‰‡ã€‚

### 3ã€‚åˆ›å»º gatsby starter é¡¹ç›®ã€‚

ä»ç»ˆç«¯è¿è¡Œ:

```
gatsby new my-awesome-website https://github.com/gatsbyjs/gatsby-starter-default 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“ç„¶ä¸ä¸€å®šæ˜¯ GatsbyJS é¡¹ç›®ï¼Œæƒ³ç”¨ä»€ä¹ˆéƒ½å¯ä»¥ã€‚

### 4ã€‚å®‰è£…æ— æœåŠ¡å™¨é¡¹ç›®å’Œæ— æœåŠ¡å™¨ finch æ’ä»¶ã€‚

åœ¨â€œç»ˆç«¯â€ä¸­ï¼Œè½¬åˆ°æ‚¨çš„æ–°ç½‘ç«™æ–‡ä»¶å¤¹:

```
cd my-awesome-website 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨åªéœ€è¿è¡Œ:

```
serverless 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶æŒ‰ç…§æç¤ºè¿›è¡Œæ“ä½œã€‚è®°å¾—é€‰æ‹© AWS Node.js ç¯å¢ƒã€‚ç°åœ¨å®‰è£…æ— æœåŠ¡å™¨ finch æ’ä»¶ã€‚ä¸ºæ­¤ï¼Œè¿è¡Œ:

```
npm install --save serverless-finch 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### 5ã€‚æ’ä»¶çš„è®¾ç½®é…ç½®ã€‚

è¦è®¾ç½®æ’ä»¶ï¼Œè¯·ä½¿ç”¨:
æ›´æ–°æ‚¨çš„ serverless.yml æ–‡ä»¶

```
plugins:
  - serverless-finch
custom:
  client:
    bucketName: unique-s3-bucketname #Bucket will be created automatically.
    distributionFolder: public
    #You can find more config options on the plugin's GitHub page. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨çš„ serverless.yml æ–‡ä»¶çœ‹èµ·æ¥åº”è¯¥æ˜¯è¿™æ ·çš„(åœ¨åˆ é™¤äº†å®‰è£…è¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ³¨é‡Šä¹‹å):

```
service: awesome-name
app: awesome-name-app
org: your-name

provider:
  name: aws
  runtime: nodejs10.x
plugins:
  - serverless-finch
custom:
  client:
    bucketName: unique-s3-bucketname #Bucket will be created automatically.
    distributionFolder: public
    #You can find more config options on plugins github page.
functions:
  hello:
    handler: handler.hello 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### 6ã€‚éƒ¨ç½²ç½‘ç«™ã€‚

ä»ç»ˆç«¯è¿è¡Œç½‘ç«™çš„æ„å»ºè¿‡ç¨‹:

```
npm run build 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¹‹åè¿è¡Œéƒ¨ç½²å‘½ä»¤:

```
serverless client deploy 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶æŒ‰ç…§æç¤ºè¿›è¡Œæ“ä½œã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹çš„æœ€åï¼Œä½ ä¼šæ”¶åˆ°ä¸€ä¸ªå´­æ–°ç½‘ç«™çš„ç½‘å€ã€‚

### æ€»ç»“

å°±è¿™æ ·ï¼Œæ‚¨å·²ç»æˆåŠŸåœ°å°†æ‚¨çš„é™æ€ç½‘ç«™éƒ¨ç½²åˆ° AWS S3 Bucketã€‚ç°åœ¨ï¼Œä½ å¯ä»¥å°è¯•æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰åŸŸåï¼Œå°†ä½ çš„ç½‘ç«™è¿æ¥åˆ° CloudFront æˆ–å…¶ä»–ä»»ä½•éœ€è¦çš„ä¸œè¥¿ã€‚å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¹¶ä¸”ä½ è®¤ä¸ºç®€çŸ­ç´§å‡‘çš„å½¢å¼å¾ˆé…·(æˆ–è€…å¦‚æœä½ ä¸å–œæ¬¢ğŸ˜ƒ)åœ¨è¯„è®ºåŒºå‘Šè¯‰æˆ‘ã€‚