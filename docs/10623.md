# æˆ‘å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªäº¤äº’å¼åœ°å›¾

> åŸæ–‡:[https://dev . to/daudr/how-I-build-a-interactive-map-from scratch-1kg f](https://dev.to/daudr/how-i-built-an-interactive-map-from-scratch-1kgf)

è¿™ç¯‡æ–‡ç« ä¹‹å‰å‘è¡¨åœ¨æˆ‘çš„ä¸»åšå®¢ä¸Šã€‚

å‰å‡ å¤©ï¼Œæˆ‘éœ€è¦ä¸ºä¸€ä¸ªå®¢æˆ·å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œè¿™é¡¹ä»»åŠ¡åŒ…æ‹¬åˆ›å»ºä¸€ä¸ªåŸºäºé™æ€ SVG çš„äº¤äº’å¼åœ°å›¾ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è§£é‡Šæˆ‘æ˜¯å¦‚ä½•å®Œæˆè¿™é¡¹å·¥ä½œçš„ğŸ‘Œ

[![Build your map](../Images/12669fcafe6be1a519901ba14571eb26.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--U-Ziwn-o--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://images.unsplash.com/photo-1524661135-423995f22d0b%3Fixlib%3Drb-1.2.1%26ixid%3DeyJhcHBfaWQiOjEyMDd9%26auto%3Dformat%26fit%3Dcrop%26w%3D1953%26q%3D80)

> å®‰å¾·é²Â·æ–¯å›¾ç‰¹æ–¯æ›¼åœ¨ [Unsplash](https://unsplash.com/) ä¸Šçš„ç…§ç‰‡

## [](#first-things-first)å…ˆåšç¬¬ä¸€ä»¶äº‹

é—®é¢˜æ˜¯æ‰€ä½¿ç”¨çš„åœ°å›¾æ ¹æœ¬ä¸æ˜¯äº¤äº’å¼çš„ï¼Œè¦æ˜¾ç¤ºæ‰€é€‰æ‹©çš„åŒºåŸŸï¼Œæ‚¨éœ€è¦æ·»åŠ  CSS ç±»ï¼Œå¹¶ä¸”ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªæ‰€é€‰æ‹©çš„åŒºåŸŸã€‚æ‰€ä»¥æˆ‘åœ¨ç½‘ä¸Šæœç´¢äº†ä¸€ä¸ªå¯èƒ½ç¬¦åˆæˆ‘éœ€è¦çš„ **angular** å›¾ä¹¦é¦†ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰ç»“æœğŸ˜¢

## [](#lets-create-a-new-angular-lib)è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„è§’åº¦åº“

æ‰€ä»¥æˆ‘å¯¹è‡ªå·±è¯´:*ä¸ºä»€ä¹ˆä¸è‡ªå·±åˆ›å»ºä¸€ä¸ªæ–°çš„åº“å‘¢ï¼Ÿå°±è¿™æ ·ï¼Œæˆ‘æ‰“å¼€æˆ‘çš„ç»ˆç«¯ï¼Œè¾“å…¥*

`ng new lib @daudr/interactive-italy`

(**æ˜¯çš„ï¼Œæˆ‘å¼€å§‹è¿™ä¸ªé¡¹ç›®æ—¶åªè€ƒè™‘äº†æ„å¤§åˆ©ï¼Œä½†å¯äº’æ¢åœ°å›¾å³å°†æ¨å‡ºï¼Œæ•¬è¯·å…³æ³¨ï¼**ğŸ˜‰)

### [](#create-the-main-component)åˆ›å»ºä¸»ç»„ä»¶

æ‰€ä»¥æˆ‘å¼€å§‹åˆ›å»ºåº“çš„ä¸»è¦ç»„ä»¶ï¼Œ`interactive-italy.component.ts`ï¼Œä½†æ˜¯è¿™ä¸ªç»„ä»¶åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
ç­”æ¡ˆæ¯”æ‚¨æƒ³è±¡çš„è¦ç®€å•ï¼Œé¦–å…ˆï¼Œæˆ‘å¿…é¡»æ‰¾åˆ°æ­£ç¡®çš„ SVG å›¾åƒï¼Œä½œä¸ºä¸€ä¸ªæ–°æ‰‹ï¼Œæˆ‘å†³å®šåœ¨äº’è”ç½‘ä¸Šå¯»æ‰¾ï¼Œæˆ‘æ‰¾åˆ°äº†æˆ‘éœ€è¦çš„ä¸œè¥¿:

[![Italy map with regions](../Images/3906cd9e15ad6ffa1a75842aadd34d5f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--1m3yIq5q--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://upload.wikimedia.org/wikipedia/commons/9/9b/Italy_map_with_regions.svg)

> æ„Ÿè°¢ç»´åŸºåª’ä½“

å”¯ä¸€çš„é—®é¢˜æ˜¯åœ°å›¾ä¸æ˜¯äº¤äº’å¼çš„ã€‚

```
<svg
  width="460.30981"
  height="562.58575"
>
  <path
  *ngFor="let region of regions"
  [attr.d]="region.d"
  [attr.title]="region.title"
  (click)="onRegionClick(region.title)"
  [ngClass]="{ selected: region.title | selected: selectedRegions }"
  />
</svg> 
```

éƒ½åœ¨è¿™é‡Œäº†ï¼Œå°±è¿™äº›ã€‚

### [](#create-the-data)åˆ›å»ºæ•°æ®

ä½†æ˜¯è®©æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯ç”±ä»€ä¹ˆé©±åŠ¨çš„:
`regions`å¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„åŒ…å«äº†ä½œä¸º SVG è·¯å¾„çš„æ‰€æœ‰åœ°å›¾åŒºåŸŸ

```
export const REGIONS: Region[] = [
  {
    d:
      'm 374.27021,304.03051 1.36,6.34 2.24,5.51 6.27,11.18 7.01,7.71 8.24,6.15 0.87,2.33 3.67,3.53 0.33,1.35 5.56,3.7 5.16,1.83 0.21,4.85 3.43,2.43 0,0 -1.17,1.85 0.91,0.84 -2.84,1.96 -2.3,2.84 -0.82,3.1 -2.36,1.66 -1.72,3.73 -4.76,5.13 -2.04,-0.37 0.79,-0.64 -1.07,-4.29 -1.1,-1.07 -2.44,-1.62 -1.05,1.32 -0.57,-0.22 -0.98,-2.19 -1.24,0.13 -0.94,-1.26 -2.91,2.38 -1.43,2.22 -2.22,0.15 -0.42,0.9 1.25,3.55 1.52,0.89 -0.42,1.03 -0.85,-0.13 -0.25,-1.01 -0.67,1.24 -1.99,0.05 -0.63,2.64 -0.79,-2.07 -1.16,0.09 -0.87,2.4 -1.33,0.05 -0.28,1.46 -1.87,-0.98 -2.1,0.52 0,0 -2.49,-3.27 -1.96,0.19 -2.4,-1.41 -1.03,0.65 -1.33,-0.4 -1.75,-3.31 -1.32,0.73 -1.07,-1.18 -1.78,-0.49 -1.06,2.09 -4.05,1.35 -1.48,-0.93 -0.73,-1.81 -1.84,-0.43 -1.48,-1.43 -1.73,-0.7 -1.4,1.36 -1,-3.63 1.28,-2.29 -1,-1.41 -1.01,0.18 -1.98,-2.28 -0.9,0.37 -7.65,-4.49 -2.03,-0.72 -0.02,1.24 -2.38,-0.64 -1.41,-2.25 0.15,-4.92 0.78,0.36 2.08,-1.78 0.05,-2.39 1.73,-0.13 6.56,3.53 1.24,-0.77 1.69,0.62 1.07,-2.23 1.5,-0.29 -0.53,-0.71 1.83,-0.33 -1.93,-1.22 -0.3,-1.63 -2.43,-0.84 -2.58,-2.54 -0.65,-3.28 -3.74,-2.48 2.08,-2.33 -3.99,-3.74 3.18,-2.42 -0.1,-2.38 -1,-1.86 1.03,-0.58 0.76,-2.76 2.75,1.04 0.61,-0.73 1.35,0 0.58,0.98 1.5,-0.77 2.26,0.31 1.35,-1.17 0.76,-3.43 -1.99,-0.63 -1.15,-1.37 0.54,-1.68 0,0 0,0 0,0 0,0 0,0 1.66,0.48 1.88,-1.33 0.57,0.46 0.6,-2.37 2.37,-0.39 0.3,-2.49 1.34,-1.49 0.24,-1.44 2.08,1.13 2.37,-1.11 0.67,0.94 1.35,-0.17 2.01,-0.94 0.46,-2.21 0.68,-0.38 2.78,-0.18 2.11,-1.41 4.99,-1.07 0,0 z',
    title: 'Abruzzo'
  },
  {
    d:
      'm 457.43021,430.14051 -0.33,-1.23 1.34,-1.23 1.95,-0.38 4.65,0.78 2.51,-0.9 1.45,1.05 1.69,-0.91 -0.16,-0.95 1.67,-0.43 -0.18,-0.76 0.82,0.29 1.42,-0.85 2.3,1.65 1.74,0.3 0.24,1.03 1.26,0.3 0.61,2.35 0.62,-0.42 1.84,1.5 -0.64,1.04 0.3,1.55 -1.79,2.05 -1.51,-0.27 0.61,1.13 5.59,2.38 1.59,1.51 2.14,-1.96 2,0.65 2.94,6.46 6.56,6.05 0.78,1.74 1.53,0.42 3.48,-4.04 2.04,2.47 -0.06,-1.89 0.97,-0.26 0.85,1.33 0.11,-1.74 1.69,0.73 1.01,-0.64 0.17,0.99 1.17,0.7 0.54,-0.74 2.92,2.22 -1.03,0.51 1.22,1.41 -0.9,3.62 0.92,2.05 -0.63,0.46 -0.43,2.89 0.96,1.01 -0.44,0.81 1.16,0.88 -0.96,2.08 0.86,0.94 1.7,-0.43 1.77,1.07 0.37,1.62 1.74,1.47 0.78,1.86 0,0 -3.94,5.64 -4.81,10.36 -2.29,1.67 0,0 -2.72,-0.95 -3.12,0.97 -3.08,-1.02 -1.91,0.37 -0.66,-1.11 -0.63,1.47 0.22,2.84 -1.03,2.22 0.26,2 -3.05,5.44 1.11,1.14 -0.44,1.32 -2.14,-2.39 -2,-0.18 -2.93,0.66 -0.02,1.75 -2.78,-1.27 -1.04,1.08 -4.8,0.26 -1.55,-1.74 0.37,-0.62 -0.85,-1.6 1.24,-2.23 -1.16,-0.32 -1.49,0.85 -0.69,-0.96 -1.85,-0.3 -1.43,1.23 -0.62,-0.87 -0.93,0.49 -0.9,-0.94 -1.68,0.18 -2.35,2.53 -0.95,2.6 0,0 -1.79,-3.55 -2.1,-1.92 -0.14,-1.48 -1.68,-0.98 0,0 1.69,-1.01 -1.27,-1.38 1.21,-0.34 1.56,-2.12 -0.32,-2.91 1.62,-1.65 -0.14,-1 3.47,-1.48 -0.52,-1.23 0.93,-0.83 -0.04,-1.42 -0.61,-1.15 -2.93,-0.85 -0.14,-1.32 -1.64,-1.51 -0.05,-2.56 -2.1,-0.76 -1.6,-2.14 -2.06,-1.03 -0.48,-1.73 -2.17,-1.71 0.72,-1.08 -1.35,-3.21 0.7,-0.82 -4.35,-2.63 0.73,-2.02 1.65,-1.01 0.06,-0.81 -5.93,-3.85 0.17,-4.85 -0.82,-0.07 0.22,-1.18 -2.06,-1.27 2.1,-0.15 0.12,-2.14 -1.02,-0.52 0.43,-0.66 4.79,1.08 0.64,-0.35 -0.23,-1.16 2.96,-1.29 2.26,-5.87 z',
    title: 'Basilicata'
  },
  ...
] 
```

### [](#and-then-comes-the-logic-behind-all)ç„¶åæ˜¯ä¸€åˆ‡èƒŒåçš„é€»è¾‘

å¦‚æœæˆ‘ä»¬æ·»åŠ ä¸€äº›é€»è¾‘ï¼Œæˆ‘ä»¬å°±æœ‰äº†å®Œæ•´çš„ç»„ä»¶

```
export class InteractiveItalyComponent {
  public regions = REGIONS;
  public selectedRegions: string[] = [];

  @Output() regionsChange = new EventEmitter<string[]>();

  onRegionClick(region: string) {
    const index = this.selectedRegions.indexOf(region);
    index === -1 ? this.selectedRegions.push(region) : this.selectedRegions.splice(index, 1);

    this.regionsChange.emit(this.selectedRegions);
  }
} 
```

### [](#but-dont-forget-the-utilities)ä½†åˆ«å¿˜äº†å…¬ç”¨äº‹ä¸š

æˆ‘åˆšåˆšæ·»åŠ äº†ä¸€ä¸ªç®¡é“ï¼ŒçŸ¥é“ä¸€ä¸ªåŒºåŸŸæ˜¯å¦è¢«é€‰ä¸­:

```
export class SelectedPipe implements PipeTransform {
  transform(value: string, regions: string[]): boolean {
    return regions.indexOf(value) !== -1;
  }
} 
```

å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬ä»…ä»…ä» SVG å›¾åƒä¸­æ„å»ºäº†ä¸€ä¸ªå®Œå…¨äº¤äº’å¼çš„æ„å¤§åˆ©åœ°å›¾ï¼Œæ˜¯ä¸æ˜¯å¾ˆé…·ï¼ŸğŸ˜

[![The final result](../Images/d6f3e115c7d29db4bab440775e05ad02.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--etYT7OEq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://firebasestorage.googleapis.com/v0/b/daudr-blog.appspot.com/o/interactive-map.gif%3Falt%3Dmedia%26token%3D330cb736-44a0-49a0-8c26-b13594471ff5)

ä½œä¸ºä¸€ä¸ªæé†’ï¼Œæˆ‘åœ¨ NPM ä¸Šå¼€æºå‘å¸ƒäº†è¿™ä¸ª Angular åº“ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³çš„è¯å°±å»çœ‹çœ‹å§ï¼

[@ daudr/interactive-NPM ä¸Šçš„æ„å¤§åˆ©](https://www.npmjs.com/package/@daudr/interactive-italy)

*æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³é˜…è¯»å¦‚ä½•åœ¨ NPM å‘å¸ƒä¸€ä¸ªæœ‰æ£±è§’çš„å›¾ä¹¦é¦†ï¼Œè¯·å‘Šè¯‰æˆ‘*