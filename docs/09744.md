# ååº”:ç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è§£é‡Šä½¿ç”¨æ•ˆæœ

> åŸæ–‡ï¼š<https://dev.to/prototyp/react-useeffect-explained-with-lifecycle-methods-296n>

React çš„`useEffect`é’©å­ç»“åˆäº†`componentDidMount`ã€`componentDidUpdate`å’Œ`componentWillUnmount`ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚è¿™éå¸¸æœ‰ç”¨ï¼ŒåŸå› å¦‚ä¸‹:å®ƒå‡å°‘äº†ä»£ç é‡ï¼Œç®€åŒ–äº†ä»£ç ï¼Œå¹¶å…è®¸åœ¨å•ä¸ªç»„ä»¶ä¸­è°ƒç”¨å¤šä¸ª`useEffect`é’©å­ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº`useEffect`é’©å­çš„å†…å®¹: [React docs](https://reactjs.org/docs/hooks-effect.html)

æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åªè¿è¡Œå…¶ä¸­ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ä¸‹é¢çš„å¤‡å¿˜å•å°†å¸®åŠ©ä½ è¾¾åˆ°ä½ æ‰€æœŸå¾…çš„æ•ˆæœã€‚

## componentidmount å½“é‡

ä¸ºäº†è®©è¿™ä¸ªé’©å­åªè¿è¡Œä¸€æ¬¡(å½“ä¸€ä¸ªç»„ä»¶è¢«æŒ‚è½½æ—¶)ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºé’©å­ä¾èµ–ã€‚

```
useEffect(() => {
  /* ComponentDidMount code */
}, []); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## componentDidUpdate ç­‰ä»·

ä¸ºäº†è®©è¿™ä¸ªé’©å­åœ¨ç»„ä»¶æ›´æ–°æ—¶è¿è¡Œ(è¿™åŒ…æ‹¬æŒ‚è½½)ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®è‡³å°‘ä¸€ä¸ªå˜é‡ä½œä¸ºé’©å­çš„ä¾èµ–(åœ¨æœ¬ä¾‹ä¸­æ˜¯`var1`å’Œ`var2`)ã€‚

```
useEffect(() => {
  /* componentDidUpdate code */
}, [var1, var2]); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## ç»„ä»¶å°†å¸è½½ç­‰æ•ˆ

ä¸ºäº†è®©è¿™ä¸ªé’©å­åœ¨ç»„ä»¶å¸è½½æ—¶è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦ä»é’©å­è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›æ¸…ç†åŠŸèƒ½åªåœ¨ç»„ä»¶è¢«å¸è½½æ—¶è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªç©ºæ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¾èµ–æ•°ç»„ä¸­è®¾ç½®äº†ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡ï¼Œæ¸…ç†å°†åœ¨æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶è¿è¡Œã€‚

```
useEffect(() => {
  return () => {
   /* componentWillUnmount code */
  }
}, []); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## ä¸‰è€…æ€»å’Œ

```
useEffect(() => {

  /* componentDidMount code + componentDidUpdate code */

  return () => {
   /* componentWillUnmount code */
  }
}, [var1, var2]); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

* * *

è¿™äº›æ–‡ç« ä»¥å’–å•¡ä¸ºç‡ƒæ–™ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ å–œæ¬¢æˆ‘çš„å·¥ä½œï¼Œè§‰å¾—å®ƒå¾ˆæœ‰ç”¨ï¼Œè¯·è€ƒè™‘ç»™æˆ‘ä¹°æ¯å’–å•¡å§ï¼æˆ‘çœŸçš„å¾ˆæ„Ÿæ¿€ã€‚

[![Buy Me A Coffee](img/f7d2fd6a693d2b9dc44399aa250c8165.png)](https://www.buymeacoffee.com/ubnZ8GgDJ)

æ„Ÿè°¢ä½ èŠ±æ—¶é—´é˜…è¯»è¿™ç¯‡æ–‡ç« ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ç»™å®ƒä¸€ä¸ªâ¤ï¸æˆ–ğŸ¦„ï¼Œåˆ†äº«è¯„è®ºã€‚