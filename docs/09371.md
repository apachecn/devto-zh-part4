# ä¸º git é…ç½® SSH

> åŸæ–‡ï¼š<https://dev.to/idrisrampurawala/configuring-ssh-for-git-2of1>

å‡è®¾æ‚¨æ­£åœ¨ä¸€ä¸ªç”± Git ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿç»´æŠ¤çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¸€ä¸ªåº”ç”¨ç¨‹åºã€‚æ‚¨é€šè¿‡è‡ªå·±çš„å‡­è¯å…‹éš† git å­˜å‚¨åº“å¹¶è®¾ç½®ç³»ç»Ÿã€‚å½“ä½ è¿è¡Œ`git pull`æ—¶ï¼Œå®ƒä¼šå†æ¬¡è¦æ±‚å‡­è¯ã€‚è¿™è‚¯å®šä¸æ˜¯ä½ æ‰€æœŸå¾…çš„ï¼Œå¯¹å—ï¼Ÿä½ æƒ³è¦çš„æ˜¯ä¸éœ€è¦ä»»ä½•äººçš„å‡­è¯å°±å¯ä»¥æ”¹å˜çš„ä¸œè¥¿ã€‚ç­”æ¡ˆæ˜¯â€”â€”`connecting to git via SSH`ã€‚

å½“ç„¶ï¼Œè¿™ä¸æ˜¯æ‚¨å¯ä»¥åˆ©ç”¨è¯¥ç‰¹æ€§çš„å”¯ä¸€ç”¨ä¾‹ã€‚å®ƒè¿˜å¯ä»¥åœ¨åƒæ„å»ºç®¡é“è¿™æ ·çš„ç”¨ä¾‹ä¸­ä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ç‚¹èƒŒæ™¯ï¼Œè®©æˆ‘ä»¬ç†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

âœ‹ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å‡è®¾å®¢æˆ·æœºè¿è¡Œåœ¨ Linux æ“ä½œæœåŠ¡å™¨ä¸Šã€‚è¿™ç§å‡è®¾ä»…é€‚ç”¨äºæˆ‘ä»¬åœ¨æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œçš„å‘½ä»¤ã€‚ä¸º git é…ç½® SSH çš„æ­¥éª¤ä¸æ“ä½œç³»ç»Ÿæ— å…³ã€‚å¯¹äºå…¶ä»–æ“ä½œç³»ç»Ÿï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å„è‡ªçš„å‘½ä»¤æ¥å®ç°è¿™äº›ç»“æœã€‚

# å…³äº SSH

SSH æ˜¯ä¸€ç§åè®®ï¼Œé€šè¿‡å®ƒæ‚¨å¯ä»¥è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨å’ŒæœåŠ¡å¹¶å¯¹å…¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚SSH åœ¨åŒæ–¹(å®¢æˆ·æœºå’ŒæœåŠ¡å™¨)ä¹‹é—´å»ºç«‹ä¸€ä¸ªå®‰å…¨çš„è¿æ¥ï¼Œå¯¹åŒæ–¹è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶æ¥å›ä¼ é€’å‘½ä»¤å’Œè¾“å‡ºã€‚ä½¿ç”¨ SSH å¯†é’¥ï¼Œæ‚¨å¯ä»¥è¿æ¥åˆ° Git æ‰˜ç®¡æœåŠ¡å™¨(ä¾‹å¦‚ GitHubã€BitBucket ),è€Œæ— éœ€åœ¨æ¯æ¬¡è®¿é—®æ—¶æä¾›æ‚¨çš„ç”¨æˆ·åæˆ–å¯†ç ã€‚

ç†è§£ SSH å·¥ä½œæµè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼Œå› æ­¤æˆ‘ä»¬å°†è®¨è®ºé™åˆ¶åœ¨è¿™ä¸ªä¸»é¢˜ä¸Šã€‚

# è®¾ç½® SSH å¯†é’¥

å½“æ‚¨è®¾ç½® SSH æ—¶ï¼Œæ‚¨åˆ›å»ºäº†ä¸€ä¸ªå¯†é’¥å¯¹â€”â€”ç§æœ‰å¯†é’¥å’Œå…¬å…±å¯†é’¥ã€‚ç§é’¥ä¿å­˜åœ¨æ‚¨çš„æœ¬åœ°è®¡ç®—æœºä¸Šï¼Œé€šå¸¸åœ¨`.ssh`æ–‡ä»¶å¤¹ä¸­ã€‚å…¬é’¥è¢«ä¼ é€’(ä¸Šä¼ )åˆ°æœåŠ¡å™¨ä»¥éªŒè¯è¯·æ±‚ã€‚

åœ¨åˆ›å»ºæ–°å¯†é’¥ä¹‹å‰ï¼Œæ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦å·²ç»åˆ›å»ºäº†å¯†é’¥å¯¹ã€‚

```
$ ls -al ~/.ssh
# Lists the files in your .ssh directory, if they exist 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ£€æŸ¥ç›®å½•åˆ—è¡¨ï¼Œçœ‹çœ‹æ‚¨æ˜¯å¦å·²ç»æœ‰äº†ä¸€ä¸ªå…¬å…± SSH å¯†é’¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¬é’¥çš„æ–‡ä»¶åä»¥`.pub`ç»“å°¾ï¼Œä¾‹å¦‚`id_rsa.pub`
å¦‚æœæ‚¨æ²¡æœ‰ç°æœ‰çš„å…¬é’¥å’Œç§é’¥å¯¹ï¼Œæˆ–è€…ä¸å¸Œæœ›ä½¿ç”¨ç°æœ‰çš„å¯†é’¥ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ç”Ÿæˆä¸€ä¸ªæ–°çš„ SSH å¯†é’¥:

*   ä½¿ç”¨`ssh-keygen`ç”Ÿæˆå¯†é’¥

```
$ ssh-keygen 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/guest/.ssh/id_rsa): 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   é…ç½®å¯†é’¥

    æ‚¨å°†è¢«è¦æ±‚è‡ªå®šä¹‰æ–‡ä»¶åå’Œå¯†ç ã€‚å¦‚æœä½ æƒ³ä¿æŒé»˜è®¤è®¾ç½®ï¼Œä½ å¯ä»¥ç›´æ¥æŒ‰å›è½¦é”®ã€‚æ•´ä¸ªäº¤äº’çœ‹èµ·æ¥å°†ç±»ä¼¼å¦‚ä¸‹:

```
$ ssh-keygen 
Generating public/private rsa key pair.
Enter file in which to save the key (/home/guest/.ssh/id_rsa):
Created directory '/home/guest/.ssh'.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/guest/.ssh/id_rsa.
Your public key has been saved in /home/guest/.ssh/id_rsa.pub.
The key fingerprint is:
4c:80:61:2c:00:3f:9d:dc:08:41:2e:c0:cf:b9:17:69 guest@myhost.local 
The key's randomart image is:
+--[ RSA 2048]----+
|*o+ooo.          |
|.+.=o+ .         |
|. *.* o .        |
| . = E o         |
|    o . S        |
|   . .           |
|     .           |
|                 |
|                 |
+-----------------+ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   é€šè¿‡åˆ—å‡ºç›®å½•æ¥éªŒè¯å·²åˆ›å»ºçš„å¯†é’¥

```
$ ls ~/.ssh 
id_rsa id_rsa.pub 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å°†å¾—åˆ°ä¸€å¯¹å…³é”®æ–‡ä»¶åä½œä¸ºè¾“å‡ºã€‚`id_rsa`æ˜¯ç§é’¥ï¼Œ`id_rsa.pub`æ˜¯å…¬é’¥ã€‚

# å‘ ssh-agent æ·»åŠ å¯†é’¥

å¦‚æœæ‚¨ä¸æƒ³åœ¨æ¯æ¬¡ä½¿ç”¨å¯†é’¥æ—¶éƒ½é”®å…¥å¯†ç ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦å°†å®ƒæ·»åŠ åˆ° ssh-agent ä¸­ã€‚

```
# start the ssh agent
$ eval `ssh-agent` 
Agent pid 9700

# add your private key (the filename without .pub)
$ ssh-add ~/.ssh/id_rsa 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# æ·»åŠ ä½ çš„å…¬é’¥åˆ°æœåŠ¡å™¨(GitHubï¼ŒBitBucket)

ä¸€æ—¦æ‚¨åˆ›å»ºäº†æ‚¨çš„å¯†é’¥å¯¹ï¼Œå°±è¯¥å°†æ‚¨çš„å…¬é’¥æ·»åŠ åˆ° git æ‰˜ç®¡æœåŠ¡å™¨æ¥éªŒè¯æ‚¨çš„ ssh é€šä¿¡äº†ã€‚æ‚¨å¯ä»¥æŒ‰ç…§é“¾æ¥ä¸­çš„æ­¥éª¤å‘ [GitHub](https://help.github.com/en/articles/adding-a-new-ssh-key-to-your-github-account) å’Œ [BitBucket æ·»åŠ å¯†é’¥(æ­¥éª¤ 4)](https://confluence.atlassian.com/bitbucket/set-up-an-ssh-key-728138079.html)

# å°†è¿œç¨‹ URL æ›´æ”¹ä¸ºæ‚¨çš„å­˜å‚¨åº“

å¤åˆ¶æ‚¨çš„å­˜å‚¨åº“çš„`SSH` git URL(ä¾‹å¦‚`git@bitbucket.org:repo/project.git`)å¹¶å°†æ‚¨çš„å®¢æˆ·ç«¯æœºå™¨ä¸Šé¡¹ç›®æ ¹æ–‡ä»¶å¤¹ä¸­çš„`remote-url`æ›´æ”¹ä¸º:

```
# listing current remote-url
$ git remote -v 
origin https://guest@bitbucket.org/repo/project.git (fetch) 
origin https://guest@bitbucket.org/repo/project.git (push)

# change the url
$ git remote set-url origin git@bitbucket.org:repo/project.git

# verify if url changed by listing again
$ git remote -v 
origin git@bitbucket.org:repo/project.git (fetch) 
origin git@bitbucket.org:repo/project.git (push) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# æœ€åä¸€æ­¥

ç§å•Šã€‚æ‚¨å·²ç»å®Œæˆäº†æ‰€æœ‰çš„é…ç½®ï¼Œç°åœ¨æ˜¯æ—¶å€™éªŒè¯æŒ‰é”®æ˜¯å¦æ­£å¸¸å·¥ä½œäº†ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨é¡¹ç›®æ ¹æ–‡ä»¶å¤¹ä¸­æ‰§è¡Œ`git pull`æ¥éªŒè¯ã€‚å®ƒä¸åº”è¯¥è¦æ±‚ä»»ä½•å‡­è¯

æ­å–œä½ ï¼ğŸ‘æ‚¨å·²ç»æˆåŠŸåœ°ä¸ºæ‚¨çš„ git å­˜å‚¨åº“è®¾ç½®äº† SSHã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ç•™è¨€ã€‚

å†è§ï¼ç›´åˆ°æˆ‘çš„ä¸‹ä¸€ç¯‡æ–‡ç« ğŸ˜‹