# React Storybook å¦‚ä½•ç®€åŒ–ç»„ä»¶æµ‹è¯•

> åŸæ–‡:[https://dev . to/bnevilleoneill/how-react-storybook-can-simplify-component-testing-1l8m](https://dev.to/bnevilleoneill/how-react-storybook-can-simplify-component-testing-1l8m)

[![react storybook](../Images/568b859a931c2b54ce59f6a6e97c378d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--XdJfnBtj--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/5hwijbpj55rjmxgqb247.png)

## [](#introduction)ç®€ä»‹

æ¯ä¸ªå¼€å‘äººå‘˜éƒ½æƒ³æ„å»ºæœ‰æ•ˆçš„è½¯ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡éš”ç¦»è½¯ä»¶å¹¶åœ¨ä¸€ç³»åˆ—æµ‹è¯•ä¸­å±•ç¤ºå…¶è¡Œä¸ºæ¥ç¡®ä¿è½¯ä»¶ä»£ç å®Œç¾è¿è¡Œã€‚å¯¹äºæˆ‘ä»¬çš„ç»„ä»¶æ¥è¯´å°±ä¸ä¸€æ ·äº†ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç¯å¢ƒä¸­æµ‹è¯•çš„ã€‚

Storybook å…è®¸æ‚¨ä»¥éš”ç¦»çš„æ–¹å¼æŸ¥çœ‹ç»„ä»¶å¹¶ä¸ä¹‹äº¤äº’ã€‚è¿™å°±åƒå•å…ƒæµ‹è¯•ä¸€æ ·ï¼Œåªæ˜¯é’ˆå¯¹ UI ç»„ä»¶ã€‚ç”¨ [Storybook çš„æ–‡æ¡£](https://storybook.js.org/docs/basics/introduction/)çš„è¯è¯´:

Storybook æ˜¯ä¸€ä¸ªç”¨æˆ·ç•Œé¢å¼€å‘ç¯å¢ƒå’Œ UI ç»„ä»¶çš„æ¸¸ä¹åœºã€‚è¯¥å·¥å…·ä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿç‹¬ç«‹åˆ›å»ºç»„ä»¶ï¼Œå¹¶åœ¨ä¸€ä¸ªéš”ç¦»çš„å¼€å‘ç¯å¢ƒä¸­äº¤äº’å±•ç¤ºç»„ä»¶ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ Storybook å¦‚ä½•å¸®åŠ©æˆ‘ä»¬åˆ›å»º UI ç»„ä»¶å¹¶æ”¹è¿›æˆ‘ä»¬çš„ç»„ä»¶æµ‹è¯•ã€‚

[![LogRocket Free Trial Banner](../Images/4aa67f42a82d61c79b61acb13eae9479.png)T2ã€‘](https://logrocket.com/signup/)

## [](#getting-started-with-storybook)æ•…äº‹ä¹¦å…¥é—¨

è®©æˆ‘ä»¬ä»å¼•å¯¼ä¸€ä¸ªæ–°çš„ React é¡¹ç›®å¼€å§‹ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡ CLI å®‰è£… story book:

```
npx create-react-app my-storybook-app
cd my-storybook-app
#install storybook
npx -p @storybook/cli sb init yarn storybook 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“è¿è¡Œ`yarn storybook`æ—¶ï¼Œä½ åº”è¯¥åœ¨æœ¬åœ°åœ°å€`http://localhost:9009/`ä¸Šçœ‹åˆ° Storybook çš„æµ‹è¯•é¡µé¢:

[![storybook ui](../Images/fd784415773ba71673e8d0046285b419.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CZdvc78c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i0.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/storybookui.png%3Fresize%3D1366%252C733%26ssl%3D1)

å‡ºäºæµ‹è¯•çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªåŸºæœ¬ç»„ä»¶â€”â€”ä¸€ä¸ªåä¸º`CoffeeButton`çš„æŒ‰é’®ã€‚å®ƒæ˜¾ç¤ºè¦ä¾›åº”çš„å’–å•¡æ¯æ•°ã€‚

```
// /src/stories/CoffeeButton.js
import React, { useState } from 'react';
const ButtonStyle = {
    backgroundColor: 'lightgrey',
    padding: '10px',
    borderRadius: '5px',
    fontSize: '15px',
    border: '#66c2ff 3px solid',
    cursor: 'pointer'
};
const CoffeeButton = ({children}) => {
    const [count, setCount] = useState(1);
    return (
        <button style = {ButtonStyle} onClick = {() => setCount(count + 1)} >
        {new Array(count).fill(children)}
        {(count < 2)
        ? <div> Please serve 1 cup of coffee </div>
        : <div> Please serve {count} cups of coffee </div>
        }
        </button>
    );
};
export default CoffeeButton; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ•…äº‹ä¹¦æ˜¯ç”¨â€œæ•…äº‹â€æ¥èµ·ä½œç”¨çš„ã€‚ä¸€ä¸ª**æ•…äº‹**æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåŒ…å«ä¸€ä¸ªç»„ä»¶çš„å•ä¸€çŠ¶æ€ï¼Œå¹¶å°†è¯¥ç»„ä»¶å‘ˆç°åˆ°å±å¹•ä¸Šç”¨äºæµ‹è¯•ç›®çš„ã€‚è®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„`CoffeeButton`ç»„ä»¶å†™ä¸€ä¸ªæ•…äº‹ã€‚åœ¨`src/stories`ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸º`CoffeeButtonStory.js` :

```
import React from 'react';
import { storiesOf } from '@storybook/react';
import CoffeeButton from './CoffeeButton';
storiesOf('CoffeeButton', module)
  .add('Black', () => (
    <CoffeeButton>
      <span role="img" aria-label="without-milk">
         ğŸ¿
      </span>
    </CoffeeButton>
  ))
  .add('White', () => (
    <CoffeeButton>
      <span role="img" aria-label="with-milk">
        ğŸ¼
      </span>
    </CoffeeButton>
)); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢æ˜¯æˆ‘ä»¬çš„ç»„ä»¶åœ¨ Storybook ä¸­çš„æ ·å­:

[![](../Images/96bfd4a43c95f6f3ce1ab90cc98512f6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ACN1ubVz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/nccu3yoohccikek8pp2e.gif)

## [](#ui-testing)UI æµ‹è¯•

Storybook æä¾›äº†ä¸åŒçš„æµ‹è¯• UI ç»„ä»¶çš„æŠ€æœ¯ã€‚å‡ºäºå„ç§åŸå› ï¼Œç»„ä»¶éœ€è¦æ¥å—æµ‹è¯•ï¼Œå…¶ä¸­ä¸€äº›åŸå› åŒ…æ‹¬:

*   bug æ£€æµ‹
*   æµ‹è¯•å¯ä»¥è¢«è®°å½•ä¸‹æ¥ï¼Œä½œä¸ºä»äº‹è¯¥é¡¹ç›®çš„å…¶ä»–å¼€å‘äººå‘˜çš„æŒ‡å—
*   ä¸ºäº†é˜²æ­¢åœ¨æ–°çš„æäº¤è¿‡ç¨‹ä¸­æ•°æ®è¢«ç ´å

è®©æˆ‘ä»¬ç»§ç»­æ£€æŸ¥ Storybook å¯ä»¥ä½¿ç»„ä»¶æµ‹è¯•æ— ç¼çš„ä¸€äº›æ–¹æ³•ã€‚

## [](#structural-testing)ç»“æ„æµ‹è¯•

ç»“æ„æµ‹è¯•åŒ…æ‹¬åŸºäºç»„ä»¶å†…éƒ¨å®ç°çŸ¥è¯†çš„ç»„ä»¶æµ‹è¯•ã€‚Storybook é€šè¿‡`storyshots`å®ç°ç»“æ„æµ‹è¯•ï¼Œè¿™æ˜¯ä¸€ä¸ªé€šè¿‡æ¯”è¾ƒä»£ç å¿«ç…§æ¥å·¥ä½œçš„é™„åŠ ç»„ä»¶ã€‚å®‰è£…`storyshots`è¿è¡Œ:

```
npm i -D @storybook/addon-storyshots react-test-renderer 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`react-test-renderer`å°† React ç»„ä»¶æ¸²æŸ“ä¸ºçº¯ JavaScript å¯¹è±¡ï¼Œè€Œä¸ä¾èµ–äº DOMã€‚è¿™ä½¿å¾—æŠ“å–ç”± React DOM å‘ˆç°çš„ DOM æ ‘çš„æˆªå›¾æˆä¸ºå¯èƒ½ã€‚

å®‰è£…åï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæµ‹è¯•æ–‡ä»¶`storyshots.test.js`ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å°†åˆå§‹åŒ–`storyshots` :

```
// src/storyshots.test.js
import initStoryshots from '@storybook/addon-storyshots';  
initStoryshots({ /* configuration options */ }); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†æµ‹è¯•ä¸€ä¸ªç»„ä»¶ï¼Œæˆ‘ä»¬è¿è¡Œ`npm test`ã€‚è¿™å°†ç”Ÿæˆä¸€ä¸ªå¿«ç…§ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ£€æŸ¥ç»„ä»¶çš„è¾“å‡ºã€‚æ¯æ¬¡è¿è¡Œæµ‹è¯•æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¿«ç…§ï¼Œå¹¶ä¸ä¹‹å‰æµ‹è¯•ç”Ÿæˆçš„å¿«ç…§è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœ`storyshots`å‘ç°ä»»ä½•å·®å¼‚ï¼Œæµ‹è¯•å°†å¤±è´¥ã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€æ¬¡æµ‹è¯•æ—¶ç”Ÿæˆçš„å¿«ç…§:

[![passed test](../Images/f66007d764edf17fabba08a6b0b32111.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--P-dJfAQ7--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/successfultest.png%3Fresize%3D417%252C259%26ssl%3D1)

æˆ‘ä»¬çš„æµ‹è¯•æ˜¯æˆåŠŸçš„ï¼Œç°åœ¨è®©æˆ‘ä»¬è¯•ç€æ”¹å˜æˆ‘ä»¬çš„`CoffeeButton`ç»„ä»¶ã€‚å°†`CoffeeButton.js`çš„ç¬¬ 16 è¡Œæ”¹ä¸º:

`? <div> Please DO NOT serve 1 cup of coffee </div>`

åœ¨è¿è¡Œæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹é”™è¯¯:

[![failed test](../Images/bbcb37116770e11e7b6fc6b8baf06593.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--8xhWQu9f--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/failedtest.png%3Fresize%3D333%252C100%26ssl%3D1)

æ›´è¯¦ç»†çš„è§†å›¾:

[![](../Images/6f631add688e65948b5bb44e363e4a9d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--dsZAArzO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i1.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/failedtestdetailed.png%3Fresize%3D466%252C317%26ssl%3D1)

## [](#automated-visual-testing)è‡ªåŠ¨åŒ–è§†è§‰æµ‹è¯•

è‡ªåŠ¨åŒ–è§†è§‰æµ‹è¯•åŒ…æ‹¬è‡ªåŠ¨éªŒè¯æˆ‘ä»¬çš„ç”¨æˆ·ç•Œé¢åœ¨è§†è§‰ä¸Šæ˜¯å¦å¦‚é¢„æœŸçš„é‚£æ ·å‡ºç°ã€‚è¿™åœ¨è·¨æµè§ˆå™¨æµ‹è¯•ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥æ£€æµ‹å‡ºå¼€å‘äººå‘˜æ²¡æœ‰æ³¨æ„åˆ°çš„å¤±è¯¯ã€‚Storybook é€šè¿‡ä¸€ä¸ªåä¸º`storyshot-puppeteer`çš„æ’ä»¶å¯¹ UI è¿›è¡Œå¯è§†åŒ–æµ‹è¯•ã€‚ä¸`storyshots`ç›¸åŒï¼Œè¿™ä¸ªæ’ä»¶é€šè¿‡å¯¹æ¯”æˆªå›¾æ¥å·¥ä½œâ€”â€”åªä¸è¿‡è¿™æ¬¡å®ƒæˆªå–çš„æ˜¯æµè§ˆå™¨çš„æˆªå›¾ï¼Œè€Œä¸æ˜¯ä»£ç ã€‚å®‰è£…`storyshot-puppeteer`è¿è¡Œ:

```
npm i -D @storybook/addon-storyshots-puppeteer 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®‰è£…åï¼Œä¸ºäº†è®©å®ƒæ¯”è¾ƒ UI è€Œä¸æ˜¯ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æ¥è‡ª`puppeteer`æ’ä»¶çš„`imageSnapshot`è¦†ç›–æµ‹è¯•æ¯”è¾ƒã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–è¾‘æˆ‘ä»¬åœ¨è¿›è¡Œç»“æ„æµ‹è¯•æ—¶åˆ›å»ºçš„`initStoryshots`å‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬è¿˜éœ€è¦æŒ‡å®šè¿è¡Œæ•…äº‹ä¹¦çš„ URL:

```
// src/storyshots.test.js
import initStoryshots from '@storybook/addon-storyshots';
import {imageSnapshot} from '@storybook/addon-storyshots-puppeteer';
initStoryshots({
    test: imageSnapshot({storybookUrl: 'http://localhost:9009/'}),
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸‹é¢æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡æµ‹è¯•å›¾åƒæ—¶ç”Ÿæˆçš„å¿«ç…§:

[![](../Images/481d9ff63b96820bd0d81351a0435473.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--yqlDYqrp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/passedtestdetailed.png%3Fresize%3D602%252C365%26ssl%3D1)

å¦‚æœæˆ‘ä»¬æ”¹å˜ç»„ä»¶ä¸­çš„ä»»ä½• UI å±æ€§ï¼Œæˆ‘ä»¬çš„æµ‹è¯•å°†ä¼šå¤±è´¥,`puppeteer`å°†ä»¥å¿«ç…§çš„å½¢å¼è¿”å›å·®å¼‚ã€‚è®©æˆ‘ä»¬æ”¹å˜æˆ‘ä»¬ UI çš„ä¸€éƒ¨åˆ†ã€‚åœ¨`CoffeeButton.js`çš„ç¬¬ 3 è¡Œï¼Œå°†èƒŒæ™¯é¢œè‰²ä»`lightgrey`æ›´æ”¹ä¸º`lightblue` :

```
backgroundColor: 'lightblue', 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æˆ‘ä»¬è¿›è¡Œæµ‹è¯•æ—¶:

[![](../Images/6efbb82642927906acb62793a0afb2ee.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--h8O9Dnv3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i1.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/test2.png%3Fresize%3D408%252C132%26ssl%3D1)

ä¸‹é¢æ˜¯åœ¨æˆ‘ä»¬çš„ UI ä¸­ç”±`puppeteer`æ³¨æ„åˆ°çš„å·®å¼‚çš„å¿«ç…§:

[![](../Images/3b786b2844c1a309c08a1eca83d95778.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--z9-Ddbxl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i1.wp.com/blog.logrocket.com/wp-content/uploads/2019/07/coffeebutton.png%3Fresize%3D2173%252C180%26ssl%3D1)

åœ¨ä¸Šé¢çš„åŒºåˆ†ä¸­ï¼ŒåŸå§‹å›¾åƒåœ¨å·¦è¾¹ï¼Œä¿®æ”¹åçš„å›¾åƒåœ¨å³è¾¹ï¼Œä¸¤è€…ä¹‹é—´çš„å·®å¼‚åœ¨ä¸­é—´ã€‚

## [](#interaction-testing)äº¤äº’æµ‹è¯•

é€šè¿‡äº¤äº’æµ‹è¯•ï¼ŒStorybook å…è®¸æ‚¨åœ¨ DOM ä¸­æ˜¾ç¤ºæµ‹è¯•åŠå…¶ç»“æœä»¥åŠæ‚¨çš„æ•…äº‹ã€‚å®ƒé€šè¿‡ä¸€ä¸ªæ’ä»¶æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚è¦å®‰è£…è¿™ä¸ªæ’ä»¶ï¼Œè¿è¡Œ:

```
npm install -D storybook-addon-specifications 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åå°†è¿™ä¸€è¡Œæ·»åŠ åˆ°æ‚¨çš„`addons.js`æ–‡ä»¶:

```
import 'storybook-addon-specifications/register'; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`react-storybook-specifications`ä¸èƒ½å•ç‹¬å·¥ä½œï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®‰è£…ä»¥ä¸‹:

`enzyme` : JavaScript çš„ React æµ‹è¯•å·¥å…·ã€‚

`enzyme-adapter-react-16`:å¯¹åº”æ‚¨æ­£åœ¨ä½¿ç”¨çš„ React ç‰ˆæœ¬çš„é…¶é€‚é…å™¨ã€‚

`expect` : Jest çš„å†…ç½®æ–¹æ³•ï¼Œç”¨äºåœ¨ç¼–å†™æµ‹è¯•æ—¶æ£€æŸ¥å€¼æ˜¯å¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ã€‚

è¦å®‰è£…è¿™äº›é™„åŠ ç»„ä»¶ï¼Œè¯·è¿è¡Œ:

```
npm install -D enzyme expect enzyme-adapter-react-16 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨æˆ‘ä»¬çš„`config.js`æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†ä»`enzyme`å’Œ`enzyme-adapter-react-16`å¯¼å…¥`configure`å’Œ`Adapter`ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ª`configure`çš„å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åƒè¿™æ ·æŒ‡å®šå®ƒä»¬:

```
import { configure as configure1 } from '@storybook/react';
import {configure as configure2} from 'enzyme';
import Adapter from 'enzyme-adapter-react-16';
function loadStories() {
  require('../src/stories');
}
configure1(loadStories, module);
configure2({ adapter: new Adapter() }); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬é€šè¿‡æµ‹è¯•`CoffeeButton`ç»„ä»¶çš„ä¸€éƒ¨åˆ†æ¥çœ‹çœ‹è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨`CoffeeButtonStory.js`ä¸­ï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç å—:

```
import React from 'react';
    import { storiesOf } from '@storybook/react';
    import { action } from '@storybook/addon-actions';
    import { specs, describe, it } from 'storybook-addon-specifications';
    import {mount} from "enzyme";
    import expect from "expect";
    import CoffeeButton from './CoffeeButton';
    const stories = storiesOf('CoffeeButton', module)
    stories
    .add('Black', () => {
        const story =
        <CoffeeButton onMouseOver={action('click')}>
        <span role="img" aria-label="without-milk">
        ğŸ¿
        </span>
      </CoffeeButton>;
      specs(() => describe('Black', () => {
         it('Should have the following text: ğŸ¿Please serve 1 cup of coffee', () => {
             let output = mount(story);
             expect(output.text()).toContain('ğŸ¿Please serve 1 cup of coffee');
         }); 
      }));
      return story;
    }) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ä¿å­˜å¹¶è¿è¡Œåº”ç”¨ç¨‹åºã€‚åœ¨æˆ‘ä»¬çš„æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šçœ‹åˆ°:

[![](../Images/da8ad13a3be3f6dd72bf95e04a020409.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Gq5YafUh--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/c9eps8k6m8ka92p5eegw.gif)

è®©æˆ‘ä»¬æ”¹å˜æˆ‘ä»¬çš„æµ‹è¯•æœŸæœ›ã€‚å°†`CoffeeButtonStory.js`çš„ç¬¬ 20 è¡Œæ”¹ä¸º:

```
expect(output.text()).toContain('ğŸ¿Please serve a cup of coffee'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œå½“æˆ‘ä»¬è¿è¡Œåº”ç”¨ç¨‹åºå¹¶æ£€æŸ¥æˆ‘ä»¬çš„æµè§ˆå™¨æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹:

[![](../Images/5dbffbf2d33b4392dabdb7e63a452253.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--WKZ38oOS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zi1zvjqddm45vmq663ki.gif)

å¯ä»¥çœ‹å‡ºï¼Œæ›´æ”¹æˆ‘ä»¬çš„é¢„æœŸè¾“å‡ºä¼šç»™ DOM å¸¦æ¥ä¸€ä¸ªé”™è¯¯ã€‚é€šè¿‡`storybook-addon-specifications`çš„äº¤äº’æµ‹è¯•ä½¿æˆ‘ä»¬èƒ½å¤Ÿæœ‰ä¸€ä¸ª`living`æ–‡æ¡£ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å¯ä»¥ä¸æˆ‘ä»¬çš„ç»„ä»¶å’Œå®ƒä»¬çš„æµ‹è¯•ç»“æœå¹¶æ’äº¤äº’ã€‚

## [](#conclusion)ç»“è®º

Storybook æä¾›äº†ä¸€ä¸ªæµ‹è¯• UI ç»„ä»¶çš„å¥½æ–¹æ³•ã€‚çœ‹èµ·æ¥æˆ‘ä»¬ä¼¼ä¹åœ¨æŠ›å¼ƒå•å…ƒæµ‹è¯•ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚å•å…ƒæµ‹è¯•æ—¨åœ¨æ‰¾å‡ºä»£ç ä¸­çš„é”™è¯¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨æµ‹è¯• React ç»„ä»¶ï¼Œå¦‚æœæˆ‘ä»¬çš„ UI å‡ºäº†é—®é¢˜ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šè¯¢é—®éœ€è¦ä¿®å¤å“ªäº›æ ‡è®°ã€‚

è¿™æ„å‘³ç€é›†æˆå’Œå¿«ç…§æµ‹è¯•ä¸å•å…ƒæµ‹è¯•ä¸€æ ·å¥½â€”â€”åœ¨è¿™ç§æƒ…å†µä¸‹ã€‚å¦‚æœä½ æƒ³ç©ä»£ç ï¼Œä½ å¯ä»¥åœ¨ Github çš„è¿™é‡ŒæŸ¥çœ‹æºä»£ç ã€‚

* * *

## [](#plug-logrocket-a-dvr-for-web-apps)Plug: [LogRocket](https://logrocket.com/signup/) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

[![LogRocket Dashboard Free Trial Banner](../Images/0abf868fe5ccbed99d71cb8d9e81ed98.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--6FG5kvEL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png%3Fresize%3D1200%252C677%26ssl%3D1)

[log rocket](https://logrocket.com/signup/)æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œè®©ä½ é‡æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux åŠ¨ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€stacktracesã€å¸¦æœ‰å¤´+ä½“çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®ã€è‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

[å…è´¹è¯•ç”¨](https://logrocket.com/signup/)ã€‚

* * *

å¸–å­ã€React Storybook å¦‚ä½•ç®€åŒ–ç»„ä»¶æµ‹è¯•æœ€å…ˆå‡ºç°åœ¨ [LogRocket åšå®¢](https://blog.logrocket.com)ä¸Šã€‚