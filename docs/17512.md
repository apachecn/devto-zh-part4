# ä¸€å‹ºå†°ç³•â€”â€”ç¬¬ä¸€å°è±¡

> åŸæ–‡:[https://dev . to/baweaver/a-scoop-of-sorbet-first-impressions-f30](https://dev.to/baweaver/a-scoop-of-sorbet-first-impressions-f30)

[![](../Images/625c90c27de33696544f01bb0d9d5265.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Gw29taoK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/0m7g9g9qli3ktoqgg08t.jpeg)

Stripe åˆšåˆšå‘å¸ƒäº†ä¸€æ¬¾æ–°çš„ Ruby é™æ€ç±»å‹å®çŸ³ï¼Œåä¸º Sorbetï¼Œæ­¤å‰å®ƒåœ¨ç±»ä¼¼äº Ruby Kaigi T1 è¿™æ ·çš„ä¼šè®®ä¸Šè¢«å…¬å¼€å˜²ç¬‘äº†å¾ˆé•¿æ—¶é—´ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€çœ‹ï¼Œçœ‹çœ‹æˆ‘ä»¬æœ‰ä»€ä¹ˆå‘ç°ã€‚è¿™äº›å°†æ˜¯æˆ‘é˜…è¯»å›¾ä¹¦é¦†çš„ç¬¬ä¸€å°è±¡ï¼Œå®ƒå¯èƒ½ä¼šéšç€ä½¿ç”¨å’Œå®éªŒè€Œæ”¹å˜ã€‚ä½ çš„ç»å†å¯èƒ½ä¸ä¸€æ ·ï¼Œä½ ä¹Ÿåº”è¯¥å†™å‡ºæ¥ï¼

# [](#homepage)[é¦–é¡µ](https://sorbet.org/)

æ¡çº¹å°±æ˜¯æ¡çº¹ï¼Œä¸»é¡µæ¼‚äº®ï¼Œå¹²å‡€ï¼Œåˆ‡ä¸­è¦å®³ã€‚æˆ‘ç°åœ¨æœ‰ç‚¹æƒ³åšä¸€ä¸ªç´«è‰²çš„ç½‘ç«™ã€‚ä¸ç®¡æ€æ ·ï¼Œæ’‡å¼€è®¾è®¡ä¸è°ˆ...

æˆ‘ä»¬ä»ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­å¼€å§‹:

```
# typed: true
extend T::Sig

sig {params(name: String).returns(Integer)}
def main(name)
  puts "Hello, #{name}!"
  name.length
end

main("Sorbet") # ok!
main()   # error: Not enough arguments provided
man("")  # error: Method `man` does not exist 
```

## [](#a-taste-of-sorbet)å“å°å†°ç³•

è¿™é‡Œé¦–å…ˆæ³¨æ„åˆ°çš„æ˜¯`typed: true`çš„å¤´éƒ¨è¯„è®ºã€‚æˆ‘æƒ³çŸ¥é“è¿™æ˜¯ä¸æ˜¯ä¸€ä¸ªç¼–è¯‘å™¨æ ‡å¿—ï¼Œå¹¶ä¸”æ˜¯æ¯ä¸ªè¿è¡Œå®ƒçš„æ–‡ä»¶æ‰€å¿…éœ€çš„ã€‚æˆ‘æƒ³æ˜¯çš„ï¼Œæœ‰ç‚¹åƒ Ruby ä¸­å†»ç»“çš„å­—ç¬¦ä¸²ã€‚

æˆ‘ä»¬ä»`T::Sig`æ‰©å±•è€Œæ¥ï¼Œæˆ‘å‡è®¾å®ƒæ˜¯ç±»å‹ç­¾åæ–¹æ³•ã€‚

`sig`æœ¬èº«å°±å¸¦å—ã€‚ä¸å–œæ¬¢æ— é—´éš”çš„é£æ ¼ï¼Œå› ä¸ºè¿™æœ‰ç‚¹éš¾è¯»ã€‚æ·»åŠ å‡ ä¸ªç©ºæ ¼å¯ä»¥æ›´å®¹æ˜“åœ°è¿›è¡Œå¯è§†åŒ–è§£æ:

```
sig { params(name: String).returns(Integer) }
def main(name)
  puts "Hello, #{name}!"
  name.length
end 
```

ä½†è¿™æ›´å¤šçš„æ˜¯ä¸ªäººå–œå¥½ã€‚

### [](#issues)é—®é¢˜

æˆ‘å¸Œæœ›èƒ½å¤Ÿå¤åˆ¶å¹¶ç²˜è´´ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œå¹¶çœ‹åˆ°å®ƒæŒ‰é¢„æœŸè¿è¡Œã€‚è€ƒè™‘åˆ°æˆ‘ä»¬è¿˜æ²¡æœ‰åŒ…å«æ¥è‡ª`sorbet`çš„ä»»ä½•å†…å®¹ï¼Œå®ƒå°†æŒ‰åŸæ ·å¤±è´¥ã€‚å¦‚æœä½ æ„¿æ„çš„è¯ï¼Œäº”ç§’é’Ÿçš„è¡ŒåŠ¨ä¼šäº§ç”Ÿç›¸å½“å¤§çš„å½±å“ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯å¯èƒ½çš„ï¼Œä½†å¯èƒ½ä¼šå¦¨ç¢ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæ‰€ä»¥å¯ä»¥ç†è§£å®ƒä¸é‚£ä¹ˆç®€å•ã€‚

## [](#get-started-quickly)å¿«é€Ÿä¸Šæ‰‹

æˆ‘å°†åœ¨ä¸€ä¸ªæ²¡æœ‰å…¶ä»–ä»£ç çš„é¡¹ç›®ä¸­å°è¯•è¿™æ ·åšï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å¦‚æœå¤±è´¥äº†ï¼Œæˆ‘ä¼šåˆ‡æ¢åˆ°æˆ‘çš„ä¸€ä¸ªç©å…·å®çŸ³ï¼Œçœ‹çœ‹å®ƒå¦‚ä½•åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å·¥ä½œã€‚

æˆ‘ä»¬å°†ä»ä¸€ä¸ªåä¸º`strawberry_sorbet`çš„æ–°å‡†ç³»ç»Ÿé¡¹ç›®å¼€å§‹ï¼Œå®ƒæœ‰ä¸€ä¸ª`Gemfile`:

```
# Gemfile

source 'https://rubygems.org'

gem 'sorbet', group: :development
gem 'sorbet-runtime' 
```

ç„¶åå®‰è£…:

```
âœ  strawberry_sorbet git:(master) âœ— bundle
Using bundler 2.0.1
Using sorbet-static 0.4.4271 (universal-darwin-17)
Using sorbet 0.4.4271
Using sorbet-runtime 0.4.4271
Bundle complete! 2 Gemfile dependencies, 4 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed. 
```

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å†°ç³•æ­é…`srb init`:

```
âœ  strawberry_sorbet git:(master) âœ— srb init

ğŸ‘‹ Hey there!

This script will get this project ready to use with Sorbet by creating a
sorbet/ folder for your project. It will contain:

- a config file
- a bunch of 'RBI files'

RBI stands for 'Ruby Interface'; these files define classes, methods, and
constants that exist, but which Sorbet doesn't always know about.

âš ï¸  Heads up:

To set up your project, this script will take two potentially destructive
actions:

1\.  It will require every file in your project. Specifically, every script in
    your project will be run, unless that script checks if __FILE__ == $PROGRAM_NAME
    before running any code, or has the magic comment # typed: ignore in it.

2\.  It will add a comment to the top of every file (like # typed: false or
    # typed: true, depending on how many errors were found in that file.)

â” Would you like to continue? [Y/n] 
```

æˆ‘æœ‰ç‚¹æƒ³çŸ¥é“æ˜¯å¦æœ‰ä¸€ä¸ª`-y`æ ‡å¿—æ¥ç»•è¿‡é‚£äº›çŸ¥é“ä»–ä»¬æƒ³è¦å®ƒå¹¶ä¸”çŸ¥é“æ‰€è¿°é£é™©çš„é¡¹ç›®ã€‚

æ˜¯ä¸€ç§å€’é€€ï¼Œæœ‰ä¸€é˜µå­æ²¡è§è¿‡äº†ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å®ƒè·‘å§ï¼

```
â” Would you like to continue? [Y/n] Y

Generating: sorbet/config
Generating: sorbet/rbi/sorbet-typed/
Generating: sorbet/rbi/gems/
Generating: sorbet/rbi/hidden-definitions/
// snipped
Generating split RBIs into sorbet/rbi/hidden-definitions/
Generating: sorbet/rbi/todo.rbi

âœ… Done!

This project is now set up for use with Sorbet. The sorbet/ folder should exist
and look something like this: sorbet/
    â”œâ”€â”€  config                      # Default options to passed to sorbet on every run
    â””â”€â”€  rbi/
        â”œâ”€â”€  sorbet-typed/           # Community writen type definition files for your gems
        â”œâ”€â”€  gems/                   # Autogenerated type definitions for your gems (from reflection)
        â”œâ”€â”€  hidden-definitions/     # All definitions that exist at runtime, but Sorbet couldn't see statically
        â””â”€â”€  todo.rbi                # Constants which were still missing, even after the three steps above. Please check this whole folder into version control.

â¡ï¸   What's next?

Up to you! First things first, you'll probably want to typecheck your project: srb tc Other than that, it's up to you!
We recommend skimming these docs to get a feel for how to use Sorbet:
 - Gradual Type Checking (https://sorbet.org/docs/gradual)
- Enabling Static Checks (https://sorbet.org/docs/static)
- RBI Files (https://sorbet.org/docs/rbi)

If instead you want to explore your files locally, here are some things to try:
 - Upgrade a file marked # typed: false to # typed: true.
  Then, run srb tc and try to fix any errors.
- Add signatures to your methods with `sig`.
  For how, read: https://sorbet.org/docs/sigs
- Check whether things that show up in the TODO RBI file actually exist in your project.
  It's possible some of these constants are typos.
- Upgrade a file marked # typed: ignore to # typed: false.
  Then, run srb tc and try to fix any errors.

ğŸ™Œ  Please don't hesitate to give us your feedback! 
```

è¿™æ˜¯å¤§é‡çš„æ–‡æœ¬ï¼Œè®©æˆ‘ä»¬æ¥ç ”ç©¶ä¸€ä¸‹ã€‚æˆ‘ä»¬å°†æš‚æ—¶å¿½ç•¥è®¸å¤šç”Ÿæˆçš„æ–‡ä»¶ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ç¯‡å®Œæ•´æ–‡ç« çš„ä¸»é¢˜ã€‚

### [](#folder-layout)æ–‡ä»¶å¤¹å¸ƒå±€

```
This project is now set up for use with Sorbet. The sorbet/ folder should exist
and look something like this: sorbet/
    â”œâ”€â”€  config                      # Default options to passed to sorbet on every run
    â””â”€â”€  rbi/
        â”œâ”€â”€  sorbet-typed/           # Community writen type definition files for your gems
        â”œâ”€â”€  gems/                   # Autogenerated type definitions for your gems (from reflection)
        â”œâ”€â”€  hidden-definitions/     # All definitions that exist at runtime, but Sorbet couldn't see statically
        â””â”€â”€  todo.rbi                # Constants which were still missing, even after the three steps above. 
```

çœ‹ç€è¿™æ£µæ ‘ï¼Œå¾ˆé«˜å…´èƒ½ç›´è§‚åœ°è¡¨ç°å‡ºæ¥ã€‚è¿™é‡Œæœ‰ä¸€ä¸ª[å°é”™åˆ«å­—(`writen -> written` )](https://github.com/sorbet/sorbet/pull/967) ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªç¡¬ä¿®å¤ã€‚

ç¤¾åŒºç¼–å†™çš„å®šä¹‰å’Œè‡ªåŠ¨ç”Ÿæˆçš„ gem ç±»å‹å®šä¹‰å¾ˆæœ‰è¶£ï¼Œç¨åæˆ‘è¿˜å°†å¯¹æ­¤è¿›è¡Œç ”ç©¶ã€‚

### [](#version-control)ç‰ˆæœ¬æ§åˆ¶

```
Please check this whole folder into version control. 
```

æ³¨æ„ï¼Œè¿™åº”è¯¥è¢«æ£€æŸ¥åˆ°ç‰ˆæœ¬æ§åˆ¶ä¸­ã€‚è€ƒè™‘åˆ°è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡å¼çš„ç³»ç»Ÿï¼Œç¡®ä¿ä¸ä¸¢å¤±è¾“å…¥ä¿¡æ¯æ˜¯ä¸ªå¥½ä¸»æ„ã€‚ä¸çŸ¥é“ä½ æœ‰å¤šæƒ³æ‰‹åŠ¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„ä¸œè¥¿ï¼Œä½†æˆ‘ä¼šå‡è®¾è‡³å°‘æœ‰ä¸€äº›ã€‚

### [](#next-steps)ä¸‹ä¸€æ­¥

æ¥ä¸‹æ¥è¿˜æœ‰ä¸€äº›åç»­æ­¥éª¤:

```
â¡ï¸   What's next?

Up to you! First things first, you'll probably want to typecheck your project: srb tc 
```

#### [](#the-homepage-example)é¦–é¡µç¤ºä¾‹

å› æ­¤ï¼Œæˆ‘å­˜å‚¨äº†ç¤ºä¾‹é—®é¢˜ï¼Œå¹¶æ³¨é‡Šæ‰äº†å¤±è´¥çš„è¡Œï¼Œä»¥å¤‡åç”¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆ:

```
# 01_homepage.rb

# typed: strong

require 'sorbet'

extend T::Sig

sig {params(name: String).returns(Integer)}
def main(name)
  puts "Hello, #{name}!"
  name.length
end

main("Sorbet") # ok!
# main()   # error: Not enough arguments provided
# man("")  # error: Method `man` does not exist 
```

åœ¨å·¥ä½œæ–‡ä»¶ä¸Šè¿è¡Œ`srb tc`ä¼šäº§ç”Ÿ:

```
âœ  strawberry_sorbet git:(master) âœ— srb tc
No errors! Great job. 
```

#### [](#inducing-errors)è¯±å‘é”™è¯¯

è®©æˆ‘ä»¬å–æ¶ˆç¬¬ä¸€ä¸ªé”™è¯¯è¡Œæ³¨é‡Š:

```
main()   # error: Not enough arguments provided 
```

...å†æ¬¡è¿è¡Œå®ƒä¼šç»™æˆ‘ä»¬:

```
âœ  strawberry_sorbet git:(master) âœ— srb tc
01_homepage.rb:14: Not enough arguments provided for method Object#main. Expected: 1, got: 0 https://srb.help/7004
    14 |main()   # error: Not enough arguments provided
        ^^^^^^
    01_homepage.rb:8: Object#main defined here
     8 |def main(name)
        ^^^^^^^^^^^^^^
Errors: 1 
```

å“¦ï¼Œé‚£å¤ªå¥½äº†ã€‚å®ƒä¸ä»…è·Ÿè¸ªå‡ºäº†ä¸»é¡µä¸Šæåˆ°çš„é”™è¯¯ï¼Œè€Œä¸”è¿˜ç»™å‡ºäº†è¢«è°ƒç”¨æ–¹æ³•çš„å‘¨å›´ç¯å¢ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ½œåœ¨åœ°çœ‹åˆ°å“ªé‡Œå‡ºé”™äº†ã€‚

æˆ‘æƒ³çŸ¥é“å¦‚æœæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ— æ•ˆç±»å‹ç»™å®ƒä¼šå‘ç”Ÿä»€ä¹ˆ:

```
main(42) 
```

æˆ‘ä»¬ä¼šå¾—åˆ°:

```
01_homepage.rb:14: Integer(42) does not match String for argument name https://srb.help/7002
    14 |main(42)
        ^^^^^^^^
    01_homepage.rb:7: Method Object#main has specified name as String
     7 |sig {params(name: String).returns(Integer)}
                    ^^^^
  Got Integer(42) originating from: 01_homepage.rb:14:
    14 |main(42)
             ^^
Errors: 1 
```

å› æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†å€¼ã€ç±»å‹ã€æ–¹æ³•ç±»å‹ç­¾åï¼Œä»¥åŠå…¶ä»–ä¸€äº›å…³äºè·Ÿè¸ªåˆ°åº•å‡ºäº†ä»€ä¹ˆé—®é¢˜çš„ç»†èŠ‚ã€‚ä»–ä»¬åœ¨æ­ç¤ºä¸Šä¸‹æ–‡æ–¹é¢åšå¾—éå¸¸å¥½ï¼Œä½¿å¾—è¿™ä¸ªç‰¹æ®Šçš„é”™è¯¯å¾ˆå®¹æ˜“è¢«è¿½è¸ªå’Œéš”ç¦»ã€‚

æˆ‘ä»¬å°†ä¸å¾—ä¸åœ¨ä»¥åå¯¹æ­¤è¿›è¡Œæ›´æ·±å…¥çš„ç ”ç©¶ã€‚

### [](#designed-to-be-interactive)è®¾è®¡æˆäº¤äº’å¼çš„

å‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘æœ‰å¹¸ä¸ Matz èŠèµ·äº†ä»–å¯¹ Ruby 3 çš„ä¸€äº›æ¢¦æƒ³ï¼Œåœ¨ä»–çš„åˆ—è¡¨ä¸­æ’åœ¨å‰åˆ—çš„æ˜¯ä¸€ä¸ªè¯­è¨€æœåŠ¡å™¨çš„æƒ³æ³•ï¼Œå®ƒå¯ä»¥ä¸ç¼–è¾‘å™¨äº¤äº’ï¼Œå¹¶å…è®¸æ›´å¹²å‡€çš„é‡æ„å’Œç¼–ç ã€‚

çœ‹åˆ°å®ƒå˜æˆç°å®å®Œå…¨æ˜¯å¦ä¸€å›äº‹ã€‚

å¦‚æœè¿™é‡Œæœ‰ä¸€ä¸ªå¦‚ä½•è®¾ç½®ä¸Šè¿°ç¼–è¾‘å™¨çš„é“¾æ¥å°±å¥½äº†ï¼Œå› ä¸ºæˆ‘ä¼šå¾ˆå¿«ç‚¹å‡»å®ƒï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

## [](#first-impression-opinions)ç¬¬ä¸€å°è±¡æ„è§ï¼Ÿ

è¿™è®©æˆ‘æƒ³èµ·äº†å¾ˆå¤š Rust å’Œå…¶ä»–ä¸€äº›è¯­è¨€ï¼Œæ„Ÿè§‰å°±åƒé™æ€è¾“å…¥æ­£ç¡®åœ°ç»™äº†ä½ ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ˜æ˜¾çš„è¿‚è…ã€‚

æˆ‘çš„è§‚ç‚¹å¯èƒ½ä¼šæ”¹å˜ï¼Œå› ä¸ºæˆ‘ä¼šç»§ç»­ç©ä¸‹å»ã€‚æˆ‘æ‰“ç®—ç€æ‰‹çš„ç¬¬ä¸€ä¸ªé¡¹ç›®æ˜¯:

1.  å¦‚ä½•ä½¿ç”¨å®ƒ
2.  å·¥ä¼šæˆ–äº§å“ç±»å‹å¦‚ä½•å·¥ä½œ
3.  å¦‚æœç³»ç»Ÿèƒ½å¤Ÿå¤„ç†ç±»ä¼¼`is_a?(Enumerable)`çš„æ¥å£
4.  è¯­è¨€æœåŠ¡å™¨å¦‚ä½•å·¥ä½œ
5.  å¦‚ä½•ä¸ Whitequark çš„è§£æå™¨ç»“åˆä½¿ç”¨
6.  å¦‚æœè¿™å¯ä»¥ä¸ Rubocop ä¸€èµ·ç”¨äºé‡æ„/ codemods
7.  å¦‚æœè¿™å¯ä»¥æ½œåœ¨åœ°ç”¨äºèŒƒç•´ç†è®ºè§„èŒƒï¼Œæ¯”å¦‚ Ruby ä¸­çš„å¹»æƒ³ä¸–ç•Œ

æˆ‘å¸Œæœ›ä¼šæœ‰æ›´å¤šçš„ï¼Œå› ä¸ºæˆ‘æœ‰æ›´å¤šçš„æœºä¼šç©è¿™ä¸ªï¼Œä½†è¿™æ˜¯ç¬¬ä¸€æ¬¡é€šè¯»ã€‚

ä½ å¥½å¥‡åœ¨å†°ç³•ä¸­å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ