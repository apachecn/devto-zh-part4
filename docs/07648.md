# é€šè¿‡ Transloco ä½¿ç”¨ MessageFormat

> åŸæ–‡ï¼š<https://dev.to/coly010/using-messageformat-with-transloco-30em>

# ğŸ¸é€šè¿‡ Transloco ä½¿ç”¨ MessageFormat

æœ€è¿‘(2019-08-16)å‘å¸ƒäº†ä¸€ä¸ªè§’åº¦å›½é™…åŒ–åº“ Transloco ï¼Œå£å·æ˜¯â€œè§’åº¦å›½é™…åŒ–åšå¯¹äº†â€ã€‚åœ¨ä½¿ç”¨è¯¥åº“ä¹‹åï¼Œå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å®ƒæå¤§åœ°ç®€åŒ–äº† Angular åº”ç”¨ç¨‹åºä¸­çš„ i18nï¼Œæä¾›äº†åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å®ƒçš„å¤šç§æ–¹æ³•:

*   ç»“æ„æŒ‡ä»¤
*   å±æ€§æŒ‡ä»¤
*   ç®¡

ä¸Šè¿°æ–¹æ³•ä¸­æ€§èƒ½æœ€å¥½çš„æ˜¯ç»“æ„æŒ‡ä»¤æ–¹æ³•ï¼Œå› ä¸ºå®ƒåªä¸ºä½ çš„æ¨¡æ¿æ‰“å¼€ä¸€ä¸ªè®¢é˜…ã€‚ä½ å¯ä»¥åœ¨ä»–ä»¬çš„[æ–‡æ¡£](https://github.com/ngneat/transloco/blob/master/README.md)ä¸­æ‰¾åˆ°æ›´å¤šå…³äºåˆå¹¶ Transloco çš„ä¿¡æ¯ã€‚

ç„¶è€Œï¼Œå¾ˆå¿«å°±å‘ç°è¿™ä¸ªåº“ä¸æ”¯æŒå¼€ç®±å³ç”¨çš„æ¶ˆæ¯æ ¼å¼ã€‚è¿™å¯¹æˆ‘ä»¬æ¥è¯´å¯èƒ½æ˜¯ä¸€ä¸ªçœŸæ­£çš„äº¤æ˜“ç ´åè€…ï¼Œå¯¹å…¶ä»–ä½¿ç”¨`messageformat`æ¥å¤„ç†åº”ç”¨ç¨‹åºä¸­å¤šå…ƒåŒ–å’Œæ€§åˆ«çš„å…¬å¸æ¥è¯´ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦‚æœè¿™äº›çŸ­è¯­å¯¹æ‚¨æ¥è¯´æ˜¯æ–°çš„ï¼Œæ‚¨æ˜¯å¦é‡åˆ°è¿‡ä»¥ä¸‹æƒ…å†µ:

```
return mins + mins === 1 ? ' minute' : ' minutes' + ' ago';

let pronoun = 'They';
if (user.gender === 'male') {
    pronoun = 'He';
} else if (user.gender === 'female') {
    pronoun = 'She';
}

return `${pronoun} went to the shop.`; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¯æ¬¡æˆ‘ä»¬éœ€è¦å¤„ç†å¤æ•°å’Œæ€§åˆ«æ—¶éƒ½è¿™æ ·åšå¯èƒ½ä¼šå¾ˆä¹å‘³ï¼Œä»¥è‡³äºæˆ‘ä»¬å¯èƒ½ä¼šå°†å®ƒä»¬æ”¾å…¥å®ƒä»¬è‡ªå·±çš„æ–¹æ³•æˆ–æœåŠ¡ä¸­ä»¥é‡ç”¨å®ƒä»¬ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥å°†è¿™ç§é€»è¾‘ä»æˆ‘ä»¬çš„ä»£ç åº“ä¸­å®Œå…¨åˆ é™¤å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬éœ€è¦æ”¯æŒå¤šç§è¯­è¨€ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ é¢å¤–çš„é€»è¾‘æ¥è¿”å›æ´»åŠ¨è¯­è¨€çš„æ­£ç¡®ä»£è¯å—ï¼Ÿ

ä¸ã€‚ç›¸åï¼Œæˆ‘ä»¬åº”è¯¥è®©æˆ‘ä»¬çš„ç¿»è¯‘æ–‡ä»¶ä¸ºæˆ‘ä»¬å¤„ç†è¿™äº›ï¼æˆ‘æœ€è¿‘ç»™ [Transloco](https://github.com/ngneat/transloco) åº“åšäº†ä¸€ä¸ª [PR](https://github.com/ngneat/transloco/pull/15) æ¥å¢åŠ å¯¹`messageformat`çš„æ”¯æŒã€‚ç›®å‰ï¼Œå®ƒå°†æ˜¯ Transloco > = 1.1.1 çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æœ‰è®¡åˆ’å°†è¿™ä¸€åŠŸèƒ½è½¬ç§»åˆ°ä¸€ä¸ªæ’ä»¶ä¸­ï¼Œå› ä¸ºå¹¶éæ‰€æœ‰ç”¨æˆ·éƒ½éœ€è¦å®ƒã€‚

ä¸‹é¢æˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•è®¾ç½®å’Œä½¿ç”¨ Transloco çš„`messageformat`ã€‚

## ğŸ”§å…ˆå†³æ¡ä»¶

ç¡®ä¿æ‚¨åœ¨å…¨çƒèŒƒå›´å†…å®‰è£…äº† Angular CLIã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤:

`npm install -g @angular/cli`

å¦‚æœæ‚¨å½“å‰æ²¡æœ‰æ­£åœ¨å¼€å‘çš„åº”ç”¨ç¨‹åºï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åº:

`ng new <application-name>`

## ğŸ”¨è®¾ç½®

å¦‚æœæ‚¨è¿˜æ²¡æœ‰å®‰è£… Translocoï¼Œé¦–å…ˆï¼Œä½¿ç”¨`ng add @ngneat/transloco`å‘½ä»¤æ·»åŠ å®ƒã€‚è¿™å°†å®‰è£…æ‰€éœ€çš„åŒ…ï¼Œå¹¶ä¸º`Transloco`çš„è¿è¡Œæ­å»ºæ‰€éœ€çš„æ–‡ä»¶ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ›´å¤šå…³äºå®‰è£… Transloco çš„ä¿¡æ¯ã€‚

è¦ä½¿ç”¨`messageformat`ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ Transloco ä½¿ç”¨`MessageFormatTranspiler`è€Œä¸æ˜¯`DefaultTranspiler`ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€ä½ çš„`app.module.ts`å’Œä¸‹é¢çš„:

```
import { TRANSLOCO_TRANSPILER, MessageFormatTranspiler } from '@ngneat/transloco'; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`@NgModule`çš„
çš„æä¾›è€…æ•°ç»„ä¸­

```
@NgModule({
    providers: [
        ...,
        { provide: TRANSLOCO_PROVIDER, useClass: MessageFormatTranspiler }
    ]
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†å…è®¸ Transloco æ­£ç¡®è§£é‡Šç¿»è¯‘æ–‡ä»¶ä¸­çš„`messageformat`æ ¼å¼å­—ç¬¦ä¸²ã€‚

## ğŸš€ä½¿ç”¨

è®¾ç½®å®Œæˆåï¼Œä½¿ç”¨ messageformat éå¸¸ç®€å•ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨ç¿»è¯‘æ–‡ä»¶ä¸­æ‰§è¡Œä»¥ä¸‹æ“ä½œ:

`en.json`

```
{
  "noParams": "Hello - english",
  "params": "The following {{ value }} was replaced by Transloco - english",
  "plural": "{count, plural, =0 {no results} one {one result} other {# results}} - english",
  "gender": "{gender, select, male {he} female {she} other {they}} went to the shop - english"
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`es.json`

```
{
  "noParams": "Hello - spanish",
  "params": "The following {{ value }} was replaced by Transloco - spanish",
  "plural": "{count, plural, =0 {no results} one {one result} other {# results}} - spanish",
  "gender": "{gender, select, male {he} female {she} other {they}} went to the shop - spanish"
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨æ‚¨çš„æ¨¡æ¿ä¸­:

ç»“æ„æŒ‡å¯¼æ–¹æ³•

```
<ng-container *transloco="let t">
    <ul>
        <li>{{ t.noParams }}</li>
        <li>{{ t.params | translocoParams: {value: "word" } }}</li>
        <li>{{ t.plural | translocoParams: {count: 2} }}</li>
        <li>{{ t.plural | translocoParams: {count: 1} }}</li>
        <li>{{ t.gender | translocoParams: {gender: "male"} }}</li>
        <li>{{ t.gender | translocoParams: {gender: ""} }}</li>
    </ul>
</ng-container> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å±æ€§æŒ‡ä»¤æ–¹æ³•

```
<ul>
    <li><span transloco="noParams"></span> }}</li>
    <li><span transloco="params" [translocoParams]="{value: 'word'}"></span></li>
    <li><span transloco="plural" [translocoParams]="{count: 2}"></span></li>
    <li><span transloco="plural" [translocoParams]="{count: 1}"></span></li>
    <li><span transloco="gender" [translocoParams]="{gender: 'male'}"></span></li>
    <li><span transloco="gender" [translocoParams]="{gender: ''}"></span></li>
</ul> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç®¡é“è¿›åœº

```
<ul>
    <li>{{ 'noParams' | transloco }}</li>
    <li>{{ 'params' | transloco: {value: "word" } }}</li>
    <li>{{ 'plural' | transloco: {count: 2} }}</li>
    <li>{{ 'plural' | transloco: {count: 1} }}</li>
    <li>{{ 'gender' | transloco: {gender: "male"} }}</li>
    <li>{{ 'gender' | transloco: {gender: ""} }}</li>
</ul> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## ğŸ‰ç»“æœ

ç°åœ¨ï¼Œæ— è®ºæ‚¨é€‰æ‹©å“ªç§æ–¹æ³•ï¼Œå½“æ‚¨è¿è¡Œåº”ç”¨ç¨‹åºæ—¶ï¼Œè¾“å‡ºå°†æ˜¯:

å½“è¯­è¨€ä¸º`en` :

```
Hello - english
The following word was replaced by Transloco - english
2 results - english
1 result - english
He went to the shop - english
They went to the shop - english 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“è¯­è¨€ä¸º`es` :

```
Hello - spanish
The following word was replaced by Transloco - spanish
2 results - spanish
1 result - spanish
He went to the shop - spanish
They went to the shop - spanish 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## ğŸ»ç»“è®º

ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨ MessageFormatTranspiler å’Œ Transloco å¯ä»¥å¤§å¤§å‡å°‘ä»£ç åº“ä¸­ä¸å¤æ•°å’Œæ€§åˆ«ç›¸å…³çš„è¯­æ³•çš„é€»è¾‘æ•°é‡ã€‚è¿™ä½¿å¾— i18n æ›´å®¹æ˜“å®ç°ï¼Œå› ä¸ºæ‚¨å¯ä»¥ç®€å•åœ°å°†æ‚¨çš„`en.json`æ–‡ä»¶äº¤ç»™æ‚¨çš„ç¿»è¯‘å›¢é˜Ÿï¼Œä»–ä»¬å¯ä»¥ä¸ºæ‰€æœ‰æ ‡è¯†ç¬¦æä¾›ç¿»è¯‘ã€‚å¯ä»¥æ·»åŠ ã€åˆ é™¤å’Œç»´æŠ¤è¿™äº›ç¿»è¯‘ï¼Œè€Œä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ï¼

å¦‚æœä½ è¿˜æ²¡æœ‰çœ‹è¿‡ trans loco,ä½ ä¸€å®šè¦çœ‹çœ‹ã€‚è¿™å¾ˆç®€å•ï¼

æ„Ÿè°¢é˜…è¯»ï¼