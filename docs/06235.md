# ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ React é’©å­(ç¬¬ä¸€éƒ¨åˆ†:å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸ)

> åŸæ–‡ï¼š<https://dev.to/dinhhuyams/why-react-hooks-part-i-1jo>

**å…ˆå†³æ¡ä»¶:**å…³äº[çš„åŸºæœ¬çŸ¥è¯†ååº”](https://reactjs.org/)

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸ºä»€ä¹ˆæˆ‘ä»¬éƒ½åº”è¯¥å¼€å§‹å­¦ä¹ å’Œä½¿ç”¨é±¼é’©ï¼Œå°½ç®¡é’“é±¼ä¸æ˜¯æˆ‘ä»¬çš„çˆ±å¥½ğŸŸ ğŸ£ã€‚

> å˜¿ Siriï¼ŒæŠŠè®¡æ—¶å™¨è®¾ç½®ä¸º 5 åˆ†é’ŸğŸ˜‹

å¦‚æœä½ ä»¥å‰ä»æœªå°è¯•è¿‡é’©å­æˆ–è€…å¬è¯´è¿‡å®ƒï¼Œå’Œæˆ‘å‘†åœ¨ä¸€èµ· **5 åˆ†é’Ÿ**ï¼Œä½ ä¼šç«‹åˆ»æ„è¯†åˆ°é’©å­çš„ç¬¬ä¸€ä¸ªé‡è¦å¥½å¤„ğŸ¥‡ã€‚

æˆ‘å·²ç»å¼€å§‹ä½¿ç”¨ React hooks å¤§çº¦ä¸€ä¸ªæœˆäº†ï¼Œå®ƒæ˜¯ä¸€ä¸ªçœŸæ­£çš„æ¸¸æˆæ”¹å˜è€…ã€‚é’©å­çš„ä¸€ä¸ªæ˜æ˜¾çš„å¥½å¤„æ˜¯å®ƒå¸®åŠ©æˆ‘ä»¬å»é™¤å¤šä½™çš„å¤æ‚çš„ååº”ç”Ÿå‘½å‘¨æœŸã€‚

> ä½ æ²¡çœ‹è§ç¦æ­¢é’“é±¼çš„æ ‡å¿—å—ï¼Œå­©å­ï¼Ÿ
> 
> æˆ‘:æˆ‘ä¸æ˜¯åœ¨é’“é±¼ï¼Œå…ˆç”Ÿã€‚....

ğŸ˜è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„

æˆ‘ä»¬ä»Šå¤©çš„ä»»åŠ¡åªæ˜¯ä¸ºç”¨æˆ·è®¢é˜…ä¸€ä¸ªæ— çº¿ç”µé¢‘é“ğŸ“»ã€‚

## 1ã€‚ç±»åˆ«ç»„ä»¶

å¯¹äºè¿™ä¸ªç®€å•çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨**ç»„ä»¶å®‰è£…**ç”Ÿå‘½å‘¨æœŸ

```
class Radio extends React.Component {
    state = {channelId: 1}

    componentDidMount() {
        subscribeToRadio(this.state.channelId)
    }

    ...
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€ä¸ªé¢‘é“æœ‰ç‚¹æ— èŠğŸ™ƒ

è®©æˆ‘ä»¬å…è®¸ç”¨æˆ·é€šè¿‡ç‚¹å‡»æŒ‰é’®è·³è½¬åˆ°ä»–ä»¬å–œæ¬¢çš„é¢‘é“ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è®¢é˜…æ–°é¢‘é“ä¹‹å‰å–æ¶ˆè®¢é˜…ä»¥å‰çš„é¢‘é“ï¼Œ **componentDidUpdate** åº”è¯¥æ˜¯åšè¿™ä»¶äº‹çš„åˆé€‚åœ°ç‚¹

```
class Radio extends React.Component {

    ...

    componentDidUpdate(prevProps, prevState) {
        if (prevState.channelId !== this.state.channelId) {

            unsubscribeRadio(prevState.channelId)

            subscribeToRadio(this.state.channelId)
        }
    }

    changeChannel = () => {
        const id = randomId()
        this.state({channelId: id})
    }

    render() {

        return (
                <div>
                    <p>Current channel: ${channelId}</p>
                    <button onClick={this.changeChannel}>Change channel</button>
                </div>
            )
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œå½“ç”¨æˆ·åœæ­¢æ”¶å¬æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å–æ¶ˆè®¢é˜…è¯¥é¢‘é“ã€‚æˆ‘ä»¬å°†åœ¨**ç»„ä»¶å¸è½½**
ä¸­è¿™æ ·åš

```
class Radio extends React.Component {

    ...

    componentWillUnmount() {
        unsubscribeRadio(this.state.channelId)
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› æ­¤ï¼Œå¯¹äºè¿™ä¸ªç®€å•çš„æ— çº¿ç”µè®¢é˜…ä»»åŠ¡ï¼Œæˆ‘ä»¬ä»ç„¶æ€»å…±éœ€è¦ **3 ä¸ªç”Ÿå‘½å‘¨æœŸ**:

*   ç»„ä»¶å®‰è£…
*   componentDidUpdate
*   ç»„ä»¶å°†æ›´æ–°

å¦‚æœä½ æ·»åŠ è¶Šæ¥è¶Šå¤šçš„åŠŸèƒ½ï¼Œæˆ‘å‡è®¾å®ƒä¼šæœ‰ä¸€äº›å‰¯ä½œç”¨ï¼Œå¯¹ä½ çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™äº›åŠŸèƒ½ä¼šæŒ‰ç…§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è€Œä¸æ˜¯å‰¯ä½œç”¨æ¥åˆ†ç»„ã€‚ä½ å°†æœ€ç»ˆåœ¨è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­å †ç§¯æ‰€æœ‰çš„é€»è¾‘ã€‚

ğŸ¤¨ ğŸ§ ğŸ˜•

æƒ³è±¡ä½ æœ‰ä¸€åªè™«å­ğŸ›ï¼Œéœ€è¦ç»è¿‡ **3 ä¸ªä¸åŒçš„åœ°æ–¹**æ‰èƒ½æ‰¾åˆ°å¹¶ä¿®å¤ã€‚ä½ å¿…é¡»ç©[ä¸‰è™«è’™ç‰¹](https://en.wikipedia.org/wiki/Three-card_Monte)æ¸¸æˆæ‰èƒ½
æ‰¾åˆ°é‚£ä¸ªè™«å­ï¼Œæˆ‘æ‰“èµŒä½ ä»¬éƒ½çŸ¥é“èµ¢å¾—é‚£ç§æ¸¸æˆæœ‰å¤šéš¾ğŸ¤¦â€

[![bugs](img/ff9cc615216e042fd8cde42c27a1249a.png "Bugs")](https://res.cloudinary.com/practicaldev/image/fetch/s--5Y_Nr2ge--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://user-images.githubusercontent.com/26871154/63650946-ec7a5380-c758-11e9-854b-41f8ac27526a.jpg)

## 2ã€‚å¸¦æŒ‚é’©çš„åŠŸèƒ½ç»„ä»¶

ğŸ”¥é’©å­æ¥æ•‘æ´äº†

> é’©å­æ˜¯ React 16.8 ä¸­çš„æ–°å¢åŠŸèƒ½ã€‚å®ƒä»¬å…è®¸æ‚¨ä½¿ç”¨çŠ¶æ€å’Œå…¶ä»– React ç‰¹æ€§ï¼Œè€Œæ— éœ€ç¼–å†™ç±»ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ Hook å¦‚ä½•å®ç°åŒæ ·çš„ç»“æœã€‚è¦ä½¿ç”¨é’©å­ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸Šé¢çš„ç±»ç»„ä»¶è½¬æ¢æˆåŠŸèƒ½ç»„ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªè¶…çº§ç®€å•çš„ç»„ä»¶:

```
const Radio = () => {
    const [channelId, setChannelId] = React.useState(1)

    React.useEffect(() => {
        subscribeToRadio(channelId)

        return () => unsubscribeRadio(channelId) 
    }, [channelId])

    const changeChannel = () => {
           const id = randomId()
           setChannelId(id)
    }

    return (
        <div>
            <p>Current channel: ${channelId}</p>
            <button onClick={changeChannel}>Change channel</button>
        </div>
    )

} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> ğŸ˜²å“‡ï¼Œå¤ªç¥å¥‡äº†ã€‚ä½ æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ

**React.useState** å’Œ **React.useEffect** æ˜¯ React æŒ‚é’©ï¼Œå¯ä»¥å¸®åŠ©ä½ å®ç°ä¸ç”Ÿå‘½å‘¨æœŸç›¸åŒçš„ç»“æœã€‚å³ä½¿æ‚¨å¯èƒ½ä¸å®Œå…¨æ¸…æ¥šä¸Šé¢çš„æŒ‚é’©ï¼Œæˆ‘æ‰“èµŒå‡½æ•°åå¯èƒ½ä¼šç»™ä½ ä¸€äº›æç¤ºï¼Œæ‚¨ä»ç„¶å¯ä»¥ç«‹å³æ„Ÿè§‰åˆ°æŒ‚é’©ä½¿ä»£ç æ›´åŠ å¹²å‡€å’Œç®€å•ã€‚

ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„é€»è¾‘éƒ½é›†ä¸­åœ¨ **1 å‹¾**è€Œä¸æ˜¯åƒä»¥å‰ä¸€æ ·çš„ **3 å¤„**ã€‚æ›´å®¹æ˜“è°ƒè¯•ã€‚å¦‚æœä½ æƒ³åˆ é™¤è¿™ä¸ªç‰¹æ€§ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯åˆ é™¤ç›¸å…³çš„æ•ˆæœã€‚

ğŸ’ªè®©æˆ‘ä»¬ä¸€èµ·æ¥æ‰“ç ´å®ƒã€‚

### Â·ä½¿ç”¨çŠ¶æ€

> **useState** æ˜¯ä¸€ä¸ªé’©å­ï¼Œå¸®åŠ©æˆ‘ä»¬ç®¡ç†å‡½æ•°ç»„ä»¶ä¸­çš„å±€éƒ¨çŠ¶æ€ã€‚

```
const Radio = () => {
    const [channelId, setChannelId] = React.useState(1)

    const changeChannel = () => {
        const id = randomId()
        setChannelId(id)
    }

    ...
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**ä½¿ç”¨çŠ¶æ€**é’©å­æ¥å—**åˆå§‹çŠ¶æ€**ä½œä¸ºå®ƒçš„å‚æ•°ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ`1`æ˜¯ **channelId** çš„åˆå§‹å€¼ã€‚

è¿™ä¸ªé’©å­è¿”å›ä¸€ä¸ªåŒ…å« 2 ä¸ªå˜é‡çš„æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå˜é‡æ˜¯å½“å‰çŠ¶æ€çš„**ï¼Œç¬¬äºŒä¸ªå˜é‡æ˜¯å…è®¸æˆ‘ä»¬æ›´æ–°çŠ¶æ€**çš„å‡½æ•°**ã€‚æˆ‘ä»¬ä½¿ç”¨æ•°ç»„ææ„`[channelId, setChannelId]`,ä½ å¯ä»¥éšæ„å‘½åå®ƒä»¬**

### Â·ä½¿ç”¨æ•ˆæœ

**React.useEffect** è®©æˆ‘ä»¬åœ¨å‡½æ•°ç»„ä»¶
ä¸­æ‰§è¡Œå‰¯ä½œç”¨

```
const Radio = () => {

    const [channelId, setChannelId] = React.useState(1)

    React.useEffect(() => {
        subscribeToRadio(channelId)
    }) 

    ...   
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰§è¡Œæ— çº¿ç”µé¢‘é“è®¢é˜…ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æ•ˆæœå°†åœ¨æ¯ä¸ªç»„ä»¶æ¸²æŸ“å’Œæ›´æ–°åè¿è¡Œã€‚

ç„¶è€Œï¼Œè¿™å®é™…ä¸Šå¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“(**componentidmount**)ååªæ‰§è¡Œä¸€æ¬¡è¿™ä¸ªæ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸º useEffect Hook çš„ç¬¬äºŒä¸ªå¯é€‰å‚æ•°ã€‚ä¸€ä¸ªç©ºæ•°ç»„æ„å‘³ç€è¿™ä¸ªæ•ˆæœä¸ä¾èµ–äºä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥å®ƒåªä¼šåœ¨æŒ‚è½½æ—¶è¿è¡Œ(å¦‚æœä½ è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°å°±å¸è½½)

```
const Radio = () => {

    const [channelId, setChannelId] = React.useState(1)

    React.useEffect(() => {
        subscribeToRadio(channelId)
    }, []) 

    ...   
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨æ¯æ¬¡ **channelId** çŠ¶æ€æ”¹å˜åæ‰§è¡Œæ•ˆæœ(å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶)ã€‚æˆ‘ä»¬å°†é€šè¿‡å°† **channelId** ä¼ é€’ç»™æ•°ç»„æ¥å‘Šè¯‰æ•ˆæœè¿™æ ·åšã€‚è®°ä½ä½ æ”¾åœ¨æ•°ç»„é‡Œçš„æ˜¯æ•ˆæœæ‰€ä¾èµ–çš„ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œä½ å¯ä»¥æŠŠå¤šä¸ªå˜é‡æ”¾å…¥è¿™ä¸ªæ•°ç»„ï¼ï¼

```
const Radio = () => {

    const [channelId, setChannelId] = React.useState(1)

    React.useEffect(() => {
        subscribeToRadio(channelId)
    }, [channelId]) 

    ...   
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥æ•ˆæœå°†é€šè¿‡æ¯”è¾ƒ**å½“å‰ channelId** å€¼å’Œ**å…ˆå‰ channelId** å€¼**(ä½¿ç”¨æµ…å±‚æ¯”è¾ƒ===)** æ¥ç¡®å®š **channelId** ä½•æ—¶æ”¹å˜ã€‚

å¦‚æœè¿™äº›å€¼ä¸å˜ï¼ŒReact å°†è·³è¿‡è¯¥æ•ˆæœğŸ˜™ã€‚å½“æˆ‘ä»¬ç”¨ **componentDidUpdate** ç”Ÿå‘½å‘¨æœŸæ¥æ¯”è¾ƒ
**this.state.channelId** å’Œ **prev.state.channelId** æ—¶ä¹Ÿæ˜¯ä¸€æ ·

> æ³¨æ„:å®ƒä½¿ç”¨æµ…ç›¸ç­‰è€Œä¸æ˜¯æ·±æ¯”è¾ƒ

æœ€åï¼Œæˆ‘ä»¬å°†å–æ¶ˆè®¢é˜…ğŸ“»å½“ç”¨æˆ·æ”¹å˜é¢‘é“æ—¶

```
const Radio = () => {

    const [channelId, setChannelId] = React.useState(1)

    React.useEffect(() => {
        subscribeToRadio(channelId)

        return () => unsubscribeRadio(channelId) 

    }, [channelId]) 

    ...   
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥æ•ˆæœè¿”å›ä¸€ä¸ªç§°ä¸ºæ¸…ç†å‡½æ•°çš„å‡½æ•°ã€‚

å½“ä½¿ç”¨ç±»ç»„ä»¶æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»å°†è¿™ä¸ªé€»è¾‘åˆ†æˆä¸¤ä¸ªç»„ä»¶**ç»„ä»¶æ›´æ–°**å’Œ**ç»„ä»¶å¸è½½**

æˆ‘ä»¬çš„æ•ˆæœä¸ä»…ä¼šåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶è¿è¡Œï¼Œè¿˜ä¼šåœ¨æ¯æ¬¡æ›´æ–°æ—¶è¿è¡Œ(å½“ channelId æ”¹å˜æ—¶)ï¼Œå› æ­¤ï¼Œæ¯æ¬¡åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“ä¹‹å‰éƒ½ä¼šè°ƒç”¨æ¸…ç†å‡½æ•°

## 3ã€‚ç»“è®º:

é’©å­çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®ƒé€šè¿‡å»é™¤å¤æ‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œè®©ä½ çš„[ååº” app 90%å¹²å‡€](https://www.youtube.com/watch?v=dpw9EHDh2bM)ã€‚

å®ƒå¸®åŠ©æˆ‘ä»¬å°†ä¸œè¥¿æ”¾åœ¨ä¸€èµ·ï¼Œæ ¹æ®å‰¯ä½œç”¨å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåŠŸèƒ½åˆ†ç»„ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬åˆ†æ•£åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ä¸­

ç°åœ¨è§‰å¾—éœ€è¦å­¦ä¹ é’©å­äº†ï¼Œè¿™é‡Œæœ‰ä¸€äº›å¥½çš„èµ„æºç»™ä½ :

*   [æŒ‚é’©ç®€ä»‹](https://reactjs.org/docs/hooks-intro.html)
*   è‚¯ç‰¹Â·cÂ·å¤šå…¹çš„ç°ä»£ååº”å·¥ä½œå®¤(ç¬¬ä¸€éƒ¨åˆ†)
*   è‚¯ç‰¹Â·cÂ·å¤šå…¹çš„ç°ä»£ååº”å·¥ä½œå®¤(ç¬¬äºŒéƒ¨åˆ†)

## ğŸ™ ğŸ’ªæ„Ÿè°¢é˜…è¯»ï¼æŒ¯ä½œèµ·æ¥ï¼Œç¬¬äºŒéƒ¨åˆ†å°±è¦æ¥äº†

è¯·åœ¨ä¸‹é¢ç•™ä¸‹ä½ çš„è¯„è®ºï¼Œè®©æˆ‘çŸ¥é“ä½ å¯¹ React Hooks çš„çœ‹æ³•

### âœï¸æ‰€å†™

**ã€huy trinhã€‘**ğŸ”¥ ğŸ©â™¥ï¸ â™ ï¸ â™¦ï¸ â™£ï¸ğŸ¤“

è½¯ä»¶å¼€å‘è€…|é­”æ³•çˆ±å¥½è€…

æ‰“æ‹›å‘¼ğŸ‘‹åœ¨

âœ… [Github](https://github.com/HuyAms)

âœ… [é¢†è‹±](https://www.linkedin.com/in/huy-trinh-dinh-253534131/)

âœ… [Medium](https://medium.com/@trnhnhhuy)