# ä½¿ç”¨ lit-html åˆ›å»º web ç»„ä»¶(Ã  la React)

> åŸæ–‡ï¼š<https://dev.to/julcasans/using-lit-html-to-create-web-components-a-la-react-118g>

> ğŸ“£**æ›´æ–°ï¼**ğŸ“£
> *ç°åœ¨ lit-html å’Œ LitElement ç»Ÿä¸€åœ¨ [Lit](https://lit.dev/) ä¸‹ã€‚*
> *æˆ‘æ­£åœ¨å†™å…³äº**ç‚¹ç‡ƒ**çš„æ–°å¸–å­ï¼ŒåŒæ—¶ä½ å¯ä»¥:*
> 
> *   *é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œå› ä¸ºåŸç†æ˜¯ä¸€æ ·çš„*
> *   *ç”¨è¿™ä¸ª[æŒ‡å—](https://lit.dev/docs/releases/upgrade/)* å‡çº§ä½ çš„ä»£ç 
> *   *è®¿é—® *Lit* ç½‘ç«™äº†è§£æœ€æ–°åŠ¨æ€*
> 
> *ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ [lit-html å•æœº](https://lit.dev/docs/libraries/standalone-templates/)T3ã€‘*

è¿™ç¯‡æ–‡ç« æ˜¯å…³äº`lit-html`ä¸­çš„æŒ‡ä»¤ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰©å±•åº“çš„æ–¹å¼ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³ä¸€ç›´æ¨è¿Ÿæˆ‘ä»¬ç³»åˆ—çš„ä¸­å¿ƒä¸»é¢˜`LitElement`çš„åˆ°æ¥ã€‚æ‰€ä»¥æˆ‘å†³å®šæŠŠæŒ‡ç¤ºç•™åˆ°ä»¥åï¼Œèµ°è¿›`LitElement`çš„å¤§é—¨ã€‚æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨`lit-html`åˆ›å»º web ç»„ä»¶ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä»é‚£é‡Œåˆ°è¾¾`LitElement`ã€‚æˆ‘ä»¬å¼€å§‹å§ï¼

# æƒ³æ³•

æˆ‘ä»¬å°†åªä½¿ç”¨`lit-html`æ„å»ºä¸€ä¸ª web ç»„ä»¶ï¼Œä½†æ˜¯ä½¿ç”¨ç±»ä¼¼äº **React** çš„æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å°†æœ‰ä¸€ä¸ªå£°æ˜æ€§çš„æ¨¡æ¿ï¼Œå®ƒå‡†ç¡®åœ°å®šä¹‰äº†ç»„ä»¶ UI åœ¨æ•´ä¸ªçŠ¶æ€ä¸‹çš„çŠ¶æ€ï¼Œå¹¶ä¸”æˆ‘ä»¬è¿˜å°†åœ¨ç»„ä»¶å±æ€§æ”¹å˜æ—¶ï¼Œä¸€ä¸ªæ–°çš„å‘ˆç°å°†æ›´æ–°å®ƒçš„ UIã€‚

ä¸ºäº†å®šä¹‰ UIï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¨¡æ¿æ–‡å­—å’Œ`html`æ ‡ç­¾ï¼Œè€Œä¸æ˜¯ JSXï¼Œå°±åƒæˆ‘ä»¬åœ¨ä»¥å‰çš„å¸–å­ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚
æˆ‘ä»¬ä¹ŸçŸ¥é“`lit-html`æ˜¯è¶…çº§é«˜æ•ˆçš„æ¸²æŸ“ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨æ¯æ¬¡å±æ€§æ”¹å˜æ—¶è°ƒç”¨`render`å‡½æ•°ï¼Œæˆ‘ä»¬ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ã€‚

æˆ‘ä»¬å°†åˆ›å»ºçš„ç»„ä»¶åœ¨è§†è§‰å’ŒåŠŸèƒ½å±‚é¢ä¸Šéå¸¸ç®€å•ã€‚ä¸è¦æŒ‡æœ›æˆ‘ä»¬ä¼šåˆ¶é€ å¤§å‹ç»„ä»¶ï¼Œè‡³å°‘ç°åœ¨ä¸ä¼šã€‚åœ¨è¿™ä»½å‡ºç‰ˆç‰©ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å°†é‡ç‚¹æ”¾åœ¨åˆ›å»º web ç»„ä»¶çš„åŸºæœ¬æ¦‚å¿µä¸Šã€‚

å› æ­¤ï¼Œæˆ‘ä»¬çš„ç»„ä»¶å°†æ˜¯ä¸€ä¸ªå¯†ç æ£€æŸ¥å™¨:ä¸€ä¸ªç»™å®šå¯†ç çš„ç»„ä»¶ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬å®ƒæ˜¯æœ‰æ•ˆè¿˜æ˜¯æ— æ•ˆï¼Œå¦‚æœå®ƒæ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒè¿˜å‘Šè¯‰æˆ‘ä»¬å®ƒæœ‰å¤šå¼ºã€‚

é€‚ç”¨çš„è§„åˆ™å¦‚ä¸‹:

*   åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œå¯†ç æœ‰æ•ˆ:
    *   å®ƒè‡³å°‘æœ‰ 4 ä¸ª
    *   å®ƒè‡³å°‘æœ‰ä¸€ä¸ªå°å†™å­—æ¯ã€‚
    *   å®ƒè‡³å°‘æœ‰ä¸€ä¸ªå¤§å†™å­—æ¯ã€‚
    *   å®ƒè‡³å°‘æœ‰ä¸€ä¸ªæ•°å­—
*   å¦‚æœæœ‰æ•ˆï¼Œå°†æ˜¾ç¤ºä¸€ä¸ªæµ‹é‡å…¶å¼ºåº¦çš„æ¡ã€‚
*   å¦‚æœæ— æ•ˆï¼Œå°†ä¸æ˜¾ç¤ºå¼ºåº¦æ ã€‚

**æœ‰æ•ˆå¯†ç ç¤ºä¾‹**

```
<password-checker password="aB1sgX4"></password-checker> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](img/28ee7f8c499554e4d221ba0607e1b75a.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--Q20IFvO9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/p4zm3aests24r5uac9rc.png)

**æ— æ•ˆå¯†ç ç¤ºä¾‹**

```
<password-checker password="aB1"></password-checker> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](img/a90e14f752b37c2445adb1e3f4076786.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--bFCCLbXG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/v5faempe21zjwzu3o0ri.png)

# ä»£ç 

æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`password-checker.js`æ–‡ä»¶ï¼Œåœ¨ç¬¬ä¸€è¡Œæˆ‘ä»¬å°†ä»`lit-html` :
å¯¼å…¥`html`å’Œ`render`å‡½æ•°

```
import { html, render } from 'lit-html'; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åï¼Œæ­£å¦‚æˆ‘ä»¬å¤„ç†ä»»ä½•å…¶ä»– web ç»„ä»¶ä¸€æ ·ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»:

1.  å»¶ä¼¸`HTMLElement`ã€‚
2.  æœ‰ä¸€ä¸ªåˆ›å»ºç»„ä»¶å½±å­ DOM çš„æ„é€ å‡½æ•°ã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬çš„ç»„ä»¶æœ‰ä¸€ä¸ªä¿å­˜å¯†ç çš„å±æ€§ï¼Œå®ƒåº”è¯¥ç”¨ç”¨æˆ·åœ¨ HTML æ–‡ä»¶ä¸­å®šä¹‰çš„å€¼è¿›è¡Œåˆå§‹åŒ–ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°çš„:`<password-checker password="aB1">`ã€‚æˆ‘ä»¬åœ¨æ„é€ å‡½æ•°çš„æœ€åä¸€è¡Œè¿™æ ·åšã€‚

```
class PasswordChecker extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({mode: 'open'});
    this.password = this.getAttribute('password');
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸‹å¯è§†åŒ–è¡¨ç¤ºï¼Œå¹¶å®šä¹‰æ¨¡æ¿:

```
 template() {
    return html`
      <span>Your password is <strong>${this.isValid(this.password) ? 
            'valid ğŸ‘' : 'INVALID ğŸ‘'}</strong></span> ${this.isValid(this.password) ? 
        html`<div>Strength: <progress value=${this.password.length-3} max="5"</progress></div>` : ``}`;

  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä»…å½“å¯†ç æœ‰æ•ˆæ—¶ï¼Œæ¨¡æ¿æ‰ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼æ¥æ˜¾ç¤ºå¼ºåº¦æ ã€‚è¿˜è¦æ³¨æ„å±æ€§`password`æ˜¯æ¨¡æ¿çš„é‡è¦éƒ¨åˆ†ï¼Œå®ƒçš„å€¼å®šä¹‰äº†ç»„ä»¶æ˜¯å¦‚ä½•å‘ˆç°çš„ã€‚å¯¹`password`å±æ€§çš„ä»»ä½•æ›´æ”¹éƒ½å¿…é¡»è§¦å‘ UI æ›´æ–°ï¼Œå¯¼è‡´ç»„ä»¶çš„é‡æ–°å‘ˆç°ã€‚æˆ‘ä»¬å¦‚ä½•å®ç°è¿™ä¸€ç›®æ ‡ï¼Ÿ

è¿™å¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¸º`password`å±æ€§åˆ›å»ºä¸€ä¸ª setterï¼Œè¿™æ ·å½“æ›´æ–°å®ƒçš„å€¼æ—¶ï¼Œæˆ‘ä»¬å¼ºåˆ¶æ›´æ–°ç»„ä»¶ã€‚æˆ‘ä»¬è¿˜å¸Œæœ› HTML å…ƒç´ çš„`password`å±æ€§æœ‰æ–°çš„å€¼ã€‚è¿™æ˜¯ä»£ç :

```
 set password(value) {
    this._password = value;
    this.setAttribute('password', value);
    this.update();
  }

  get password() { return this._password; }

  update() {
    render(this.template(), this.shadowRoot, {eventContext: this});
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“æˆ‘ä»¬å®šä¹‰ setter æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå®šä¹‰äº† getterã€‚
`update`å‡½æ•°è°ƒç”¨`render`å‡½æ•°ï¼Œè¿™å°†å¯¼è‡´ç»„ä»¶çš„ UI è¢«æ›´æ–°ã€‚

ğŸ‘‰è¿™é‡Œè¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæˆ‘ä»¬è°ƒç”¨äº†ä¼ é€’ç»„ä»¶çš„å½±å­æ ¹çš„å‡½æ•°ï¼Œè¿™æ ·æ¨¡æ¿å°±è¿›å…¥äº†ç»„ä»¶çš„å½±å­ DOMã€‚ç¬¬ä¸‰ä¸ªå‚æ•°å…·æœ‰å°†åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­ä½¿ç”¨çš„ä¸Šä¸‹æ–‡(å¦‚æœæœ‰)ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ¨¡æ¿ä¸­å¯ä»¥æœ‰è¿™æ ·çš„ä¸œè¥¿:
`<button @click=${this.start}>Start</button>`ã€‚`@click=${this.start}`ä¸­çš„`this`å·²ç»åœ¨`eventContext`å±æ€§ä¸­ä¼ é€’äº†ä¸Šä¸‹æ–‡ã€‚å¦‚æœä¸é€šè¿‡ä¸Šä¸‹æ–‡ï¼Œ`this.start`å°±ä¼šå¤±è´¥ã€‚

æœ€åæˆ‘ä»¬æ³¨å†Œ web ç»„ä»¶:

```
customElements.define('password-checker', PasswordChecker); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åçš„ä»£ç ï¼ŒåŠ åœ¨ä¸€èµ·æ˜¯è¿™æ ·çš„:

```
import { html, render } from 'lit-html';

class PasswordChecker extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({mode: 'open'});
    this.password = this.getAttribute('password');
  }

  get password() { return this._password; }

  set password(value) {
    this._password = value;
    this.setAttribute('password', value);
    this.update();
  }

  update() {
    render(this.template(), this.shadowRoot, {eventContext: this});
  }

  isValid(passwd) { 
    const re = /(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{4,}/;
    return re.test(passwd);
  }

  template() {
    return html`
      <span>Your password is <strong>${this.isValid(this.password) ? 'valid ğŸ‘' : 'INVALID ğŸ‘'}</strong></span> ${this.isValid(this.password) ? 
        html`<div>Strength: <progress value=${this.password.length-3} max="5"</progress></div>` : ``}`;

  }
}

customElements.define('password-checker', PasswordChecker); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# é‡è¿°

è¿™æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ›å»º web ç»„ä»¶ *Ã  la* React çš„æ–¹æ³•ã€‚

1.  ä»`lit-html`å¯¼å…¥`html`å’Œ`render`ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ‰©å±• HTMLElement çš„ç±»ã€‚
3.  ç¼–å†™ä¸€ä¸ªæ„é€ å‡½æ•°:
    *   åˆ›å»ºé˜´å½± DOMã€‚
    *   ä» HTML æ ‡è®°ä¸­çš„å€¼åˆå§‹åŒ–å±æ€§ã€‚
4.  ä¸ºç»„ä»¶ UI ç¼–å†™æ¨¡æ¿ã€‚
5.  å†™ä¸€ä¸ªè°ƒç”¨`render`çš„æ›´æ–°å‡½æ•°ã€‚
6.  å¯¹äºæ¯ä¸ªéœ€è¦æ›´æ–° UI çš„å±æ€§å€¼æ›´æ”¹:
    *   ç¼–å†™ä¸€ä¸ª setter æ¥æ›´æ–°ç”¨æˆ·ç•Œé¢å¹¶å°†å±æ€§ä¸å…¶ç›¸å…³çš„ HTML å±æ€§åŒæ­¥ã€‚
    *   å†™ä¸€ä¸ª getterã€‚
7.  æ³¨å†Œç»„ä»¶ã€‚

# é å°æ•…éšœè¿‡æ´»

ä½ å¯ä»¥åœ¨æˆ‘çš„æ•…éšœé¡µé¢ä¸Šçœ‹åˆ°ä»£ç å¹¶ä½¿ç”¨å®ƒã€‚

[https://glitch.com/embed/#!/embed/handy-train?path=index.html](https://glitch.com/embed/#!/embed/handy-train?path=index.html)

# æœ€åçš„æƒ³æ³•

### ç±»ä¼¼æœ‰ååº”ä½†ä¸åƒæœ‰ååº”

æˆ‘ä»¬ç”¨æ¥åˆ›å»ºç»„ä»¶çš„æ–¹æ³•ç±»ä¼¼äº Reactï¼Œä½†å¹¶ä¸å®Œå…¨ç›¸åŒã€‚æˆ‘ä»¬å¯ä»¥è¯´ï¼Œæˆ‘ä»¬å®šä¹‰æ¨¡æ¿çš„æ–¹å¼æ˜¯ç›¸åŒçš„ï¼Œä½†å®ç°ä¸åŒ:React ä½¿ç”¨çš„æ˜¯å¿…é¡»ç»è¿‡å¤„ç†æ‰èƒ½ç”Ÿæˆ JavaScript ä»£ç çš„è¯­è¨€`JSX`ï¼Œè€Œ`lit-html`åŸºäº JavaScript ç‰¹æ€§ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„å¤„ç†ã€‚
å®ƒä»¬çš„ä¸åŒä¹‹å¤„åœ¨äº UI çš„æ›´æ–°:å½“æˆ‘ä»¬è°ƒç”¨`setState`å‡½æ•°æ—¶ï¼ŒReact æ›´æ–°ç»„ä»¶ï¼Œè€Œåœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸­ï¼Œå½“å±æ€§æ”¹å˜æ—¶ï¼Œæ›´æ–°â€œè‡ªåŠ¨â€å‘ç”Ÿã€‚è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªéå¸¸å¾®å¦™çš„åŒºåˆ«ï¼Œä½†å½“æˆ‘ä»¬åœ¨`LitElement`ä¸­çœ‹åˆ°åŒæ ·çš„æƒ³æ³•æ—¶ï¼Œå®ƒä¼šæ›´åŠ æ˜æ˜¾ã€‚

### lit-ç°å®ä¸–ç•Œä¸­çš„ html

ä¹‹å‰æˆ‘ä»¬å·²ç»çœ‹åˆ°`lit-html`ä¸éœ€è¦ç»„ä»¶æ¨¡å‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å„ç§é¡¹ç›®ä¸­ä½¿ç”¨å®ƒï¼Œç”šè‡³å°†å®ƒä¸å…¶ä»–æ¡†æ¶å’Œåº“æ··åˆä½¿ç”¨ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œæœ‰äº†è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬å¯ä»¥å®ç° web ç»„ä»¶ï¼Œè¿™ä½¿å¾—å®ƒæ›´å¼ºå¤§ï¼Œæ›´å®¹æ˜“é›†æˆåˆ°å…¶ä»–é¡¹ç›®ä¸­ã€‚

æœ‰å‡ ä¸ªé¡¹ç›®ä½¿ç”¨äº†`lit-hmtl`ã€‚æˆ‘ç•™äº†ä¸€äº›åœ¨è¿™é‡Œã€‚è¿™ä¸ªä¿¡æ¯çš„æ¥æºæ˜¯`lit-html`ä¸Šè¿™ä¸ªå¥‡å¦™çš„èµ„æºé›†åˆï¼Œæˆ‘æ¨èä½ çœ‹ä¸€çœ‹:[ç‰›é€¼æ–‡å­¦](https://github.com/web-padawan/awesome-lit)ã€‚

å½“ç„¶æˆ‘ä¹Ÿæ¨è[æ¸…æ™°å®Œæ•´çš„å®˜æ–¹`lit-html`æ–‡ä»¶](https://lit.dev/docs/libraries/standalone-templates/)ã€‚

åŸºäº`lit-html`çš„ä¸€äº›é¡¹ç›®

*   [Fit-html](https://github.com/Festify/fit-html)
*   [GluonJs](https://github.com/ruphin/gluonjs)
*   [ui5 web ç»„ä»¶](https://github.com/SAP/ui5-webcomponents)

### LitElement æ¥äº†...

æœ€åï¼Œåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä¼šè°ˆåˆ°`LitElement`ï¼å›å¤´è§ã€‚