# åœ¨ JavaScript ä¸­ä½¿ç”¨æœ¬åœ°æå– API æ—¶çš„é”™è¯¯å¤„ç†

> åŸæ–‡:[https://dev . to/param Harrison/error-handling-while-using-native-fetch-API-in-JavaScript-4bg 1](https://dev.to/paramharrison/error-handling-while-using-native-fetch-api-in-javascript-4bg1)

Fetch API éå¸¸å¼ºå¤§ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è·å– API è½»æ¾å‘é€ Ajax è¯·æ±‚ã€‚ä½†æ˜¯å®ƒä¹Ÿæœ‰è‡ªå·±çš„ç¼ºç‚¹ã€‚

ä¸€ä¸ªä¸»è¦çš„ç¼ºç‚¹æ˜¯ä½¿ç”¨ fetch æ—¶çš„é”™è¯¯å¤„ç†ã€‚

ä¾‹ï¼Œ

```
fetch(url).then((response) => {
  // Always gets a response, unless there is network error
  // It never throws an error for 4xx or 5xx response ğŸ˜Ÿ
}).catch(error) => {
  // Only network error comes here
}; 
```

*   é™¤éå‡ºç°ç½‘ç»œé”™è¯¯ï¼Œå¦åˆ™å®ƒæ€»æ˜¯ä¼šå¾—åˆ°å“åº”
*   æ‰€æœ‰ 4xxã€5xx éƒ½ä¸ä¼šè¿›å…¥åˆ¶åŠ¨å—

### [](#error-handling-in-fetch-api-using-promises)ä½¿ç”¨æ‰¿è¯ºè·å– API ä¸­çš„é”™è¯¯å¤„ç†

é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹ï¼Œæ²¡æœ‰å¤„ç†é”™è¯¯ï¼Œ

```
fetch(url)
  .then(response => {
    return response.json();
  })
  .then(jsonResponse => {
    // do whatever you want with the JSON response
  }); 
```

*   è¿™å¾ˆç³Ÿç³•ï¼Œå› ä¸ºå³ä½¿ url å‘é€äº† 404ï¼Œæˆ‘ä»¬ä¹Ÿåªæ˜¯å°†å…¶ä½œä¸ºå“åº”å‘é€ï¼Œè€Œä¸ä¼šç ´åå®ƒã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡æŠ›å‡ºé”™è¯¯æ¥çº æ­£å®ƒï¼Œåªå…è®¸çŠ¶æ€ä»£ç åœ¨ 200 åˆ° 299 ä¹‹é—´çš„å“åº”ã€‚

```
fetch(url)
  .then((response) => {
    if (response.status >= 200 && response.status <= 299) {
      return response.json();
    } else {
      throw Error(response.statusText);
    }
  })
  .then((jsonResponse) => {
    // do whatever you want with the JSON response
  }).catch(error) => {
    // Handle the error
    console.log(error);
  }; 
```

è¿™å°†è§£å†³é—®é¢˜ï¼Œæ‚¨ç”šè‡³å¯ä»¥æå–æ£€æŸ¥çŠ¶æ€éƒ¨åˆ†ä½œä¸ºè¿”å›æ‰¿è¯ºæˆ–æŠ›å‡ºé”™è¯¯çš„å‡½æ•°ã€‚

```
function CheckError(response) {
  if (response.status >= 200 && response.status <= 299) {
    return response.json();
  } else {
    throw Error(response.statusText);
  }
}

// Now call the function inside fetch promise resolver
fetch(url)
  .then(CheckError)
  .then((jsonResponse) => {
  }).catch(error) => {
  }; 
```

### [](#how-to-handle-fetch-errors-using-asyncawait-syntax)å¦‚ä½•ä½¿ç”¨ async-await è¯­æ³•å¤„ç†æå–é”™è¯¯

å®ƒå’Œæ‰¿è¯ºä¸€æ ·ï¼Œåªæ˜¯è¯­æ³•ä¼šæ”¹å˜ã€‚é¦–å…ˆæˆ‘ä»¬å°†çœ‹åˆ°æ²¡æœ‰é”™è¯¯å¤„ç†ï¼Œ

```
const response = await fetch(url);
const jsonResponse = await response.json();
console.log(jsonResponse); 
```

é”™è¯¯å¤„ç†ç¤ºä¾‹ï¼Œ

```
const response = await fetch(url);
if (response.status >= 200 && response.status <= 299) {
  const jsonResponse = await response.json();
  console.log(jsonResponse);
} else {
  // Handle errors
  console.log(response.status, response.statusText);
} 
```

å¸Œæœ›ä½ å­¦åˆ°äº†ä¸€äº›ä½¿ç”¨ fetch API çš„æŠ€å·§ï¼Œè¯·ç»§ç»­å…³æ³¨æ›´å¤šçš„ JavaScript æŠ€å·§ğŸ˜‡