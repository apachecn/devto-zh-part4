# ç”¨ GO æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª Rest Api

> åŸæ–‡ï¼š<https://dev.to/moficodes/build-your-first-rest-api-with-go-2gcj>

# ç”¨ GO æ„å»ºä½ çš„ç¬¬ä¸€ä¸ª Rest API

æœ¬æ¬¡ç ”è®¨ä¼šåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚

1.  åº”ç”¨ç¨‹åºæ¥å£
2.  Rest API
3.  å¸¦ GO çš„ Rest API

## API

å¦‚æœä½ åœ¨ç”µè„‘å‰å‘†çš„æ—¶é—´å¤Ÿé•¿ï¼Œä½ å¯èƒ½å¬è¯´è¿‡è¿™ä¸ªä¸œè¥¿ã€‚è¿™ä¸ª API æ˜¯ä»€ä¹ˆï¼Ÿ

API ä»£è¡¨åº”ç”¨ç¨‹åºæ¥å£ã€‚åƒè®¡ç®—æœºç§‘å­¦ä¸­çš„å¤§å¤šæ•°ä¸œè¥¿ä¸€æ ·ï¼Œç¼©å†™æ²¡æœ‰å¤šå¤§å¸®åŠ©ã€‚

å®ƒå®é™…ä¸Šçš„æ„æ€æ˜¯å…¬å¼€åŠŸèƒ½è€Œä¸å…¬å¼€å†…éƒ¨ã€‚å¦‚æœä½ ç”¨ä¸€ç§æ”¯æŒç¼–å†™å‡½æ•°æˆ–æ–¹æ³•çš„è¯­è¨€ç¼–ç¨‹(å‡ ä¹æ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€)ï¼Œä½ ä¼šå®Œå…¨ç†è§£æˆ‘åœ¨è¯´ä»€ä¹ˆã€‚

```
func addNumber(a, b int) int {
    // DO AMAZING MATH HERE
    // and return the result
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å³ä½¿ä½ æ˜¯è¶…çº§æ–°æ‰‹ï¼Œä½ ä¹Ÿèƒ½çœ‹å‡ºè¿™ä¸ªå‡½æ•°æ˜¯å…³äºä¸¤ä¸ªæ•°ç›¸åŠ å¹¶è¿”å›ç»“æœçš„ã€‚

å¯¹äºå‡½æ•°çš„ç”¨æˆ·æ¥è¯´ï¼Œä½ åªéœ€è¦è°ƒç”¨å‡½æ•°ï¼Œè€Œä¸å¿…æ‹…å¿ƒå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„(ä¸è¦ç›¸ä¿¡æ¯ä¸€ä¸ªå‡½æ•°)ã€‚

è¿™å°±æ˜¯ API çš„å…¨éƒ¨ã€‚API å¯ä»¥æ˜¯æ‚¨ç¼–å†™çš„å‡½æ•°ï¼Œæˆ–è€…æ˜¯æ¥è‡ªæŸä¸ªæ¡†æ¶çš„åº“æˆ–æ–¹æ³•çš„å‡½æ•°ï¼Œæˆ–è€…æ˜¯ http ç«¯ç‚¹ã€‚

* * *

## ä¼‘æ¯ API

ç°åœ¨ç¼–å†™çš„å¤§å¤šæ•° API éƒ½æ˜¯ web apisã€‚ä¸è¦å¼•ç”¨æˆ‘çš„è¯ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰åšä»»ä½•ç ”ç©¶æ¥å¾—åˆ°ä¸€ä¸ªåˆé€‚çš„æ•°å­—ã€‚ğŸ˜ä½†æ˜¯è€ƒè™‘åˆ°ç½‘ç»œæœåŠ¡å’Œç½‘ç»œåº”ç”¨çš„æ•°é‡ï¼Œæˆ‘ä¸è®¤ä¸ºæˆ‘å·®å¾—å¤ªè¿œã€‚

### ä»€ä¹ˆæ˜¯ä¼‘æ¯

REST æ˜¯ä»£è¡¨ T2ã€T4ã€è½¬ç§»çš„ç¼©å†™ã€‚å®ƒæ˜¯**åˆ†å¸ƒå¼è¶…åª’ä½“ç³»ç»Ÿ**çš„æ¶æ„é£æ ¼ï¼Œç”± Roy Fielding äº 2000 å¹´åœ¨å…¶è‘—åçš„[è®ºæ–‡](https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)ä¸­é¦–æ¬¡æå‡ºã€‚

åƒä»»ä½•å…¶ä»–æ¶æ„é£æ ¼ä¸€æ ·ï¼ŒREST ä¹Ÿæœ‰å®ƒè‡ªå·±çš„ [6 æŒ‡å¯¼çº¦æŸ](https://restfulapi.net/rest-architectural-constraints/)ï¼Œå¦‚æœä¸€ä¸ªæ¥å£éœ€è¦è¢«ç§°ä¸º **RESTful** ï¼Œé‚£ä¹ˆå¿…é¡»æ»¡è¶³è¿™äº›çº¦æŸã€‚è¿™äº›åŸåˆ™åˆ—ä¸¾å¦‚ä¸‹ã€‚

### ä¼‘æ¯çš„æŒ‡å¯¼åŸåˆ™

1.  **å®¢æˆ·ç«¯â€“æœåŠ¡å™¨**â€“é€šè¿‡å°†ç”¨æˆ·ç•Œé¢é—®é¢˜ä¸æ•°æ®å­˜å‚¨é—®é¢˜åˆ†ç¦»ï¼Œæˆ‘ä»¬æé«˜äº†ç”¨æˆ·ç•Œé¢åœ¨å¤šä¸ªå¹³å°ä¸Šçš„å¯ç§»æ¤æ€§ï¼Œå¹¶é€šè¿‡ç®€åŒ–æœåŠ¡å™¨ç»„ä»¶æé«˜äº†å¯æ‰©å±•æ€§ã€‚
2.  **æ— çŠ¶æ€**â€“ä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„æ¯ä¸ªè¯·æ±‚å¿…é¡»åŒ…å«ç†è§£è¯·æ±‚æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸èƒ½åˆ©ç”¨æœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ä»»ä½•ä¸Šä¸‹æ–‡ã€‚å› æ­¤ï¼Œä¼šè¯çŠ¶æ€å®Œå…¨ä¿å­˜åœ¨å®¢æˆ·ç«¯ã€‚
3.  **å¯ç¼“å­˜**â€“ç¼“å­˜çº¦æŸè¦æ±‚å¯¹è¯·æ±‚çš„å“åº”ä¸­çš„æ•°æ®éšå¼æˆ–æ˜¾å¼åœ°æ ‡è®°ä¸ºå¯ç¼“å­˜æˆ–ä¸å¯ç¼“å­˜ã€‚å¦‚æœä¸€ä¸ªå“åº”æ˜¯å¯ç¼“å­˜çš„ï¼Œé‚£ä¹ˆå®¢æˆ·æœºç¼“å­˜å°±æœ‰æƒä¸ºä»¥åçš„ç­‰ä»·è¯·æ±‚é‡ç”¨è¯¥å“åº”æ•°æ®ã€‚
4.  **ç»Ÿä¸€æ¥å£**â€”â€”é€šè¿‡å°†è½¯ä»¶å·¥ç¨‹çš„é€šç”¨æ€§åŸåˆ™åº”ç”¨äºç»„ä»¶æ¥å£ï¼Œç®€åŒ–äº†æ•´ä½“ç³»ç»Ÿæ¶æ„ï¼Œæé«˜äº†äº¤äº’çš„å¯è§†æ€§ã€‚ä¸ºäº†è·å¾—ç»Ÿä¸€çš„æ¥å£ï¼Œéœ€è¦å¤šä¸ªæ¶æ„çº¦æŸæ¥æŒ‡å¯¼ç»„ä»¶çš„è¡Œä¸ºã€‚REST ç”±å››ä¸ªæ¥å£çº¦æŸå®šä¹‰:èµ„æºçš„æ ‡è¯†ï¼›é€šè¿‡è¡¨ç°æ“çºµèµ„æºï¼›è‡ªæˆ‘æè¿°çš„æ¶ˆæ¯ï¼›è¶…åª’ä½“æ˜¯åº”ç”¨ç¨‹åºçŠ¶æ€çš„å¼•æ“ã€‚
5.  **åˆ†å±‚ç³»ç»Ÿ**â€“åˆ†å±‚ç³»ç»Ÿé£æ ¼é€šè¿‡çº¦æŸç»„ä»¶è¡Œä¸ºï¼Œä½¿å¾—æ¯ä¸ªç»„ä»¶ä¸èƒ½â€œçœ‹åˆ°â€ä¸å…¶äº¤äº’çš„ç›´æ¥å±‚ä¹‹å¤–ï¼Œä»è€Œå…è®¸æ¶æ„ç”±åˆ†å±‚çš„å±‚ç»„æˆã€‚
6.  **æŒ‰éœ€ç¼–ç (å¯é€‰)**â€“REST å…è®¸é€šè¿‡ä¸‹è½½å’Œæ‰§è¡Œ applets æˆ–è„šæœ¬å½¢å¼çš„ä»£ç æ¥æ‰©å±•å®¢æˆ·ç«¯åŠŸèƒ½ã€‚è¿™é€šè¿‡å‡å°‘éœ€è¦é¢„å…ˆå®ç°çš„åŠŸèƒ½æ•°é‡æ¥ç®€åŒ–å®¢æˆ·ç«¯ã€‚

è¦æŸ¥çœ‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ REST API çš„ç¤ºä¾‹

### HTTP åŠ¨è¯

è¿™äº›æ˜¯ HTTP apis éµå¾ªçš„ä¸€äº›çº¦å®šã€‚è¿™äº›å®é™…ä¸Šä¸æ˜¯ Rest è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦äº†è§£è¿™äº›æ‰èƒ½å……åˆ†åˆ©ç”¨ Rest APIã€‚

HTTP å®šä¹‰äº†ä¸€ç»„**è¯·æ±‚æ–¹æ³•**,ä»¥æŒ‡ç¤ºå¯¹ç»™å®šèµ„æºè¦æ‰§è¡Œçš„æœŸæœ›åŠ¨ä½œã€‚è™½ç„¶å®ƒä»¬ä¹Ÿå¯ä»¥æ˜¯åè¯ï¼Œä½†æ˜¯è¿™äº›è¯·æ±‚æ–¹æ³•æœ‰æ—¶è¢«ç§°ä¸º *HTTP åŠ¨è¯*ã€‚å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½å®ç°äº†ä¸åŒçš„è¯­ä¹‰ï¼Œä½†æ˜¯å®ƒä»¬ä¹‹é—´æœ‰ä¸€äº›å…±åŒçš„ç‰¹æ€§:ä¾‹å¦‚ï¼Œä¸€ä¸ªè¯·æ±‚æ–¹æ³•å¯ä»¥æ˜¯[å®‰å…¨çš„](https://developer.mozilla.org/en-US/docs/Glossary/safe)ã€[å¹‚ç­‰çš„](https://developer.mozilla.org/en-US/docs/Glossary/idempotent)ï¼Œæˆ–è€…[å¯ç¼“å­˜çš„](https://developer.mozilla.org/en-US/docs/Glossary/cacheable)ã€‚

[`GET`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET)`GET`æ–¹æ³•è¯·æ±‚æŒ‡å®šèµ„æºçš„è¡¨ç¤ºã€‚ä½¿ç”¨`GET`çš„è¯·æ±‚åº”è¯¥åªæ£€ç´¢æ•°æ®ã€‚

[`HEAD`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/HEAD)`HEAD`æ–¹æ³•è¦æ±‚ä¸`GET`è¯·æ±‚ç›¸åŒçš„å“åº”ï¼Œä½†æ˜¯æ²¡æœ‰å“åº”ä½“ã€‚

[`POST`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST)`POST`æ–¹æ³•ç”¨äºå°†å®ä½“æäº¤ç»™æŒ‡å®šçš„èµ„æºï¼Œé€šå¸¸ä¼šå¯¼è‡´æœåŠ¡å™¨ä¸Šçš„çŠ¶æ€å˜åŒ–æˆ–å‰¯ä½œç”¨ã€‚

[`PUT`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT)`PUT`æ–¹æ³•ç”¨è¯·æ±‚è´Ÿè½½æ›¿æ¢ç›®æ ‡èµ„æºçš„æ‰€æœ‰å½“å‰è¡¨ç¤ºã€‚

[`DELETE`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/DELETE)`DELETE`æ–¹æ³•åˆ é™¤æŒ‡å®šçš„èµ„æºã€‚

[`CONNECT`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/CONNECT)`CONNECT`æ–¹æ³•å»ºç«‹åˆ°ç”±ç›®æ ‡èµ„æºè¯†åˆ«çš„æœåŠ¡å™¨çš„éš§é“ã€‚

[`OPTIONS`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/OPTIONS)`OPTIONS`æ–¹æ³•ç”¨äºæè¿°ç›®æ ‡èµ„æºçš„é€šä¿¡é€‰é¡¹ã€‚

[`TRACE`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/TRACE)`TRACE`æ–¹æ³•æ²¿ç€åˆ°ç›®æ ‡èµ„æºçš„è·¯å¾„æ‰§è¡Œæ¶ˆæ¯ç¯å›æµ‹è¯•ã€‚

[`PATCH`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PATCH)`PATCH`æ–¹æ³•ç”¨äºå¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹ã€‚

è¿™äº›éƒ½æ˜¯è°è¨€ã€‚

### çŠ¶æ€ç 

**1xx ä¿¡æ¯**

*   [100 ç»§ç»­](https://httpstatuses.com/100)
*   [101 äº¤æ¢åè®®](https://httpstatuses.com/101)
*   [102 å¤„ç†](https://httpstatuses.com/102)

**2xx æˆåŠŸ**

*   [200 OK](https://httpstatuses.com/200)
*   [201 åˆ›å»ºäº†](https://httpstatuses.com/201)
*   [202 å·²æ¥å—](https://httpstatuses.com/202)
*   [203 éæƒå¨ä¿¡æ¯](https://httpstatuses.com/203)
*   [204 æ— å†…å®¹](https://httpstatuses.com/204)
*   [205 é‡ç½®å†…å®¹](https://httpstatuses.com/205)
*   [206 åˆ†éƒ¨åˆ†é¡¹å†…å®¹](https://httpstatuses.com/206)
*   [207 å¤šçŠ¶æ€](https://httpstatuses.com/207)
*   [208 å·²ç»ä¸ŠæŠ¥](https://httpstatuses.com/208)
*   [226 IM å·²ç”¨](https://httpstatuses.com/226)

**3xx é‡å®šå‘**

*   [300 å¤šé¡¹é€‰æ‹©](https://httpstatuses.com/300)
*   [301 æ°¸ä¹…ç§»åŠ¨](https://httpstatuses.com/301)
*   [302 å‘ç°](https://httpstatuses.com/302)
*   [303 å‚è§å…¶ä»–](https://httpstatuses.com/303)
*   [304 æœªä¿®æ”¹](https://httpstatuses.com/304)
*   [305 ä½¿ç”¨ä»£ç†](https://httpstatuses.com/305)
*   [307 ä¸´æ—¶é‡å®šå‘](https://httpstatuses.com/307)
*   [308 æ°¸ä¹…é‡å®šå‘](https://httpstatuses.com/308)

**4xx å®¢æˆ·ç«¯é”™è¯¯**

*   [400 é”™è¯¯è¯·æ±‚](https://httpstatuses.com/400)
*   [401 æœªç»æˆæƒ](https://httpstatuses.com/401)
*   [402 è¦æ±‚ä»˜æ¬¾](https://httpstatuses.com/402)
*   [403 ç¦æ­¢](https://httpstatuses.com/403)
*   [404 æœªæ‰¾åˆ°](https://httpstatuses.com/404)
*   [405 ä¸å…è®¸çš„æ–¹æ³•](https://httpstatuses.com/405)
*   [406 ä¸å¯æ¥å—](https://httpstatuses.com/406)
*   [407 éœ€è¦ä»£ç†è®¤è¯](https://httpstatuses.com/407)
*   [408 è¯·æ±‚è¶…æ—¶](https://httpstatuses.com/408)
*   [409 å†²çª](https://httpstatuses.com/409)
*   [410 èµ°äº†](https://httpstatuses.com/410)
*   [411 æ‰€éœ€é•¿åº¦](https://httpstatuses.com/411)
*   [412 å‰ç½®æ¡ä»¶å¤±è´¥](https://httpstatuses.com/412)
*   [413 æœ‰æ•ˆè´Ÿè½½è¿‡å¤§](https://httpstatuses.com/413)
*   [414 è¯·æ±‚â€”â€”URI å¤ªä¹…](https://httpstatuses.com/414)
*   [415 ä¸æ”¯æŒçš„åª’ä½“ç±»å‹](https://httpstatuses.com/415)
*   [416 è¯·æ±‚çš„èŒƒå›´ä¸å¯æ»¡è¶³](https://httpstatuses.com/416)
*   [417 æœŸæœ›å¤±è´¥](https://httpstatuses.com/417)
*   418 æˆ‘æ˜¯èŒ¶å£¶
*   [421 é”™è¯¯çš„è¯·æ±‚](https://httpstatuses.com/421)
*   [422 ä¸å¯å¤„ç†å®ä½“](https://httpstatuses.com/422)
*   [423 é”å®š](https://httpstatuses.com/423)
*   [424 å¤±è´¥ä¾èµ–](https://httpstatuses.com/424)
*   [426 éœ€è¦å‡çº§](https://httpstatuses.com/426)
*   [428 éœ€è¦çš„å‰ææ¡ä»¶](https://httpstatuses.com/428)
*   [429 å¤ªå¤šçš„è¯·æ±‚](https://httpstatuses.com/429)
*   [431 è¯·æ±‚æ ‡é¢˜å­—æ®µå¤ªå¤§](https://httpstatuses.com/431)
*   [444 è¿æ¥å…³é—­ï¼Œæ— å“åº”](https://httpstatuses.com/444)
*   [451 å› æ³•å¾‹åŸå› ä¸å¯ç”¨](https://httpstatuses.com/451)
*   [499 å®¢æˆ·ç«¯å…³é—­è¯·æ±‚](https://httpstatuses.com/499)

**5xx æœåŠ¡å™¨é”™è¯¯**

*   [500 å†…éƒ¨æœåŠ¡å™¨é”™è¯¯](https://httpstatuses.com/500)
*   [501 æœªå®æ–½](https://httpstatuses.com/501)
*   [502 åç½‘å…³](https://httpstatuses.com/502)
*   [503 æœåŠ¡ä¸å¯ç”¨](https://httpstatuses.com/503)
*   [504 ç½‘å…³è¶…æ—¶](https://httpstatuses.com/504)
*   [ä¸æ”¯æŒ 505 HTTP ç‰ˆæœ¬](https://httpstatuses.com/505)
*   [506 å˜å‹ä¹Ÿåå•†](https://httpstatuses.com/506)
*   [507 å­˜å‚¨ä¸è¶³](https://httpstatuses.com/507)
*   [æ£€æµ‹åˆ° 508 å›è·¯](https://httpstatuses.com/508)
*   [510 æœªå»¶é•¿](https://httpstatuses.com/510)
*   [511 éœ€è¦ç½‘ç»œè®¤è¯](https://httpstatuses.com/511)
*   [599 ç½‘ç»œè¿æ¥è¶…æ—¶é”™è¯¯](https://httpstatuses.com/599)

è¿™ä¹Ÿæ²¡æœ‰å®é™…æ„ä¹‰ã€‚

### æœ¯è¯­

ä»¥ä¸‹æ˜¯ä¸ REST APIs ç›¸å…³çš„æœ€é‡è¦çš„æœ¯è¯­

*   **èµ„æº**æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æŸç‰©çš„è¡¨ç¤ºï¼Œå®ƒæœ‰ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ•°æ®ï¼Œå¯ä»¥æœ‰ä¸€ç»„æ–¹æ³•å¯¹å…¶è¿›è¡Œæ“ä½œã€‚ä¾‹å¦‚åŠ¨ç‰©ã€å­¦æ ¡å’Œå‘˜å·¥éƒ½æ˜¯èµ„æºï¼Œ*åˆ é™¤ã€æ·»åŠ ã€æ›´æ–°*æ˜¯å¯¹è¿™äº›èµ„æºè¿›è¡Œçš„æ“ä½œã€‚
*   **é›†åˆ**æ˜¯èµ„æºçš„é›†åˆï¼Œä¾‹å¦‚*å…¬å¸*æ˜¯*å…¬å¸*èµ„æºçš„é›†åˆã€‚
*   **URL** (ç»Ÿä¸€**èµ„æº**å®šä½å™¨)æ˜¯ä¸€ä¸ªè·¯å¾„ï¼Œé€šè¿‡å®ƒå¯ä»¥å®šä½**èµ„æº**å¹¶å¯¹å…¶æ‰§è¡Œä¸€äº›æ“ä½œã€‚

### API ç«¯ç‚¹

è¿™å°±æ˜¯ API ç«¯ç‚¹çš„æ ·å­ã€‚

```
https://www.github.com/golang/go/search?q=http&type=Commits 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ª URL å¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†

| **åè®®** | å­æ•´ç¯ | **åŸŸ** | **è·¯å¾„** | æ¸¯å£ | **æŸ¥è¯¢** |
| --- | --- | --- | --- | --- | --- |
| *http/https* | å­æ•´ç¯ | åŸºç¡€ url | *èµ„æº/å…¶ä»–èµ„æº* | ä¸€äº›æ¸¯å£ | *é”®å€¼å¯¹* |
| https | ä¸‡ç»´ç½‘ | github.com | golang/go/æœç´¢ | Eighty | ï¼Ÿq = http & type =æäº¤ |

#### åè®®

æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯åº”è¯¥å¦‚ä½•ä¸æœåŠ¡å™¨é€šä¿¡ã€‚

#### å­åŸŸ

ä¸»åŸŸçš„å­åˆ’åˆ†

#### åŸŸ

åœ¨äº’è”ç½‘ä¸Šè¯†åˆ«ç½‘ç«™çš„å”¯ä¸€å‚è€ƒ

#### ç«¯å£

è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šçš„ç«¯å£ã€‚é»˜è®¤ä¸º 80ã€‚æ‰€ä»¥å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬çœ‹ä¸åˆ°å®ƒ

#### è·¯å¾„

Rest API ä¸­çš„è·¯å¾„å‚æ•°ä»£è¡¨èµ„æºã€‚

```
https://jsonplaceholder.typicode.com/posts/1/comments 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`posts/1/comments`

è¿™æ¡è·¯å¾„ä»£è¡¨çš„æ˜¯`1st` `posts`èµ„æº c `comments`

åŸºæœ¬ç»“æ„æ˜¯

```
top-level-resource/<some-identifier>/secondary-resource/<some-identifier>/... 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### æŸ¥è¯¢

æŸ¥è¯¢æ˜¯ä¿¡æ¯çš„é”®å€¼å¯¹ï¼Œä¸»è¦ç”¨äºè¿‡æ»¤ç›®çš„ã€‚

```
https://jsonplaceholder.typicode.com/posts?userId=1 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`?`åçš„éƒ¨åˆ†æ˜¯æŸ¥è¯¢å‚æ•°ã€‚æˆ‘ä»¬åªæœ‰ä¸€ä¸ªé—®é¢˜ã€‚`userId=1`

#### æ ‡é¢˜

è¿™ä¸æ˜¯ URL æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ ‡å¤´æ˜¯ç”±å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‘é€çš„ç½‘ç»œç»„ä»¶çš„ä¸€éƒ¨åˆ†ã€‚æ ¹æ®æ˜¯è°å‘çš„ã€‚æœ‰ä¸¤ç§æ ‡é¢˜

1.  è¯·æ±‚å¤´(å®¢æˆ·ç«¯->æœåŠ¡å™¨)
2.  å“åº”å¤´(æœåŠ¡å™¨->å®¢æˆ·ç«¯)

#### æ­£æ–‡

æ‚¨å¯ä»¥å‘æœåŠ¡å™¨çš„è¯·æ±‚å’ŒæœåŠ¡å™¨çš„å“åº”æ·»åŠ é¢å¤–çš„ä¿¡æ¯ã€‚

### å“åº”ç±»å‹

é€šå¸¸æ˜¯ JSON æˆ–è€… XMLã€‚

ç°åœ¨ä¸»è¦æ˜¯ JSONã€‚

* * *

## Rest API å¸¦ GO

è¿™å°±æ˜¯ä½ åœ¨è¿™é‡Œçš„åŸå› ã€‚æˆ–è€…æˆ‘å¸Œæœ›è¿™å°±æ˜¯ä½ åœ¨è¿™é‡Œçš„åŸå› ã€‚

[æœåŠ¡äºè½¯ä»¶å·¥ç¨‹çš„è¯­è¨€è®¾è®¡](https://talks.golang.org/2012/splash.article)

ä¸Šé¢è¿™ç¯‡æ–‡ç« æ˜¯ 2012 å¹´å‡ºçš„ã€‚ä½†ä»ç„¶ä¸å­¦ä¹ å›´æ£‹èƒŒåçš„æ„è¯†å½¢æ€å¯†åˆ‡ç›¸å…³ã€‚

å¦‚æœä½ æ­£åœ¨ç¼–å†™ Rest APIï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹© goï¼Ÿ

1.  æ˜¯ç¼–çš„ã€‚æ‰€ä»¥ä½ ä¼šå¾—åˆ°å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
2.  å®ƒå¾ˆå¿«ã€‚(æ¯” c/c++æˆ– rust æ…¢)ä½†æ¯”å¤§å¤šæ•°å…¶ä»– web ç¼–ç¨‹è¯­è¨€å¿«ã€‚
3.  å¾ˆå®¹æ˜“ç†è§£ã€‚
4.  è¿™åœ¨å¾®æœåŠ¡é¢†åŸŸéå¸¸æœ‰æ•ˆï¼ŒåŸå› ä¸€ã€‚

### net/http

go ä¸­çš„æ ‡å‡†åº“é™„å¸¦äº†`net/http`åŒ…ï¼Œè¿™æ˜¯æ„å»º RestAPIs çš„ç»ä½³èµ·ç‚¹ã€‚å¹¶ä¸”å¤§å¤šæ•°å…¶ä»–åº“å¢åŠ äº†ä¸€äº›é¢å¤–çš„ç‰¹æ€§ï¼Œä¹Ÿå¯ä»¥ä¸ net/http åŒ…äº’æ“ä½œï¼Œæ‰€ä»¥ç†è§£ net/http åŒ…å¯¹äºä½¿ç”¨ golang for RestAPIs æ˜¯è‡³å…³é‡è¦çš„ã€‚

[net/http](https://golang.org/pkg/net/http)

æˆ‘ä»¬å¯èƒ½ä¸éœ€è¦çŸ¥é“ net/http åŒ…ä¸­çš„æ‰€æœ‰å†…å®¹ã€‚ä½†æ˜¯ï¼Œå¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥çŸ¥é“ä¸€äº›äº‹æƒ…ã€‚

### å¤„ç†ç¨‹åºæ¥å£

æˆ‘ä»æ¥éƒ½ä¸æ˜¯è®°å¿†ä»€ä¹ˆä¸œè¥¿çš„æè®®è€…ï¼Œä½†æ­£å¦‚æ‰˜å¾·Â·éº¦å…‹åŠ³å¾·åœ¨ä»–çš„è¯¾ç¨‹ä¸­åå¤æåˆ°çš„é‚£æ ·ã€‚æˆ‘ä»¬éœ€è¦è®°ä½å¤„ç†ç¨‹åºæ¥å£ã€‚

```
type Handler interface {
        ServeHTTP(ResponseWriter, *Request)
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯äº†ã€‚

å®ƒæœ‰ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”åªæœ‰ä¸€ä¸ªæ–¹æ³•ã€‚

å¦‚æœä¸€ä¸ªç»“æ„æˆ–å¯¹è±¡æœ‰ä¸€ä¸ªæ–¹æ³•`ServeHTTP`ï¼Œå®ƒé‡‡ç”¨`ResponseWriter`å’ŒæŒ‡å‘`Request`çš„æŒ‡é’ˆï¼Œé‚£ä¹ˆå®ƒå°†æ˜¯å¤„ç†ç¨‹åºã€‚

æ ¹æ®æˆ‘ä»¬æ‰€æœ‰çš„çŸ¥è¯†ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½åšä¸€äº›ç ´åäº†ã€‚

# æˆ‘ä»¬å¼€å§‹å§

æˆ‘æƒ³ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹äº†ã€‚

é‚£æ˜¯ä¸€å¤§å †ç†è®ºã€‚æˆ‘ç­”åº”ä½ ä¼šå»ºä½ çš„ç¬¬ä¸€ä¸ªé¤é¦†ã€‚

## ç®€å• Rest API

æ‰€ä»¥è®©æˆ‘ä»¬ç›´æ¥å¼€å§‹å§ã€‚

åœ¨ä½ æƒ³å†™ go ä»£ç çš„æ–‡ä»¶å¤¹é‡Œ

```
go mod init api-test 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œä½ å¯ä»¥éšæ„å‘½åã€‚

æˆ‘å«æˆ‘çš„`main.go`

```
package main

import (
    "log"
    "net/http"
)

type server struct{}

func (s *server) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
        w.WriteHeader(http.StatusOK)
    w.Write([]byte(`{"message": "hello world"}`))
}

func main() {
    s := &server{}
    http.Handle("/", s)
    log.Fatal(http.ListenAndServe(":8080", nil))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬åˆ†è§£è¿™æ®µä»£ç ã€‚

åœ¨é¡¶éƒ¨ï¼Œæˆ‘ä»¬æœ‰æˆ‘ä»¬çš„`package main`æ‰€æœ‰å»æ‰§è¡Œéœ€è¦ä¸€ä¸ªä¸»åŒ…ã€‚

æˆ‘ä»¬æœ‰è¿›å£è´§ã€‚`log`ç”¨äºè®°å½•å‘ç”Ÿçš„é”™è¯¯ã€‚`net/http`å› ä¸ºæˆ‘ä»¬å†™çš„æ˜¯ rest apiã€‚

ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ªå«åšæœåŠ¡å™¨çš„ç»“æ„ã€‚å®ƒæ²¡æœ‰å­—æ®µã€‚æˆ‘ä»¬å°†å‘è¿™ä¸ªæœåŠ¡å™¨`ServeHTTP`æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™å°†æ»¡è¶³å¤„ç†ç¨‹åºæ¥å£ã€‚åœ¨ go ä¸­ä½ ä¼šæ³¨æ„åˆ°ä¸€ä»¶äº‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ˜ç¡®åœ°è¯´å‡ºæˆ‘ä»¬æ­£åœ¨å®ç°çš„æ¥å£ã€‚ç¼–è¯‘å™¨è¶³å¤Ÿèªæ˜ï¼Œèƒ½å¤Ÿç†è§£è¿™ä¸€ç‚¹ã€‚åœ¨`ServeHTTP`æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è®¾ç½® httpStatus 200 æ¥è¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚æˆ‘ä»¬å°†å†…å®¹ç±»å‹ä¼ é€’ç»™`application/json`,è¿™æ ·å½“æˆ‘ä»¬å°† json ä½œä¸ºæœ‰æ•ˆè½½è·å‘é€å›æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å°±æ˜ç™½äº†ã€‚æœ€åæˆ‘ä»¬å†™

```
{"message": "hello world"} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çš„å›åº”ã€‚

è®©æˆ‘ä»¬è¿è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨

```
go run main.go 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ ä¹‹å‰å·²ç»å®‰è£…äº† postmanï¼Œè®©æˆ‘ä»¬ç”¨ postman å¿«é€Ÿæµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚

[![](img/e55be4f27a644d782729bea01f511f2b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--Db0MgchP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/moficodes/rest-api-with-go/master/gitbook/.gitbook/assets/screen-shot-2019-08-21-at-1.04.26-pm.png)

Get è¿”å›æˆ‘ä»¬çš„æ¶ˆæ¯ã€‚

å¹²å¾—å¥½ï¼

ä½†æ˜¯ç­‰ç­‰ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿˜æ”¯æŒå“ªäº› HTTP åŠ¨è¯ã€‚

åœ¨ postman ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜è¯·æ±‚çš„ç±»å‹ã€‚å•å‡»ä¸‹æ‹‰èœå•å¹¶é€‰æ‹©å…¶ä»–å†…å®¹ã€‚å‡è®¾æˆ‘ä»¬å‘å¸ƒäº†ã€‚

[![](img/3cabfd91573147ff96b86bbd9404384b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--qEExIukE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/moficodes/rest-api-with-go/master/gitbook/.gitbook/assets/screen-shot-2019-08-21-at-1.11.56-pm.png)

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œè¯·æ±‚ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœã€‚

è¿™æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„é”™è¯¯ã€‚ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›æ ¹æ®è¯·æ±‚ç±»å‹åšä¸åŒçš„äº‹æƒ…ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

æˆ‘ä»¬å°†ç”¨ä¸‹é¢çš„ä»£ç ä¿®æ”¹æˆ‘ä»¬çš„ ServeHTTP æ–¹æ³•ã€‚

```
func (s *server) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    switch r.Method {
    case "GET":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "get called"}`))
    case "POST":
        w.WriteHeader(http.StatusCreated)
        w.Write([]byte(`{"message": "post called"}`))
    case "PUT":
        w.WriteHeader(http.StatusAccepted)
        w.Write([]byte(`{"message": "put called"}`))
    case "DELETE":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "delete called"}`))
    default:
        w.WriteHeader(http.StatusNotFound)
        w.Write([]byte(`{"message": "not found"}`))
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæˆ‘ä»¬çš„æœåŠ¡å™¨å·²ç»åœ¨è¿è¡Œï¼Œè®©æˆ‘ä»¬ç”¨`ctrl-c`åœæ­¢å®ƒ

å†è¿è¡Œä¸€æ¬¡ã€‚

```
go run main.go 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å†ç”¨ postman æˆ–è€… curl æµ‹è¯•ä¸€ä¸‹ã€‚

ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ä¸€ä»¶äº‹ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨æˆ‘ä»¬çš„æœåŠ¡å™¨ç»“æ„æ¥å°†ä¸€ä¸ªæ–¹æ³•é™„åŠ åˆ°ã€‚

go å›¢é˜ŸçŸ¥é“è¿™æ˜¯ä¸æ–¹ä¾¿çš„ï¼Œå¹¶ç»™äº†æˆ‘ä»¬ http åŒ…ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå…è®¸æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å…·æœ‰ä¸ T1 ç›¸åŒçš„ç­¾åï¼Œå¹¶å¯ä»¥æœåŠ¡äºä¸€æ¡è·¯çº¿ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ª
ç¨å¾®æ¸…ç†ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç 

```
package main

import (
    "log"
    "net/http"
)

func home(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    switch r.Method {
    case "GET":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "get called"}`))
    case "POST":
        w.WriteHeader(http.StatusCreated)
        w.Write([]byte(`{"message": "post called"}`))
    case "PUT":
        w.WriteHeader(http.StatusAccepted)
        w.Write([]byte(`{"message": "put called"}`))
    case "DELETE":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "delete called"}`))
    default:
        w.WriteHeader(http.StatusNotFound)
        w.Write([]byte(`{"message": "not found"}`))
    }
}

func main() {
    http.HandleFunc("/", home)
    log.Fatal(http.ListenAndServe(":8080", nil))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åŠŸèƒ½åº”è¯¥å®Œå…¨ç›¸åŒã€‚

## å¤§çŒ©çŒ© Mux

`net/http`å†…ç½®æ–¹æ³•å¾ˆæ£’ã€‚æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªæ²¡æœ‰å¤–éƒ¨åº“çš„æœåŠ¡å™¨ã€‚ä½†æ˜¯`net/http`æœ‰å®ƒçš„å±€é™æ€§ã€‚æ²¡æœ‰ç›´æ¥å¤„ç†è·¯å¾„å‚æ•°çš„æ–¹æ³•ã€‚å°±åƒè¯·æ±‚æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨å¤„ç†è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°ã€‚

Gorilla Mux æ˜¯ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„åº“ï¼Œå®ƒéå¸¸é€‚åˆ net/http åŒ…ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬åšäº†ä¸€äº›äº‹æƒ…ï¼Œä½¿ api æ„å»ºå˜å¾—è½»è€Œæ˜“ä¸¾ã€‚

### ä½¿ç”¨ Gorilla Mux

è¦å®‰è£…ä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`go get`

å»å¼•æ“ç›–ä¸‹å–ç”¨ gitã€‚

åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½ æœ‰ä½ çš„`go.mod`å’Œ`main.go`æ–‡ä»¶è¿è¡Œ

```
go get github.com/gorilla/mux 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æŠŠä»£ç æ”¹æˆè¿™ä¸ª

```
package main

import (
    "log"
    "net/http"

    "github.com/gorilla/mux"
)

func home(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    switch r.Method {
    case "GET":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "get called"}`))
    case "POST":
        w.WriteHeader(http.StatusCreated)
        w.Write([]byte(`{"message": "post called"}`))
    case "PUT":
        w.WriteHeader(http.StatusAccepted)
        w.Write([]byte(`{"message": "put called"}`))
    case "DELETE":
        w.WriteHeader(http.StatusOK)
        w.Write([]byte(`{"message": "delete called"}`))
    default:
        w.WriteHeader(http.StatusNotFound)
        w.Write([]byte(`{"message": "not found"}`))
    }
}

func main() {
    r := mux.NewRouter()
    r.HandleFunc("/", home)
    log.Fatal(http.ListenAndServe(":8080", r))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çœ‹èµ·æ¥é™¤äº†ä¸€ä¸ªæ–°çš„å¯¼å…¥å’Œç¬¬ 32 è¡Œä¹‹å¤–ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰æ”¹å˜ã€‚

### HandleFunc HTTP æ–¹æ³•

ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨æˆ‘ä»¬çš„`HandleFunc`åšæ›´å¤šçš„äº‹æƒ…ï¼Œæ¯”å¦‚è®©æ¯ä¸ªå‡½æ•°å¤„ç†ä¸€ä¸ªç‰¹å®šçš„ HTTP æ–¹æ³•ã€‚

å®ƒçœ‹èµ·æ¥åƒè¿™æ ·

```
package main

import (
    "log"
    "net/http"

    "github.com/gorilla/mux"
)

func get(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusOK)
    w.Write([]byte(`{"message": "get called"}`))
}

func post(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusCreated)
    w.Write([]byte(`{"message": "post called"}`))
}

func put(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusAccepted)
    w.Write([]byte(`{"message": "put called"}`))
}

func delete(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusOK)
    w.Write([]byte(`{"message": "delete called"}`))
}

func notFound(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusNotFound)
    w.Write([]byte(`{"message": "not found"}`))
}

func main() {
    r := mux.NewRouter()
    r.HandleFunc("/", get).Methods(http.MethodGet)
    r.HandleFunc("/", post).Methods(http.MethodPost)
    r.HandleFunc("/", put).Methods(http.MethodPut)
    r.HandleFunc("/", delete).Methods(http.MethodDelete)
    r.HandleFunc("/", notFound)
    log.Fatal(http.ListenAndServe(":8080", r))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœä½ è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œå®ƒä»ç„¶ä¼šåšåŒæ ·çš„äº‹æƒ…ã€‚æ­¤æ—¶ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“ç”¨æ›´å¤šçš„ä»£ç è¡ŒåšåŒæ ·çš„äº‹æƒ…æ˜¯ä¸€ä»¶å¥½äº‹å—ï¼Ÿ

ä½†æ˜¯è¿™ä¹ˆæƒ³å§ã€‚æˆ‘ä»¬çš„ä»£ç å˜å¾—æ›´åŠ æ¸…æ™°ï¼Œå¯è¯»æ€§æ›´å¥½ã€‚

> ### æ¸…æ™°èƒœäºå·§å¦™
> 
> **æŠ¢é•¿æª**

### å­è·¯ç”±å™¨

```
func main() {
    r := mux.NewRouter()
    api := r.PathPrefix("/api/v1").Subrouter()
    api.HandleFunc("", get).Methods(http.MethodGet)
    api.HandleFunc("", post).Methods(http.MethodPost)
    api.HandleFunc("", put).Methods(http.MethodPut)
    api.HandleFunc("", delete).Methods(http.MethodDelete)
    api.HandleFunc("", notFound)
    log.Fatal(http.ListenAndServe(":8080", r))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é™¤äº†æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªå«åšå­è·¯ç”±å™¨çš„ä¸œè¥¿ä¹‹å¤–ï¼Œå…¶ä»–ä¸€åˆ‡éƒ½ä¿æŒä¸å˜ã€‚å½“æˆ‘ä»¬æƒ³è¦æ”¯æŒå¤šç§èµ„æºæ—¶ï¼Œå­è·¯ç”±å™¨éå¸¸æœ‰ç”¨ã€‚å¸®åŠ©æˆ‘ä»¬å¯¹å†…å®¹è¿›è¡Œåˆ†ç»„ï¼Œå¹¶é¿å…æˆ‘ä»¬é‡æ–°é”®å…¥ç›¸åŒçš„è·¯å¾„å‰ç¼€ã€‚

æˆ‘ä»¬å°† api è½¬ç§»åˆ°`api/v1`ã€‚è¿™æ ·ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»º api çš„ v2..

### è·¯å¾„å’ŒæŸ¥è¯¢å‚æ•°

```
package main

import (
    "fmt"
    "log"
    "net/http"
    "strconv"

    "github.com/gorilla/mux"
)

func get(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusOK)
    w.Write([]byte(`{"message": "get called"}`))
}

func post(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusCreated)
    w.Write([]byte(`{"message": "post called"}`))
}

func put(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusAccepted)
    w.Write([]byte(`{"message": "put called"}`))
}

func delete(w http.ResponseWriter, r *http.Request) {
    w.Header().Set("Content-Type", "application/json")
    w.WriteHeader(http.StatusOK)
    w.Write([]byte(`{"message": "delete called"}`))
}

func params(w http.ResponseWriter, r *http.Request) {
    pathParams := mux.Vars(r)
    w.Header().Set("Content-Type", "application/json")

    userID := -1
    var err error
    if val, ok := pathParams["userID"]; ok {
        userID, err = strconv.Atoi(val)
        if err != nil {
            w.WriteHeader(http.StatusInternalServerError)
            w.Write([]byte(`{"message": "need a number"}`))
            return
        }
    }

    commentID := -1
    if val, ok := pathParams["commentID"]; ok {
        commentID, err = strconv.Atoi(val)
        if err != nil {
            w.WriteHeader(http.StatusInternalServerError)
            w.Write([]byte(`{"message": "need a number"}`))
            return
        }
    }

    query := r.URL.Query()
    location := query.Get("location")

    w.Write([]byte(fmt.Sprintf(`{"userID": %d, "commentID": %d, "location": "%s" }`, userID, commentID, location)))
}

func main() {
    r := mux.NewRouter()

    api := r.PathPrefix("/api/v1").Subrouter()
    api.HandleFunc("", get).Methods(http.MethodGet)
    api.HandleFunc("", post).Methods(http.MethodPost)
    api.HandleFunc("", put).Methods(http.MethodPut)
    api.HandleFunc("", delete).Methods(http.MethodDelete)

    api.HandleFunc("/user/{userID}/comment/{commentID}", params).Methods(http.MethodGet)

    log.Fatal(http.ListenAndServe(":8080", r))
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬çœ‹çœ‹ç¬¬ 36 è¡Œçš„`params`å‡½æ•°ã€‚æˆ‘ä»¬å¤„ç†è·¯å¾„å‚æ•°å’ŒæŸ¥è¯¢å‚æ•°ã€‚

æœ‰äº†è¿™ä¸ªä½ ç°åœ¨çŸ¥é“è¶³å¤Ÿçš„å±é™©ã€‚

# Bookdata API

åœ¨ Kaggle ä¸­ï¼Œæœ‰ä¸€ä¸ª bookdata çš„æ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä¸ªåŒ…å«å¤§çº¦ 13000 æœ¬ä¹¦çš„ csv æ–‡ä»¶ã€‚æˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥åˆ¶ä½œæˆ‘ä»¬è‡ªå·±çš„ bookdata apiã€‚

[books.csv](https://raw.githubusercontent.com/moficodes/rest-api-with-go/master/gitbook/.gitbook/assets/books.csv)

ä½ å¯ä»¥çœ‹çœ‹â˜çš„æ¡£æ¡ˆğŸ¼é‚£é‡Œã€‚

### å…‹éš†å›è´­

è®©æˆ‘ä»¬å¼€å§‹å§ã€‚

åœ¨å•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­

```
git clone https://github.com/moficodes/bookdata-api.git 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### å·¡å›ä»£ç 

ä»£ç ä¸­æœ‰ä¸¤ä¸ªåŒ…ã€‚ä¸€ä¸ªå«åšæ•°æ®å­˜å‚¨ï¼Œä¸€ä¸ªå«åšåŠ è½½å™¨ã€‚

Loader å¤„ç†å°†`csv`æ•°æ®è½¬æ¢æˆ bookdata å¯¹è±¡çš„æ•°ç»„ã€‚

æ•°æ®å­˜å‚¨å¤„ç†æˆ‘ä»¬å¦‚ä½•è®¿é—®æ•°æ®ã€‚ä¸»è¦æ˜¯ä¸€ä¸ªæœ‰ä¸€äº›æ–¹æ³•çš„æ¥å£ã€‚

### è¿è¡Œ app

ä»å›è´­çš„æ ¹æœ¬

è¿è¡Œ

```
go run . 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### ç«¯ç‚¹

è¯¥åº”ç”¨ç¨‹åºæœ‰å‡ ä¸ªç«¯ç‚¹

æ‰€æœ‰ api ç«¯ç‚¹éƒ½å¸¦æœ‰å‰ç¼€`/api/v1`

è¦åˆ°è¾¾ä»»ä½•ç«¯ç‚¹ï¼Œè¯·ä½¿ç”¨`baseurl:8080/api/v1/{endpoint}`æˆ–

```
Get Books by Author
"/books/authors/{author}" 
Optional query parameter for ratingAbove ratingBelow limit and skip

Get Books by BookName
"/books/book-name/{bookName}"
Optional query parameter for ratingAbove ratingBelow limit and skip

Get Book by ISBN
"/book/isbn/{isbn}"

Delete Book by ISBN
"/book/isbn/{isbn}"

Create New Book
"/book" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## å°†åº”ç”¨éƒ¨ç½²åˆ°äº‘

è¿™ä¸€æ­¥æ˜¯å®Œå…¨å¯é€‰çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³åœ¨äº‘ä¸­çš„æŸä¸ªåœ°æ–¹è¿è¡Œ go åº”ç”¨ç¨‹åºï¼ŒIBM Cloud æœ‰ä¸€ä¸ªä½¿ç”¨ Cloud Foundry çš„ä¼˜ç§€ paas è§£å†³æ–¹æ¡ˆã€‚

å¦‚æœä½ æƒ³è·Ÿç€å»

*   [ç‚¹å‡»æ­¤å¤„å¼€å§‹](https://cloud.ibm.com/registration?cm_mmc=Email_Events-_-Developer_Innovation-_-WW_WW-_-advocates:roger-osorio,eherrertitle:buildyourfirstapiwithgolang-newyorkcity-08212019eventid:5d48e3b2c60e6be4b7305a2edate:Aug2019type:workshopteam:global-devadvgrp-newyorkcity:newyorkcitycountry:unitedstates&cm_mmca1=000019RS&cm_mmca2=10004805&cm_mmca3=M99938765&eventid=5d48e3b2c60e6be4b7305a2e&cvosrc=email.Events.M99938765&cvo_campaign=000019RS)
*   å®‰è£… [IBM Cloud CLI](https://cloud.ibm.com/docs/cli?topic=cloud-cli-install-ibmcloud-cli#shell_install)

ä¸€æ—¦æ‚¨æœ‰äº† IBM Cloud å¸æˆ·å¹¶å®‰è£…äº† IBM Cloud CLIï¼Œ

ä»ç»ˆç«¯

```
ibmcloud login 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
ibmcloud target --cf 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰“å¼€å…‹éš†åº“æ ¹ç›®å½•ä¸‹çš„`manifest.yaml`ã€‚

æŠŠåº”ç”¨ç¨‹åºçš„åå­—æ”¹æˆä½ å–œæ¬¢çš„åå­—ã€‚æ›´æ”¹åï¼Œæ–‡ä»¶åº”è¯¥çœ‹èµ·æ¥åƒè¿™æ ·

```
---
applications:
- name: <your-app-name>
  random-route: true
  memory: 256M
  env:
    GOVERSION: go1.12
    GOPACKAGENAME: bookdata-api
  buildpack: https://github.com/cloudfoundry/go-buildpack.git 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åä»æ ¹å›è´­è¿è¡Œ

```
ibmcloud cf push 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç­‰å‡ åˆ†é’Ÿï¼Œç§ï¼å®ƒåº”è¯¥åœ¨è¿è¡Œã€‚

æŸ¥æ‰¾æ‚¨çš„åº”ç”¨ç¨‹åºç½‘å€

```
ibmcloud cf apps 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºæ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸” URL ä¹Ÿåœ¨é‚£é‡Œã€‚

ä»è¿™ä¸ªç½‘å€ä½ å¯ä»¥æµ‹è¯•å‡ºæ‰€æœ‰çš„ç«¯ç‚¹ä»ç„¶å·¥ä½œã€‚

## æµ‹è¯•

å¯ä»¥æµ‹è¯•æˆ‘çš„è·‘æ­¥ app[mofi-golang-api-demo-appreciative-antelope.mybluemix.net](https://mofi-golang-api-demo-appreciative-antelope.mybluemix.net)(è¿™é‡Œæ²¡æœ‰å‰ç«¯ï¼Œè¯•ä¸€ä¸ªç«¯ç‚¹)

å¦‚æœä½ æƒ³çœ‹ JK ç½—ç³å†™çš„æ‰€æœ‰ä¹¦

```
https://mofi-golang-api-demo-appreciative-antelope.mybluemix.net/api/v1/books/authors/rowling 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶ ping æˆ‘ [@moficodes](https://twitter.com/moficodes) ã€‚