# NGConf 2019 -ä¸æ˜¯æ¯ä¸ªåº”ç”¨éƒ½æ˜¯ SPA

> åŸæ–‡:[https://dev . to/angular/ng conf-2019-not-every-app-is-a-spa-e84](https://dev.to/angular/ngconf-2019-not-every-app-is-a-spa-e84)

## [](#disclaimer)å…è´£å£°æ˜

è¿™æ˜¯æˆ‘ä¸ªäººå¯¹ ngconf ä¼šè®®çš„æ€»ç»“ã€‚è™½ç„¶æˆ‘ç”¨è‡ªå·±çš„è¯æ€»ç»“è¿™äº›ä¸œè¥¿ï¼Œä½†æ‰€ä½¿ç”¨çš„ææ–™ï¼Œå¦‚å›¾åƒã€å›¾è¡¨ã€æºä»£ç ç¤ºä¾‹éƒ½ä¸æ˜¯æˆ‘è‡ªå·±çš„ã€‚å…¶ä¸­å¤§éƒ¨åˆ†æ¥è‡ª Youtube è§†é¢‘æˆ–å„åœºä¼šè®®å‘è¨€äººçš„å¹»ç¯ç‰‡ã€‚

## [](#other-sessions)å…¶ä»–æ—¶æ®µï¼Ÿ

è¿™ç¯‡æ–‡ç« æ˜¯ä»[æˆ‘çš„åšå®¢](https://juristr.com/blog)äº¤å‰å‘å¸ƒçš„ã€‚å¦‚æœä½ æƒ³é˜…è¯»åŸæ–‡ï¼Œä¹ŸåŒ…æ‹¬å…¶ä»–ä¼šè®®ï¼Œå‰å¾€[åŸæ–‡](https://juristr.com/blog/2019/05/Angular-8-and-the-Future-NGConf-2019-Roundup/?utm_source=devto&utm_medium=crosspost)ã€‚

åœ¨ twitter ä¸Šå…³æ³¨æˆ‘ã€‚

## [](#not-every-app-is-a-spa)ä¸æ˜¯æ¯ä¸ª App éƒ½æ˜¯ SPA

*ç½—å¸ƒÂ·æ²ƒé©¬å°”å¾·*

Rob çš„ç›®æ ‡æ˜¯ Igor æåˆ°çš„å…³äºå½“å‰æ­£åœ¨é‡‡ç”¨çš„é¢†åŸŸ Angular apps çš„å›¾è¡¨ã€‚

[![](../Images/5de2e2a05a96d54105ab5c5c7c7f1be6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--dAw9uMNA--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-graph-angular-adoption.png)

å±•æœ›æœªæ¥ï¼Œå›¢é˜Ÿçš„ç›®æ ‡æ˜¯ç„å‡†è¯¥å›¾ä¸­ç¼ºå¤±çš„ä¸¤æ¡è¾¹ã€‚

### [](#smallmedium-apps-demos-edu-apps)ä¸­å°å‹åº”ç”¨ã€æ¼”ç¤ºã€Edu åº”ç”¨

[![](../Images/68801acb553f9036c3acf990d85d0eb6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Jtfgs-bW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-graph-small-apps.png)

é’ˆå¯¹å›¾çš„å·¦ä¾§ï¼Œä¹Ÿå°±æ˜¯ä¸­å°å‹åº”ç”¨ç¨‹åºæ‰€åœ¨çš„åœ°æ–¹ï¼Œç­”æ¡ˆè‚¯å®šæ˜¯è§’å…ƒç´ ã€‚

[![](../Images/ecd2ac5a6f2cdaf2f9d96fff140b0c9d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--LmQEow2c--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-angular-elements.png)

å¦‚æœè¿™å¯¹ä½ æ¥è¯´å¬èµ·æ¥å¾ˆæ–°é²œï¼Œ[çœ‹çœ‹æˆ‘çš„ç›¸å…³æ–‡ç« ](https://juristr.com/blog/2019/04/intro-to-angular-elements/)ã€‚

æ··åˆç¯å¢ƒä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå…¶ä¸­è§’å…ƒç´ éå¸¸é€‚åˆ:

*   è®¸å¤šä¸åŒçš„æ¡†æ¶
*   ä¸æ˜¯æ¯ä¸ªäººéƒ½å¯ä»¥ä»ç»¿åœ°å¼€å§‹
*   è°·æ­Œä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜(Angularï¼ŒAngularJSï¼ŒDartï¼ŒGWTï¼ŒPolymerï¼Œ...)
*   åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ä¸Šè¿è¡Œçš„è¿·ä½ åº”ç”¨ç¨‹åº
*   NgUpgrade

åœ¨è§’åº¦å…ƒç´ çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå°†å•ä¸ªç»„ä»¶æ†ç»‘ä¸ºè§’åº¦å…ƒç´ çš„æ³¨å†Œè¿‡ç¨‹å½“å‰ä¸º(< Angular v7) still quite verbose:

```
@NgModule({
  imports: [BrowserModule, CommonModule],
  declarations: [HelloWorld],
  entryComponents: [HelloWorld]
})
class HelloWorldModule {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åéœ€è¦æ³¨å†Œä¸ºè§’å…ƒç´ :

```
platformBrowser()
  .bootstrapModule(HelloWorldModule)
  .then(({injector}) => {
    const HelloWorldElement = createCustomElement(HelloWorld, {injector});
    customElements.define('hello-world', HelloWorldElement);
  }); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è‰¾è–‡ä¼šæœ‰ä»€ä¹ˆæ”¹å˜å—ï¼Ÿ

[![](../Images/1c8d915574b0a58ebc88c68a1143cbc0.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--T0tYxLlw--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-elements-with-ivy.png)

åœ¨ Ivy ä¸­å‘ˆç°ç»„ä»¶çš„æœ€ç®€å•æ–¹å¼å¦‚ä¸‹:

```
import { Component, Input, Output, renderComponent } from '@angular/core';

@Component({
  selector: 'hello-world',
  template: `...`
})
class HelloWorld {
  @Input() name: string;
  @Output() nameChange = new EventEmitter();
  changeName = () => this.nameChange.emit(this.name);
}

renderComponent(HelloWorld); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®©è¿™æˆä¸ºå¸¸æ˜¥è—¤ä¸­çš„æ£±è§’å…ƒç´ å‘¢ï¼ŸRob åœ¨èˆå°ä¸Šå±•ç¤ºäº†å®ƒçš„æ ·å­ã€‚

```
import { renderComponent } from '@angular/core';
import { HelloWorld } from './hello-world.component';

// manually define the host rather than let Angular look for it
// then pass it as a 2nd argument to the renderComponent
const host = document.querySelector('hello-world');

renderComponent(HelloWorld, { host });

// create a custom element using the native browser API
class HelloWorldElement extends HTMLElement {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯ç¬¬ä¸€æ­¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ¬åœ°æµè§ˆå™¨ API åˆ›å»ºä¸€ä¸ªå®šåˆ¶å…ƒç´ ï¼Œå¹¶ä»é‚£é‡Œè°ƒç”¨`renderComponent`ã€‚

```
import { renderComponent } from '@angular/core';
import { HelloWorld } from './hello-world.component';

// create a custom element using the native browser API
class HelloWorldElement extends HTMLElement {
  component: HelloWorld;
  constructor()  {
    super();
    // associate "this" as the host element
    this.component = renderComponent(HelloWorld, { host: this })
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•ä¼ é€’`this`(è¿™æ˜¯è‡ªå®šä¹‰å…ƒç´ å®ä¾‹ï¼Œä½œä¸ºæ¸²æŸ“å‡½æ•°çš„å®¿ä¸»)ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ ç®€å•åŒ…è£…çš„å±æ€§ã€‚

```
import { renderComponent, detectChanges } from '@angular/core';
import { HelloWorld } from './hello-world.component';

// create a custom element using the native browser API
class HelloWorldElement extends HTMLElement {
  component: HelloWorld;
  constructor()  {
    super();
    // associate "this" as the host element
    this.component = renderComponent(HelloWorld, { host: this })
  }

  set name(value) {
    this.component.name = value;
    detectChangs(this.component);
  }
  get name() {
    return this.component.name;
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`detectChanges`å¯ä»¥ç›´æ¥ä» Angular å¯¼å…¥ã€‚è¿™åªæ˜¯ä¸€ä¸ªå‡½æ•°ğŸ’ª(ä¸ä¸€å®šéœ€è¦ DI æ¥æ³¨å…¥`ChangeDetectorRef`ç­‰..)!

è¦æ‹¥æœ‰å±æ€§ï¼Œæˆ‘ä»¬åªéœ€ç»§ç»­ä½¿ç”¨åŸç”Ÿæµè§ˆå™¨ APIã€‚

```
import { renderComponent, detectChanges } from '@angular/core';
import { HelloWorld } from './hello-world.component';

// create a custom element using the native browser API
class HelloWorldElement extends HTMLElement {
  static observedAttributes = ['name'];
  component: HelloWorld;
  constructor()  {
    super();
    // associate "this" as the host element
    this.component = renderComponent(HelloWorld, { host: this })
  }

  attributeChangedCallback(attr, oldValue, newValue) {
    this.name = newValue;
  }

  set name(value) {...}
  get name() {...}
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™åªæ˜¯ä¸ºäº†å±•ç¤ºç”¨ Ivy è‡ªå·±æ„å»ºå®ƒæ˜¯å¤šä¹ˆå®¹æ˜“ã€‚ä½ ä¸å¿…æ¯æ¬¡éƒ½è¿™æ ·ã€‚æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼ŒIvy çš„æƒ…å†µæ˜¯è¿™æ ·çš„:

```
import { withNgComponent } from '@angular/elements';
import { HelloWorld } from './hello-world.component';

// create a Custom Element that wraps the Angular Component
const HelloWorldElement = withNgComponent(HelloWorld);

// register it
customElements.define('hello-world', HelloWorldElement); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ²¡æœ‰å¹³å°ï¼Œæ²¡æœ‰æ¨¡å—ğŸ‰ ğŸ‰å½“ç„¶ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œæ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨æ³¨å°„å™¨:

```
...
// create a Custom Element that wraps the Angular Component
const HelloWorldElement = withNgComponent(HelloWorld, {injector});
... 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ‚¨å·²ç»æœ‰äº†ä¸€ä¸ªæƒ³è¦è½¬æ¢ä¸ºå…ƒç´ çš„è§’åº¦ç»„ä»¶ã€‚**ä½†æ˜¯å¦‚æœä½ ä¸æƒ³è¦ä¸€ä¸ªè§’åˆ†é‡ï¼Œè€Œåªæ˜¯ä¸€ä¸ªè§’å…ƒç´ å‘¢ï¼Ÿ**ğŸ¤”åŸºæœ¬ä¸Šä½ åªæ˜¯æƒ³è¦æœ‰è§’åº¦çš„æ¨¡æ¿ç³»ç»Ÿç»™ä½ çš„å¥½å¤„ã€‚ç°åœ¨çš„â€œé—®é¢˜â€æ˜¯æˆ‘ä»¬æœ‰äº†`NgModule`ï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨éœ€è¦å“ªäº›ä¾èµ–é¡¹ï¼Œå¹¶å¸®åŠ©å®ƒä¼˜åŒ–æœ€ç»ˆç»“æœã€‚ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼ŒIvy ä¸éœ€è¦ä¸€ä¸ª`NgModule`ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶éœ€è¦æœ‰ä¸€ç§æ–¹æ³•æ¥å‘Šè¯‰ç»„ä»¶å®ƒçš„æ¨¡æ¿ä¸­è¿˜æœ‰å“ªäº›æŒ‡ä»¤/ç»„ä»¶ã€‚ä¸€ä¸ª**æè®®** ( < <è¿™æ˜¯å›¢é˜Ÿå¸Œæœ›å¾—åˆ°åé¦ˆçš„æ—©æœŸæè®®)æ˜¯å…è®¸åœ¨`@Component`æ ‡ç­¾ä¸­ç›´æ¥æ³¨å†Œä¾èµ–é¡¹ï¼Œå°±åƒä½ å·²ç»å¯ä»¥ç”¨`providers`å’Œå·²ç»åœ¨`Angular RC4`ä¸­çš„ä¸€æ ·(æ˜¯çš„ï¼Œæˆ‘è®°å¾—ğŸ˜…).å¤§æ¦‚æ˜¯è¿™æ ·:

```
@Component({
  selector: 'hello-world',
  template: `...`,
  providers: [SomeService],
  deps: [SomeDirective, SomePipe]
})
class HelloWorld {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™è‚¯å®šæ›´å†—é•¿ï¼Œä½†å¦‚æœä½ æ„¿æ„ï¼Œä¹Ÿæ›´ç›´æ¥å’Œâ€œæ›´ç®€å•â€ã€‚ä¸ºäº†å®ç°åªæœ‰ä¸€ä¸ª ng å…ƒç´ (æ²¡æœ‰è§’åˆ†é‡)çš„æœ€ç»ˆç›®æ ‡ï¼Œå¯ä»¥çœ‹èµ·æ¥åƒè¿™æ ·(åŸºäºæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„å†…å®¹):

```
import { NgElement, withElement } from '@angular/elements';
...
@NgElement({
  selector: 'hello-world',
  template: `...`,
  providers: [SomeService],
  deps: [SomeDirective, SomePipe]
})
class HelloWorld extends withNgElement {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ç»™äº†ä½ **ä¸€ä¸ªæ²¡æœ‰è§’åˆ†é‡**çš„è§’å…ƒç´ ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚æ„å»ºè®¾è®¡ç³»ç»Ÿæ—¶ï¼Œè¿™å¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚

### [](#scaling-up-or-what-is-project-angular-photon)æŒ‰æ¯”ä¾‹æ”¾å¤§â€”â€”æˆ–è€…ä»€ä¹ˆæ˜¯â€œè§’å…‰å­â€é¡¹ç›®ï¼Ÿ

å›¾è¡¨çš„å¦ä¸€è¾¹:æ‰©å¤§è§„æ¨¡ã€‚

[![](../Images/5d23a879d9a82f92899fe08b173864d6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HqLByS9L--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-graph-angular-scaleup.png)

åœ¨è¿™ç§èƒŒæ™¯ä¸‹(åœ¨ä¸»é¢˜æ¼”è®²æœŸé—´-è¯·å‚é˜…è¿›ä¸€æ­¥çš„å†…å®¹)ï¼Œå‡ºç°äº†* *è§’å…‰å­è¿™ä¸ªåç§°ã€‚é‡è¦çš„:

[![](../Images/8c02aca39b09cf63e00840a99b7a88ad.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0VAd5uif--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-photon.png)

è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„ç ”ç©¶é¡¹ç›®ï¼Œæ—¨åœ¨â€œå†³å®šå¦‚ä½•ä¸ºä¸‹ä¸€ä»£ Angular å¼€å‘äººå‘˜æ„å»ºåˆé€‚çš„å·¥å…·â€ã€‚è¿™æ˜¯ä¸€ä¸ªåˆä½œé¡¹ç›®

*   è°·æ­Œè´­ç‰©å¿«é€’(ç”¨ Angular æ„å»º)
*   Wiz

[![](../Images/e70f7c4089c560b9e4e0be035a9f8466.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Jc2zc9SF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-collaboration.png)

[![](../Images/45a48dee96bb50e2366104176a6c79e5.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--dlnBM2Lu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://juristr.com/blog/assets/imgs/ngconf2019/rob-what-wanted.png)

æŒ‰éœ€åŠ è½½ç»„ä»¶æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„éƒ¨åˆ†ã€‚å…ˆç¹ä¸ºå¿«ï¼Œè¿™å¯èƒ½æ˜¯å®ƒçš„æ ·å­

```
import { withLazyNgComponent } from '@angular/elements';

// create a Custom Element that wraps the Angular Component
const HelloWorldElement = withLazyNgComponent(() => import('./hellow-world.component'));

// register it
customElements.define('hello-world', HelloWorldElement); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨æ„`withLazyNgComponent`,å®ƒåªåœ¨çœŸæ­£éœ€è¦çš„æ—¶å€™è·å–å¿…è¦çš„è„šæœ¬ã€‚