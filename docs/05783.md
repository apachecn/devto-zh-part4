# RESTã€GraphQL å’Œ Graphback é€Ÿæˆç­#3: GraphQL

> åŸæ–‡:[https://dev . to/aero gear/technologies-that-changed-my-perception-of-software-development-MBM](https://dev.to/aerogear/technologies-that-changed-my-perception-of-software-development-mbm)

* * *

# [](#graphql)

<center>GraphQL</center>

* * *

GraphQL æ˜¯è„¸ä¹¦å‘æ˜çš„ä¸€ç§æŸ¥è¯¢è¯­è¨€ï¼Œæ˜¯ REST è®¾è®¡å’Œæ„å»º API çš„æ›¿ä»£æ–¹æ³•ã€‚Schema æ˜¯ä»»ä½• GraphQL æœåŠ¡å™¨çš„æ ¸å¿ƒï¼Œå®ƒæè¿°äº†å®¢æˆ·æœºå¯ç”¨çš„åŠŸèƒ½ã€‚æ¶æ„å…·æœ‰å®šä¹‰ä»¥ä¸‹å†…å®¹çš„ç±»å‹:

*   å®ä½“ä¹‹é—´çš„å…³ç³»â€”â€”åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯ç”¨æˆ·å’Œä»»åŠ¡ä¹‹é—´çš„å…³ç³»
*   å¯ä»¥ç”±å®¢æˆ·ç«¯æ‰§è¡Œçš„æ•°æ®æ“çºµå’Œæ“ä½œï¼Œåœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œè¿™äº›å°†æ˜¯ä¾‹å¦‚è·å–æ‰€æœ‰ç”¨æˆ·æˆ–æ‰€æœ‰ä»»åŠ¡çš„æŸ¥è¯¢ï¼Œä»¥åŠåˆ é™¤å’Œæ·»åŠ ç”¨æˆ·æˆ–ä»»åŠ¡çš„çªå˜ã€‚

ä¸ºäº†æ„å»ºæˆ‘ä»¬çš„ GraphQL æœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨â€œæ¨¡å¼ä¼˜å…ˆâ€çš„æ–¹æ³•ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯åœ¨å¼€å‘ä¸­ä¼˜å…ˆæ„å»ºæ¨¡å¼ã€‚å®ƒå…è®¸æˆ‘å¯è§†åŒ–å®ä½“ä¹‹é—´çš„æ•°æ®æµå’Œæˆ‘å¯èƒ½éœ€è¦çš„æŸ¥è¯¢/å˜åŒ–ï¼æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ Apollo framework for GraphQL serverï¼Œè¿™æ˜¯ä¸€ä¸ªå¸®åŠ©æˆ‘ä»¬å°† graph QL æ¨¡å¼è¿æ¥åˆ°èŠ‚ç‚¹æœåŠ¡å™¨çš„åº“ï¼Œä¸ express framework for REST ç›¸åŒã€‚

## [](#requirements)è¦æ±‚

*   [ä¼‘æ¯ 10 åˆ†é’Ÿ](https://dev.to/aerogear/technologies-that-changed-my-perception-of-software-development-34lm)å®Œæˆæˆ–ä»æˆ‘çš„[ä¼‘æ¯æ•™ç¨‹](https://github.com/MStokluska/REST-Tutorial) github åº“ä¸‹è½½ã€‚

## [](#lets-get-started)æˆ‘ä»¬å¼€å§‹å§

é¦–å…ˆï¼Œè€ƒè™‘æ¨¡å¼ï¼Œæˆ‘ä»¬çš„å®ä½“å°†ä¼šæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬è®¡åˆ’è¿”å›ä»€ä¹ˆæ•°æ®ï¼Ÿå®¢æˆ·éœ€è¦ä»€ä¹ˆï¼Ÿæƒ³è±¡ä¸€ä¸‹æˆ‘ä»¬çš„é¡¹ç›®ï¼Œæœ‰ä»»åŠ¡å’Œç”¨æˆ·ï¼Œæˆ‘ä»¬çš„ GraphQL ç±»å‹çœ‹èµ·æ¥ä¼šåƒè¿™æ ·:

```
type User {
    id: ID!
    firstName: String!
    lastName: String!
    title: String!
    email: String
}

type Task {
    id: ID!
    title: String!
    description: String!
    status: String!
    assignedTo: [User!]!
} 
```

æˆ‘ä»¬æ­£åœ¨å®šä¹‰ä¸¤ä¸ªå®ä½“ï¼Œä¸€ä¸ª`User`å’Œ`Task`å®ä½“ã€‚ä¸¤è€…éƒ½æœ‰ä¸åŒçš„å±æ€§å’Œè¿”å›ç±»å‹ã€‚å®¢æˆ·ç«¯å¯ä»¥è®¿é—®ä¸€ä¸ª`User`å¯¹è±¡æˆ–`Task`å¯¹è±¡ï¼Œä»é‚£é‡Œä»–å¯ä»¥è®¿é—®ä»»ä½•ç»™å®šçš„å±æ€§ï¼Œç„¶è€Œï¼Œ`Task`çš„`assignedTo`è¿”å›ä¸€ä¸ª`User`å¯¹è±¡ã€‚æ„Ÿå¹å·åªæ˜¯è¡¨ç¤º`Required`ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬çš„`assignedTo`ç¤ºä¾‹ä¸­â€”â€”è¿”å›ç±»å‹éœ€è¦æ˜¯`Users`çš„æ•°ç»„ç±»å‹ã€‚

*   åœ¨ç°æœ‰çš„æœåŠ¡å™¨é¡¹ç›®ä¸­ï¼Œä½¿ç”¨ npm æ·»åŠ ä»¥ä¸‹ä¾èµ–é¡¹:

```
$ npm install apollo-server-express graphql graphql-import 
```

*   æ¥ä¸‹æ¥ï¼Œç¼–è¾‘æˆ‘ä»¬çš„`index.js`æ–‡ä»¶ã€‚

```
const express = require('express');
const { ApolloServer } = require('apollo-server-express');
const schema = require('./schema');

const app = express();

app.use(express.json());

const server = new ApolloServer({ schema });

server.applyMiddleware({
  app,
  path: '/graphql',
});

const port = 4000;

app.listen(port, () => {
  console.log(`ğŸš€ Server is running at: http://localhost:${port}/graphql`);
}); 
```

æˆ‘ä»¬ä¸å†éœ€è¦ REST æ–¹æ³•ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åˆ é™¤å®ƒä»¬ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°† Apollo æœåŠ¡å™¨æ·»åŠ åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚ç„¶åï¼Œå°†ä¸€ä¸ªæ¨¡å¼(å°šæœªå®ç°)åº”ç”¨åˆ°æˆ‘ä»¬çš„ Apollo æœåŠ¡å™¨ï¼Œæœ€åï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸­é—´ä»¶åº”ç”¨åˆ°å®ƒï¼Œè¿™æ˜¯ express å’Œ path -ä¹Ÿç§°ä¸º- endpointã€‚

*   åœ¨æˆ‘ä»¬çš„`server`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`schema`çš„æ–°æ–‡ä»¶å¤¹
*   åœ¨`schema`æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªåä¸º`typeDefs.graphql`çš„æ–‡ä»¶ï¼Œå®ƒå°†ä¿å­˜æˆ‘ä»¬ä¸Šé¢æŒ‡å®šçš„ç±»å‹ã€‚ç²˜è´´ä»¥ä¸‹ä»£ç :

```
type User {
    id: ID!
    firstName: String!
    lastName: String!
    title: String!
    email: String
}

type Task {
    id: ID!
    title: String!
    description: String!
    status: String!
    assignedTo: [User!]!
} 
```

*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ ç±»å‹æŸ¥è¯¢â€”â€”å®ƒæ”¯æŒç»™å®šçš„æŸ¥è¯¢ï¼Œç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¿æŒç®€å•ï¼ŒåšæŒæˆ‘ä»¬çš„ä¸¤ä¸ªåŸºæœ¬æŸ¥è¯¢,`tasks`,å®ƒå…è®¸å®¢æˆ·ç«¯è®¿é—®æ‰€æœ‰ä»»åŠ¡çš„åˆ—è¡¨ï¼Œä»¥åŠ`users`,å®ƒå…è®¸è®¿é—®æ•´ä¸ªç”¨æˆ·æ•°ç»„ã€‚

```
type Query {
    tasks: [Task!]!
    users: [User!]!
} 
```

*   æ¥ä¸‹æ¥ï¼Œå°†å¦ä¸€ä¸ªåä¸º`resolvers.js`çš„æ–‡ä»¶æ·»åŠ åˆ°`schema`æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :

```
const { tasks, users } = require('../db');

const resolvers = {
  Query: {
    tasks() {
      return tasks;
    },

    users() {
      return users;
    },
  },
};

module.exports = resolvers; 
```

è§£æå™¨åªæ˜¯ä» typeDefs ä¸­è§£æç±»å‹å€¼çš„å‡½æ•°ã€‚å®ƒä»¬å¯ä»¥è¿”å›å€¼ï¼Œå¦‚å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ç­‰ã€‚ä¾‹å¦‚ï¼Œ`users`è§£æå™¨å¿…é¡»è¿”å›ä¸€ä¸ªæ•°ç»„`Users`ã€‚å®ƒä»¬ç±»ä¼¼äºæˆ‘ä»¬åœ¨ express ä¸­çœ‹åˆ°çš„ HTTP å¤„ç†å‡½æ•°ï¼Œå®ƒä»¬å®ç°ä¸šåŠ¡é€»è¾‘å¹¶è¿”å›ç»“æœã€‚

*   åœ¨`schema`æ–‡ä»¶å¤¹ä¸­åˆ›å»º`index.js`å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç :

```
const { importSchema } = require('graphql-import');
const { makeExecutableSchema } = require('graphql-tools');
const resolvers = require('./resolvers');
const typeDefs = importSchema('schema/typeDefs.graphql');

module.exports = makeExecutableSchema({ resolvers, typeDefs }); 
```

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«è§£æå™¨å’Œç±»å‹å®šä¹‰çš„å¯æ‰§è¡Œæ¨¡å¼ï¼Œå› æ­¤å®ƒå¯ä»¥åœ¨æˆ‘ä»¬çš„`index.js`
ä¸­ä½¿ç”¨

```
const express = require('express');
const { ApolloServer } = require('apollo-server-express');
const schema = require('./schema'); <-----------------------------

const app = express();

app.use(express.json());

const server = new ApolloServer({ schema });<---------------------

server.applyMiddleware({
  app,
  path: '/graphql',
});

const port = 4000;

app.listen(port, () => {
  console.log(`ğŸš€ Server is running at: http://localhost:${port}/graphql`);
}); 
```

*   æ‚¨ç°åœ¨å¯ä»¥ä¿å­˜æ‰€æœ‰æ›´æ”¹ï¼Œè¿è¡Œ`npm start`å¹¶å¯¼èˆªåˆ°`http://localhost:4000/graphql`ã€‚æ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹:

[![Playground](../Images/6829e7648695daa0ced7d7e870f9dce7.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--EJjUEZ3W--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/gaz5w352o1y0k8fxnbw6.png)

æ‚¨åˆšåˆšä»æ‚¨çš„ç¬¬ä¸€å° GraphQL æœåŠ¡å™¨ä¸Šå¯åŠ¨äº† GraphQL playgroundï¼åœ¨å·¦ä¾§çª—å£ä¸­ï¼Œæ‚¨å¯ä»¥å†™ä¸‹æ‚¨çš„æŸ¥è¯¢å’Œçªå˜ï¼Œè€Œå“åº”å°†æ˜¾ç¤ºåœ¨å³ä¾§ï¼è®©æˆ‘ä»¬è¯•ä¸€è¯•ï¼Œç¼–å†™æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæŸ¥è¯¢:

[![First Query](../Images/eee4d1c687f33ebcdc933403ffac3b19.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--pUidqr-f--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/c04ztnuycm9rl0q7pczu.png)

*   ç¬¬ 2 è¡Œ`query AnyNameOfQuery` -åœ¨è¿™é‡Œä½ ç®€å•åœ°æŒ‡å®šä½ æ˜¯å¦è¦ä½¿ç”¨æŸ¥è¯¢æˆ–å˜å¼‚ï¼Œå¹¶ä¸”ä½ å‘½åä½ çš„æŸ¥è¯¢/å˜å¼‚ã€‚
*   ç¬¬ 3 è¡Œ`tasks{`è¿™æ˜¯æˆ‘ä»¬åœ¨`typeDefs`æ–‡ä»¶ä¸­æŒ‡å®šçš„æŸ¥è¯¢åç§°:

```
tasks: [Task!]! 
```

*   ç¬¬ 4 & 5 è¡Œè¯´æ˜äº†æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯ä»€ä¹ˆã€‚æˆ‘ä»¬å·²ç»åœ¨ typeDefs ä¸­æŒ‡å®šï¼ŒæŸ¥è¯¢ä»»åŠ¡å°†è¿”å›ä¸€ä¸ªç”±`task`å¯¹è±¡ç»„æˆçš„æ•°ç»„ã€‚
*   ç‚¹å‡»æ“åœºä¸­é—´çš„æ’­æ”¾æŒ‰é’®ï¼Œæ‚¨åº”è¯¥ä¼šå¾—åˆ°ä»¥ä¸‹å“åº”:

[![First Response](../Images/29834107ce2264985f54d065aaeaffce.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--NvMyY_7i--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/nkkd90xqxyfghssgr5ny.png)

å¦‚æœæ‚¨åœ¨å·¦è¾¹çš„çª—å£ä¸­è¾“å…¥äº†ä¸æ­¢ä¸€ä¸ªæŸ¥è¯¢æˆ–å˜å¼‚ï¼Œé‚£ä¹ˆ play æŒ‰é’®ä¼šä¸ºæ‚¨æä¾›ä¸€ä¸ªé€‰é¡¹æ¥é€‰æ‹©æ‚¨æƒ³è¦æ‰§è¡Œçš„æŸ¥è¯¢/å˜å¼‚ã€‚

å½“æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢`task`æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®æ•´ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯èƒ½åªæƒ³è¦å®ƒçš„æŸä¸€éƒ¨åˆ†ï¼æ‰€ä»¥åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªä»ä¸€ä¸ªæ•°ç»„`tasks`ä¸­è¯·æ±‚äº†æ ‡é¢˜å’Œæè¿°ã€‚æ‚¨å¯èƒ½ä¼šæƒ³ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ typeDefs ä¸­é¢„å…ˆå‘½åçš„æŸ¥è¯¢ï¼Œä¸ºä»€ä¹ˆè¿˜è¦è®¾ç½®æŸ¥è¯¢çš„åç§°ã€‚
ç­”æ¡ˆæ˜¯â€”â€”æˆ‘ä»¬ä¸éœ€è¦ï¼ä½†æ˜¯æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨ä¸ºä¸€ä¸ªå®¢æˆ·å·¥ä½œï¼Œä½ æƒ³è®¿é—®ä»»åŠ¡ä¸¤æ¬¡ï¼Œä¸€æ¬¡ä½ åªå¯¹æ ‡é¢˜æ„Ÿå…´è¶£ï¼Œå¦ä¸€æ¬¡ä½ åªå¯¹æè¿°æ„Ÿå…´è¶£ï¼å‘½åæŸ¥è¯¢éå¸¸æœ‰ç”¨ã€‚

*   ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†`assignedTo`æ·»åŠ åˆ°æˆ‘ä»¬ç°æœ‰çš„æŸ¥è¯¢ä¸­ï¼Œè¿™æš‚æ—¶ä¸ä¼šèµ·ä½œç”¨ï¼Œä½†æˆ‘å¸Œæœ›æ‚¨å°è¯•ä¸€ä¸‹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è§£æå™¨çš„èŒè´£ã€‚

æ·»åŠ `assignedTo{`å¹¶ç‚¹å‡»`ctrl + space`ã€‚æ‚¨åº”è¯¥çœ‹åˆ° GraphQL å¯ä»¥ä¸ºæ‚¨è·å–çš„æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œæ‰€æœ‰è¿™äº›ä¿¡æ¯éƒ½æ¥è‡ªäºåœ¨`typeDefs`ä¸­æŒ‡å®šçš„ç±»å‹ã€‚

*   å‡è®¾æˆ‘ä»¬å¯¹ç”¨æˆ·çš„`firstName`å’Œ`lastName`æ„Ÿå…´è¶£ã€‚

[![AssignedTo](../Images/b017776c007b5b981e544a9492d583ec.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--zlTRUxeV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/hflmb09uk44obzjdpcrd.png)

ç‚¹å‡»æ’­æ”¾å¹¶...ä¸€ä¸ªé”™è¯¯ï¼ç°åœ¨æƒ³æƒ³æˆ‘ä»¬çš„è§£æå™¨å’Œç±»å‹å®šä¹‰:

```
const { tasks, users } = require('../db');

const resolvers = {
  Query: {
    tasks() {
      return tasks;
    },

    users() {
      return users;
    },
  },
};

module.exports = resolvers; 
```

å®ƒä¸å·¥ä½œçš„åŸå› æ˜¯æˆ‘ä»¬å¿…é¡»å®ç°ä¸€ä¸ªæ–°çš„è§£æå™¨æ¥è¿”å›ä»»åŠ¡è¢«åˆ†é…åˆ°çš„ç”¨æˆ·ã€‚

*   è®©æˆ‘ä»¬é€šè¿‡å‘è§£æå™¨æ·»åŠ ä»¥ä¸‹ä»£ç æ¥æŒ‡å®šæˆ‘ä»¬çš„ assignedTo åº”è¯¥åšä»€ä¹ˆ:

```
const resolvers = {

    Task: {
        assignedTo(task) {
            return users.filter(u => u.id === task.assignedTo);
        },
    },

    Query: {
        tasks() {
            return tasks;
        },

        users() {
            return users;
        },
    },
}; 
```

å› æ­¤ï¼Œå½“è®¿é—®`assignedTo`æ—¶ï¼Œæˆ‘ä»¬å°†è¿‡æ»¤ä¸€ä¸ªæ•°ç»„`users`å¹¶è¿”å›ä¸€ä¸ª`user`ï¼Œå®ƒå…·æœ‰ä¸`assignedTo`åŒ¹é…çš„`id`ã€‚

ç°åœ¨æˆ‘ä»¬çš„æŸ¥è¯¢åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨æ“åœºä¸Šç©ä¸€ä¼šå„¿æŸ¥è¯¢ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ GraphQLã€‚

*   æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å‘æˆ‘ä»¬çš„æœåŠ¡å™¨å†æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢â€”â€”å‡è®¾æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æœåŠ¡å™¨æ¥å—ä¸€ä¸ªç”¨æˆ·åå¹¶è¿”å›ä¸€ä¸ªåŒåçš„`User`å¯¹è±¡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¾‘æˆ‘ä»¬çš„`typeDefs.graphql`:

```
type Query {
    tasks: [Task!]!
    users: [User!]!
    userByName(firstName: String!): User!
} 
```

æ‰€ä»¥æˆ‘ä»¬æ–°çš„`userByName`æŸ¥è¯¢å°†æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ç»™æˆ‘ä»¬ã€‚

*   ç°åœ¨è¿›å…¥è§£æå™¨:

```
Query: {
        tasks() {
            return tasks;
        },

        users() {
            return users;
        },

        userByName(parent, args, context,){
            return users.filter(u => u.firstName === args.firstName)
        },
    }, 
```

æˆ‘ä»¬æ‰€åšçš„ç›¸å½“äº REST paramsï¼

*   ç°åœ¨é‡å¯æœåŠ¡å™¨ï¼Œåœ¨æ“åœºä¸Šæµ‹è¯•æˆ‘ä»¬çš„æ–°æŸ¥è¯¢:

[![Search for user by name](../Images/a63e3a3d49ddd586cde7516dab94f746.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--n6Hk9jH9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/cj0jobage6c0jmj9opwc.png)

æˆ‘è®¤ä¸ºå¯ç”¨å¦ä¸€ä¸ªæŸ¥è¯¢æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µï¼Œæ¯”å¦‚è¯´`findUserById`â€”â€”è‡ªå·±å°è¯•ä¸€ä¸‹å§ï¼

*   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªçªå˜ç±»å‹ï¼å¦‚æœæˆ‘ä»¬å¯ä»¥å°†ä»»åŠ¡æ·»åŠ åˆ°æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ï¼Œè¦å¯åŠ¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆç¼–è¾‘æˆ‘ä»¬çš„ typeDefs:

```
type Mutation {
    addTask(id: ID!, title: String!, description: String!, status: String!, assignedTo: ID!): Task!
} 
```

æˆ‘ä»¬çš„`addTask`å˜å¼‚æ¥å— idã€æ ‡é¢˜ã€æè¿°ã€çŠ¶æ€å’Œ assignedToï¼Œæ‰€æœ‰å­—æ®µéƒ½æ˜¯å¿…éœ€çš„ï¼Œæˆ‘ä»¬å¸Œæœ›è¿”å›æ–°çš„`task`ã€‚

*   ç°åœ¨æ¥è°ˆè°ˆè§£å†³æ–¹æ¡ˆ:

```
const { tasks, users } = require('../db');

const resolvers = {

    Task: {
        assignedTo(task) {
            return users.filter(u => u.id === task.assignedTo);
        },
    },

    Query: {
        tasks() {
            return tasks;
        },

        users() {
            return users;
        },

        userByName(parent, args, context,){
            return users.filter(u => u.firstName === args.firstName)
        }
    },
    Mutation: {
        addTask(parent, args, context) {
          const newTask = {
            id: args.id,
            title: args.title,
            description: args.description,
            status: args.status,
            assignedTo: args.assignedTo,
          };

            tasks.push(newTask);

            return newTask;
        },
    };
};

module.exports = resolvers; 
```

æˆ‘ä»¬åœ¨`addTask`çªå˜ä¸­æ‰€åšçš„æ˜¯:

*   åŸºäºä¼ å…¥çš„å‚æ•°åˆ›å»ºæ–°çš„`task`
*   å°†æ–°çš„`task`æ¨é€åˆ°`task`æ•°ç»„
*   è¿”å›æ–°åˆ›å»ºçš„`task`

ä½ å¯ä»¥é€šè¿‡å‚è§‚æ“åœºæ¥è§‚çœ‹æˆ‘ä»¬æ–°åˆ›é€ çš„çªå˜:

[![new task mutation](../Images/61068f9f79a79863c1b023aa2b55641a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--O84HGVjp--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/io6thze4xpnmaeootujl.png)

*   æˆ‘ä»¬çš„ç¬¬äºŒä¸ªçªå˜å°†æ˜¯`deleteTask`çªå˜ï¼Œæˆ‘ä»¬å†æ¬¡ä»`typeDefs.graphql`æ–‡ä»¶å¼€å§‹:

```
removeTask(id: ID!): [Task!]! 
```

*   æ¥ä¸‹æ¥æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ:

```
const resolvers = {

    Task: {
        assignedTo(task) {
            return users.filter(u => u.id === task.assignedTo);
        },
    },

    Query: {
        tasks() {
            return tasks;
        },

        users() {
            return users;
        },

        userByName(parent, args, context,){
            return users.filter(u => u.firstName === args.firstName)
        }
    },
    Mutation: {
        addTask(parent, args, context) {
          const newTask = {
            id: args.id,
            title: args.title,
            description: args.description,
            status: args.status,
            assignedTo: args.assignedTo,
          };

            tasks.push(newTask);

            return newTask;
        },

        removeTask(parent, args, context) {
            const taskIndex = tasks.findIndex(t => t.id === args.id);

            tasks.splice(taskIndex, 1);

            return tasks;
          },
    }
}; 
```

å°±åƒç¬¬ä¸€æ¬¡å˜å¼‚ä¸€æ ·ï¼Œåœ¨æ“åœºä¸Šè¯•ä¸€è¯•ï¼

## [](#summary)æ€»ç»“

æˆ‘æƒ³ç°åœ¨ä½ åº”è¯¥å¾ˆæ¸…æ¥šä½ å¯ä»¥ç”¨ GraphQL åšä»€ä¹ˆï¼Œä»¥åŠ GraphQL å’Œ REST ä¹‹é—´çš„åŒºåˆ«â€”â€”æˆ‘ä»¬ç»å†çš„æ‰€æœ‰è¿™äº›æŸ¥è¯¢å’Œå˜åŒ–éƒ½ä½¿ç”¨ä¸€ä¸ªç«¯ç‚¹ï¼Œå®¢æˆ·ç«¯å†³å®šä»–æƒ³ä»æœåŠ¡å™¨å¾—åˆ°ä»€ä¹ˆï¼Œè¿™å¯ä»¥æå¤§åœ°æé«˜æˆ‘ä»¬çš„å“åº”é€Ÿåº¦ï¼GraphQL çš„å¦ä¸€ä¸ªå·¨å¤§æˆåŠŸæ˜¯å®ƒå…è®¸åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­æ¥æ”¶è®¸å¤šèµ„æºï¼æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨æ‚¨çš„ä¸€ä¸ªé¡µé¢ä¸Šï¼Œæ‚¨éœ€è¦è®¿é—®ä»»åŠ¡å’Œç”¨æˆ·â€”â€”æ‚¨å¯ä»¥é€šè¿‡å‘é€ä¸€ä¸ªæŸ¥è¯¢æ¥å®ç°ï¼å¯¹æˆ‘æ¥è¯´ï¼Œç†è§£ GraphQL æ”¹å˜äº†æˆ‘çœ‹å¾…å®¢æˆ·æœº-æœåŠ¡å™¨æ¶æ„çš„æ–¹å¼â€”â€”ä»…ä»…æ˜¯å› ä¸ºæˆ‘å‘ç°å®ƒå¦‚æ­¤ç¥å¥‡å’Œå®¹æ˜“ä½¿ç”¨ï¼Œä»¥è‡³äºæˆ‘åæ‚”ç°åœ¨æ‰äº†è§£å®ƒï¼æˆ‘çœŸçš„å¸Œæœ›ä½ ä¹Ÿä¼šå–œæ¬¢å®ƒï¼

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç›´å¥”æœ€åä¸€éƒ¨åˆ†â€”â€”ç»å¯¹ä»¤äººå…´å¥‹çš„ Graphbackï¼