# Ruby å³æ—¶æ€§èƒ½æµ‹é‡

> åŽŸæ–‡:[https://dev . to/n 350071/ruby-instant-performance-measurement-2kcp](https://dev.to/n350071/ruby-instant-performance-measurement-2kcp)

## [](#parent-note)ðŸ”—çˆ¶æ³¨é‡Š

[![n350071 image](img/c9dd0fa7ece3b4a6c3e55d373898cd1e.png)](/n350071) [## æˆ‘çš„ Rails ç¬”è®°

### n350071ðŸ‡¯ðŸ‡µ9 æœˆ 11 æ—¥ 193 åˆ†é’Ÿé˜…è¯»

#rails](/n350071/my-rails-note-47cj)

## [](#situation)ðŸ¤”æƒ…å†µ

è®©æˆ‘ä»¬å‡è®¾ä½ æœ‰è¿™æ ·çš„ä»£ç ï¼Œä½ æƒ³æ¯”è¾ƒå®žä¾‹å’Œä¼šè¯çš„æ€§èƒ½ã€‚

```
def current_role
  return @current_role if @current_role
  # ommit..
  @current_role = session[CURRENT_ROLE].reload
end 
```

## [](#instant-solution)ðŸ¦„å³æ—¶è§£å†³æ–¹æ¡ˆ

ä½ å¯ä»¥ç”¨è¿™ä¸ªä»£ç æ¥è¡¡é‡ã€‚

```
def instant_performance(&target)
  start_time = Time.now
  yield
  Time.now - start_time
end 
```

## [](#usage-amp-examples)ðŸ‘ç”¨æ³•&ä¸¾ä¾‹

```
> instant_performance{ puts 'hello' }
hello
=> 3.9e-05

> instant_performance{ puts 'hello' }.class
hello
=> Float

> instant_performance{ @user }
=> 2.0e-06

> instant_performance{ @current_role }
=> 3.0e-06

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 41.0

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> Infinity

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 44.0

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 42.0

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 29.0

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 56.0

> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }

=> Infinity
> instant_performance{ user_session[CURRENT_ROLE] } / instant_performance{ @current_role }
=> 50.00000000000001
`` 
```