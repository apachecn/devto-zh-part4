# è®©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ ResizeObserverğŸ‘‹ğŸ¼

> åŸæ–‡ï¼š<https://dev.to/yashints/let-s-get-to-know-the-resizeobserver-lae>

[Resize Observer](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver) API æ˜¯å¦ä¸€ä¸ªå¾ˆæ£’çš„ JavaScript APIï¼Œå®ƒå¯ä»¥è®©ä½ åœ¨å…ƒç´ å¤§å°æ”¹å˜æ—¶å¾—åˆ°é€šçŸ¥ã€‚ä½†æ˜¯åœ¨å…ƒç´ å±‚é¢ä¸Šã€‚

## é‚£ä¸ªå•¥

å…ƒç´ å¤§å°å¯èƒ½æ”¹å˜çš„æœ€å¸¸è§æƒ…å†µæ˜¯è°ƒæ•´è§†å£å¤§å°æ—¶ã€‚æˆ–è€…å°±ç§»åŠ¨è®¾å¤‡è€Œè¨€ï¼Œæ–¹å‘æ”¹å˜ã€‚

åœ¨`ResizeObserver`ä¹‹å‰ï¼Œä½ å¿…é¡»è¿æ¥åˆ°`window.onresize`æˆ–è€…ä½¿ç”¨`window.resize`æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ çš„å¤§å°æ˜¯å¦æ”¹å˜äº†ã€‚è¿™æ˜¯éå¸¸ä½æ•ˆçš„ï¼Œå› ä¸ºå®ƒä¼šè§¦å‘å¦‚æ­¤å¤šçš„äº‹ä»¶ã€‚

è¿™ä¸ª API å¯ä»¥æ´¾ä¸Šç”¨åœºçš„å¦ä¸€ä¸ªåœºæ™¯æ˜¯å½“æ‚¨åŠ¨æ€åœ°æ·»åŠ /åˆ é™¤ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçˆ¶å…ƒç´ çš„å¤§å°å‘ç”Ÿå˜åŒ–ï¼Œè€Œä¸æ˜¯è§†å£ã€‚

> `ResizeObserver`æ¥å£æŠ¥å‘Šå¯¹`Element`çš„å†…å®¹æˆ–è¾¹ç•Œæ¡†ï¼Œæˆ–è€…`SVGElement`çš„è¾¹ç•Œæ¡†çš„å°ºå¯¸çš„æ”¹å˜ã€‚

å†…å®¹æ¡†æ˜¯å¯ä»¥æ”¾ç½®å†…å®¹çš„æ¡†ï¼Œå³è¾¹æ¡†å‡å»å¡«å……å’Œè¾¹æ¡†å®½åº¦ã€‚è¾¹æ¡†æ¡†åŒ…å«å†…å®¹ã€å¡«å……å’Œè¾¹æ¡†ã€‚

[![Box model](img/6f97b6c6d9ea8885dc17b68a2bc39d56.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--8G-QY1_Z--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zssfifqzp764x66mzmjj.png)

## è¯´å¤Ÿäº†ï¼Œç»™æˆ‘é‹ç ğŸ˜‰

æœ€ç®€å•çš„å½¢å¼æ˜¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„ API å®ä¾‹å¹¶å‘å…¶ä¼ é€’å›è°ƒæ¥ä½¿ç”¨`ResizeObserver`ã€‚

```
const myObserver = new ResizeObserver(entries => {
  // iterate over the entries, do something.
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æœ¬èº«ä¸ä¼šæœ‰å¤ªå¤§å¸®åŠ©ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨å®ä¾‹ä¸Šè°ƒç”¨`observe`æ–¹æ³•å¹¶ç»™å®ƒä¸€ä¸ªå…ƒç´ ï¼Œå®ƒå°†å¼€å§‹æ•æ‰å®ƒçš„å¤§å°å˜åŒ–å¹¶è°ƒç”¨ä½ çš„å›è°ƒå‡½æ•°ã€‚

```
const myEl = document.querySelector('.my-element');

myObserver.observe(myEl); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæ¯å½“æˆ‘çš„å…ƒç´ çš„å¤§å°æ”¹å˜æ—¶ï¼Œå®ƒå°†è§¦å‘å›è°ƒï¼Œç§ã€‚

## å›è°ƒè¾“å…¥å¯¹è±¡

å½“æ‚¨å°†å›è°ƒä¼ é€’ç»™ API çš„æ„é€ å‡½æ•°æ—¶ï¼Œæ‚¨å¾—åˆ°çš„æ˜¯å¦‚ä¸‹æ‰€ç¤ºçš„å¯¹è±¡æ•°ç»„:

[![ResizeObserver Entry](img/16875d2c454055aa8d9ade6f633156a1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--wUuUMbzI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/1hm7uy1rmo7i85gg12im.JPG)

å¯ä»¥çœ‹åˆ°ï¼Œä½ å¾—åˆ°çš„å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼Œ **`contentRect`** å’Œ`target`ã€‚ç›®æ ‡å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯ DOM å…ƒç´ æœ¬èº«ã€‚ä¸å…ƒç´ çš„`getBoundingClientRect`ä¸åŒï¼Œ **`contentRect`** ä¸Šçš„`width`å’Œ`height`å€¼ä¸åŒ…æ‹¬å¡«å……ã€‚

## æ¼”ç¤º

ä½¿ç”¨è¿™ä¸ª API å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œä»æ ¹æ®å…ƒç´ çš„å¤§å°æ”¹å˜å­—ä½“å¤§å°ï¼Œåˆ°åœ¨å¤§å°æ”¹å˜æ—¶æ”¹å˜æ ·å¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæˆ‘æ ¹æ®å…ƒç´ å¤§å°æ”¹å˜è¾¹ç•Œæ— çº¿ç”µçš„ä¾‹å­ã€‚è°ƒæ•´çª—å£å¤§å°ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆğŸ˜ã€‚

[https://codepen.io/yashints/embed/QWLaMej?height=600&default-tab=result&embed-version=2](https://codepen.io/yashints/embed/QWLaMej?height=600&default-tab=result&embed-version=2)

## æ¼”ç¤ºè§£é‡Š

æ¼”ç¤ºå¹¶ä¸å¤æ‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª`div`ï¼Œå®ƒæœ‰ä¸¤ä¸ªå­©å­:

```
<div class="boxes">
  <div class="box"></div>
  <div class="box"></div>
</div> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æ·»åŠ äº†ä¸€äº›æ ·å¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å˜åŒ–:

```
.boxes {
  display: flex;
  flex-wrap: wrap;
  width: 40vw;
  margin-bottom: 50px;
}
.box {
  height: 200px;
  flex-shrink: 1;
  flex-grow: 1;
  margin: 10px;
  box-sizing: border-box;
  border: 3px solid black;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†ï¼Œæˆ‘ä»¬æ·»åŠ æˆ‘ä»¬çš„å°ç‰‡æ®µè®©è§‚å¯Ÿè€…é€šçŸ¥æˆ‘ä»¬å˜åŒ–:

```
const ro = new ResizeObserver(entries => {
  for (let entry of entries) {
    entry.target.style.borderRadius =
      Math.max(0, 250 - entry.contentRect.width) +
      'px'
  }
})
console.log('horay');
// Only observe the 2nd box
ro.observe(
  document.querySelector('.box:nth-child(2)')
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨å›è°ƒä¸­ï¼Œæˆ‘ä»¬ç®€å•åœ°æ ¹æ®å…ƒç´ çš„å®½åº¦æ”¹å˜è¾¹ç•Œæ— çº¿ç”µï¼Œç§ã€‚

## æµè§ˆå™¨æ”¯æŒ

æµè§ˆå™¨æ”¯æŒå¤§å¤šæ•°ä¸»æµæµè§ˆå™¨éƒ½æœ‰ï¼Œæˆ‘ä»¬æœ‰ Chrome 64+ï¼ŒFirefox 69+ï¼ŒMicrosoft Edge 76 å’Œ Safari 13-TP æ”¯æŒ APIï¼Œä½†å¯¹ç§»åŠ¨æµè§ˆå™¨çš„æ”¯æŒå¾ˆå·®ã€‚

äº«å—æ¢ç´¢ API çš„ä¹è¶£ï¼Œç”¨å®ƒåšä¸€äº›å¾ˆé…·çš„äº‹æƒ…ğŸ˜ã€‚