# PowerShell é€šç”¨ä»ªè¡¨æ¿:åˆ¶ä½œäº¤äº’å¼ä»ªè¡¨æ¿

> åŸæ–‡:[https://dev . to/jcoelho/powershell-é€šç”¨-ä»ªè¡¨ç›˜-åˆ¶ä½œ-äº’åŠ¨-ä»ªè¡¨ç›˜-9kl](https://dev.to/jcoelho/powershell-universal-dashboard-making-interactive-dashboards-9kl)

# [](#powershell-universal-dashboard)PowerShell é€šç”¨ä»ªè¡¨ç›˜

PowerShell Universal Dashboard æ˜¯ä¸€ä¸ªéå¸¸é…·çš„ PowerShell æ¨¡å—ï¼Œä¹Ÿæ˜¯æˆ‘è§è¿‡çš„æœ€æœ‰è¶£çš„å¼€æºé¡¹ç›®ä¹‹ä¸€ã€‚
å®ƒå…è®¸ä½ åªä½¿ç”¨ PowerShell å‘½ä»¤ï¼Œä¸ºä½ çš„ It ç³»ç»Ÿåˆ›å»ºåŸºäºç½‘ç»œçš„ã€æ¼‚äº®çš„ã€äº¤äº’å¼çš„ä»ªè¡¨æ¿ã€‚
å®ƒéå¸¸é€‚åˆè®¾ç½®ç›‘æ§ä»ªè¡¨æ¿æ¥è·Ÿè¸ªæ‚¨çš„ç³»ç»Ÿã€‚

> æ¯ä¸ªç³»ç»Ÿç®¡ç†å‘˜éƒ½æ¢¦æƒ³åœ¨è‡ªå·±çš„åŠå…¬å®¤é‡Œæœ‰ä¸€ä¸ªå¤§å±å¹•ï¼Œå¯ä»¥çœ‹åˆ°ä»–ä»¬ç³»ç»Ÿçš„çŠ¶æ€ã€‚

[![monitor](../Images/e9e12dd3caa456832ba4d69834edb3b7.png)T2ã€‘](https://i.giphy.com/media/nxuFTiUbYR3SE/giphy.gif)

## [](#lets-build-one)æˆ‘ä»¬æ¥é€ ä¸€ä¸ªå§

è®©æˆ‘ä»¬è¨€å½’æ­£ä¼ ï¼Œè®¾ç½®ä¸€ä¸ªç®€å•çš„ä»ªè¡¨ç›˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥äº†è§£è¿™ä¸ªå·¥å…·äº†ã€‚
<sub>**(æ¥ä¸‹æ¥ä½ éœ€è¦ PowerShell 5+ï¼Œå¹¶æŒ‰ç…§[çš„æŒ‡ç¤ºå®‰è£…](https://docs.universaldashboard.io/getting-started)è¯¥æ¨¡å—ã€‚)**<sub>T7ã€‘</sub></sub>

åˆ›å»ºä¸€ä¸ª`dashboard.ps1`æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç :

```
$dashboard  =  New-UDDashboard  -Title  "DevTo Dashboard"  -Content{  New-UDHeading  -Text  "DevTo"  }  Start-UDDashboard  -Dashboard  $dashboard  -Port  1000  -AutoReload 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä»ªè¡¨æ¿å¯¹è±¡ï¼Œå¹¶å‘å…¶æ·»åŠ æ ‡é¢˜ã€‚
å¦‚æœåœ¨æ‰§è¡Œè¯¥æ–‡ä»¶åä¸€åˆ‡æ­£å¸¸ï¼Œæ‚¨åº”è¯¥å¾—åˆ°ä»¥ä¸‹è¾“å‡º:

```
Name       Port Running
---------       ---- -------
Dashboard2 1000    True 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨çš„ä»ªè¡¨æ¿åº”è¯¥åœ¨ [http://localhost:1000](http://localhost:1000) ä¸Šå¯ç”¨:

[![dashboard](../Images/b069409b6965e3938b272b2c335d339f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--lOZnvCPO--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/rqco7vwsux6857nv8yth.png)

ç°åœ¨è®©æˆ‘ä»¬è®©å®ƒæ›´é…·ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªä¸åŒçš„ä¸»é¢˜ï¼Œæˆ‘ç‰¹åˆ«å–œæ¬¢å†…ç½®çš„ Azure ä¸»é¢˜:

```
$theme  =  Get-UDTheme  -Name  'Azure'  $dashboard  =  New-UDDashboard  -Title  "DevTo Dashboard"  -Theme  $theme  -Content{  New-UDHeading  -Text  "DevTo"  }  ... 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨é…·å¤šäº†ï¼Œå¯¹å§ï¼Ÿ
[![azure theme](../Images/b789e380df34fbc78b336ea29dfe5c79.png)T3ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Z8M0CLCN--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/hh00mjohwrc2s1vqzkic.png)

## [](#monitoring)ç›‘æ§

PowerShell Universal Dashboard æœ‰ä¸€ä¸ªåä¸º [monitor](https://docs.universaldashboard.io/components/monitors) çš„ç»„ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å›¾è¡¨ï¼Œå¯ä»¥éšç€æ—¶é—´çš„æ¨ç§»è·Ÿè¸ªæ•°æ®ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥ç»˜åˆ¶ CPU æˆ–å†…å­˜çš„ä½¿ç”¨æƒ…å†µã€‚

```
$theme  =  Get-UDTheme  -Name  'Azure'  $dashboard  =  New-UDDashboard  -Title  "DevTo Dashboard"  -Theme  $theme  -Content{  New-UdMonitor  -Title  "CPU (% processor time)"  -Type  Line  -DataPointHistory  20  -RefreshInterval  10  -ChartBackgroundColor  '#80FF6B63'  -ChartBorderColor  '#FFFF6B63'  -Endpoint  {  try  {  Get-Counter  '\Processor(_Total)\% Processor Time'  -ErrorAction  SilentlyContinue  |  Select-Object  -ExpandProperty  CounterSamples  |  Select-Object  -ExpandProperty  CookedValue  |  Out-UDMonitorData  }  catch  {  0  |  Out-UDMonitorData  }  }  }  Start-UDDashboard  -Dashboard  $dashboard  -Port  1000  -AutoReload 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œåšçš„æ˜¯ä½¿ç”¨ [Get-Counter cmdlet](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-counter?view=powershell-5.1) ä» Windows æ€§èƒ½ç›‘æ§å·¥å…·ä¸­è·å–å®æ—¶æ•°æ®ï¼Œç„¶åé€šè¿‡`Out-UDMonitorData`å°†è¿™äº›ä¿¡æ¯è½¬æ¢ä¸ºç›‘æ§å™¨å¯è¯»çš„æ•°æ®ã€‚

**Un*x ç”¨æˆ·**:è¿™ä¸ªç‰¹å®šçš„å‘½ä»¤åªèƒ½åœ¨ **Windows** ä¸Šè¿è¡Œï¼Œæ‰€ä»¥ä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ªä¸åŒçš„ç­–ç•¥æ¥è·å–ä½ çš„ CPU æ•°æ®ã€‚
ä¹Ÿè®¸å¯ä»¥å°è¯•ä½¿ç”¨`sysstat`åŒ…ä¸­çš„`mpstat`å‘½ä»¤ï¼Œç„¶åç”¨ Powershell è§£ææ•°æ®ã€‚

## [](#charts)å›¾è¡¨

å¦ä¸€ä¸ªçœŸæ­£æœ‰ç”¨çš„ç»„ä»¶æ˜¯[å›¾è¡¨](https://docs.universaldashboard.io/components/data-visualizations/charts)ã€‚ä½ å¯ä»¥å°†å„ç§æ•°æ®æ˜¾ç¤ºåœ¨**æ¡**ã€**çº¿**ã€**åœ†ç¯å›¾**æˆ–**é¥¼å›¾**ä¸­ã€‚å®ƒä»¬éå¸¸æ˜“äºå®šåˆ¶å’Œä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”¨ [Chart.js åº“](https://www.chartjs.org/docs/latest/)æ„å»ºçš„ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åœ†ç¯å›¾æ¥æ˜¾ç¤ºæ‚¨ä½¿ç”¨çš„å’Œå¯ç”¨çš„ç£ç›˜ç©ºé—´:

```
$theme  =  Get-UDTheme  -Name  'Azure'  $dashboard  =  New-UDDashboard  -Title  "DevTo Dashboard"  -Theme  $theme  -Content{  New-UDChart  -Title  "Disk Space"  -Type  Doughnut  -RefreshInterval  $refreshRate  -Endpoint  {  try  {  Get-CimInstance  -ClassName  Win32_LogicalDisk  |  Where-Object  {$_.DriveType  -eq  '3'}  |  Select-Object  -First  1  -Property  DeviceID,Size,FreeSpace  |  ForEach-Object  {  @([PSCustomObject]@{  Label  =  "Used Space"  Data  =  [Math]::Round(($_.Size  -  $_.FreeSpace)  /  1GB,  2);  },  [PSCustomObject]@{  Label  =  "Free Space"  Data  =  [Math]::Round($_.FreeSpace  /  1GB,  2);  })  |  Out-UDChartData  -DataProperty  "Data"  -LabelProperty  "Label"  -BackgroundColor  @("#80FF6B63","#8028E842")  -HoverBackgroundColor  @("#80FF6B63","#8028E842")  -BorderColor  @("#80FF6B63","#8028E842")  -HoverBorderColor  @("#F2675F","#68e87a")  }  }  catch  {  0  |  Out-UDChartData  -DataProperty  "Data"  -LabelProperty  "Label"  }  }  }  Start-UDDashboard  -Dashboard  $dashboard  -Port  1000  -AutoReload 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨ä»ªè¡¨æ¿ä¸Šè¿æ¥ç›‘è§†å™¨å’Œå›¾è¡¨ã€‚è¿™æ˜¯ä½ çš„ä»ªè¡¨æ¿ç°åœ¨åº”è¯¥çœ‹èµ·æ¥çš„æ ·å­ã€‚å¾ˆé…·çš„åŒˆå¥´äººï¼ŸğŸ˜ƒ

[![](../Images/577d72d235c7e427b5ea8800429aa8cb.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--CyNfS1An--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/yf24d0vspd7h7shh8zeo.png)

**Un*x ç”¨æˆ·**:åŒæ ·ï¼Œè¿™åªé€‚ç”¨äº Windowsï¼Œä½†æ˜¯ä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å°†å…¶åº”ç”¨äº Un*x ç³»ç»Ÿã€‚

ç°åœ¨ä½ çŸ¥é“äº†ï¼ä¸€ä¸ªå¾ˆé…·å¾ˆå¥½çœ‹çš„ä»ªè¡¨æ¿ã€‚ç°åœ¨ç»™ä½ è‡ªå·±å¼„ä¸€ä¸ªå¤§å±å¹•æŒ‚åœ¨å¢™ä¸Šå¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚

## [](#explore)æ¢ç´¢

è¿™äº›ä¾‹å­åªæ˜¯è¿™ä¸ªæ¡†æ¶æ‰€èƒ½åšçš„ä¸€å°éƒ¨åˆ†ã€‚æ‚¨è¿˜å¯ä»¥æ„å»ºç®€å•çš„ REST APIï¼ŒåŠ¨æ€æ—‹è½¬å¤šä¸ªé¡µé¢ï¼Œå¡«å†™è¾“å…¥è¡¨å•å’Œè®¸å¤šå…¶ä»–ç»„ä»¶ã€‚

ä½ èƒ½åšçš„æœ€å¥½çš„äº‹æƒ…æ˜¯è‡ªå·±æ£€æŸ¥ï¼Œä»–ä»¬æœ‰å¾ˆå¥½çš„æ–‡æ¡£ã€‚

æˆ‘å¸Œæœ›æ‚¨å’Œæˆ‘ä¸€æ ·è§‰å¾—è¿™ä¸ªå·¥å…·æœ‰è¶£ä¸”æœ‰ç”¨ã€‚

**ä½ è§‰å¾—è¿™ä¸ª PowerShell æ¨¡å—æ€ä¹ˆæ ·ï¼Ÿå¦‚æœä½ ç”¨è¿‡è¿™ä¸ªå·¥å…·ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘å¦‚ä½•ä½¿ç”¨:)**