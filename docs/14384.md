# ä½¿ç”¨ Google Auth çš„ç¤¾äº¤ç™»å½•

> åŸæ–‡:[https://dev . to/ogwurjohnson/social-logins-with-Google-auth-4e 15](https://dev.to/ogwurujohnson/social-logins-with-google-auth-4e15)

> å£°æ˜:æˆ‘å»ºè®®ä½ è€å¿ƒç­‰å¾…ï¼Œå› ä¸ºæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•è½»æ¾åœ°å°† Google Auth æ— ç¼é›†æˆåˆ° react åº”ç”¨ç¨‹åºä¸­ã€‚

éšç€ç»Ÿä¸€è®¤è¯ç³»ç»Ÿçš„å‡ºç°ï¼Œå¦‚è„¸ä¹¦ã€è°·æ­Œã€Github ç™»å½•ï¼Œäººä»¬å€¾å‘äºä½¿ç”¨è¿™äº›æ–¹æ³•åœ¨ä»»ä½•å…·æœ‰è¿™ç§è®¤è¯æœåŠ¡çš„å¹³å°ä¸Šè·å¾—æˆæƒã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•å»ºç«‹ä¸€ä¸ªï¼›react åº”ç”¨ç¨‹åºä¸­çš„ Google ç¤¾äº¤ç™»å½•ã€‚

ç»™å®šä¸€ä¸ª React ç™»å½•ç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹:

```
 import React, {Component} from 'react'

      export default class Login extends Component {
          render(){
             return(
                 <div>
                    <input type="text" placeholder="username"/>
                    <input type="text" placeholder="username"/> 
                    <button>Login</button>
                 </div>
             )
          }
      } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬éœ€è¦å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…æ¥å¸®åŠ©æˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸Šè®¾ç½® Google ç™»å½•åŠŸèƒ½ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…`react-google-login`åŒ…ã€‚

```
 yarn add react-google-login || or you can use || npm i react-google-login 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆåŠŸå®‰è£…è½¯ä»¶åŒ…åï¼Œæˆ‘ä»¬å¿…é¡»å°†å®ƒå¯¼å…¥åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ã€‚æˆ‘ä»¬çš„é¡¹ç›®åº”è¯¥æ˜¯è¿™æ ·çš„:

```
 import React, {Component} from 'react'
     import GoogleLogin from 'react-google-login'

      export default class Login extends Component {
          render(){
             return(
                 <div>
                    <input type="text" placeholder="username"/>
                    <input type="text" placeholder="username"/> 
                    <button>Login</button>
                 </div>
             )
          }
      } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰€ä»¥è¦ä½¿ç”¨è¿™ä¸ªåŒ…ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯é€šè¿‡åœ¨`<button>Login</button>`ä¸‹é¢æ·»åŠ è¿™ä¸ª`<GoogleLogin />`æ¥åœ¨æˆ‘ä»¬çš„ç»„ä»¶ä¸­å‘ˆç°å®ƒã€‚

å‘ˆç°çš„ GoogleLogin ç»„ä»¶éœ€è¦ä¸€äº›å±æ€§ä½œä¸ºé“å…·ä¼ é€’ç»™å‡½æ•°ï¼Œè¿™äº›å±æ€§åŒ…æ‹¬:`clientId`ã€`buttonText`ã€`onSuccess`ã€`onFailure`ã€‚æˆ‘å°†è®¨è®ºå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªï¼Œä»æœ€å®¹æ˜“è®¾ç½®åˆ°æœ€éš¾è®¾ç½®ã€‚

**buttonText** :è¿™åªæ˜¯å°†å‡ºç°åœ¨æŒ‰é’®ä¸Šçš„æ–‡æœ¬ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°é€šè¿‡ç»™ buttonText åˆ†é…ä¸€ä¸ªæ–‡æœ¬æ¥å®Œæˆè¿™äº›ï¼Œå¦‚ä¸‹:`buttonText = 'Log in With Google';`

**onSuccess å’Œ onFailure** :è¿™äº›å®é™…ä¸Šæ˜¯æ–¹æ³•ï¼Œå½“è¯·æ±‚å‘ Google è®¤è¯æ—¶ï¼Œå®ƒä»¬å……å½“å›è°ƒå‡½æ•°ï¼Œå› æ­¤åœ¨è¿™äº›æ–¹æ³•ä¸­ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå½“ Google è¿”å›å“åº”æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œä¸€ä¸ª`onSuccess`æ–¹æ³•å¯èƒ½å¦‚ä¸‹æ‰€ç¤º:

```
 responseGoogle = async (response) => {
    const userObject = {
      username: response.w3.ofa,
      password: 'test'
    }
    if(response.w3.ofa) {
      await localStorage.setItem("user", JSON.stringify(userObject));
      await window.location.reload();
    } else {

    }
    console.log(response);
  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Google å‘é€çš„å“åº”æœ‰ä¸€ä¸ªåä¸º`w3`çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å±æ€§`w3`å’Œç”¨æˆ·ç”µå­é‚®ä»¶çš„å¦ä¸€ä¸ªå±æ€§ã€‚è¿™å¯èƒ½å¯¹ä½ æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥è¯·åœ¨å›å¤æ—¶è®°å½•ä½ çš„å›å¤ï¼Œä»¥æŒ‘é€‰ä½ éœ€è¦çš„ç»†èŠ‚ã€‚

å› ä¸º Google ä¸ä¼šè¿”å›ç”¨æˆ·å¯†ç ï¼Œæ‰€ä»¥æˆ‘é€šå¸¸ä¼šç»™ä»–ä»¬åˆ†é…ä¸€ä¸ªé»˜è®¤å¯†ç ï¼Œå¹¶å°†è¿™ä¸ªå¯†ç å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚è¿˜æœ‰ä¸€æ¬¡ï¼Œå¦‚æœç”¨æˆ·è¯•å›¾ç™»å½•ï¼Œæˆ‘æ‰€è¦åšçš„å°±æ˜¯å°†ä¸€ä¸ªåŒ…å«ä»–çš„ç”¨æˆ·åå’Œé»˜è®¤å¯†ç çš„å¯¹è±¡å‘é€å›æœåŠ¡å™¨ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯`test`ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠ`userObject`å­˜å‚¨åœ¨`local storage`ä¸­ï¼Œä½†æ˜¯å¦‚æœä½ åœ¨æ•°æ®åº“ä¸­æŒä¹…åŒ–ä½ çš„æ•°æ®ï¼Œä½ å°†ä¸å¾—ä¸æŠŠè¿™ä¸ªå¯¹è±¡å‘é€ç»™åœ¨æœåŠ¡å™¨ä¸Šå¤„ç†ç”¨æˆ·è®¤è¯çš„æ–¹æ³•ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬ç°åœ¨å°†åˆ›å»ºçš„æ–¹æ³•åˆ†é…ç»™`onSuccess`å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼›`onSuccess = responseGoogle;`ã€‚å¯¹äº onFailure å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªè¾“å‡ºé”™è¯¯æ¶ˆæ¯çš„æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªè­¦å‘Šæˆ–æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥åƒå¯¹`onSuccess`ä¸€æ ·å°†è¿™ä¸ªæ–¹æ³•åˆ†é…ç»™`onFailure`å±æ€§ã€‚

**clientId** :
è¦è·å¾—è¿™äº›ä¿¡æ¯ï¼Œä½ éœ€è¦è®¿é—®è°·æ­Œ API æ§åˆ¶å°[è¿™é‡Œ](https://console.developers.google.com)

*   ç‚¹å‡»å‡­è¯éƒ¨åˆ†ï¼Œå¹¶ç‚¹å‡»åˆ›å»ºå‡­è¯æŒ‰é’®![credentials](../Images/00c6e02d551d409d5358f3a447b9786c.png)
*   é€‰æ‹© Oauth é€‰é¡¹![select 0auth](../Images/2f4fb607cc50bf93daaf2b81442243ee.png)
*   è¯·æ³¨æ„ï¼Œå¦‚æœæ‚¨åœ¨æ­¤ä¹‹å‰æ²¡æœ‰åˆ›å»ºé¡¹ç›®ï¼Œå®ƒä¼šæç¤ºæ‚¨æŒ‰ç…§è¯´æ˜åˆ›å»ºé¡¹ç›®ï¼Œç„¶åå†æ¬¡å°è¯•ç”Ÿæˆå‡­è¯ã€‚è¿™ä¸€æ¬¡ï¼ŒæŒ‰ç…§æç¤ºï¼Œç›´åˆ°æ‚¨çœ‹åˆ°æ‚¨çš„`clientId`çš„éƒ¨åˆ†ï¼Œå¤åˆ¶ clientId å¹¶åˆ†é…æˆ‘ä»¬è‡ªå·±çš„`clientId`ç»™å®ƒã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬çš„`Login`ç»„ä»¶çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:

    ä»' react'
    å¯¼å…¥ Reactï¼Œ{Component}ä»' react-google-login 'å¯¼å…¥ GoogleLogin

    ```
     export default class Login extends Component {

          responseGoogle = async (response) => {
             const userObject = {
                username: response.w3.ofa,
                password: 'test'
             }
             if(response.w3.ofa) {
                await localStorage.setItem("user", JSON.stringify(userObject));
                await window.location.reload();
             } else {

          }
          console.log(response);
          }
          render(){
             return(
                 <div>
                    <input type="text" placeholder="username"/>
                    <input type="text" placeholder="username"/> 
                    <button>Login</button>
                    <GoogleLogin
                      clientId="##########" //id gotten from Google
                      buttonText="Log in with Google"
                      onSuccess={this.props.responseGoogle}
                      onFailure={this.props.responseGoogleError}
                    />
                 </div>
             )
          }
      } 
    ```

    è¿™æ ·ï¼Œæˆ‘ä»¬çš„ React åº”ç”¨ç¨‹åºé€šè¿‡äº† Google 0auth çš„è®¤è¯ã€‚è¿™å¾ˆç®€å•ï¼Œå¦‚æœéœ€è¦è¿›ä¸€æ­¥æ¾„æ¸…ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ï¼Œè¿™é‡Œæˆ–é€šè¿‡è°·æ­Œé‚®ä»¶ğŸ˜‚