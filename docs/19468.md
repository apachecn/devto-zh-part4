# åˆ©ä¼¯æ‹‰ğŸš€conâœ¨ Fastlaneâœ¨æœ¬åœŸååº”åº”ç”¨

> åŸæ–‡:[https://dev . to/javymb/libera-aplicaciones-de-react-native-con-fast lane-9 G8](https://dev.to/javymb/libera-aplicaciones-de-react-native-con-fastlane-9g8)

ä½¿ç”¨ React Native (JavaScript)åˆ›å»ºåº”ç”¨ç¨‹åºå°±åƒç«¥è¯ä¸€æ ·ä¸€åˆ‡éƒ½æ˜¯ç²‰çº¢è‰²ç›´åˆ°å‘è¡Œæ–°ç‰ˆçš„ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ ä¸ç†Ÿæ‚‰ iOS æˆ– Android çš„æ¯è¯­ã€‚
å‘ App Store å’Œ Play Store å•†åº—æäº¤ç”³è¯·çš„è¿‡ç¨‹ï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªä»¤äººæ²®ä¸§ã€ç¼“æ…¢æˆ–ç»æœ›çš„ç»å†è™½ç„¶æœ‰å¾ˆå¤šæ–‡ä»¶ï¼Œä½†å¹¶ä¸æ€»æ˜¯å¾ˆæ¸…æ¥šæˆ–åªæ˜¯é”™è¿‡äº†è®¸å¤šé‡è¦çš„æ­¥éª¤ï¼Œå› ä¸ºè¿˜æœ‰å¾ˆå¤šäº‹æƒ…è¦åšã€‚

é‚£å°±æ˜¯ä»–æ¥æ•‘æ´çš„æ—¶å€™ï¼
æœ¬æ–‡å°†å‘æ‚¨ä»‹ç»å¦‚ä½•å°† Android åº”ç”¨ç¨‹åºçš„å‘å°„è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚âˆæœ€å¸¸è§çš„ä»»åŠ¡ï¼Œå¦‚è¯ä¹¦ã€åº”ç”¨ç¨‹åºç¼–è¯‘ã€Beta åˆ†å‘ç­‰ã€‚

Fastlane æ˜¯ iOS å’Œ Android å¼€å‘äººå‘˜çš„ä¸€ä¸ªå·¥å…·ï¼Œå¯å¸®åŠ©ä»–ä»¬è‡ªåŠ¨æ‰§è¡Œç¹ççš„ä»»åŠ¡ï¼Œå¦‚ç”Ÿæˆå±å¹•æˆªå›¾ã€å¤„ç†è¯ä¹¦å’Œå¯åŠ¨åº”ç”¨ç¨‹åºã€‚
çœŸå®è¯è¯:

> âˆæˆ‘å¼€å§‹ä½¿ç”¨ï¼Œæˆ‘çš„ç”Ÿæ´»æ”¹å˜äº†ï¼Œç°åœ¨æˆ‘æœ‰æ›´å¤šçš„æ—¶é—´åœ¨ä¹¦æ¡Œä¸Šå–æ¯å’–å•¡æ”¾æ¾ä¸€ä¸‹ï¼ŒåŒæ—¶ Fastlane è´Ÿè´£ä¸€åˆ‡ã€‚ğŸ™‡

## [](#empezando)å¼€å§‹

å®‰è£…å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…æœ€æ–°çš„ Xcode å‘½ä»¤è¡Œå·¥å…·ï¼Œç„¶åå®‰è£…

`brew cask install fastlane;`
å®‰è£…åï¼Œåœ¨æ‚¨çš„æœ¬æœºæ ¹çº§ååº”é¡¹ç›®å†…åˆ›å»º fast lane/âˆæ–‡ä»¶å¤¹ã€‚ç„¶åï¼Œåœ¨æ­¤ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º Fastfile çš„æ–‡ä»¶(ä¸å¸¦æ‰©å±•åï¼Œä»… Fastlane)ã€‚

Fastfile æ–‡ä»¶æ˜¯æˆ‘ä»¬å°†å¯¹è½¦é“(lanes)è¿›è¡Œç¼–ç çš„ä½ç½®ã€‚è½¦é“åŒ…å«ä¸€ç»„åŠ¨ä½œï¼Œæ‚¨å¯ä»¥åŒæ­¥æ‰§è¡Œè¿™äº›åŠ¨ä½œä»¥è‡ªåŠ¨åŒ–æµç¨‹ã€‚æ“ä½œæ˜¯æ‰§è¡Œä»»åŠ¡çš„å‡½æ•°ã€‚

è®©æˆ‘ä»¬ä»è¿™ä¸ªåŸºæœ¬æ¨¡æ¿ *Fastfile* å¼€å§‹ï¼Œå¦‚æ‚¨æ‰€è§ï¼Œæœ‰ä¸€ä¸ª before_all é“¾æ¥ï¼Œå®ƒåŸºæœ¬ä¸Šæ‰§è¡ŒçŠ¶æ€æ£€æŸ¥ï¼Œæœ‰ä¸‰ä¸ªåŠ¨ä½œï¼Œä»¥ç¡®ä¿å®ƒå¤„äºæœ€åä¸€ä¸ªåˆ†æ”¯(branch)ä¸­ï¼ŒçŠ¶æ€æ˜¯å¹²å‡€çš„ã€‚

```
fastlane_version '2.53.1'

before_all do
  ensure_git_branch
  ensure_git_status_clean
  git_pull
end

platform :ios do
   # iOS Lanes
end

platform :android do
  # Android Lanes
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#certificados)è®¤è¯

å½“æ‚¨è¦å¯åŠ¨ä¸€ä¸ªæ–°çš„åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯å®Œç¾çš„ï¼Œç›´åˆ°æ‚¨å¿…é¡»ç­¾ç½²å¹¶æ§åˆ¶åº”ç”¨ç¨‹åºè¯ä¹¦ã€‚

### [](#ios)iOSğŸ

ç­¾ç½²ä½ çš„ä»£ç çš„æœ€å¥½æ–¹æ³•æ˜¯ä½¿ç”¨ match åœ¨å°† march æ•´åˆåˆ°ã€Œè½¦é“ã€(lane)ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ‰§è¡Œä¸‹åˆ—æ­¥éª¤:

1-ä½¿ç”¨ Nuke åˆ é™¤ç°æœ‰é…ç½®æ–‡ä»¶å’Œè¯ä¹¦ã€‚

2-é€šè¿‡ init å‘½ä»¤å¯åŠ¨ match é…ç½®ã€‚

`Fastlane match init`
3-åœ¨ ios å¹³å°ä¸Šåˆ›å»ºä½¿ç”¨é…å¯¹çš„è½¦é“ã€‚

```
desc 'Fetch certificates and provisioning profiles'
  lane :certificates do
  match(app_identifier: 'com.app.bundle', type: 'development', readonly: true)
  match(app_identifier: 'com.app.bundle', type: 'appstore', readonly: true)
End 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¹‹åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ fastlane ios è¯ä¹¦å‘½ä»¤æˆ–ä½¿ç”¨è¯ä¹¦ä½œä¸ºå…¶ä»–è½¦é“ä¸Šçš„åŠŸèƒ½ã€‚Match ä¼šè‡ªåŠ¨å°†é…ç½®æ–‡ä»¶å’Œè¯ä¹¦ä¿å­˜åˆ°æ‚¨çš„ OS X å¯†é’¥(Keychain)ä¸­ã€‚

### [](#android)å®‰å“ğŸ¤–

åœ¨å‘å¸ƒæ¨¡å¼ä¸‹ä½¿ç”¨â€œæ±‡ç¼–â€ä»»åŠ¡ç¼–è¯‘ Android åº”ç”¨ç¨‹åºæ—¶ï¼Œåº”ç”¨ç¨‹åºå°†è‡ªåŠ¨ç­¾åã€‚ä½†ä½ é¦–å…ˆéœ€è¦ç”Ÿæˆæˆ–é¢„å…ˆç”Ÿæˆç­¾åå¯†é’¥å¹¶å°†å…¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œå¯ä»¥æŸ¥é˜…æœ¬ Facebook æŒ‡å—äº†è§£å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

## [](#compilaci%C3%B3n-build)æ±‡ç¼–(æ„å»º)

### [](#ios)iOSğŸ

ä¸ºäº†ç”Ÿæˆç­¾åæ„å»ºï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä½¿ç”¨ä»¥å‰åˆ›å»ºçš„è¯ä¹¦å­˜å‚¨åº“çš„è½¦é“ï¼Œå¹¶ä½¿ç”¨ gym å¿«é€Ÿè½»æ¾åœ°æ„å»ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚è¿‡ç¨‹ç»“æŸæ—¶ï¼Œæˆ‘ä»¬ä¼šå¢åŠ ç¼–è¯‘ç¼–å·ï¼ŒæŠŠæˆ‘ä»¬çš„ç”³è¯·é€åˆ°ã€beta æµ‹è¯• T2]æœåŠ¡

```
desc 'Build the iOS application.'
private_lane :build do
  certificates
  increment_build_number(xcodeproj: './ios/name.xcodeproj')
  gym(scheme: 'name', project: './ios/name.xcodeproj')
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#android)å®‰å“ğŸ¤–

ä¸ºäº†ç”Ÿæˆç­¾åçš„. apkï¼Œæˆ‘ä»¬å°†åˆ›å»ºç¼–è¯‘è½¦é“ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ grad æ“ä½œï¼Œä»¥æ¸…ç†å·¥ç¨‹å¹¶è£…å¤‡å‘å°„ç‰ˆæœ¬ï¼Œä»»åŠ¡ä¸º[grad](https://docs.gradle.org/current/userguide/userguide.html)ã€‚

```
desc 'Build the Android application.'
private_lane :build do
  gradle(task: 'clean', project_dir: 'android/')
  gradle(task: 'assemble', build_type: 'Release', project_dir: 'android/')
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åè‡ªåŠ¨å¢åŠ *ç‰ˆæœ¬ä»£ç *ï¼Œå°†*æ±‡ç¼–ç§Ÿèµ*ä¸è¿™ä¸ªå°ä»»åŠ¡è¿æ¥èµ·æ¥ã€‚

## åˆ†é…

### [](#ios)iOSğŸ

testflight æ˜¯ IOs beta æµ‹è¯•æ—¶çš„å‰è¿›ä¹‹è·¯ã€‚è™½ç„¶å¼€å‘è€…é—¨æˆ·æœ‰ç‚¹æ··ä¹±ï¼Œä½†å®ƒç¡®å®è¿è¡Œå¾—å¾ˆå¥½ã€‚ä½¿ç”¨ pilotï¼Œæˆ‘ä»¬å¯ä»¥ç®¡ç†æˆ‘ä»¬çš„ testflight ç¼–è¯‘ã€‚

beta è½¦é“å°†ä½¿ç”¨ç¼–è¯‘è½¦é“å‘ pilot æä¾›ä¸€ä¸ªç­¾åçš„. ipaï¼Œç„¶åå°†å…ƒç´ å‘é€åˆ° gitï¼Œå¹¶é€šè¿‡å¢åŠ ç¼–è¯‘ç¼–å·æ¥é©±åŠ¨æ‰€åšçš„æ›´æ”¹ï¼Œæœ€åå°†æœ¬åœ°ç¼–è¯‘ä¸Šè½½åˆ° testflightã€‚

```
desc 'Ship to Testflight.'
  lane :beta do
    build
    pilot
    commit_version_bump(message: 'Bump build', xcodeproj: './ios/name.xcodeproj')
    push_to_git_remote
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#android)å®‰å“ğŸ¤–

Android ä½¿ç”¨ playstore å…±äº« beta ç‰ˆã€‚fastlane ä¹Ÿèƒ½å®ç°è‡ªåŠ¨åŒ–ï¼

Android çš„ beta è½¦é“ä¸ iOS å‡ ä¹ç›¸åŒï¼Œå®ƒä½¿ç”¨ç¼–è¯‘è½¦é“ç”Ÿæˆå·²ç­¾åçš„. apkï¼Œç¡®è®¤ç‰ˆæœ¬ä»£ç çš„æ›´æ”¹ï¼Œä½¿ç”¨ supply ä»¥ beta ç‰ˆå½¢å¼ä¿ƒè¿› playstore çš„æœ¬åœ°ç¼–è¯‘ã€‚

```
desc 'Ship to Playstore Beta.'
lane :beta do
    build
    supply(track: 'beta', track_promote_to: 'beta')
    git_commit(path: ['./android/gradle.properties'], message: 'Bump versionCode')
    push_to_git_remote
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ çš„ Fastfile åº”è¯¥çœ‹èµ·æ¥å¾ˆåƒä¸‹é¢æ˜¾ç¤ºçš„

```
fastlane_version '2.53.1'

before_all do
  ensure_git_branch
  ensure_git_status_clean
  git_pull
end

platform :ios do
   # iOS Lanes
  desc 'Fetch certificates and provisioning profiles'
  lane :certificates do
    match(app_identifier: 'com.app.bundle', type: 'development', readonly: true)
    match(app_identifier: 'com.app.bundle', type: 'appstore', readonly: true)
  end
  desc 'Build the iOS application.'
  private_lane :build do
    certificates
    increment_build_number(xcodeproj: './ios/name.xcodeproj')
    gym(scheme: 'name', project: './ios/name.xcodeproj')
  end
  desc 'Ship to Testflight.'
  lane :beta do
    build
    pilot
    commit_version_bump(message: 'Bump build', xcodeproj: './ios/name.xcodeproj')
    push_to_git_remote
  end
end

platform :android do
  # Android Lanes
  desc 'Build the Android application.'
  private_lane :build do
    gradle(task: 'clean', project_dir: 'android/')
    gradle(task: 'assemble', build_type: 'Release', project_dir: 'android/')
  end
  desc 'Ship to Playstore Beta.'
  lane :beta do
      build
      supply(track: 'beta', track_promote_to: 'beta')
      git_commit(path: ['./android/gradle.properties'], message: 'Bump versionCode')
      push_to_git_remote
  end
end 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**è°¢è°¢**
Felix Krauseï¼ŒCarlos Cuesta

ä¸ºæˆ‘ç¾ä¸½çš„å®‰æ›¼å¾’äº‰å–æƒŠäººçš„æ”¯æŒï¼
ä½ éœ€è¦å¸®åŠ©å—ï¼Ÿ
ç»™æˆ‘ç•™è¨€ï¼Œæˆ‘å¾ˆä¹æ„å¸®ä½ ï¼

å“ˆç»´å°”Â·ç©†å°¼å¥¥æ–¯Â·å·´é‡Œå¥¥æ–¯
([@ jaymb](https://dev.to/javymb))|æ¨ç‰¹