# ä¸€ä¸ªå®Œæ•´çš„ SwiftUI åº”ç”¨ï¼

> åŸæ–‡:[https://dev.to/kevinmaarek/a-complete-swiftui-app-2eg7](https://dev.to/kevinmaarek/a-complete-swiftui-app-2eg7)

åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨åœ¨æˆ‘çš„[swift ui å…¥é—¨ä¸­åˆ¶ä½œçš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œå¹¶ç»“åˆ](https://dev.to/kevinmaarek/getting-started-with-swiftui-and-combine-dd8)æ–‡ç« ï¼Œå°è¯•æ”¹è¿›å®ƒå¹¶å®ç°ç°å®ç”Ÿæ´»ä¸­çš„åŠŸèƒ½ã€‚

è¿™ç¯‡æ–‡ç« å¯ä»¥ä½œä¸ºä¸Šä¸€ç¯‡æ–‡ç« çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬å°†ç»§ç»­æ¢ç´¢è‹¹æœçš„ SwiftUI å¹¶ç»“åˆæ¡†æ¶çš„å¯èƒ½æ€§ã€‚

åœ¨åŒ†å¿™è¿›å…¥ XCode ä¹‹å‰ï¼Œæˆ‘æƒ³å¯¹æˆ‘æƒ³è¦æ·»åŠ çš„ç‰¹æ€§åšä¸€ä¸ªå¿«é€Ÿçš„æ¸…å•ã€‚è¿™æ˜¯æˆ‘å¾—åˆ°çš„:

*   âœ…å°†å¾…åŠäº‹é¡¹æ ‡è®°/å–æ¶ˆæ ‡è®°ä¸ºå®Œæˆ
*   ğŸ“Œå°†é¡¹ç›®å›ºå®šåœ¨åˆ—è¡¨é¡¶éƒ¨çš„èƒ½åŠ›
*   ğŸ‘¨â€ğŸ¨æ”¹è¿›ç”¨æˆ·ç•Œé¢(ä½¿å…¶è·å¾—è‹¹æœè®¾è®¡å¥–)

å¥½äº†ï¼Œç°åœ¨ä¸‹è½½å¹¶æ‰“å¼€åŸºç¡€é¡¹ç›®(è¿™é‡Œæœ‰[å’Œ](https://github.com/Que20/ToDoSwiftUI))ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹äº†ã€‚

æˆ‘ä»¬ä»ç®€å•çš„å¼€å§‹ã€‚æˆ‘ä»¬éœ€è¦å°†`pinned`å±æ€§æ·»åŠ åˆ°æˆ‘ä»¬çš„æ¨¡å‹ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“ Todo é¡¹æ˜¯å¦è¢«å›ºå®šã€‚

```
public class Todo: Codable, Identifiable {    
    public let userID: Int
    public let id: Int
    public var title: String
    public var completed: Bool
    public var pinned: Bool?
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼è§†å›¾æ¨¡å‹ã€‚ç”±äºæˆ‘ä»¬å°†å¢åŠ æ›´å¤šçš„åŠŸèƒ½å’Œæ˜¾ç¤ºçš„ä¸œè¥¿ï¼Œæˆ‘å–œæ¬¢ä¿æŒä¸œè¥¿å¹²å‡€ã€‚

```
public class TodoCellViewModel {

    private var todo: Todo

    public init(todo: Todo) {
        self.todo = todo
    }

    public func isPinned() -> Bool {
        return self.todo.pinned ?? false
    }

    public func isComleted() -> Bool {
        return self.todo.completed
    }

    public func getTitle() -> String {
        return self.todo.title
    }

    public func getId() -> Int {
        return self.todo.id
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®ƒåªä¼šé˜»æ­¢å•å…ƒå¤„ç†å®é™…çš„æ¨¡å‹ã€‚ç°åœ¨æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯æ­£å¦‚æˆ‘è¯´çš„:æ„Ÿè§‰æ›´å¹²å‡€äº†ã€‚ğŸ˜‡

ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹å•å…ƒæ ¼çš„ UI æ¥æ·»åŠ ä¸€ä¸ªâ€œå¤§å¤´é’ˆâ€æŒ‰é’®:
åŸºæœ¬ä¸Šå°±æ˜¯åœ¨ HStack ä¸­æ·»åŠ ä¸€ä¸ªé—´éš”ç¬¦å’Œä¸€ä¸ªå¤§å¤´é’ˆå›¾åƒã€‚
æˆ‘ä»¬è¿˜å°†æ·»åŠ ä¸¤ä¸ªå—:ä¸€ä¸ªç”¨äºæ ‡è®°å®ŒæˆåŠ¨ä½œï¼Œå¦ä¸€ä¸ªç”¨äºé”å®šåŠ¨ä½œã€‚æˆ‘ä»¬ä¼šåœ¨æ­£ç¡®çš„ç›®æ ‡ä¸Šè°ƒç”¨è¿™äº›ã€‚

```
struct TodoCell : View {
    var todoCellViewModel: TodoCellViewModel
    var markDoneAction: ((_ id: Int) -> Void)
    var pinAction: ((_ id: Int) -> Void)

    var body: some View {
        HStack {
            // NOT USING BUTTONS BUT IMAGE + TAP ACTION
            // BUG W/ Buttons in List

            Image(systemName: (self.todoCellViewModel.isComleted() ? "checkmark.square" : "square")).tapAction {
                self.markDoneAction(self.todoCellViewModel.getId())
            }

            Text(self.todoCellViewModel.getTitle())
            Spacer()

            Image(systemName: (self.todoCellViewModel.isPinned() ? "pin.fill" : "pin")).tapAction {
                self.pinAction(self.todoCellViewModel.getId())
            }
        }
        .padding()
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

âš ï¸:æˆ‘ç”¨çš„ä¸æ˜¯`Buttons`ï¼Œè€Œæ˜¯å¸¦æœ‰ç‚¹å‡»åŠ¨ä½œçš„å›¾ç‰‡ã€‚åˆ—è¡¨å•å…ƒæ ¼ä¸­çš„å¤šä¸ªæŒ‰é’®å½“å‰å­˜åœ¨é—®é¢˜ã€‚

è®©æˆ‘ä»¬ä¹Ÿæ¸…ç†å†…å®¹è§†å›¾ï¼Œéš”ç¦»åˆ—è¡¨ï¼Œåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„åˆ—è¡¨è§†å›¾ï¼Œå®ƒçœ‹èµ·æ¥ä¹Ÿæ›´å¹²å‡€ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å°†è°ƒç”¨æˆ‘ä»¬çš„æ–°å•å…ƒã€‚æ‚¨éœ€è¦åˆ›å»ºä¸å•å…ƒæ ¼ä¸­ç›¸åŒçš„å›è°ƒã€‚è¿™äº›å°†è°ƒç”¨æˆ‘ä»¬éšåå°†åˆ›å»ºçš„ viewModel æ–¹æ³•ã€‚

```
struct TodoList : View {
    var todos: Todos
    var markDoneAction: ((_ id: Int) -> Void)
    var pinAction: ((_ id: Int) -> Void)

    var body: some View {
        List(self.todos) { todo in
            TodoCell(todoCellViewModel: TodoCellViewModel(todo: todo), markDoneAction: { (id) in
                self.markDoneAction(id)
            }) { (id) in
                self.pinAction(id)
            }
        }
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¾ˆå¥½ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€å‘æˆ‘ä»¬çš„è§†å›¾æ¨¡å‹æ·»åŠ æ–°çš„æ–¹æ³•æ¥å›ºå®šå’Œæ ‡è®°å®Œæˆã€‚æˆ‘æ˜¯è¿™æ ·åšçš„:

```
 func markDone(id: Int) {
        self.todos.first(where: { $0.id == id })?.completed.toggle()
        self.didChange.send(self)
    }

    func pin(id: Int) {
        self.todos.first(where: { $0.id == id })?.pinned?.toggle()
        self.sort()
    }

    func sort() {
        self.todos = self.todos.sorted(by: { ($0.pinned ?? false) && (!($1.pinned ?? false)) })
    } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åï¼Œè°ƒç”¨ ContentView ä¸­çš„ TodoList:

```
TodoList(todos: self.viewModel.todos, markDoneAction: {(id) in
    self.viewModel.markDone(id: id)
}, pinAction: {(id) in
    self.viewModel.pin(id: id)
}) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å®Œäº‹äº†ã€‚æˆ‘æƒ³æ¸…ç†ä¸€ä¸‹æ–‡ä»¶çš„å±‚æ¬¡ç»“æ„ã€‚

[![](../Images/df01f4fe25226a391631047a64ad2d0e.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--9mol7qiL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/mrp2jwyjpxj4frfm38ra.png)

ä¸ºäº†è¿›ä¸€æ­¥æ¨è¿›è¿™ä¸ªé¡¹ç›®ï¼Œåœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³å°è¯•åœ¨ todo æ–‡æœ¬ä¸Šå‘ˆç°ä¸€ä¸ªæ¨¡æ€ï¼Œå®ƒå°†æ˜¾ç¤ºé¡¹ç›®çš„ç»†èŠ‚å¹¶é€‰æ‹©ä¸€ä¸ªé¢œè‰²æ ‡ç­¾ï¼Œä½ çŸ¥é“ï¼Œå°±åƒåœ¨ macOS Finder ä¸­ä¸€æ ·ã€‚åœ¨
åˆ—è¡¨ä¸­ï¼Œæ·»åŠ è¿‡æ»¤å™¨ï¼Œå¦‚`Show Pin Only`æˆ–`Done Only`ã€‚

ç°åœ¨ï¼Œ[è¿™é‡Œçš„](https://github.com/Que20/ToDoSwiftUIV2)æ˜¯ä½ å¯ä»¥ä¸‹è½½å¹¶ä½¿ç”¨çš„é¡¹ç›®æ–‡ä»¶ã€‚

[![](../Images/4bab3be2e0d6b1e872e8762c33b69fe2.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--98EO7kYg--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/mc20qpkicuqog17yv199.png)

å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½å®Œæ•´çš„é¡¹ç›®æ–‡ä»¶ã€‚

ç¼–ç å¿«ä¹ï¼