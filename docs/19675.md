# å°è¯•å­¦ä¹  Go - Issuer 01

> åŸæ–‡:[https://dev . to/shinda Kun/attempting-to-learn-go-issuer-01-5f0k](https://dev.to/shindakun/attempting-to-learn-go-issuer-01-5f0k)

# [](#github-issuer)GitHub å‘è¡Œè€…

å¦‚æœä½ æ²¡æœ‰ç¢°å·§[çœ‹è¿‡ä¸Šä¸€ç¯‡æ–‡ç« ](https://shindakun.dev/posts/working-on-a-new-flow/)ï¼Œæˆ‘ä¼šç»™ä½ ä¸€ä¸ªç®€å•çš„æ¦‚è¿°ã€‚æˆ‘æ­£åœ¨å°è¯•ä¸€ä¸ªæ–°çš„ç³»ç»Ÿæ¥å¤„ç†æˆ‘çš„é¡¹ç›®å’Œå¾…åŠäº‹é¡¹ã€‚

é—®é¢˜æ˜¯å½“å‰çš„è®¾ç½®éå¸¸æ‰‹åŠ¨ã€‚æˆ‘æƒ³åšçš„æ¯ä¸€ä»¶â€œäº‹æƒ…â€ï¼Œæˆ–è€…é¡¹ç›®ï¼Œéƒ½æœ‰è‡ªå·±çš„ä»“åº“ï¼Œæœ‰è‡ªå·±çš„è‡ªåŠ¨åŒ–çœ‹æ¿ã€‚æˆ‘åœ¨å›è´­ä¸­æ‰“å¼€ä¸€ä¸ªé—®é¢˜ï¼Œå°†å…¶åˆ†é…ç»™é¡¹ç›®å§”å‘˜ä¼šï¼Œç„¶åâ€œå˜­â€çš„ä¸€å£°ï¼Œæ–°ä»»åŠ¡ã€‚ä½†æ˜¯ï¼Œæˆ‘éœ€è¦æ‰‹åŠ¨å°†è¯¥é—®é¢˜æ·»åŠ åˆ°æˆ‘çš„ä¸»â€œå¾…åŠäº‹é¡¹â€å›è´­ä¸­ã€‚

æˆ‘ä»¬ä¸èƒ½è¿™æ ·ï¼è¿™ä½¿å¾—ç³»ç»Ÿæ¯”å®ƒåº”è¯¥åšçš„å·¥ä½œæ›´å¤šã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¸ä¼šä½¿ç”¨å®ƒã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬æœ‰è§£å†³åŠæ³•ï¼GitHub åº“å¯ä»¥å¯ç”¨ webhooksã€‚å› æ­¤ï¼Œåœ¨æ¯ä¸€æœŸæ‚å¿—ä¸Šï¼Œæˆ‘ä»¬çš„ webhook éƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªåŒ…å«è¯¥æœŸæ‚å¿—è¯¦ç»†ä¿¡æ¯çš„ POST è¯·æ±‚ã€‚è¿™å°±æ˜¯`Issuer`çš„ç”¨æ­¦ä¹‹åœ°ã€‚å®ƒå°†é©»ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œç­‰å¾…ä¼ å…¥çš„ POST äº‹ä»¶ã€‚ä¸€æ—¦æœ‰é—®é¢˜ï¼Œå®ƒå°†ä½¿ç”¨ GitHub API åœ¨ TODO repo ä¸­åˆ›å»ºä¸€ä¸ªé—®é¢˜ã€‚

* * *

## [](#lets-go)èµ°å§

å¥½å§ï¼è®©æˆ‘ä»¬ç›´å…¥ä¸»é¢˜ï¼Œçœ‹çœ‹æˆ‘ä»¬åœ¨å¤„ç†ä»€ä¹ˆã€‚å¦‚æœä½ é˜…è¯»äº†`Uploader`ç³»åˆ—çš„ç¬¬äºŒæˆ–ç¬¬ä¸‰ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆéƒ¨åˆ†åŸºæœ¬ä»£ç çœ‹èµ·æ¥ä¼šå¾ˆç›¸ä¼¼ã€‚æˆ‘ä»¬å¯¹ Go web æœåŠ¡å™¨ä½¿ç”¨éå¸¸æ ‡å‡†çš„æ–¹æ³•ã€‚

```
package  main  import  (  "encoding/json"  "fmt"  "log"  "net/http"  ) 
```

ä¸æˆ‘ä»¬å®é™…éœ€è¦çš„ç›¸æ¯”ï¼ŒGitHub é—®é¢˜çš„æœ‰æ•ˆè½½è·æ˜¯â€œå·¨å¤§çš„â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„`Payload`ç»“æ„å°†åªåŒ…å«åˆ›å»ºæ–°é—®é¢˜æ‰€éœ€çš„å†…å®¹ã€‚

```
type  Payload  struct  {  Action  string  `json:"action"`  Issue  struct  {  URL  string  `json:"url"`  RepositoryURL  string  `json:"repository_url"`  Number  int  `json:"number"`  Title  string  `json:"title"`  Body  string  `json:"body"`  }  `json:"issue"`  Repository  struct  {  Name  string  `json:"name"`  }  `json:"repository"`  } 
```

ä½ å¥½ï¼è¿™æ˜¯ä¸å¿…è¦çš„ï¼Œä½†æˆ‘å–œæ¬¢æœ‰å®ƒä½œä¸ºä¸€ä¸ªå°çš„å¥åº·æ£€æŸ¥ã€‚åœ¨æ›´å¥å£®çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä»æœåŠ¡å™¨è¿”å›æŸç§åº¦é‡ã€‚ç„¶åï¼Œå¦‚æœæˆ‘æ„¿æ„ï¼Œæˆ‘å¯ä»¥å°† Uptime Robot æŒ‡å‘`/`æ¥æé†’å®ƒæ˜¯å¦åœæœºã€‚

```
func  status(res  http.ResponseWriter,  req  *http.Request)  {  fmt.Fprintf(res,  "Hello!")  } 
```

æˆ‘å°†ä»‹ç»å¦‚ä½•åœ¨å›è´­ä¸­å¯ç”¨ webhooksï¼Œä»¥åŠç¨åå¦‚ä½•è¿›è¡Œæµ‹è¯•ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹æˆ‘ä»¬çš„ webhook å¤„ç†å‡½æ•°ã€‚æˆ‘ä»¬ä»è®¾ç½®æˆ‘ä»¬çš„`Payload`å˜é‡å’Œ`defer`å…³é—­è¯·æ±‚ä½“å¼€å§‹ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨`json.NewDecoder()`æ¥å‡†å¤‡å’Œè§£ç æˆ‘ä»¬çš„ JSON æœ‰æ•ˆè½½è·ã€‚å¦‚æœ`decode.Decoder()`è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å°†é¦–å…ˆè¿”å›ä¸€ä¸ª`400`ç»™åŸå§‹æœåŠ¡å™¨ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†é”™è¯¯è®°å½•åˆ°æ§åˆ¶å°ï¼Œç„¶åä»å‡½æ•°è¿”å›ã€‚

```
func  handleWebhook(res  http.ResponseWriter,  req  *http.Request)  {  var  Payload  Payload  defer  req.Body.Close()  decoder  :=  json.NewDecoder(req.Body)  err  :=  decoder.Decode(&Payload)  if  err  !=  nil  {  http.Error(res,  "bad request: "+err.Error(),  400)  log.Printf("bad request: %v",  err.Error())  return  } 
```

å‡è®¾ä¸€åˆ‡é¡ºåˆ©ï¼Œæˆ‘ä»¬å°† webhook çš„è¯¦ç»†ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°ä¸­ã€‚

```
 log.Printf("%#v\n",  Payload.Repository.Name)  log.Printf("%#v\n",  Payload.Issue.URL)  log.Printf("%#v\n",  Payload.Issue.Title)  log.Printf("%#v\n",  Payload.Issue.Body)  log.Printf("%#v\n",  Payload.Issue.Number)  log.Printf("%#v\n",  Payload.Issue.RepositoryURL)  } 
```

å¯¹äºè¿™ä¸ªåŸºæœ¬çš„ä¾‹å­ï¼Œæˆ‘ä»¬çš„ main ç”±ä¸¤ä¸ªå¤„ç†ç¨‹åºå’Œ`http.ListenAndServe()`ç»„æˆã€‚æˆ‘ä»¬å¯èƒ½å¸Œæœ›åœ¨æŸä¸ªæ—¶å€™æ‰©å±•å®ƒï¼Œä»¥å…è®¸ä½¿ç”¨æ›¿ä»£çš„ HTTP å®¢æˆ·ç«¯ã€‚ä¸ºäº†ä¿æŒä»£ç ç®€å•ï¼Œæˆ‘ä»¬æš‚æ—¶ä¸å†™å®ƒã€‚

```
func  main()  {  log.Println("Issuer")  http.HandleFunc("/",  status)  http.HandleFunc("/webhook",  handleWebhook)  http.ListenAndServe(":3000",  nil)  } 
```

## [](#next-time)ä¸‹æ¬¡

ä¸‹æ¬¡è§é¢æ—¶ï¼Œæˆ‘ä»¬å°†å¢åŠ æ ¹æ®æ”¶åˆ°çš„æœ‰æ•ˆè½½è·åˆ›å»ºé—®é¢˜çš„èƒ½åŠ›ã€‚å¦‚æœè¿›å±•é¡ºåˆ©ï¼Œæˆ‘ä»¬ç”šè‡³ä¼šæ·»åŠ ä»£ç ï¼Œå°†é—®é¢˜æ·»åŠ åˆ° TODO é¡¹ç›®ä¸­ã€‚ğŸ‰

* * *

ä½ å¯ä»¥åœ¨ GitHub ä¸Šçš„ repo ä¸­æ‰¾åˆ°è¿™ä¸ªå’Œå¤§å¤šæ•°å…¶ä»–è¯•å›¾å­¦ä¹ å›´æ£‹çš„å¸–å­çš„ä»£ç ã€‚

## ![GitHub logo](../Images/375dfcc32199b4dedf2b526645c27ff7.png) [ã€æ–°è¾¾æ˜†ã€‘](https://github.com/shindakun) / [ atlg](https://github.com/shindakun/atlg)

### æˆ‘åœ¨ dev.to ä¸Šå‘å¸ƒçš„â€œå°è¯•å­¦ä¹ å›´æ£‹â€å¸–å­çš„æ¥æºæŠ¥å‘Š

<article class="markdown-body entry-content p-5" itemprop="text">

# å°è¯•å­¦ä¹ å›´æ£‹

åœ¨è¿™é‡Œä½ å¯ä»¥æ‰¾åˆ°æˆ‘ä¸ºå°è¯•å­¦ä¹ å›´æ£‹è€Œå†™çš„ä»£ç ï¼Œè¿™äº›ä»£ç æ˜¯æˆ‘åœ¨ [Dev.to](https://dev.to/shindakun) ä¸Šå†™çš„ã€‚

## å¸–å­ç´¢å¼•

| é‚®æ”¿ | å¯†ç  |
| --- | --- |
| [åˆ¶ä½œä¸‹è½½å™¨ç¬¬ 01 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-a-downloader-part-01-44gl) | - |
| [åˆ¶ä½œä¸‹è½½å™¨ç¬¬ 02 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-a-downloader-part-02-2k7i) | - |
| [åˆ¶ä½œä¸‹è½½å™¨ç¬¬ 03 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-a-downloader-part-03-2214) | - |
| [åˆ¶ä½œä¸‹è½½å™¨ç¬¬ 4 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-a-downloader-part-04-3ln9) | - |
| [å»ºé€ ä¸‹è½½å™¨ç¬¬ 05 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-a-downloader-part-05-44o) | - |
| [ä½¿ç”¨ REST API](https://dev.to/shindakun/attempting-to-learn-go---consuming-a-rest-api-5c7g) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-api-01/main.go) |
| [ç»§ç»­ä¼‘æ¯å†’é™©](https://dev.to/shindakun/attempting-to-learn-go---continuing-rest-adventures-2l4l) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-api-02/main.go) |
| [ç°åœ¨å‘é€ä¼‘æ¯è¯·æ±‚](https://dev.to/shindakun/attempting-to-learn-go---now-sending-rest-requests-akp) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-api-03/main.go) |
| [REST API å’Œæ¨¡æ¿ä¸Šçš„ä½](https://dev.to/shindakun/attempting-to-learn-go---rest-api-and-a-bit-on-templates-4kca) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-api-04/main.go) |
| [å†æ¬¡é€šè¿‡ API å‘é€ç”µå­é‚®ä»¶](https://dev.to/shindakun/attempting-to-learn-go---sending-email-via-api-again-2e4e) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-api-05/main.go) |
| [è®©æˆ‘ä»¬æ¨¡å—åŒ–å§ï¼](https://dev.to/shindakun/attempting-to-learn-go---lets-get-modular-390i) | [src](https://github.com/shindakun/mailgunner) |
| [è®©æˆ‘ä»¬å†ä¸€æ¬¡æ¨¡å—åŒ–ï¼](https://dev.to/shindakun/attempting-to-learn-go---lets-get-modular---again-10cd) | [src](https://github.com/shindakun/mailgunner) |
| [æ„å»ºå¼€å‘æ—¥å¿—ç¬¬ 1 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-dev-log-part-01-1c3m) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devsite-01/main.go) |
| [æ„å»ºå¼€å‘æ—¥å¿—ç¬¬ 2 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-dev-log-part-02-179c) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devsite-02/main.go) |
| [æ„å»ºå¼€å‘æ—¥å¿—ç¬¬ 3 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-dev-log-part-03-7lk) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devsite-03/main.go) |
| [æ„å»ºå¼€å‘æ—¥å¿—ç¬¬ 4 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-dev-log-part-04-2bok) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devsite-04/main.go) |
| [æ„å»ºå¼€å‘æ—¥å¿—ç¬¬ 5 éƒ¨åˆ†](https://dev.to/shindakun/attempting-to-learn-go---building-dev-log-part-05-4mo1) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devsite-05/main.go) |
| [æŒ‰æ‰©å±•å 01 åˆ—å‡ºæ–‡ä»¶](https://dev.to/shindakun/attempting-to-learn-go---listing-files-by-extension-1n10) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-sort-01/main.go) |
| [æŒ‰æ‰©å±•å 02 åˆ—å‡ºæ–‡ä»¶](https://dev.to/shindakun/attempting-to-learn-go---sorting-and-moving-files-by-extension-227j) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-sort-01/main.go) |
| [å¼€å‘è‡³ API 01](https://dev.to/shindakun/interacting-with-the-devto-article-api-4g34) | [src](https://raw.githubusercontent.com/shindakun/atlg/master//go-devtoapi-01/main.go) |
| [å¼€å‘è‡³ API 02](https://dev.to/shindakun/interacting-with-the-devto-article-api---again-sort-of-2o8g) | å‚è§ä¸Šé¢çš„ä»£ç  |

</article>

[View on GitHub](https://github.com/shindakun/atlg)

* * *

| å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿ |
| --- |
| ç»™æˆ‘ä¹°æ¯å’–å•¡æ€ä¹ˆæ ·ï¼Ÿ |

* * *

| è¿™ç¯‡æ–‡ç« æœ€åˆå‘è¡¨åœ¨ [shindakun.dev](https://shindakun.dev/?utm_source=dev&utm_medium=web&utm_campaign=devposts) ä¸Šã€‚ |
| --- |