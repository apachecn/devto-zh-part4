# è¿æ¥ Redux è¡¨å•å’Œ React Redux

> åŸæ–‡:[https://dev . to/its menata lie/connecting-redux-form-with-react-redux-ml4](https://dev.to/itsmenatalie/connecting-redux-form-with-react-redux-ml4)

åœ¨ React ä¸­å¤„ç†è¡¨å•æœ‰æ—¶ä¼šå¾ˆéº»çƒ¦ã€‚æ‚¨éœ€è¦æ³¨æ„é€‚å½“çš„çŠ¶æ€ç®¡ç†ã€æµç•…çš„ç”¨æˆ·ä½“éªŒã€ç®€å•çš„è¡¨å•å£°æ˜ã€å¯é‡ç”¨çš„ç»„ä»¶ç­‰ç­‰ã€‚ä½†æ˜¯æˆ‘ä½¿ç”¨ Redux Form çš„åŸå› æ˜¯éªŒè¯ã€‚æˆ‘æƒ³è®©è¡¨å•çš„å®ç°æ›´åŠ ç®€å•å¿«æ·ï¼Œè€Œä¸éœ€è¦åœ¨é¡µé¢ç»„ä»¶ä¸­æ·»åŠ å¤§é‡ä»£ç ã€‚ä½†å½“æˆ‘è¯•å›¾å°† Redux Form ä¸ React Redux è¿æ¥èµ·æ¥æ—¶ï¼Œæˆ‘ç¢°å£äº†ã€‚

è¿™ä¸æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è¿™ä¹ˆåšï¼Œæ‰€ä»¥æˆ‘æ²¡æƒ³åˆ°ä¼šæœ‰ä»€ä¹ˆå›°éš¾ã€‚æˆ‘é”™äº†ã€‚æœ‰äº†æœ€æ–°çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘åœ¨è¿æ¥`reduxForm`å’Œ`connect()`å‡½æ•°æ—¶å°è¯•äº†è®¸å¤šä¸åŒçš„æ–¹æ³•ã€‚ä»å°†ä¸€ä¸ªæ”¾å…¥å¦ä¸€ä¸ªä¸­ï¼Œåˆ°å°†å¯¼å‡ºçš„ç»„ä»¶ä¸æ¯ä¸ªåŠŸèƒ½åˆ†åˆ«è¿æ¥ã€‚ä¸€åˆ‡éƒ½ä¸æ­£å¸¸ã€‚ä¸ç®¡æˆ‘åšäº†ä»€ä¹ˆï¼Œæˆ‘æœ€ç»ˆå¾—åˆ°äº†è¿™ä¸ªé”™è¯¯æ¶ˆæ¯:

```
Uncaught Invariant Violation:
You must pass a component to the function returned by connect.
Instead received {"displayName":"ReduxForm",
"defaultProps": {destroyOnUnmount":true, "form":"loginForm", etc.}} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘å†³å®šåœ¨ç½‘ä¸Šå¯»æ±‚å¸®åŠ©ã€‚æ²¡æœ‰ç›´æ¥çš„ç­”æ¡ˆæ¥å¸®åŠ©æˆ‘ï¼Œæˆ‘é”™è¿‡äº†ä»€ä¹ˆï¼Œæˆ–è€…æˆ‘åº”è¯¥å¦‚ä½•æ­£ç¡®åœ°åšå®ƒã€‚æ˜¾ç„¶ï¼Œäººä»¬ä»ç„¶åœ¨è¿™ä¸ªé—®é¢˜ä¸ŠæŒ£æ‰ã€‚æ£€æŸ¥ StackOverflow å’Œå…¶ä»–è®ºå›åªèƒ½æ‰¾åˆ°è¿‡æ—¶çš„å·¥ä½œç‰ˆæœ¬ã€‚ç”šè‡³æ¥è‡ª [redux-form æ–‡æ¡£](https://redux-form.com/8.2.2/docs/faq/howtoconnect.md/)çš„å®˜æ–¹ä¾‹å­ä¹Ÿä¸èµ·ä½œç”¨ï¼æˆ‘å†³å®šå°è¯•ä¸€æ­¥ä¸€æ­¥çš„æ–¹æ³•ï¼Œå°†æ¯ä¸ªéƒ¨åˆ†åˆ†åˆ«è¿æ¥åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚æˆ‘ä»¥ä¸€ä¸ªé¢å¤–çš„æ–‡ä»¶`container.tsx`ç»“æŸï¼Œåœ¨é‚£é‡Œæˆ‘è¿æ¥äº†ä¸€ä¸ªæ›´é«˜å±‚æ¬¡çš„ç»„ä»¶ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ Redux Form è¿æ¥ä¸€ä¸‹æˆ‘ä¹‹å‰åˆ›å»ºçš„ä¸€ä¸ªè¡¨å•ç»„ä»¶:

```
import React from 'react'; 
import { Field, InjectedFormProps, reduxForm } from 'redux-form';

export interface IDispatchProps {
  //...
}

const LoginComponent = (props:IDispatchProps) => (
  <form>...</form>
);

export const LoginForm = reduxForm({
  form: 'loginForm',
})(LoginComponent); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä¸ºè¿™ä¸ªç»„ä»¶å®ç°ä¸€ä¸ªå®¹å™¨:

```
import * as React from 'react';
import { connect } from 'react-redux';

import { LoginForm, IProps } from './LoginForm';
import actions from './actions';
import selector from './selector';

const LoginContainer = (props:IProps) =>
  <LoginForm {...props} />;

export default connect(selector, actions)(LoginContainer); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æ­£åœ¨åšçš„æ˜¯ï¼Œæˆ‘ä»¬å°†åˆ›å»ºçš„`LoginComponent`å‡½æ•°ç”¨`reduxForm`åŒ…è£…èµ·æ¥ã€‚åœ¨`container.tsx`æ–‡ä»¶ä¸­`LoginContainer`å‡½æ•°ä¼šå°†æˆ‘ä»¬çš„é“å…·ä¼ é€’ç»™å¯¼å…¥çš„ç»„ä»¶ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`connect()`æ¥åˆ›å»ºå®¹å™¨å’Œå•†åº—é“å…·ä¹‹é—´çš„é€šä¿¡ã€‚å¦‚æœæˆ‘ä»¬æƒ³å°† TypeScript æ·»åŠ åˆ°è¡¨å•ä¸­ï¼Œå¹¶ä¸”æ ¹æœ¬ä¸ä½¿ç”¨`any`ï¼Œé‚£ä¹ˆæœ€æ£˜æ‰‹çš„éƒ¨åˆ†å°±å¼€å§‹äº†ï¼ç¦»å¼€åŸºæœ¬ç»„ä»¶çš„é“å…·ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¯´æˆ‘ä»¬çš„é“å…·åœ¨è¿™ä¸ªç»„ä»¶ä¸­ä¸å­˜åœ¨ã€‚ä½†æˆ‘ä»¬åˆšåˆšè¿‡äº†ï¼Œå¯¹å§ï¼Ÿ

```
TS2559: Type '{ loginAction: () => any; }' has no properties in common with type
'IntrinsicAttributes & IntrinsicClassAttributes<FormInstance<{},
Partial<ConfigProps<{}, {}, string>>, string>> & Readonly
<Partial<ConfigProps<{}, {}, string>>> & Readonly<...>'. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘èŠ±äº†è‡³å°‘ä¸€ä¸ªå°æ—¶æ‰æƒ³æ˜ç™½ï¼Œå›ç­”â€œä¸ºä»€ä¹ˆï¼Ÿâ€ã€‚æˆ‘å†³å®šå†æ¬¡ä¸Šç½‘å¯»æ±‚å¸®åŠ©ï¼Œä½†æˆ‘æ‰¾åˆ°çš„å”¯ä¸€ç­”æ¡ˆæ˜¯ä¸æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘åº”è¯¥æŠŠæˆ‘çš„é“å…·æ”¾åœ¨å“ªé‡Œã€‚ç»è¿‡å‡ æ¬¡å°è¯•ï¼Œæˆ‘ç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªæ˜æ™ºçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘å¾ˆæ»¡æ„ã€‚é¦–å…ˆï¼Œåœ¨`LoginForm.tsx`æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨è¡¨å•ä¸­çš„å­—æ®µåç§°åˆ›å»ºä¸€ä¸ªæ¥å£`IFormProps`ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä»`redux-form`åº“ä¸­å¯¼å…¥`InjectedFormProps`çš„ç±»å‹å®šä¹‰ï¼Œå¹¶å°†å…¶ä¸æˆ‘ä»¬çš„ props æ¥å£ç›¸ç»“åˆã€‚InjectedFormProps æ¥å—ä¸¤ä¸ªå‚æ•°:`FormProps = {}`å’Œ`P={}`ã€‚ç¬¬ä¸€ä¸ªè¡¨ç¤ºå°†æ”¾å…¥è¡¨å•çš„è¡¨å•æ•°æ®ï¼Œç¬¬äºŒä¸ªæ˜¯ç»„ä»¶çš„é“å…·ã€‚ç†è®ºä¸Šï¼Œæ‚¨å¯ä»¥å°†ä¸¤ä¸ªå¯¹è±¡éƒ½ç•™ç©ºã€‚ä½†è¿™ä¸æ˜¯æˆ‘ä»¬ä½¿ç”¨ TypeScript çš„åŸå› ï¼Œå¯¹å—ï¼Ÿ

```
import React from 'react'; 
import { Field, InjectedFormProps, reduxForm } from 'redux-form';

interface IFormProps {
  username:string;
  password:string;
}

export interface IDispatchProps {
  //...
}

const LoginComponent =
(props:IDispatchProps & InjectedFormProps<IFormProps, IDispatchProps>) => (
  <form>
    <Field
      name="username"
      component={Input}
      type="text"
      label="Enter username"
    />
    <Field
      name="password"
      component={Input}
      type="password"
      label="Enter password"
    />
  </form>
);

export const LoginForm = reduxForm<IFormProps, IDispatchProps>({
  form: 'loginForm',
})(LoginComponent); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ æƒ³æŠŠ Redux Form å’Œ React Redux è¿æ¥èµ·æ¥ï¼Œé‚£å°±å¸®ä½ è‡ªå·±ä¸€ä¸ªå¿™ï¼Œåˆ›å»ºå¦ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºè¿™ä¸¤ä¸ªåº“ä¹‹é—´çš„æ¡¥æ¢ã€‚ä¸è¦å¿˜äº†å°†å®ƒä¸ TypeScript ç»“åˆèµ·æ¥ã€‚å¦‚æœä½ æƒ³çœ‹ä¸€ä¸ªä¾‹å­ï¼Œçœ‹çœ‹æˆ‘çš„å·¥ä½œå®ç°: [Redux Form with TypeScript](https://github.com/CodeMeNatalie/Redux-Forms-with-TypeScript) ã€‚ç¥ä½ å¥½è¿ï¼Œä¸‹æ¬¡å†è§ï¼ğŸ‘ğŸ»

## ![GitHub logo](../Images/292a238c61c5611a7f4d07a21d9e8e0a.png)[codemenata lie](https://github.com/CodeMeNatalie)/[Redux-Forms-with-TypeScript](https://github.com/CodeMeNatalie/Redux-Forms-with-TypeScript)

### è¿æ¥ Redux è¡¨å•å’Œ React Redux ç¤ºä¾‹

<article class="markdown-body entry-content container-lg" itemprop="text">

### ä»£ç å¨èƒ [![redux form](../Images/8c103dad64c972dc6efddc0a4fade647.png)](https://camo.githubusercontent.com/354760287c15fe73bfcd0b5d21d9c2a3b2501bc42bd5213f680c3b705c6e3d20/687474703a2f2f636f64656d656e6174616c69652e636f6d2f77702d636f6e74656e742f75706c6f6164732f323031392f30372f72656475782d666f726d2e706e67)

### ç”¨ TypeScript è¿˜åŸè¡¨å•

è¿™ä¸ªé¡¹ç›®æ˜¯ Redux Forms å’Œ TypeScript çš„å·¥ä½œå®ç°çš„ä¸€ä¸ªä¾‹å­ã€‚åœ¨æˆ‘çš„æ–‡ç« [ä¸­æè¿°äº†è¿æ¥ Redux è¡¨å•å’Œè¿æ¥](https://raw.githubusercontent.com/CodeMeNatalie/Redux-Forms-with-TypeScript/master/codemenatalie.com/blog/connecting-redux-form-and-connect)çš„æ•´ä¸ªè¿‡ç¨‹ã€‚

[ç½‘ç«™](https://codemenatalie.com)â™€[åšå®¢](http://codemenatalie.com/blog)

## å¿«é€Ÿå¯åŠ¨

*   å…‹éš†å›è´­:`git clone https://github.com/CodeMeNatalie/Redux-Form-with-TypeScript.git`
*   å®‰è£…ä¾èµ–é¡¹
*   è¿è¡Œåº”ç”¨ç¨‹åº`npm start`
*   æ‰“å¼€ [http://localhost:3000](http://localhost:3000) åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹é¡¹ç›®ã€‚

[![coding doge](../Images/8ff777942927e9f7c33303a6319d0dde.png)T2ã€‘](https://camo.githubusercontent.com/b3b5969b73c0ab5267e90f97519969c45eb99e1da020fa062f881bf5c4758780/68747470733a2f2f6d656469612e67697068792e636f6d2f6d656469612f6d43524a446f323455764a4d412f67697068792e676966)

### äº«å—<g-emoji class="g-emoji" alias="computer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4bb.png">ğŸ’»</g-emoji>

</article>

[View on GitHub](https://github.com/CodeMeNatalie/Redux-Forms-with-TypeScript)

é‡è¦é€šçŸ¥:
ä¸Šé¢çš„æ–‡ç« å’Œç¤ºä¾‹æ˜¯ç”¨ redux-form 8.2.2 å’Œ react-redux 6.0.1 åˆ›å»ºçš„ã€‚