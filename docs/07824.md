# å¦‚ä½•åœ¨ React web åº”ç”¨ç¨‹åºä¸­æ·»åŠ é»‘æš—æ¨¡å¼

> åŸæ–‡ï¼š<https://dev.to/wchr/how-to-add-a-dark-mode-to-your-react-web-app-4f1>

æˆ‘ä»¬ç›®å‰ç”Ÿæ´»åœ¨ä¸‡ç‰©æ—¶ä»£çš„é»‘æš—æ¨¡å¼ä¸­ã€‚ç°åœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ªå¼€å…³ï¼Œè¦ä¹ˆåœ¨å¯¼èˆªæ ä¸Šï¼Œè¦ä¹ˆå°±åœ¨å®ƒçš„è®¾ç½®é™„è¿‘ï¼Œä½ åªéœ€ç‚¹å‡»ä¸€ä¸‹ï¼Œå±å¹•å°±ä¼šå˜é»‘ã€‚ä¸€äº›åº”ç”¨ç¨‹åºç”šè‡³é»˜è®¤è®¾ç½®äº†é»‘æš—æ¨¡å¼ï¼Œä¾‹å¦‚[æ··åˆå™¨](https://mixer.com)
[![Screenshot 2019-08-15 at 3.19.23 PM.png](img/22ec00a929b1e2b50daeaef5efa4462f.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--uUEWSVNS--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn.hashnode.com/res/hashnode/image/upload/v1565871575888/hE9mSc11D.png) ï¼Œç”šè‡³ç½‘é£ä¹Ÿé»˜è®¤è®¾ç½®äº†é»‘æš—æ¨¡å¼ã€‚

æ‹¥æœ‰é»‘æš—æ¨¡å¼å°†çœŸæ­£æœ‰åŠ©äºå‡å°‘ç”±å…‰æ˜æ¨¡å¼å¼•èµ·çš„çœ¼ç›ç–²åŠ³ï¼Œåˆ°æœ¬æ–‡ç»“æŸæ—¶ï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨å‡ åˆ†é’Ÿå†…å°†é»‘æš—æ¨¡å¼æ·»åŠ åˆ°ä½ çš„ Reactjs åº”ç”¨ç¨‹åºä¸­ã€‚

# å…ˆå†³æ¡ä»¶

æ‚¨åº”è¯¥å¯¹ä»¥ä¸‹å†…å®¹æœ‰åŸºæœ¬çš„äº†è§£:

*   ååº”æ¦‚å¿µ(ç”Ÿå‘½å‘¨æœŸ)
*   css æ¦‚å¿µï¼Œå°¤å…¶æ˜¯ CSS å˜é‡
*   Javascript æ–‡æ¡£å¯¹è±¡æ¨¡å‹

# è®¾ç½®

åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•æ¥å­˜æ”¾æˆ‘ä»¬çš„ React åº”ç”¨ç¨‹åºã€‚

```
$ mkdir simple_dark_theme_react_app && cd simple_dark_theme_react_app 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†éœ€è¦`create-react-app` CLI æ¥å¸®åŠ©å¿«é€Ÿè®¾ç½®ä¸€ä¸ªç®€å•çš„ React åº”ç”¨ç¨‹åºï¼Œæ— éœ€ä»»ä½• webpack é…ç½®ã€‚

```
$ npx create-react-app . 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åº

```
$ yarn start or npm start 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®ƒåº”è¯¥ä¼šè‡ªåŠ¨å¯åŠ¨æ‚¨çš„æµè§ˆå™¨ï¼Œå¦‚æœæ²¡æœ‰è®¿é—®`http://localhost:3000`ã€‚

> å¦‚æœä½ ç¢°å·§é‡åˆ°ä¸€ä¸ª`fsevents is not a constructor`è®¿é—®è¿™ä¸ª Github çš„äººæå‡ºå…³äºå®ƒçš„é—®é¢˜[é“¾æ¥](https://github.com/facebook/create-react-app/issues/6891)
> 
> å¦‚æœè¿™æ²¡æœ‰å¸®åŠ©ï¼Œæˆ‘æ‰€åšçš„å°±æ˜¯åˆ é™¤`lock`æ–‡ä»¶å’Œ`node_module`æ–‡ä»¶å¤¹ï¼Œå¹¶é‡æ–°å®‰è£…è½¯ä»¶åŒ…ã€‚

```
{  "name":  "simple_dark_theme_react_app",  "version":  "0.1.0",  "private":  true,  "dependencies":  {  "react":  "^16.9.0",  "react-dom":  "^16.9.0",  "react-scripts":  "3.1.1"  },  "scripts":  {  "start":  "react-scripts start",  "build":  "react-scripts build",  "test":  "react-scripts test",  "eject":  "react-scripts eject"  },  "eslintConfig":  {  "extends":  "react-app"  },  "browserslist":  {  "production":  [  ">0.2%",  "not dead",  "not op_mini all"  ],  "development":  [  "last 1 chrome version",  "last 1 firefox version",  "last 1 safari version"  ]  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*ä»¥ä¸Šæ˜¯æˆ‘çš„ package.json æ–‡ä»¶ã€‚*

# å¥½ç©çš„éƒ¨åˆ†

æˆ‘ä¸ä¼šåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ react åº”ç”¨ç¨‹åºï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šä½¿è¿™ä¸ªåšå®¢å¾ˆé•¿ï¼Œæˆ‘ä¹Ÿå¸Œæœ›ä½ æœ‰åˆ›æ„ï¼Œæ²¡æœ‰æ··ä¹±ã€‚æˆ‘å°†ä½¿ç”¨é»˜è®¤çš„`create-react-app`æ¨¡æ¿ã€‚

[![Screenshot 2019-08-15 at 3.54.58 PM.png](img/ab9fe2ec19f02bbe395e49cffe654d8e.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--rHiu8n4g--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn.hashnode.com/res/hashnode/image/upload/v1565873711199/Hp3n0R4qk.png)

## æˆ‘ä»¬å°†åšä»€ä¹ˆ

æˆ‘ä»¬è¦åšçš„æ˜¯ä½¿ç”¨ä¸Šé¢é»˜è®¤çš„ React åº”ç”¨èƒŒæ™¯è‰²ä½œä¸ºæˆ‘ä»¬çš„æ·±è‰²ä¸»é¢˜ï¼Œç™½è‰²ä½œä¸ºæˆ‘ä»¬çš„æµ…è‰²ä¸»é¢˜ã€‚ä¸€ä¸ªå¼€å…³å°†å­˜åœ¨äºé¡µé¢ä¸‹æ–¹ï¼Œå…è®¸æˆ‘ä»¬åˆ‡æ¢ä¸»é¢˜çš„å˜åŒ–ã€‚

> **æ³¨æ„**:æˆ‘ä¸ä¼šä½¿ç”¨`react`é’©å­ï¼Œå› ä¸ºæˆ‘æ²¡æœ‰æ—¶é—´å»ç ”ç©¶å®ƒï¼Œè€Œä¸”ç±»ç»„ä»¶å¯¹æˆ‘æ¥è¯´ä¹Ÿå¾ˆæœ‰ç”¨ã€‚

## CSS éƒ¨åˆ†

CSS åœ¨åˆ‡æ¢ä¸»é¢˜æ—¶èµ·ç€é‡è¦çš„ä½œç”¨ã€‚å¯åŠ¨ä½ æœ€å–œæ¬¢çš„ç¼–è¾‘å™¨ï¼Œæ‰“å¼€æˆ‘ä»¬éœ€è¦æ·»åŠ å‡ ä¸ªå˜é‡çš„`src/App.css`æ–‡ä»¶ã€‚

```
/* Define our color variables */

html {
  --primary-color: #fff;
  --secondary-color: #282c34;
}

/* Redefine our color variables if the data-theme attr
  value is "dark
*/

html[data-theme="dark"] {
  --primary-color: #282c34;
  --secondary-color: #fff;
}

.App {
  text-align: center;
}

.App-logo {
  animation: App-logo-spin infinite 20s linear;
  height: 40vmin;
  pointer-events: none;
}

.App-header {
  background-color: var(--secondary-color);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: calc(10px + 2vmin);
  color: var(--primary-color);
}

@keyframes App-logo-spin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ æˆ‘ä»¬çš„ä¸»é¢˜åˆ‡æ¢å¼€å…³ã€‚æ‰“å¼€`src/App.js`æ–‡ä»¶ã€‚

```
import React from "react";
import logo from "./logo.svg";
import "./App.css";

class App extends React.Component {
  render() {
    return (
      <div className="App">
        <header className="App-header">
          <img src={logo} className="App-logo" alt="logo" />
          <p>
            Edit <code>src/App.js</code> and save to reload.
          </p>
          <label class="switch">
            <input type="checkbox" />
            <span class="slider round" />
          </label>
        </header>
      </div>
    );
  }
}

export default App; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

> æ³¨æ„ï¼Œæˆ‘åœ¨`src/App.js`æ–‡ä»¶ä¸­ä½¿ç”¨äº†ä¸€ä¸ªç±»ç»„ä»¶ã€‚

æˆ‘ä»¬éœ€è¦æ·»åŠ å‡ ä¸ª css æ ·å¼çš„åˆ‡æ¢æŒ‰é’®ï¼Œæ‰“å¼€`src/App.css`æ–‡ä»¶ã€‚

```
/* CSS styling for our switch */
/* This switch was styled with the help of w3schools */
/* https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_switch */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked+.slider {
  background-color: #2196F3;
}

input:focus+.slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked+.slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ åº”è¯¥æœ‰ç±»ä¼¼ä¸‹å›¾çš„ä¸œè¥¿ã€‚
[![Screenshot 2019-08-15 at 4.42.41 PM.png](img/b9a50f8659644eb2eeba25e27969754e.png)T3ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--vxrCypiw--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn.hashnode.com/res/hashnode/image/upload/v1565876598744/IaJbLKbHA.png)

## Javascript/React éƒ¨åˆ†

> æ³¨æ„:ä¸ºäº†é˜²æ­¢åˆ·æ–°åº”ç”¨ç¨‹åºæ—¶ä¸¢å¤±çŠ¶æ€ï¼Œæˆ‘ä»¬å°†ä¸»é¢˜çŠ¶æ€å­˜å‚¨åœ¨æµè§ˆå™¨çš„`localStorage`ä¸­ã€‚

æ‰“å¼€ä½ çš„`src/App.js`æ–‡ä»¶ï¼Œè®©æˆ‘ä»¬æ›´æ–°å®ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸»é¢˜
ä¹‹é—´åˆ‡æ¢

```
import React from "react";
import logo from "./logo.svg";
import "./App.css";

class App extends React.Component {
  // Define a state object to hold our app's state
  state = {
    // Boolean attribute that will allow us to toggle the switch
    // Keep the switch on if the theme is dark
    checked: localStorage.getItem("theme") === "dark" ? true : false,
    /**
     * When a user activates the dark theme we will store the value
     * on localstorage or set default value to light if it is neither dark
     * nor light
     */
    theme: localStorage.getItem("theme")
  };

  componentDidMount() {
    // Update the data-theme attribute of our html tag
    document
      .getElementsByTagName("HTML")[0]
      .setAttribute("data-theme", localStorage.getItem("theme"));
  }

  // Class method allowing us to toggle the theme change
  toggleThemeChange = () => {
    const { checked } = this.state;
    // If theme is light then change to dark
    if (checked === false) {
      // Update localstorage
      localStorage.setItem("theme", "dark");
      /**
       * The document.getElementsByTagName(...).setAttribute(...)
       * will only update the value
       */
      // Update the data-theme attribute of our html tag
      document
        .getElementsByTagName("HTML")[0]
        .setAttribute("data-theme", localStorage.getItem("theme"));
      // Update our state
      this.setState({
        // Ensure our switch is on if we change to dark theme
        checked: true
      });
    } else {
      // Update localstorage
      localStorage.setItem("theme", "light");
      /**
       * The document.getElementsByTagName(...).setAttribute(...)
       * will only update the value until the App is mounted and we change
       * the state of the switch so we will need to introduce
       * a React lifecycle called ËcomponentDidMount()Ë
       */
      // Update the data-theme attribute of our html tag
      document
        .getElementsByTagName("HTML")[0]
        .setAttribute("data-theme", localStorage.getItem("theme"));
      // Update our state
      this.setState({
        // Ensure our switch is off if we change to light theme
        checked: false
      });
    }
  };

  render() {
    return (
      <div className="App">
        <header className="App-header">
          <img src={logo} className="App-logo" alt="logo" />
          <p>Click the switch to toggle themes</p>
          <label class="switch">
            {/* checked attribute is used to determine the state of 
              checkbox
              ----------------------------------------------
              The onChange attribute will toggle our theme change
            */}
            <input
              type="checkbox"
              // checked={this.state.checked}
              defaultChecked={this.state.checked}
              onChange={() => this.toggleThemeChange()}
            />
            <span class="slider round" />
          </label>
        </header>
      </div>
    );
  }
}

export default App; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å“‡å“¦ï¼ä½ çš„åº”ç”¨ç¨‹åºæœ‰é»‘æš—æ¨¡å¼ã€‚
[![darkthemeblog.gif](img/bd22eaf20c2efa80a12ba4158d63c2a7.png)T3ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--kKziYRcU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn.hashnode.com/res/hashnode/image/upload/v1565942037781/9SU6czVvV.gif)

# æ€»ç»“

åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä¸ºæˆ‘ä»¬çš„ react åº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªé»‘æš—æ¨¡å¼ã€‚

# åŠ è´º

*   å›è´­[ç¯èŠ‚](https://github.com/werickblog/simple_dark_theme_react_app)
*   Codesandbox [é“¾æ¥](https://codesandbox.io/s/simplereactappwithdarktheme-jnpvg)
*   æ¼”ç¤º[é“¾æ¥](https://simpledarkthemereactapp.ewachira254.now.sh/)

## é’©å­ç‰ˆæœ¬

[https://gist . github . com/oxy RUS/B4 edab 0372 B3 c 9 B1 b 60 a 59 e 7955121](https://gist.github.com/Oxyrus/b4edab0372b3c9b1c1b60a59e7955121)ç”±

[![andres image](img/5d8117442b460f716983bf1fdda8a994.png)](/andres)

## å®‰å¾·çƒˆæ–¯Â·ä½©é›·æ–¯

[Web developer from ğŸ‡¨ğŸ‡´](/andres)