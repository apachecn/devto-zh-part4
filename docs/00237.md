# è‡ªåŠ¨åŒ–ç›–èŒ¨æ¯”èŒä½åˆ›å»º

> åŸæ–‡:[https://dev . to/mercantte/automating-Gatsby-post-creation-1 bnd](https://dev.to/mercatante/automating-gatsby-post-creation-1bnd)

æˆ‘æ˜¯ä¸€ä¸ªæ‡’æƒ°çš„ç¨‹åºå‘˜ã€‚æˆ‘å–œæ¬¢å»ºç­‘ææ–™ï¼Œä½†æˆ‘è®¨åŒé‡å¤è‡ªå·±ã€‚æ¯å½“æˆ‘ä¸ºæˆ‘çš„ç½‘ç«™å†™ä¸€ç¯‡æ–°æ–‡ç« æ—¶ï¼Œæˆ‘ä¼šåšä»¥ä¸‹äº‹æƒ…:

*   åœ¨â€œç»ˆç«¯â€ä¸­å¯¼èˆªåˆ°â€œæˆ‘çš„ç½‘ç«™â€ç›®å½•
*   å¼€æ”¾ VS ä»£ç 
*   åˆ›å»ºæ–°æ–‡ä»¶
*   è®¾ç½®æ ‡é¢˜
*   è®¾ç½®åºŸæ–™æµ†
*   è®¾å®šæ—¥æœŸ
*   å°†å…¶å‘å¸ƒæ ‡å¿—è®¾ç½®ä¸º false

è¿™ç»ä¸æ„å‘³ç€å·¥ä½œé‡å¾ˆå¤§ï¼Œä½†æ˜¯å½“æˆ‘æœ‰äº†è¦å†™çš„ä¸œè¥¿çš„æƒ³æ³•æ—¶ï¼Œæˆ‘æƒ³ç«‹åˆ»å¼€å§‹å†™ã€‚æ‰€ä»¥ï¼Œåƒä»»ä½•æœ‰è‡ªå°Šçš„æ‡’æƒ°ç¨‹åºå‘˜ä¸€æ ·ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªè¿‡ç¨‹æ¥å°½å¯èƒ½åœ°æ¶ˆé™¤æ‘©æ“¦ã€‚è€å®è¯´ï¼Œæˆ‘ç”¨è¿™ä¸ªä¾‹å­æ¥å­¦ä¹ æ›´å¤šå…³äº [Alfred workflows](https://www.alfredapp.com/workflows/) å’Œ bash è„šæœ¬çš„çŸ¥è¯†ã€‚

## [](#so-whats-the-goal)é‚£ä¹ˆï¼Œç›®æ ‡æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

æˆ‘ä¸€ç›´ä½¿ç”¨ Alfredï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºè¿™å°†æ˜¯æˆ‘çš„æ–°æµç¨‹çš„å®Œç¾ç•Œé¢ã€‚æˆ‘æƒ³ç®€å•åœ°æ‰“å¼€ Alfred
æç¤ºç¬¦ï¼Œé”®å…¥`art <some article title>`ï¼Œè®©å®ƒæ‰§è¡Œä¸Šé¢åˆ—å‡ºçš„æ­¥éª¤ã€‚

[![alfred-prompt](img/d48571b83b448d3f151e078812e8c058.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--bccenurt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/8k4fg2cqcmw2lbc5woqh.png)

## [](#the-implementation)å®ç°

[Gatsby Post Manager](https://github.com/steven-mercatante/gatsby-post-manager) æœ‰ä¸€ä¸ª`posts new`å‘½ä»¤ï¼Œæˆ‘å¯ä»¥ç”¨å®ƒæ¥åˆ›å»ºå®é™…çš„æ–‡ä»¶ã€‚å‘½ä»¤æœ¬èº«çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:

```
$ gpm posts new path/to/posts "hello world" 
```

è¿™ä¸ªå‘½ä»¤è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶ï¼Œå¹¶ç»™å®ƒåˆ†é…æ ‡é¢˜ã€slug å’Œæ—¥æœŸï¼Œä½†æ˜¯æˆ‘ä»ç„¶éœ€è¦æŠŠæ–‡ç« çš„è·¯å¾„ä¼ é€’ç»™å®ƒã€‚è¿™ä¸ªè·¯å¾„å¯¹æˆ‘æ¥è¯´æ°¸è¿œä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä¸éœ€è¦æ¯æ¬¡éƒ½è¾“å…¥å®ƒã€‚

æˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯åˆ›å»ºä¸€ä¸ª Alfred å·¥ä½œæµï¼Œå°†å‘½ä»¤ä¼ é€’ç»™ç»ˆç«¯ã€‚è¿™æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å®ƒæœ‰ä¸¤ä¸ªç¼ºç‚¹:

*   æ¯å½“æˆ‘è°ƒç”¨è¯¥å‘½ä»¤æ—¶ï¼ŒAlfred éƒ½ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çš„ç»ˆç«¯çª—å£
*   æˆ‘ä»ç„¶éœ€è¦æ‰“å¼€ VS ä»£ç æ¥å®é™…ç¼–å†™æ–‡ç« ï¼Œè¿™æ„å‘³ç€æˆ‘éœ€è¦å°†`gpm`çš„è¾“å‡ºä¼ è¾“åˆ°`code`

æ›´å¥½çš„æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ª bash è„šæœ¬ï¼Œè°ƒç”¨`gpm`ï¼Œç„¶åæ‰“å¼€ VS ä»£ç ã€‚

## Bash è„šæœ¬

```
#!/bin/bash

# Alfred sometimes has trouble finding Node; the below fixes that
export PATH=$PATH:/usr/local/bin

# Require a single argument for the article name
if [ $# -ne 1 ]; then echo 1>&2 "Usage: $0 article-name"
  exit 3
fi

# Create the article file
# Uses Gatsby Post Manager (gpm): https://github.com/steven-mercatante/gatsby-post-manager
RESULT=`/usr/local/bin/gpm posts new /Users/steve/sites/stevemerc.com/content/posts "$1"`

# Split $RESULT into an array
# $RESULT normally looks like: "/path/to/posts/post.md successfully created", but we only want the filename

# This is the delimiter that $RESULT will be split on
IFS=' '

# Creates $ARTICLE_ARR array from $RESULT string
read -ra ARTICLE_ARR <<< $RESULT

# Grab just the filename from the success or error message
ARTICLE=${ARTICLE_ARR[0]}

# Open up VS Code on the proper project, then open up the newly created article
/usr/local/bin/code /Users/steve/sites/stevemerc.com && /usr/local/bin/code $ARTICLE 
```

è¿™é‡Œæœ‰ä¸€ä¸ª[åˆ°å›è´­](https://github.com/steven-mercatante/create-article-script)çš„é“¾æ¥ã€‚

æˆ‘å·²ç»å°½äº†æœ€å¤§åŠªåŠ›æ¥è®°å½•è¿™ä¸ªè„šæœ¬åšäº†ä»€ä¹ˆã€‚å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å‘å¾®åšç»™æˆ‘ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ç¼–æ’ä¸€åˆ‡çš„è„šæœ¬ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒè¿æ¥åˆ°é˜¿å°”å¼—é›·å¾·ã€‚

## [](#creating-the-alfred-workflow)åˆ›å»ºé˜¿å°”å¼—é›·å¾·å·¥ä½œæµ

æˆ‘ä½¿ç”¨çš„æ˜¯ Alfred v4ï¼Œå› æ­¤æ‚¨çš„è®¾ç½®å¯èƒ½ä¸æˆ‘çš„ç•¥æœ‰ä¸åŒã€‚ä½†æ˜¯è¦ç‚¹æ˜¯:

*   æ‰“å¼€é˜¿å°”å¼—é›·å¾·çš„åå¥½è®¾ç½®
*   å¯¼èˆªè‡³`Workflows`éƒ¨åˆ†
*   ç‚¹å‡»åº•éƒ¨é™„è¿‘çš„`+`æŒ‰é’®ï¼Œé€‰æ‹©`Templates > Essentials > Keyword to Script`

[![alfred-keyword-to-script-menu](img/db437eb6f5120e61294b10a8f7e44294.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--k_dvKI3u--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4agts11vw8m7wffvhfi9.png)

éšæ„å‘½åæ‚¨çš„å·¥ä½œæµç¨‹ï¼Œç„¶åç‚¹å‡»`Create`æŒ‰é’®ã€‚å°±æˆ‘è€Œè¨€ï¼Œæˆ‘ç§°ä¹‹ä¸ºâ€œåˆ›é€ æ–‡ç« â€ã€‚è¿™ç”¨äºç»„ç»‡ç›®çš„ã€‚

ç„¶åï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°æ–°åˆ›å»ºçš„å·¥ä½œæµå’Œä¸¤ä¸ªèŠ‚ç‚¹:

[![create-article-nodes](img/62144f0fe955ba05faadab29a6f00422.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--8QptvlDk--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/0hdqrrohwwiua72wgm8t.png)

åŒå‡»`Keyword`èŠ‚ç‚¹ï¼Œä¼šæç¤ºæ‚¨å®šä¹‰å‘½ä»¤åå’Œæ ‡é¢˜ã€‚

[![keyword-node](img/bdfb23abdd676224501e564a9db1666a.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--GVffwYc8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/gsujb4el3ejiwd9su78t.png)

æ¥ä¸‹æ¥ï¼ŒåŒå‡»`Run Script`èŠ‚ç‚¹ï¼Œç³»ç»Ÿä¼šæç¤ºæ‚¨è¦ä¹ˆåœ¨è¿™é‡Œç¼–å†™ bash è„šæœ¬ï¼Œè¦ä¹ˆé€‰æ‹©`External Script` ( < -è¿™æ ·åš)ã€‚

[![script-node](img/9dcd1cacdd653c86b195a5c720ab1910.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HD55vVxB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/c14sbai1l3ot6qr59m99.png)

ä¸€æ—¦åœ¨`Script File:`è¾“å…¥ä¸­è¾“å…¥ä¸€ä¸ªç°æœ‰ bash è„šæœ¬çš„è·¯å¾„ï¼Œå®ƒçš„å†…å®¹å°±ä¼šå‡ºç°åœ¨ä¸‹é¢ã€‚

ç°åœ¨ä¸€åˆ‡éƒ½åº”è¯¥è®¾ç½®å¥½äº†ï¼Œæ‚¨å¯ä»¥åœ¨ Alfred æç¤ºç¬¦ä¸‹é”®å…¥`art hello world`æ¥åˆ›å»ºæ‚¨çš„æ–°æ–‡ç« ã€‚

è¿™æ˜¯æ–°åˆ›å»ºçš„`hello-world.md`æ–‡ä»¶çš„å†…å®¹:

```
---
title: Hello World
slug: 'hello-world'
tags: []
published: false
date: '2019-09-24'
---
Add your content here 
```

## [](#debugging)è°ƒè¯•

æˆ‘å¾ˆéš¾è®© bash è„šæœ¬å’Œ Alfred ä¸€èµ·å·¥ä½œã€‚ä¸è·¯å¾„æœ‰å…³...è°çŸ¥é“å‘¢ã€‚å¹¸è¿çš„æ˜¯ï¼Œé˜¿å°”å¼—é›·å¾·è®©æˆ‘ä»¬è°ƒè¯•æˆ‘ä»¬çš„å·¥ä½œæµç¨‹ã€‚

[![alfred-debug](img/12716cc72661f3118783d326dde4c89f.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--5iysjRUc--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ettczhexmx74t82jalbt.png)

å•å‡»è¿™ä¸ªå° bug å›¾æ ‡åï¼Œå®ƒä¼šæ‰“å¼€ä¸€ä¸ªæ§åˆ¶å°çª—å£ï¼Œæ‰“å°å‡º Alfred æ‰§è¡Œçš„æ­¥éª¤ï¼Œä»¥åŠ bash è„šæœ¬çš„ä»»ä½•è¾“å‡ºæˆ–é”™è¯¯ã€‚å¦‚æœæ²¡æœ‰è°ƒè¯•å™¨ï¼Œè®©è¿™ä¸ªè¿‡ç¨‹æ­£å¸¸å·¥ä½œè‚¯å®šä¼šèŠ±è´¹æ›´é•¿çš„æ—¶é—´ã€‚

## [](#wrapping-up)åŒ…è£…å®Œæ¯•

æˆ‘ä¸æœŸæœ›å¾ˆå¤šäººæƒ³è§£å†³æˆ‘åˆšåˆšè§£å†³çš„åŒæ ·çš„é—®é¢˜ï¼Œ*ä½†æ˜¯*ï¼ŒçŸ¥é“å¦‚ä½•è¿æ¥å‘½ä»¤è¡Œå·¥å…·ã€bash è„šæœ¬å’Œ Alfred æ¥ç¼–æ’å¸¸è§å’Œé‡å¤çš„ä»»åŠ¡æ˜¯ä¸€é¡¹æœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚

ğŸ‘‹å–œæ¬¢è¿™ç¯‡æ–‡ç« å—ï¼Ÿ

åŠ å…¥æˆ‘çš„[æ—¶äº‹é€šè®¯](https://stevemerc.com/newsletter/?r=dev)å¹¶åœ¨ Twitter[@ mercantate](https://twitter.com/mercatante)ä¸Šå…³æ³¨æˆ‘ä»¥è·å¾—æ›´å¤šç±»ä¼¼çš„å†…å®¹ã€‚