# å¼‚æ­¥å‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ªæ‰¿è¯ºâ€”â€”è®©æˆ‘ä»¬æ·±å…¥å¼‚æ­¥ä¸–ç•Œ

> åŸæ–‡:[https://dev . to/param Harrison/async-functions-always-return-a-promise-let-deep-into-the-async-world-4 ADC](https://dev.to/paramharrison/async-functions-always-return-a-promise-lets-deep-into-the-async-world-4adc)

> æˆ‘æœ‰ä¸€ä¸ªæ–°çš„å…è´¹å·¥ä½œåŠï¼Œæ˜¯ä¸ºä½¿ç”¨ Node Js å’Œ MongoDB çš„åˆå­¦è€…è®¾è®¡çš„ *APIã€‚è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå·¥ä½œåŠï¼Œè®©æˆ‘ä»¬ä¸€èµ·å­¦ä¹ ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ³¨å†Œ[å·¥ä½œåŠ](https://www.eventbrite.com/e/api-design-for-beginners-using-node-js-and-mongodb-english-tickets-89601978931)*

å¼‚æ­¥å‡½æ•°æ˜¯ä¸€ç§é€šè¿‡ç­‰å¾…å“åº”æ¥åŒæ­¥è¿›è¡Œå¼‚æ­¥æ“ä½œçš„æ–¹æ³•ã€‚è®©æˆ‘ä»¬ç›´æ¥åœ¨ç¤ºä¾‹ä¸­çœ‹åˆ°å®ƒï¼Œ

```
// Normal async function - Returning promise
const getCats = async () => {
  return new Promise((resolve, reject) =>
    setTimeout(
      () =>
        resolve([
          {
            name: 'tiger',
          },
          {
            name: 'jimmy',
          },
        ]),
      2000
    )
  );
};

// Self envoking async function
(async () => {
  console.log(getCats()); // Promise { <pending> }
  const cats = await getCats();
  console.log(cats); // [{ name: 'tiger' }, { name: 'jimmy' }]
})(); 
```

å¦‚æ‚¨æ‰€è§ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨è¿”å›ä¸€ä¸ªæ‰¿è¯ºã€‚

ç°åœ¨è®©æˆ‘ä»¬é€šè¿‡è¿”å›ç›´æ¥ JSON æ•°ç»„æ¥çœ‹ä¸‹ä¸€ä¸ªä¾‹å­ï¼Œ

```
// async function - Returning JSON
const getCatsJson = async () => {
  return [
    {
      name: 'tiger',
    },
    {
      name: 'jimmy',
    },
  ];
};

// Self envoking async function
(async () => {
  console.log(getCatsJson()); // Promise { [{ name: 'tiger' }, { name: 'jimmy' }] }
  const catsJson = await getCatsJson();
  console.log(catsJson); // [{ name: 'tiger' }, { name: 'jimmy' }]
})(); 
```

æ‚¨å¯ä»¥æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—ï¼Œå°½ç®¡æˆ‘ä»¬ä» async å‡½æ•°è¿”å›äº†ä¸€ä¸ª JSON å¯¹è±¡ã€‚å®ƒè¢«åŒ…è£…æˆä¸€ä¸ªæ‰¿è¯ºã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ç­‰å¾…å’Œè§£å†³çš„æ‰¿è¯ºã€‚

ä½¿ç”¨ promise æ–¹å¼ï¼Œæ‚¨æ€»æ˜¯å¯ä»¥è§£å†³å¼‚æ­¥é—®é¢˜ï¼Œè€Œæ— éœ€ç­‰å¾…ï¼Œ

```
getCatsJson().then(console.log); // [{ name: 'tiger' }, { name: 'jimmy' }] 
```

ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ä¾‹å­ï¼Œ

[https://codesandbox.io/embed/async-promise-return-value-fpis9](https://codesandbox.io/embed/async-promise-return-value-fpis9)

å¸Œæœ›ï¼Œè¿™æœ‰åŠ©äºæ‚¨ç†è§£ async å¦‚ä½•é€šè¿‡å°†å€¼åŒ…è£…æˆæ‰¿è¯ºæ¥è¿”å›å€¼ğŸ˜‹

> åœ¨ [twitter](https://twitter.com/learnwithparam) ä¸Šå…³æ³¨æˆ‘ã€‚æˆ‘åœ¨æ¨ç‰¹ä¸Šåˆ†äº«æˆ‘çš„é˜…è¯»æ¸…å•å’Œå°è´´å£«