# å®‰è£…æ­¤ PWA ä»¥ç»§ç»­

> åŸæ–‡:[https://dev.to/samthor/install-this-pwa-to-continue-mea](https://dev.to/samthor/install-this-pwa-to-continue-mea)

åœ¨è¿è¡Œ iOS 11.3+å’Œç°ä»£ Chrome çš„ç§»åŠ¨è®¾å¤‡ä¸Šâ€”â€”å› æ­¤ï¼ŒåŸºæœ¬ä¸Šè¥¿æ–¹ä¸–ç•Œçš„æ¯ä¸ªäººâ€”â€”ä½ éƒ½å¯ä»¥åœ¨æ‰‹æœºçš„ä¸»å±å¹•ä¸Šæ·»åŠ ä¸€ä¸ª PWAã€‚è¿™æ˜¯ä¸€ä¸ªä¼Ÿå¤§è€Œä»¤äººé’¦ä½©çš„ç›®æ ‡ï¼Œä½†å®ç°è¿™ä¸ªç›®æ ‡å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ã€‚ğŸ¤”

[![Santa Tracker as a PWA](../Images/a4803f32b2c39e568da9b5352962cb98.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--ohOH4ZGn--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developers.google.com/web/showcase/2017/images/santa/phone.png)

# [](#what-if-)å¦‚æœ...

å¦‚æœä½ *åšæŒ*ä½ çš„ç”¨æˆ·åœ¨æ”¶åˆ°ä½ çš„åº”ç”¨ä¹‹å‰åšè¿™ä¸ªåŠ¨ä½œä¼šæ€ä¹ˆæ ·ï¼Ÿè¿™**æ°¸è¿œä¸ä¼š**å¯¹å†…å®¹ç«™ç‚¹æœ‰æ„ä¹‰:ç»´åŸºã€æ–°é—»æ–‡ç« ç­‰ï¼Œè€å®è¯´ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹è¿™å¯èƒ½æ˜¯ä¸€ç§åæ¨¡å¼ï¼›ä½†å®ƒ*å¯èƒ½*é€‚ç”¨äºä»¥ä¸‹æƒ…å†µ:

*   æ¯”èµ›
*   â€œç±»ä¼¼åº”ç”¨â€çš„ä½“éªŒ
*   ä½œä¸ºç”¨æˆ·ï¼Œæ‚¨è¢«é”å®šçš„å·¥å…·(æ¯”å¦‚ï¼Œæ‚¨å…¬å¸çš„è´¹ç”¨æŠ¥å‘Šåº”ç”¨ç¨‹åº)ã€‚

æœ€åä¸€ä¸ªæ¡ˆä¾‹ç‰¹åˆ«æœ‰æ„æ€ã€‚é€šè¿‡è®©ä½ çš„ç”¨æˆ·é€šè¿‡ç½‘ç»œâ€œå®‰è£…â€åº”ç”¨ç¨‹åºï¼Œä½ å¯èƒ½å®é™…ä¸Šå…é™¤äº†ä¸€äº› FUDï¼Œæ¯”å¦‚â€œå“¦ï¼Œå®ƒä¸€å®šæ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºâ€ã€‚

[![Must Install](../Images/b0a13383f82b18da27b5d4ffcad6895d.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PylxppJK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ewnhagfk4weezt9c1ket.png)

## [](#implementation-theory)å®ç°ç†è®º

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥æ£€æµ‹å·²å®‰è£…çš„ PWAã€‚åœ¨ iOS ä¸Šï¼Œè¿™å¾ˆç®€å•:æˆ‘ä»¬å¯ä»¥å¯»æ‰¾`navigator.standalone`å±æ€§:å½“ä¸€ä¸ªé¡µé¢ä»ä¸»å±å¹•å¯åŠ¨æ—¶ï¼Œå®ƒæ˜¯*çœŸå®çš„*ã€‚

åœ¨ Android ä¸Šï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ªé€‰é¡¹ã€‚ç¬¬ä¸€ç§ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€ç§ï¼Œæ˜¯é…ç½®ç«™ç‚¹å®‰è£…æ—¶åŠ è½½çš„ URLã€‚å¦‚æœä½ æ­£åœ¨æ„å»ºä¸€ä¸ª PWAï¼Œä½ å°†æœ‰ä¸€ä¸ª [Web åº”ç”¨æ¸…å•](https://developer.mozilla.org/en-US/docs/Web/Manifest)â€”â€”é€šå¸¸è¢«å‘½åä¸º`manifest.json`æˆ–`manifest.webmanifest`ã€‚å½“ç”¨æˆ·è¢«æç¤ºå®‰è£…ä½ çš„ PWA æ—¶ï¼Œè¿›å…¥ä¸»å±å¹•çš„ URL å®é™…ä¸Šæ˜¯ç”±`start_url`å­—æ®µè®¾ç½®çš„:

```
{
  "name": "You Must Install!",
  "short_name": "Installed!",
  "display": "standalone",
  "start_url": "/?homescreen=1",  // set a query we can detect
  ...
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç¬¬äºŒä¸ªé€‰æ‹©æ˜¯ï¼Œå¦‚æœä½ çš„ç½‘ç«™æ˜¯`display: standalone`â€”â€”å®ƒç§»é™¤äº†åœ°å€æ ï¼Œç»™ä½ çš„ PWA ä¸€ä¸ªç±»ä¼¼åº”ç”¨çš„ä½“éªŒâ€”â€”ä½ å¯ä»¥é€šè¿‡ CSS æ£€æŸ¥è¿™ä¸€ç‚¹ã€‚

## [](#implementation-in-practice)åœ¨å®è·µä¸­å®ç°

æˆ‘ä»¬æœ€ç»ˆçš„ JS æ–¹æ³•å¦‚ä¸‹æ‰€ç¤º:

```
function isInstalled() {
  if (navigator.standalone) {
    return true;  // iOS
  }
  if (window.matchMedia('(display-mode: standalone)').matches) {
    return true;  // Android with "display": "standalone" in Manifest
  }
  if (new URL(window.location).searchParams.has('homescreen')) {
    return true;  // fallback to check for "?homescreen=1"
  }
  return false;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥æ§åˆ¶ç«™ç‚¹åŠ è½½ï¼Œå¹¶åšæŒè®©ç”¨æˆ·*åœ¨ç»§ç»­ä¹‹å‰å®‰è£…*ã€‚

## [](#practical-concerns)ç°å®é¡¾è™‘

åœ¨è¿™ä¸¤ä¸ªä¸»è¦å¹³å°ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½çœŸæ­£å¼ºåˆ¶å®‰è£…æç¤ºï¼Œæˆ–è€…çŸ¥é“æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‰é’®æˆ–ç”¨æˆ·äº¤äº’å¯é åœ°è§¦å‘å®ƒçš„æµç¨‹ã€‚

åœ¨ iOS ä¸Šï¼Œè¿™(æˆªè‡³ 2019 å¹´)åœ¨æŠ€æœ¯ä¸Šæ ¹æœ¬ä¸å¯èƒ½ã€‚

åœ¨ Android ä¸Šï¼Œå‚ä¸åº¦æŒ‡æ ‡ç”¨äºæç¤ºç”¨æˆ·å®‰è£…ï¼Œä½ çš„ç½‘ç«™ä¹Ÿå¯ä»¥ä½¿ç”¨ [`onbeforeinstallprompt`](https://developer.mozilla.org/en-US/docs/Web/API/Window/onbeforeinstallprompt) æ¥æ›´å¥½åœ°æ§åˆ¶æç¤ºã€‚

è¿™ä¸ªæŒ‡æ ‡éå¸¸æœ‰ç”¨ã€‚ä½œä¸ºç½‘ç»œç”¨æˆ·ï¼Œæˆ‘ä»¬çŸ¥é“æ²¡å®Œæ²¡äº†çš„â€œå…è®¸é€šçŸ¥â€æç¤ºä»¤äººéå¸¸æ²®ä¸§ã€‚æ·»åŠ â€œå®‰è£…â€æç¤ºï¼Œæ²¡æœ‰ä»»ä½•æ¥åˆæ§åˆ¶ï¼Œåªä¼šç«ä¸Šæµ‡æ²¹ã€‚ğŸ”¥

å½’ç»“èµ·æ¥å°±æ˜¯ï¼Œåœ¨è¿™ä¸¤ä¸ªå¹³å°ä¸Šï¼Œè¿™æ•´ä¸ªæè®®å°†è¿«ä½¿ä½ æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ï¼Œè¯´â€œåœ¨ä½¿ç”¨å‰ç‚¹å‡»ä½ çš„å¹³å°çš„ç”¨æˆ·ç•Œé¢æ¥â€˜å®‰è£…â€™â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„æ€ç»´å®éªŒè™½ç„¶æœ‰è¶£ï¼Œä½†å¯èƒ½ä¸å®ç”¨ã€‚ğŸ‘

# [](#thanks)æ„Ÿè°¢

è°¢è°¢ä½ å’Œæˆ‘ä¸€èµ·è¸ä¸Šè¿™æ®µæ—…ç¨‹ï¼ğŸ’­

Fourteen