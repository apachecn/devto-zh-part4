# ğŸš€Transloco ç®€ä»‹:è§’åº¦å›½é™…åŒ–è¿›å±•é¡ºåˆ©

> åŸæ–‡:[https://dev . to/netanel basal/introducing-transloco-angular-international ization-done-right-3hh 7](https://dev.to/netanelbasal/introducing-transloco-angular-internationalization-done-right-3hh7)

æœ€åˆå‘è¡¨äº[netbasal.com](https://netbasal.com/introducing-transloco-angular-internationalization-done-right-54710337630c)

æœ‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä¸€ç›´åœ¨è€ƒè™‘åˆ›å»ºä¸€ä¸ª Angular i18n åº“ï¼Œå®ƒåŒ…å«äº†æˆ‘è„‘æµ·ä¸­çš„ä¸€äº›æ¦‚å¿µã€‚

å‡ å‘¨å‰ï¼Œæˆ‘å¾ˆæ— èŠğŸ˜€ï¼Œæ‰€ä»¥æˆ‘å†³å®šæ˜¯æ—¶å€™ä¸ç•è‰°é™©ï¼Œç»§ç»­åˆ›å»ºä¸€ä¸ªå¥å£®çš„åº“äº†ï¼Œé‡Œé¢è£…æ»¡äº†æˆ‘æœŸæœ›ä»è¿™æ ·ä¸€ä¸ªåº“ä¸­è·å¾—çš„æ‰€æœ‰ç‰¹æ€§ã€‚

æˆ‘æ‹›å‹Ÿäº†æ²™å“ˆå°”Â·å¡æ‰å…¹å’Œä¼Šæ³°Â·å¥¥å¾·æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼›æˆ‘ä»¬ä¸€èµ·åœ¨å·¥ä½œæ—¥çš„æ™šä¸ŠåŠªåŠ›å·¥ä½œï¼Œè¿™å°±æ˜¯ Transloco çš„è¯ç”Ÿã€‚

æˆ‘è¿˜åˆ›å»ºäº† ng-neat ç»„ç»‡æ¥ä¿å­˜æˆ‘æ‰€æœ‰çš„å¼€æºåº“ã€‚ç›®å‰å®ƒåªæŒæœ‰ Translocoï¼Œä½†æˆ‘ä¹Ÿè®¡åˆ’è½¬ç§»[æ—è§‚è€…](https://github.com/NetanelBasal/spectator)ã€ [ngx-until-destroy](https://github.com/NetanelBasal/ngx-take-until-destroy) ã€ngx-content-loader ä»¥åŠæˆ‘å°†æ¥åˆ›å»ºçš„ä»»ä½•å¼€æº Angular åº“ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ Transloco æä¾›äº†ä»€ä¹ˆã€‚

ä½¿ç”¨ Angular CLI å®‰è£…åº“:

```
ng add @ngneat/transloco 
```

[![](../Images/4d3b4b28ddd113790f17a8da7eac4603.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--YzGZMBA3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/2600/1%2ARnSX-ybFkKsUYEawHDWJHQ.gif)

ä½œä¸ºå®‰è£…è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæ‚¨ä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼›ä¸€æ—¦ä½ å›ç­”äº†è¿™äº›é—®é¢˜ï¼Œæ‰€æœ‰ä½ éœ€è¦çš„ä¸œè¥¿éƒ½ä¼šè‡ªåŠ¨ä¸ºä½ ç”Ÿæˆã€‚è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹ç”Ÿæˆçš„æ–‡ä»¶ã€‚

é¦–å…ˆï¼ŒTransloco ä¸ºè¯·æ±‚çš„ç¿»è¯‘åˆ›å»ºæ ·æ¿æ–‡ä»¶:

assets/i18n/en.json

```
{  "hello":  "transloco en",  "dynamic":  "transloco {{value}}"  } 
```

assets/i18n/es.json

```
{  "hello":  "transloco es",  "dynamic":  "transloco {{value}}"  } 
```

æ¥ä¸‹æ¥ï¼Œå®ƒå°†`TranslocoModule`æ³¨å…¥åˆ°`AppModule`ä¸­ï¼Œå¹¶ä¸ºæ‚¨è®¾ç½®ä¸€äº›é»˜è®¤é€‰é¡¹:

```
import { TRANSLOCO_CONFIG, TranslocoModule } from '@ngneat/transloco';
import { HttpClientModule } from '@angular/common/http';
import { httpLoader } from './loaders/http.loader';
import { environment } from '../environments/environment';

@NgModule({
  imports: [TranslocoModule, HttpClientModule],
  providers: [
    httpLoader
    {
      provide: TRANSLOCO_CONFIG,
      useValue: {
        prodMode: environment.production,
        listenToLangChange: true,
        defaultLang: 'en'
      }
    }
  ],
  bootstrap: [AppComponent]
})
export class AppModule {} 
```

è®©æˆ‘ä»¬è§£é‡Šä¸€ä¸‹æ¯ä¸ªé…ç½®é€‰é¡¹:

*   `listenToLangChange`:è®¢é˜…è¯­è¨€æ›´æ”¹äº‹ä»¶ï¼Œå…è®¸æ‚¨æ›´æ”¹æ´»åŠ¨è¯­è¨€ã€‚åœ¨ä¸å…è®¸ç”¨æˆ·åœ¨è¿è¡Œæ—¶æ›´æ”¹è¯­è¨€çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè¿™æ˜¯ä¸éœ€è¦çš„(ä¾‹å¦‚ï¼Œä»ä¸‹æ‹‰èœå•ä¸­)ï¼Œå› æ­¤åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œé€šè¿‡å°†å…¶è®¾ç½®ä¸º falseï¼Œæ‚¨å¯ä»¥é€šè¿‡æ¸²æŸ“è§†å›¾ä¸€æ¬¡å¹¶å–æ¶ˆè®¢é˜…è¯­è¨€æ›´æ”¹äº‹ä»¶(é»˜è®¤ä¸º false)æ¥èŠ‚çœå†…å­˜
*   `defaultLang`:è®¾ç½®é»˜è®¤è¯­è¨€
*   `fallbackLang`:è®¾ç½®é»˜è®¤è¯­è¨€ä½œä¸ºå¤‡ç”¨è¯­è¨€
*   `failedRetries`:å¦‚æœåŠ è½½å¤±è´¥ï¼ŒTransloco åº”è¯¥é‡è¯•åŠ è½½ç¿»è¯‘æ–‡ä»¶å¤šå°‘æ¬¡(é»˜è®¤ä¸º 2 æ¬¡)

å®ƒè¿˜å°† httpLoader æ³¨å…¥åˆ°`AppModule`æä¾›è€…:

```
import { HttpClient } from '@angular/common/http';
import { Translation, TRANSLOCO_LOADER, TranslocoLoader } from '@ngneat/transloco';
import { Injectable } from '@angular/core';

@Injectable({ providedIn: 'root' })
export class HttpLoader implements TranslocoLoader {
  constructor(private http: HttpClient) {}

  getTranslation(langPath: string) {
    return this.http.get<Translation>(`/assets/i18n/${langPath}.json`);
  }
}

export const httpLoader = { provide: TRANSLOCO_LOADER, useClass: HttpLoader }; 
```

`HttpLoader`æ˜¯ä¸€ä¸ªå®ç°`TranslocoLoader`æ¥å£çš„ç±»ã€‚å®ƒè´Ÿè´£æŒ‡å¯¼ transloco å¦‚ä½•åŠ è½½ç¿»è¯‘æ–‡ä»¶ã€‚å®ƒä½¿ç”¨ Angular HTTP å®¢æˆ·ç«¯æ ¹æ®ç»™å®šçš„è·¯å¾„è·å–æ–‡ä»¶ã€‚

## [](#translation-in-the%C2%A0template)æ¨¡æ¿ä¸­çš„ç¿»è¯‘

Transloco æä¾›äº†ä¸‰ç§ç¿»è¯‘æ¨¡æ¿çš„æ–¹æ³•:

### [](#using-the-structural-directive)ä½¿ç”¨ç»“æ„åŒ–æŒ‡ä»¤

è¿™æ˜¯æ¨èçš„æ–¹æ³•ã€‚å®ƒç®€æ´é«˜æ•ˆï¼Œå› ä¸ºå®ƒä¸ºæ¯ä¸ªæ¨¡æ¿åˆ›å»ºä¸€ä¸ªè®¢é˜…:

```
<ng-container *transloco="let t">
  <ul>
    <li>{{ t.home }}</li>
    <li>{{ t.alert | translocoParams: { value: dynamic } }}</li>
  </ul>
</ng-container> 
```

### [](#using-the-attribute-directive)ä½¿ç”¨å±æ€§æŒ‡ä»¤

```
<ul>
  <li><span transloco="home"></span></li>
  <li>
    <span transloco="alert" [translocoParams]="{ value: dynamic }"></span>
  </li>
  <li><span [transloco]="key"></span></li>
</ul> 
```

### [](#using-the%C2%A0pipe)ä½¿ç”¨ç®¡é“

```
<span>{{ 'home' | transloco }}</span> 
<span>{{ 'alert' | transloco: { value: dynamic } }}</span> 
```

## [](#programmatical-translation)ç¨‹åºç¿»è¯‘

æœ‰æ—¶æ‚¨å¯èƒ½éœ€è¦ç¿»è¯‘ç»„ä»¶æˆ–æœåŠ¡ä¸­çš„ä¸€ä¸ªé”®ã€‚ä¸ºæ­¤ï¼Œæ‚¨å¯ä»¥æ³¨å…¥ TranslocoService å¹¶ä½¿ç”¨å®ƒçš„ translate æ–¹æ³•:

```
export class AppComponent {
  constructor(private service: TranslocoService) {}

  ngOnInit() {
    this.service.translate('hello');
    this.service.translate('hello', { value: 'world' });
    this.service.translate(['hello', 'key']);
    this.service.translate('hello', params, 'en');
    this.service.translate<T>(translate => translate.someKey);
  }
} 
```

## [](#but-wait%E2%80%8A%E2%80%8Atheres%C2%A0more)ğŸ˜±ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æœ‰æ›´å¤šï¼

è¿™åªæ˜¯ Transloco çš„ä¸€ä¸ªå°è¯•ï¼Œå®ƒè¿˜æ”¯æŒ:

*   ğŸ˜´æƒ°æ€§è£…è½½
*   ğŸ˜å¤šç§è¯­è¨€
*   ğŸ”¥å¤šæ¬¡å›è½
*   ğŸ¤“æµ‹è¯•
*   ğŸ¦Šå®Œå…¨å¯å®šåˆ¶

æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„å®˜æ–¹è‡ªè¿°æ–‡ä»¶ä¸­æ‰¾åˆ°æ‚¨éœ€è¦çš„æ‰€æœ‰å†…å®¹å’Œç¤ºä¾‹ã€‚

## [](#migration-from-ngxtranslate)ä» ngx è¿ç§»-ç¿»è¯‘

Transloco æä¾›äº†ä¸€ä¸ª schematics å‘½ä»¤æ¥å¸®åŠ©æ‚¨å®Œæˆè¿ç§»è¿‡ç¨‹ã€‚æŸ¥çœ‹æ¯”è¾ƒ[è¡¨](https://github.com/ngneat/transloco/#comparison-to-other-libraries)äº†è§£æ›´å¤šä¿¡æ¯ã€‚

ç¿»è¯‘æ„‰å¿«ï¼Œåˆ«å¿˜äº†é€šè¿‡ä¸»æ¼”æ¥è¡¨è¾¾ä½ çš„æ¬£èµï¼

â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸