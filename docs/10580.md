# WebGL æœˆä»½ã€‚ç¬¬ä¸‰åå¤©ã€‚WebGL ä¸­çš„æ–‡æœ¬å‘ˆç°

> åŸæ–‡:[https://dev . to/lesnitsky/web GL-month-day-30-text-rendering-in-web GL-3ih 3](https://dev.to/lesnitsky/webgl-month-day-30-text-rendering-in-webgl-3ih3)

è¿™æ˜¯ä¸€ç³»åˆ—ä¸ WebGL ç›¸å…³çš„åšæ–‡ã€‚æ¯å¤©éƒ½ä¼šæœ‰æ–°å¸–å­

[![GitHub stars](../Images/7135120af1222f52e8cbd2d667467057.png)](https://github.com/lesnitsky/webgl-month)
[![Twitter Follow](../Images/9e598f0325869910a956a73860b171ca.png)T6ã€‘](https://twitter.com/lesnitsky_a)

[åŠ å…¥é‚®ä»¶åˆ—è¡¨](http://eepurl.com/gwiSeH),è®©æ–°é‚®ä»¶ç›´æ¥è¿›å…¥ä½ çš„æ”¶ä»¶ç®±

[æ­¤å¤„æä¾›æºä»£ç ](https://github.com/lesnitsky/webgl-month)

å»ºé€ äº

[![Git Tutor Logo](../Images/4a5fcbd1126401b65ca7fbe362404aa0.png)T2ã€‘](https://github.com/lesnitsky/git-tutor)

* * *

å˜¿ğŸ‘‹

æ¬¢è¿æ¥åˆ° WebGL æœˆã€‚

åœ¨ä»¥å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸“æ³¨äºæ¸²æŸ“ 2d å’Œ 3d å›¾å½¢ï¼Œä½†ä»æœªæ¸²æŸ“è¿‡æ–‡æœ¬ï¼Œè¿™æ˜¯ä»»ä½•åº”ç”¨ç¨‹åºçš„é‡è¦éƒ¨åˆ†ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å›é¡¾æ–‡æœ¬æ¸²æŸ“çš„å¯èƒ½æ–¹å¼ã€‚

### [](#html-overlay)HTML è¦†ç›–

æœ€æ˜æ˜¾å’Œç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨ HTML æ¸²æŸ“æ–‡æœ¬ï¼Œå¹¶æŠŠå®ƒæ”¾åœ¨ webgl ç”»å¸ƒä¸Šï¼Œä½†è¿™åªé€‚ç”¨äº 2D åœºæ™¯ï¼Œ3D å†…å®¹éœ€è¦ä¸€äº›è®¡ç®—æ¥è®¡ç®—æ–‡æœ¬ä½ç½®å’Œ css è½¬æ¢

### [](#canvas-as-texture)ç”»å¸ƒä½œä¸ºçº¹ç†

å…¶ä»–æŠ€æœ¯å¯ä»¥åº”ç”¨äºæ›´å¹¿æ³›çš„æƒ…å†µã€‚è¿™éœ€è¦å‡ ä¸ªæ­¥éª¤

1.  åˆ›å»ºå¦ä¸€ä¸ªç”»å¸ƒ
2.  è·å– 2d ä¸Šä¸‹æ–‡(`canvas.getContext('2d')`)
3.  ç”¨`fillText`æˆ–`strokeText`æ¸²æŸ“æ–‡æœ¬
4.  ä½¿ç”¨æ­¤ç”»å¸ƒä½œä¸ºå…·æœ‰æ­£ç¡®çº¹ç†åæ ‡çš„ webgl çº¹ç†

ç”±äºçº¹ç†æ˜¯å…‰æ …åŒ–çš„å›¾åƒï¼Œå½“ä½ â€œé è¿‘â€ç‰©ä½“æ—¶ï¼Œå®ƒä¼šå¤±å»è´¨é‡

### [](#glyphs-texture)å­—å½¢çº¹ç†

æ¯ä¸ªå­—ä½“å®é™…ä¸Šæ˜¯ä¸€ç»„â€œå­—å½¢â€â€”â€”æ¯ä¸ªç¬¦å·éƒ½å‘ˆç°åœ¨ä¸€ä¸ªå›¾åƒä¸­

```
A | B | C | D | E | F | G |
---------------------------
H | I | J | K | L | M | N |
... 
```

æ¯ä¸ªå­—æ¯éƒ½æœ‰è‡ªå·±çš„â€œå±æ€§â€ï¼Œæ¯”å¦‚å®½åº¦(`i`æ¯”`W`ç»†)ã€é«˜åº¦(`o`æ¯”`L`)ç­‰ç­‰ã€‚
è¿™äº›å±æ€§å°†å½±å“å¦‚ä½•æ„å»ºåŒ…å«æ¯ä¸ªå­—æ¯çš„çŸ©å½¢

é€šå¸¸ï¼Œé™¤äº†çº¹ç†ä¹‹å¤–ï¼Œä½ è¿˜éœ€è¦ä¸€ä¸ª javascript å¯¹è±¡æ¥æè¿°åŸå§‹çº¹ç†å›¾åƒä¸­çš„æ‰€æœ‰å±æ€§å’Œåæ ‡

```
const font = {
    textureSize: {
        width: 512,
        height: 512,
    },
    height: 32,
    glyphs: {
        a: { x: 0, y: 0, height: 32, width: 16 },
        b: { x: 16, y: 0, height: 32, width: 14 },
    },
    // ...
}; 
```

ä¸ºäº†æ¸²æŸ“ä¸€äº›æ–‡æœ¬ï¼Œä½ éœ€è¦è¿™æ ·çš„ä¸œè¥¿

```
function getRects(text, sizeMultiplier) {
    let prevLetterX = 0;

    const rects = text.split('').map((symbol) => {
        const glyph = font.glyphs[symbol];

        return {
            x: prevLetterX,
            y: font.height - glyph.height,
            width: glyph.width * sizeMultiplier,
            height: glyph.height * sizeMultiplier,
            texCoords: glyph,
        };
    });
} 
```

ç¨åè¿™ä¸ªâ€œrectsâ€å°†ç”¨äºç”Ÿæˆå±æ€§æ•°æ®

```
import { createRect } from './gl-helpers';

function generateBuffers(rects) {
    const attributeBuffers = {
        position: [],
        texCoords: [],
    };

    rects.forEach((rect, index) => {
        attributeBuffers.position.push(...createRect(rect.x, rect.y, rect.width, rect.height)),
            attributeBuffers.texCoords.push(
                ...createRect(rect.texCoords.x, rect.texCoords.y, rect.texCoords.width, rect.texCoords.height)
            );
    });

    return attributeBuffers;
} 
```

æœ‰ä¸€ä¸ª [gl-render-text](https://www.npmjs.com/package/gl-render-text) åŒ…å¯ä»¥æ¸²æŸ“åŸºäºçº¹ç†çš„å­—ä½“

### [](#font-triangulation)å­—ä½“ä¸‰è§’å‰–åˆ†

ç”±äº webgl èƒ½å¤Ÿç»˜åˆ¶ä¸‰è§’å½¢ï¼Œä¸€ä¸ªæ›´æ˜æ˜¾çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†æ¯ä¸ªå­—æ¯åˆ†æˆä¸‰è§’å½¢
è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ä»»åŠ¡ğŸ˜¢

å¹¸è¿çš„æ˜¯â€”â€”æœ‰ä¸€ä¸ª [fontpath-gl](https://github.com/mattdesl/fontpath-gl) åŒ…å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹

### [](#signed-distance-field-font)æœ‰ç¬¦å·è·ç¦»å­—æ®µå­—ä½“

åœ¨ OpenGL/WebGL ä¸­æ¸²æŸ“æ–‡æœ¬çš„å¦ä¸€ç§æŠ€æœ¯

ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹æ›´å¤šä¿¡æ¯

* * *

[![GitHub stars](../Images/5eea89274fa9a1b31a3f227425518833.png)](https://github.com/lesnitsky/webgl-month)
[![Twitter Follow](../Images/9e598f0325869910a956a73860b171ca.png)T6ã€‘](https://twitter.com/lesnitsky_a)

[åŠ å…¥é‚®ä»¶åˆ—è¡¨](http://eepurl.com/gwiSeH),è®©æ–°é‚®ä»¶ç›´æ¥è¿›å…¥ä½ çš„æ”¶ä»¶ç®±

[æ­¤å¤„æä¾›æºä»£ç ](https://github.com/lesnitsky/webgl-month)

å»ºé€ äº

[![Git Tutor Logo](../Images/4a5fcbd1126401b65ca7fbe362404aa0.png)T2ã€‘](https://github.com/lesnitsky/git-tutor)