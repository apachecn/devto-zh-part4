# JavaScript ä¸­å…‹éš†å¯¹è±¡çš„ 3 ç§æ–¹æ³•

> åŸæ–‡:[https://dev . to/Samantha Ming/3-ways-to-clone-objects-in-JavaScript-2 OIE](https://dev.to/samanthaming/3-ways-to-clone-objects-in-javascript-2oie)

[![CodeTidbit by SamanthaMing.com](../Images/14f0e2d328ad2b1ab0bb1aac3fdaa416.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--hKg1SbkB--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/cc861cn6f2047d6ydyec.png)

å› ä¸º#JavaScript ä¸­çš„å¯¹è±¡æ˜¯å¼•ç”¨å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°ä½¿ç”¨`=`è¿›è¡Œå¤åˆ¶ã€‚ä½†æ˜¯ä¸è¦æ‹…å¿ƒï¼Œè¿™é‡Œæœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥è®©ä½ å…‹éš†ä¸€ä¸ªå¯¹è±¡ğŸ‘

```
const food = { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' }

// "Spread"
{ ...food }

// "Object.assign"
Object.assign({}, food)

// "JSON"
JSON.parse(JSON.stringify(food))

// RESULT:
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

## [](#objects-are-reference-types)å¯¹è±¡ä¸ºå‚ç…§ç±»å‹

ä½ çš„ç¬¬ä¸€ä¸ªé—®é¢˜å¯èƒ½æ˜¯ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¸èƒ½ä½¿ç”¨`=`ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™æ ·åšä¼šå‘ç”Ÿä»€ä¹ˆ:

```
const obj = {one: 1, two: 2};

const obj2 = obj;

console.log(
  obj,  // {one: 1, two: 2};
  obj2  // {one: 1, two: 2};
) 
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸¤ä¸ªå¯¹è±¡ä¼¼ä¹è¾“å‡ºç›¸åŒçš„ä¸œè¥¿ã€‚æ‰€ä»¥æ²¡é—®é¢˜ï¼Œå¯¹ã€‚ä½†æ˜¯è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœç¼–è¾‘ç¬¬äºŒä¸ªå¯¹è±¡ä¼šå‘ç”Ÿä»€ä¹ˆ:

```
const obj2.three = 3;

console.log(obj2);
// {one: 1, two: 2, three: 3}; <-- âœ…

console.log(obj);
// {one: 1, two: 2, three: 3}; <-- ğŸ˜± 
```

WTHï¼Ÿï¼æˆ‘æ”¹å˜äº†`obj2`ä½†æ˜¯ä¸ºä»€ä¹ˆ`obj`ä¹Ÿå—åˆ°äº†å½±å“ã€‚è¿™æ˜¯å› ä¸ºå¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ã€‚æ‰€ä»¥å½“ä½ ä½¿ç”¨`=`æ—¶ï¼Œå®ƒæŠŠæŒ‡é’ˆå¤åˆ¶åˆ°å®ƒæ‰€å æ®çš„å†…å­˜ç©ºé—´ã€‚å¼•ç”¨ç±»å‹ä¸ä¿å­˜å€¼ï¼Œå®ƒä»¬æ˜¯æŒ‡å‘å†…å­˜ä¸­çš„å€¼çš„æŒ‡é’ˆã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œå¯ä»¥å»çœ‹çœ‹é«˜é¡¿çš„æœ±[æ‰‹è¡¨å’Œä»£ç ](https://watchandcode.com)è¯¾ç¨‹ã€‚æŠ¥åå…è´¹ï¼Œçœ‹è§†é¢‘ã€Šä¸ç‰©ä½“å¯¹æ¯”ã€‹ã€‚ä»–ç»™å‡ºäº†ä¸€ä¸ªè¶…çº§æ£’çš„è§£é‡Šã€‚

## [](#using-spread)åˆ©ç”¨ä¼ æ’­

ä½¿ç”¨æ‰©å±•å°†å…‹éš†æ‚¨çš„å¯¹è±¡ã€‚è¯·æ³¨æ„ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªè‚¤æµ…çš„å‰¯æœ¬ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå…‹éš†å¯¹è±¡çš„æ‰©å±•æ“ä½œç¬¦å¤„äºç¬¬ 4 é˜¶æ®µã€‚æ‰€ä»¥è¿˜æ²¡æœ‰æ­£å¼åˆ—å…¥è§„æ ¼ã€‚æ‰€ä»¥å¦‚æœä½ è¦ç”¨è¿™ä¸ªï¼Œä½ éœ€è¦ç”¨ Babel(æˆ–è€…ç±»ä¼¼çš„ä¸œè¥¿)æ¥ç¼–è¯‘å®ƒã€‚

```
const food = { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' };

const cloneFood = { ...food };

console.log(cloneFood); 
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

## [](#using-objectassign)ä½¿ç”¨ Object.assign

æˆ–è€…ï¼Œ`Object.assign`æ˜¯åœ¨æ­£å¼å‘å¸ƒçš„åŒæ—¶ä¹Ÿåˆ›å»ºä¸€ä¸ªæµ…æ‹·è´çš„å¯¹è±¡ã€‚

```
const food = { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' };

const cloneFood = Object.assign({}, food);

console.log(cloneFood);
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

## [](#using-json)ä½¿ç”¨ JSON

è¿™æœ€åçš„æ–¹å¼ä¼šç»™ä½ ä¸€ä¸ªæ·±åˆ»çš„å‰¯æœ¬ã€‚ç°åœ¨æˆ‘è¦æä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ç§å¿«é€Ÿè€Œè‚®è„çš„æ·±åº¦å…‹éš†å¯¹è±¡çš„æ–¹æ³•ã€‚å¯¹äºä¸€ä¸ªæ›´å¥å£®çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ‘æ¨èä½¿ç”¨ç±»ä¼¼äº[æ´›è¾¾ä»€](https://lodash.com/docs/#cloneDeep)
çš„ä¸œè¥¿

```
const food = { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' };

const cloneFood = JSON.parse(JSON.stringify(food))

console.log(cloneFood); 
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

### [](#lodash-deepclone-vs-json)Lodash DeepClone vs JSON

è¿™æ˜¯æ¥è‡ªç¤¾åŒºçš„è¯„è®ºã€‚æ˜¯çš„ï¼Œæ˜¯ä¸ºäº†æˆ‘ä¹‹å‰çš„å¸–å­ï¼Œ[å¦‚ä½•æ·±åº¦å…‹éš†ä¸€ä¸ªæ•°ç»„](https://www.samanthaming.com/tidbits/50-how-to-deep-clone-an-array)ã€‚ä½†æ˜¯è¿™ä¸ªæƒ³æ³•ä»ç„¶é€‚ç”¨äºç‰©ä½“ã€‚

æˆ‘æƒ³è®©ä½ æ³¨æ„åˆ°ï¼ŒdeepClone å’Œ JSON.stringify/parse.ä¹‹é—´æœ‰ä¸€äº›ä¸åŒ

*   **JSON.stringify/parse**åªå¤„ç†æ•°å­—ã€å­—ç¬¦ä¸²å’Œæ²¡æœ‰å‡½æ•°æˆ–ç¬¦å·å±æ€§çš„å¯¹è±¡æ–‡å­—ã€‚
*   **deepClone** å·¥ä½œç”¨çš„æ‰€æœ‰ç±»å‹ã€å‡½æ•°å’Œç¬¦å·éƒ½æ˜¯é€šè¿‡å¼•ç”¨å¤åˆ¶çš„ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:

```
const lodashClonedeep = require("lodash.clonedeep");

const arrOfFunction = [() => 2, {
    test: () => 3,
}, Symbol('4')];

// deepClone copy by refence function and Symbol
console.log(lodashClonedeep(arrOfFunction));
// JSON replace function with null and function in object with undefined
console.log(JSON.parse(JSON.stringify(arrOfFunction)));

// function and symbol are copied by reference in deepClone
console.log(lodashClonedeep(arrOfFunction)[0] === lodashClonedeep(arrOfFunction)[0]);
console.log(lodashClonedeep(arrOfFunction)[2] === lodashClonedeep(arrOfFunction)[2]); 
```

*[@ OlegVaraksin](https://twitter.com/OlegVaraksin/status/1152850845303824384):*JSON æ–¹æ³•æœ‰å¾ªç¯ä¾èµ–çš„éº»çƒ¦ã€‚æ­¤å¤–ï¼Œå…‹éš†å¯¹è±¡ä¸­å±æ€§çš„é¡ºåºå¯èƒ½ä¸åŒã€‚

## [](#shallow-clone-vs-deep-clone)æµ…å±‚å…‹éš† vs æ·±å±‚å…‹éš†

å½“æˆ‘ä½¿ç”¨ spread æ—¶...è¦å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘åªæ˜¯åˆ›å»ºä¸€ä¸ªæµ…æ‹·è´ã€‚å¦‚æœæ•°ç»„æ˜¯åµŒå¥—çš„æˆ–è€…å¤šç»´çš„ï¼Œé‚£å°±ä¸è¡Œã€‚æˆ‘ä»¬æ¥çœ‹çœ‹:

```
const nestedObject = {
  country: 'ğŸ‡¨ğŸ‡¦',
  {
    city: 'vancouver'
  }
};

const shallowClone = { ...nestedObject };

// Changed our cloned object
clonedNestedObject.country = 'ğŸ‡¹ğŸ‡¼'
clonedNestedObject.country.city = 'taipei'; 
```

æ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ”¹å˜åŸå¸‚æ¥æ”¹å˜æˆ‘ä»¬çš„å…‹éš†å¯¹è±¡ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¾“å‡ºã€‚

```
console.log(shallowClone);
// {country: 'ğŸ‡¹ğŸ‡¼', {city: 'taipei'}} <-- âœ…

console.log(nestedObject);
// {country: 'ğŸ‡¨ğŸ‡¦', {city: 'taipei'}} <-- ğŸ˜± 
```

æµ…å¤åˆ¶æ„å‘³ç€å¤åˆ¶ç¬¬ä¸€ä¸ªçº§åˆ«ï¼Œå¼•ç”¨æ›´æ·±çš„çº§åˆ«ã€‚

### [](#deep-copy)æ·±åº¦å¤åˆ¶

è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªç›¸åŒçš„ä¾‹å­ï¼Œä½†æ˜¯ä½¿ç”¨â€œJSONâ€
åº”ç”¨æ·±åº¦æ‹·è´

```
const deepClone = JSON.parse(JSON.stringify(nestedObject));

console.log(deepClone);
// {country: 'ğŸ‡¹ğŸ‡¼', {city: 'taipei'}} <-- âœ…

console.log(nestedObject);
// {country: 'ğŸ‡¨ğŸ‡¦', {city: 'vancouver'}} <-- âœ… 
```

å¦‚æ‚¨æ‰€è§ï¼Œæ·±å±‚å‰¯æœ¬æ˜¯åµŒå¥—å¯¹è±¡çš„çœŸå®å‰¯æœ¬ã€‚é€šå¸¸æµ…æ‹·è´å°±è¶³å¤Ÿäº†ï¼Œä½ ä¸éœ€è¦æ·±æ‹·è´ã€‚å°±åƒé’‰æª vs é”¤å­ã€‚å¤§éƒ¨åˆ†æ—¶é—´é”¤å­éƒ½å¾ˆå¥½ã€‚å¯¹äºä¸€äº›å°çš„è‰ºæœ¯å’Œå·¥è‰ºæ¥è¯´ï¼Œä½¿ç”¨å°„é’‰æªç»å¸¸æ˜¯å¤§æå°ç”¨ï¼Œé”¤å­å°±å¯ä»¥äº†ã€‚è¿™ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†ä½¿ç”¨æ­£ç¡®çš„å·¥å…·å®Œæˆæ­£ç¡®çš„å·¥ä½œğŸ¤“

## [](#performance)è¡¨ç°

ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä¸èƒ½ä¸º spread ç¼–å†™æµ‹è¯•ï¼Œå› ä¸ºå®ƒè¿˜æ²¡æœ‰æ­£å¼çº³å…¥è§„èŒƒã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯å°†å®ƒåŒ…å«åœ¨æµ‹è¯•ä¸­ï¼Œä»¥ä¾¿æ‚¨å°†æ¥å¯ä»¥è¿è¡Œå®ƒã€‚ä½†æ˜¯ç»“æœæ˜¾ç¤º`Object.assign`æ¯”`JSON`å¿«å¾ˆå¤šã€‚

[æ€§èƒ½æµ‹è¯•](https://jsperf.com/3-ways-to-clone-object/1)

## [](#community-input)ç¤¾åŒºè¾“å…¥

### object . assign vs spray

*[@d9el](https://dev.to/adameier/comment/d9el) :* éœ€è¦æ³¨æ„çš„æ˜¯ Object.assign æ˜¯ä¸€ä¸ªä¿®æ”¹å¹¶è¿”å›ç›®æ ‡å¯¹è±¡çš„å‡½æ•°ã€‚åœ¨èæ›¼çŠçš„ä¾‹å­ä¸­ä½¿ç”¨äº†ä¸‹é¢çš„è¯ï¼Œ

```
const cloneFood = Object.assign({}, food) 
```

`{}`æ˜¯è¢«ä¿®æ”¹çš„å¯¹è±¡ã€‚æ­¤æ—¶ï¼Œç›®æ ‡å¯¹è±¡æ²¡æœ‰è¢«ä»»ä½•å˜é‡å¼•ç”¨ï¼Œä½†æ˜¯å› ä¸º`Object.assign`è¿”å›ç›®æ ‡å¯¹è±¡ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°†ç»“æœèµ‹å€¼å¯¹è±¡å­˜å‚¨åˆ°`cloneFood`å˜é‡ä¸­ã€‚æˆ‘ä»¬å¯ä»¥æ”¹å˜æˆ‘ä»¬çš„ä¾‹å­ï¼Œä½¿ç”¨ä¸‹é¢çš„:

```
const food = { beef: 'ğŸŒ½', bacon: 'ğŸ¥“' };

Object.assign(food, { beef: 'ğŸ¥©' });

console.log(food);
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬çš„é£Ÿç‰©å¯¹è±¡ä¸­çš„`beef`çš„å€¼æ˜¯é”™è¯¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`Object.assign`æ¥èµ‹å€¼`beef`çš„æ­£ç¡®å€¼ã€‚æˆ‘ä»¬å®é™…ä¸Šæ ¹æœ¬æ²¡æœ‰ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬ä¿®æ”¹äº†æˆ‘ä»¬ç”¨ const `food`å¼•ç”¨çš„ç›®æ ‡å¯¹è±¡ã€‚

å¦ä¸€æ–¹é¢ï¼ŒSpread æ˜¯å°†ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å¤åˆ¶åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ä¸­çš„æ“ä½œç¬¦ã€‚å¦‚æœæˆ‘ä»¬æƒ³å¤åˆ¶ä¸Šé¢çš„ä¾‹å­ï¼Œä½¿ç”¨ spread æ¥ä¿®æ”¹æˆ‘ä»¬çš„å˜é‡`food...`

```
const food = { beef: 'ğŸŒ½', bacon: 'ğŸ¥“' };

food = {
  ...food,
  beef: 'ğŸ¥©',
}
// TypeError: invalid assignment to const `food' 
```

æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åˆ›å»ºæ–°å¯¹è±¡æ—¶ä½¿ç”¨äº† spreadï¼Œå› æ­¤å°†ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡èµ‹ç»™äº†ç”¨`const`å£°æ˜çš„`food`ï¼Œè¿™æ˜¯éæ³•çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©å£°æ˜ä¸€ä¸ªæ–°å˜é‡æ¥ä¿å­˜æˆ‘ä»¬çš„æ–°å¯¹è±¡ï¼Œå¦‚ä¸‹:

```
const food = { beef: 'ğŸŒ½', bacon: 'ğŸ¥“' };

const newFood = {
  ...food,
  beef: 'ğŸ¥©',
}

console.log(newFood);
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

æˆ–è€…æˆ‘ä»¬å¯ä»¥ç”¨`let`æˆ–`var`å£°æ˜`food`ï¼Œè¿™å°†å…è®¸æˆ‘ä»¬åˆ†é…ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡:

```
let food = { beef: 'ğŸŒ½', bacon: 'ğŸ¥“' };

food = {
  ...food,
  beef: 'ğŸ¥©',
}

console.log(food);
// { beef: 'ğŸ¥©', bacon: 'ğŸ¥“' } 
```

*æ„Ÿè°¢:[@ d9el](https://dev.to/adameier/comment/d9el)T3ã€‘*

### [](#deep-clone-using-external-libraries)ä½¿ç”¨å¤–éƒ¨åº“è¿›è¡Œæ·±åº¦å…‹éš†

*   *[@ lesjeuxdebel](https://twitter.com/lesjeuxdebebel/status/1153259251705503744):*æˆ‘ä¸ªäººç”¨çš„æ˜¯å¸¦`$.extend();`åŠŸèƒ½çš„ jquery
*   *[@edlinkiii](https://twitter.com/edlinkiii/status/1153035836356747267) :* ä¸‹åˆ’çº¿. js ~~ `_.clone()`
*   *[@Percy_Burton](https://twitter.com/Percy_Burton/status/1152671704155660289) :* æˆ‘æ‰€çŸ¥é“çš„å”¯ä¸€çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ Lodash åº“ï¼ŒcloneDeep æ–¹æ³•ã€‚

### [](#more-ways-using-javascript)ä½¿ç”¨ JavaScript çš„æ›´å¤šæ–¹å¼

*   *[@ hariharan _ d3v](https://twitter.com/hariharan_d3v/status/1152815791009460224):*`Object.fromEntries(Object.entries(food))`ã€æµ…è–„ã€‘å…‹éš†å¯¹è±¡ã€‚

**ğŸ’¬ä½ è¿˜çŸ¥é“å¦‚ä½•å…‹éš†ä¸€ä¸ªå¯¹è±¡çš„å…¶ä»–æ–¹æ³•å—ï¼ŸæŠŠå®ƒä»¬æ”¾åœ¨è¯„è®ºé‡ŒğŸ™ƒ**

* * *

## [](#resources)èµ„æº

*   [MDN Web Docs: Object.assign](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)
*   [å †æ ˆæº¢å‡º:åœ¨ JavaScript ä¸­æ·±åº¦å…‹éš†ä¸€ä¸ªå¯¹è±¡æœ€æœ‰æ•ˆçš„æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ](https://stackoverflow.com/questions/122102/what-is-the-most-efficient-way-to-deep-clone-an-object-in-javascript)
*   [2 å±æ€§:å‰©ä½™/å±•å¼€å±æ€§](https://2ality.com/2016/10/rest-spread-properties.html)
*   [å †æ ˆæº¢å‡º:å¯¹è±¡æ‰©æ•£ vs. Object.assign](https://stackoverflow.com/questions/32925460/object-spread-vs-object-assign)

* * *

**æ„Ÿè°¢é˜…è¯»â¤**
é—®å¥½ï¼[insta gram](https://www.instagram.com/samanthaming/)|[Twitter](https://twitter.com/samantha_ming)|[è„¸ä¹¦](https://www.facebook.com/hisamanthaming) | [åšå®¢](https://www.samanthaming.com/blog)|[SamanthaMing.com](https://www.samanthaming.com/)