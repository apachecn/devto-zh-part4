# é˜¿æ³¢ç½—å’Œå¤–éƒ¨æœåŠ¡

> åŸæ–‡:[https://dev.to/iamphill/apollo-and-external-services-4cpo](https://dev.to/iamphill/apollo-and-external-services-4cpo)

æ‚¨æ˜¯å¦æ›¾ç»æƒ³ä½¿ç”¨ GraphQL å’Œ Apolloï¼Œä½†ä»ç„¶æƒ³è®¿é—®ä¸€äº›å¤–éƒ¨æˆ–è¾ƒæ—§çš„ APIï¼Ÿ

å—¯ä½ **å¯ä»¥**ï¼è€Œä¸”åšèµ·æ¥è¶…çº§ç®€å•ã€‚

é¦–å…ˆè®©æˆ‘ä»¬è®¾ç½®æˆ‘ä»¬çš„é˜¿æ³¢ç½—å®¢æˆ·ç«¯

```
import { ApolloClient } from 'apollo-client';
import { InMemoryCache } from 'apollo-cache-inmemory';

const client = new ApolloClient({
  url: URL_TO_GRAPHQL,
  cache: new InMemoryCache(),
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯äº‹æƒ…å˜å¾—æœ‰è¶£çš„åœ°æ–¹ã€‚åœ¨æ—§ç‰ˆæœ¬çš„ Apollo ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ [apollo-link-state](https://www.apollographql.com/docs/link/links/state/) ï¼Œè¿™å°†å…è®¸æ‚¨é€šè¿‡ GraphQL æŸ¥è¯¢è®¿é—®å®¢æˆ·ç«¯æ•°æ®ã€‚ä¸è¿‡ï¼Œè¿™å·²ç»è¢«åˆå¹¶åˆ°é˜¿æ³¢ç½—å®¢æˆ·ç«¯([https://www . apollographql . com/docs/react/essentials/local-state/](https://www.apollographql.com/docs/react/essentials/local-state/))ğŸ‰

è¿™å…è®¸æ‚¨åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨`@client`æŒ‡ä»¤æ¥è®¿é—®æœ¬åœ°ç¼“å­˜çš„æ•°æ®ã€‚

```
query  {  someLocalData  @client  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬é€šè¿‡ GraphQL æŸ¥è¯¢æ¥æŸ¥è¯¢æœ¬åœ°æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Apollo å®¢æˆ·æœºä»£ç å¹¶æ·»åŠ ä¸€ä¸ªé¢å¤–çš„å±æ€§æ¥åˆ›å»ºä¸€äº›æœ¬åœ°æŸ¥è¯¢ã€‚

```
import { ApolloClient } from 'apollo-client';
import { InMemoryCache } from 'apollo-cache-inmemory';

const client = new ApolloClient({
  url: URL_TO_GRAPHQL,
  cache: new InMemoryCache(),
  resolvers: {
    Query: {
      oldApi() {
        return fetch('https://old.api.com/get/old/data')
          .then(r => r.json());
      },
    },
  }
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªéƒ¨åˆ†æ˜¯æœ€é‡è¦çš„éƒ¨åˆ†ã€‚è¿™å‘Šè¯‰ Apolloï¼Œæ¯å½“å®ƒåœ¨æŸ¥è¯¢ä¸­çœ‹åˆ°ä¸€ä¸ª`@client`æŒ‡ä»¤æ—¶ï¼Œå°±ä½¿ç”¨æˆ‘ä»¬çš„æœ¬åœ°è§£æå™¨ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬å‘é€åˆ° API ç«¯ç‚¹ã€‚

ä½¿ç”¨è§£æå™¨è®¾ç½®ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªç±»ä¼¼äº:
çš„æŸ¥è¯¢

```
query  {  oldApi  @client  {  id  text  }  } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯è¿™å®é™…ä¸Šæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä¸€äº›ä¾‹å­:

*   å¯¹è¾ƒæ–°çš„æ•°æ®ä½¿ç”¨æ–°çš„ GraphQL APIï¼Œä½†ä»ç„¶è®¿é—®æ—§çš„ API
*   åˆ›å»ºå°†æ•°æ®ä¿å­˜åˆ°æ—§çš„å†…éƒ¨ API çš„å˜å¼‚ã€‚