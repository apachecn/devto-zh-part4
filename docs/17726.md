# å¦‚ä½•åˆ®è„¸ä¹¦äº‹ä»¶çš„ä¹è¶£å’Œåˆ©æ¶¦ï¼Ÿ

> åŸæ–‡:[https://dev . to/iduoad/how-to-scrape-Facebook-events-for-fun-and-profit-26lo](https://dev.to/iduoad/how-to-scrape-facebook-events-for-fun-and-profit-26lo)

**å…è´£å£°æ˜:è¿™æ˜¯ä¸šä½™çˆ±å¥½è€…çš„ä½œå“ï¼ï¼æœ‰æ›´å¥½çš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼ï¼**

ä¸Šå‘¨ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªå…³äºå¦‚ä½•åˆ®è„¸ä¹¦äº‹ä»¶çš„å¸–å­ï¼Œæˆ‘ä¸€ç›´æƒ³è¿™ä¹ˆåšï¼Œæ‰€ä»¥æˆ‘å†³å®šå°è¯•ä¸€ä¸‹ï¼Œä¸‹é¢æ˜¯ç»“æœã€‚

## [](#1-the-tooling-)1-æ˜é¢ä¸Šï¼

ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦:

*   ç°ä»£æµè§ˆå™¨å¼€å‘å·¥å…·
*   ç®€å•çš„ HTTP å®¢æˆ·ç«¯æµ‹è¯•çš„ä¸œè¥¿ã€‚
*   JS/Browser HTTP å®¢æˆ·ç«¯(å¯é€‰)ã€‚
*   Web æœåŠ¡å™¨å……å½“ä»£ç†ä»¥é¿å… CORS é—®é¢˜(å¯é€‰)ã€‚

## [](#2-browser-network-tools)2-æµè§ˆå™¨ç½‘ç»œå·¥å…·ğŸ”¥ğŸ”¥

ç½‘ç»œå·¥å…·æ˜¯æœ‰å²ä»¥æ¥æœ€è¢«ä½ä¼°çš„å¼€å‘å·¥å…·ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ firefox çš„ä¸€äº›ç½‘ç»œå·¥å…·åŠŸèƒ½ï¼Œå³è¿‡æ»¤å™¨å’Œå¤åˆ¶ä¸º cURLã€‚
[![Firefox dev tools](../Images/d215e7256624da52bdd589a42d22447c.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--r5_CM9Ek--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://0x0.st/zexr.png) 
ä½ è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ¸¸è§ˆ fb.com/events å¹¶æ‰“å¼€ç½‘ç»œå·¥å…·ã€‚æ–½å±•ä¸€äº›è¿‡æ»¤é­”æ³•ã€‚è„¸ä¹¦å‘/events å‘å‡ºä¸€ä¸ª post è¯·æ±‚ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯æ‹¦æˆªè¿™ä¸ªè¯·æ±‚å¹¶åˆ†æå®ƒçš„å†…å®¹ã€‚

`method: POST regexp:events/`

ç„¶åç‚¹å‡»è¯·æ±‚è¡Œï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç»“æœã€‚å¦‚æœä»€ä¹ˆéƒ½æ²¡æœ‰å‡ºç°ï¼Œå‘ä¸‹æ»šåŠ¨ä¸€ç‚¹ï¼Œç›´åˆ°æµè§ˆå™¨å‘å‡ºå¦ä¸€ä¸ªå‘å¸ƒè¯·æ±‚ã€‚

## [](#3-lets-explore-the-thing)3-è®©æˆ‘ä»¬æ¥æ¢ç´¢è¿™ä¸ªä¸œè¥¿

ä¸‹ä¸€æ­¥æ˜¯æ¢ç´¢è¯·æ±‚ä½“å¹¶ä»ä¸­å­¦ä¹ ã€‚è€å®è¯´ï¼Œæˆ‘ä¸çŸ¥é“è¿™äº›å‚æ•°æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Œä½†æ˜¯å¥½å§ï¼

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å³é”®å•å‡»è¯·æ±‚ï¼Œå¹¶ä»å¤åˆ¶èœå•ä¸­é€‰æ‹©å¤åˆ¶ cURLã€‚

å¥½å§ï¼Œè®©æˆ‘ä»¬å†åšä¸€äº›ã€‚ä¸‹ä¸€æ­¥å¤åˆ¶ç²˜è´´åˆ°ä½ çš„ç»ˆç«¯(ä½ æœ‰ curl æˆ–ä¸€äº› curl å…¼å®¹å·¥å…·)å’Œ Tadaaaï¼ï¼æœ‰ç‚¹é•¿äº†ï¼Œä¸æ˜¯å—ï¼Ÿï¼Ÿè®©æˆ‘ä»¬æŠŠå®ƒåˆ†è§£æˆ:

```
curl 'https://www.facebook.com/events/discover/query/' --data 'suggestion_token=%7B%22city%22%3A%22default_108085075885850%22%7D&timezone_id=1&__a=1' > events.json 
```

è¿™æ˜¯æ‚¨ç«‹å³è·å¾—æ´»åŠ¨æ‰€éœ€çš„å…¨éƒ¨å†…å®¹ï¼æœ€æœ‰ç”¨çš„å‚æ•°æ˜¯ *suggestion_token* ,å®ƒåŒ…å«å…³äºæ‚¨å¸Œæœ›äº‹ä»¶å‘ç”Ÿçš„åœ°ç‚¹ã€ä¸»é¢˜å’Œæ—¥æœŸçš„é¦–é€‰é¡¹...

## [](#4-hakuna-matata-lets-make-something)4- Hakuna Matataï¼è®©æˆ‘ä»¬åšç‚¹ä¸œè¥¿

ç°åœ¨æˆ‘ä»¬éœ€è¦ä½¿ç”¨æˆ‘ä»¬çš„äº‹ä»¶(ä¾‹å¦‚åœ¨ä¸€ä¸ªæ¼‚äº®çš„ç½‘é¡µä¸Šæ˜¾ç¤ºå®ƒä»¬)ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæµè§ˆå™¨ http å®¢æˆ·ç«¯åº“(æˆ–è€…è·å– API æˆ–è€…åªæ˜¯æˆ‘ä»¬çš„è€æœ‹å‹ XHR)ã€‚ä½†æ˜¯è¿™ä¸ä¼šç»™æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºè¯¥æ­»çš„æµè§ˆå™¨ä¼šé˜»æ­¢æˆ‘ä»¬çš„è·¨æ¥æºè¯·æ±‚(ä¸ºäº†æˆ‘ä»¬çš„ ofcğŸ™„).
æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸ªä»£ç†(web æœåŠ¡å™¨)ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬åšæŠ“å–ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†é€šè¿‡ fetch æˆ– jquery æˆ– axios æˆ–å…¶ä»–æ–¹å¼åœ¨å®¢æˆ·ç«¯è·å– jsonã€‚
å†æ¬¡æ­¥éª¤:

*   å› ä¸ºæˆ‘ä»¬æ‡’å¾—ç”¨æˆ‘ä»¬æœ€å–œæ¬¢çš„è¯­è¨€é‡å†™ http è¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç”¨è¿™ä¸ªç½‘ç«™æŠŠ cURL è¯­æ³•ç¿»è¯‘æˆ whatever è¯­æ³•:p . [curl to whatever](https://curl.trillworks.com)

```
import requests
data = {  'suggestion_token': '{"city":"default_108085075885850"}',  'timezone_id': '1',  '__a': '1'}
response = requests.post('https://www.facebook.com/events/discover/query/', data=data) 
```

*   è®¾ç½®ä¸€ä¸ª web æœåŠ¡å™¨æ¥æä¾›å¿…é¡»æä¾›çš„æœåŠ¡ã€‚åŒæ ·ï¼Œæˆ‘ä»¬æ‡’å¾—è®¾ç½®ä¸€ä¸ªåˆé€‚çš„ä»£ç†(ä½¿ç”¨ flask æˆ–å…¶ä»–å·¥å…·)æˆ–è‡³å°‘å†™ä¸€ä¸ªåƒæ ·çš„ä»£ç†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨ä¸åˆ° 1 æˆ– 2 åˆ†é’Ÿçš„æ—¶é—´å†…ç¼–å†™ä¸€ä¸ªç®€å•çš„è„šæœ¬..Daaaamnï¼Œè¿™å¤ªä¹±äº†:p

```
from http.server import HTTPServer, BaseHTTPRequestHandler
import requests

class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):    
    def do_GET(self):        
        data = {
          'suggestion_token': '{"city":"default_108085075885850"}',
          'timezone_id': '1',
          '__a': '1'
        }
        response = requests.post('https://www.facebook.com/events/discover/query/', data=data)
        self.send_response(200)
        self.send_header("Access-Control-Allow-Origin", "*") # this is the key line of code !
        self.end_headers()
        self.wfile.write(response.text.encode())

PORT = 8080
httpd = HTTPServer(("", PORT), SimpleHTTPRequestHandler)
httpd.serve_forever() 
```

*   ç”¨ axios æˆ–è€… fetch ä»€ä¹ˆçš„æŠŠå®ƒæ”¾åœ¨ä½ æ¼‚äº®çš„ç½‘é¡µé‡Œã€‚

```
axios.get('localhost:8080')
  .then(function (response) {
    parseAndAddToMyBeautifulWebPage(response);    // beware the for(;;); in the beginning of the json data 
  }) 
```

å°±æ˜¯è¿™æ ·ï¼æ„Ÿè°¢æ‚¨é˜…è¯»:Dï¼ŒæŠ±æ­‰é€ æˆæ··ä¹±ã€‚