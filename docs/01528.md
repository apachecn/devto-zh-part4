# å¦‚ä½•åœ¨ Django | Django Packages ç³»åˆ—#1 ä¸­ä¸ºæ‚¨çš„æ¨¡å‹æ·»åŠ æ ‡ç­¾

> åŸæ–‡ï¼š<https://dev.to/thepylot/how-to-add-tags-to-your-models-in-django-django-packages-series-1-3704>

é€šè¿‡[åè½¬ Python](https://reversepython.net)

å˜¿å¾·å¤«æ–¯ï¼

æ¬¢è¿æ¥åˆ° Django å¥—é¤ç³»åˆ—ç¬¬ä¸€å¸–ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•å‘æ¨¡å‹æ·»åŠ æ ‡è®°åŠŸèƒ½ã€‚

ç±»åˆ«å’Œæ ‡ç­¾å¸®åŠ©æ‚¨ç»„ç»‡æ‚¨çš„ç½‘ç«™æˆ–åšå®¢ï¼Œå¹¶å¸®åŠ©æ‚¨çš„ç”¨æˆ·æ‰¾åˆ°ä»–ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚åšå®¢ç±»åˆ«æ˜¯æ‚¨åœ¨åšå®¢ä¸Šæå‡ºçš„ä¸»é¢˜ã€‚ä½ çš„ç±»åˆ«åˆ—è¡¨å°±åƒä½ åšå®¢çš„ç›®å½•ã€‚æ ‡ç­¾æ›´å…·ä½“ï¼Œå®ƒé’ˆå¯¹ä½ åœ¨æŸç¯‡åšæ–‡ä¸­è®¨è®ºçš„å†…å®¹ã€‚æ ‡ç­¾é€šå¸¸åªæœ‰ä¸€ä¸¤ä¸ªè¯ï¼Œåæ˜ äº†æ–‡ç« çš„å…³é”®è¯æˆ–è¦ç‚¹ã€‚å¦‚æœç±»åˆ«æ˜¯ä½ åšå®¢çš„ç›®å½•ï¼Œæ ‡ç­¾å°±æ˜¯ä½ åšå®¢çš„ç´¢å¼•ã€‚é€šè¿‡ç”¨ç›¸å…³çš„å…³é”®è¯æ ‡è®°ä¸€ç¯‡æ–‡ç« ï¼Œç”¨æˆ·å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°ä¿¡æ¯ï¼Œä»è€Œä½¿ä½ çš„åšå®¢æ›´åŠ ä¸“ä¸šã€‚

django-taggit æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„åº”ç”¨ç¨‹åºï¼Œå®ƒä¸»è¦ä¸ºæ‚¨æä¾›ä¸€ä¸ªæ ‡ç­¾æ¨¡å‹ï¼Œä»¥åŠä¸€ä¸ªå¯ä»¥æ–¹ä¾¿åœ°å‘ä»»ä½•æ¨¡å‹æ·»åŠ æ ‡ç­¾çš„ç®¡ç†å™¨ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªéå¸¸ç®€å•çš„åšå®¢åº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨å…¶ä¸­å®ç°æ ‡ç­¾ç³»ç»Ÿã€‚

æˆ‘å‡è®¾ä½ å·²ç»åˆ›å»ºäº† Django é¡¹ç›®ã€‚è®©æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¼€å§‹å®‰è£…åŒ…:

```
pip3 install django-taggit 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®‰è£…å®Œæˆåï¼Œæ‰“å¼€ **settings.py** å¹¶å°† taggit åŒ…å«åœ¨ INSTALLED_APPS ä¸­

```
INSTALLED_APPS = [
    ...
    'taggit'
] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### åˆ›å»ºæ¨¡å‹

ç°åœ¨ï¼Œæ‰“å¼€ **models.py** å¹¶åˆ›å»º Post æ¨¡å‹:

```
from django.db import models
from taggit.managers import TaggableManager

class Post(models.Model):
    title = models.CharField(max_length=250)
    description = models.TextField()
    published = models.DateField(auto_now_add=True)
    slug = models.SlugField(unique=True, max_length=100)
    tags = TaggableManager()

    def __str__(self):
        return self.title 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

TaggableManager å°†åœ¨æ¨¡å‹è¡¨å•æˆ–ç®¡ç†ä¸­è‡ªåŠ¨æ˜¾ç¤ºä¸ºä¸€ä¸ªå­—æ®µã€‚é€šè¿‡è¡¨å•å­—æ®µè¾“å…¥çš„æ ‡ç­¾è§£æå¦‚ä¸‹:

*   å¦‚æœè¾“å…¥ä¸åŒ…å«ä»»ä½•é€—å·æˆ–åŒå¼•å·ï¼Œå®ƒå°†è¢«ç®€å•åœ°è§†ä¸ºä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„æ ‡è®°ååˆ—è¡¨ã€‚
*   å¦‚æœè¾“å…¥åŒ…å«è¿™äº›å­—ç¬¦ä¸­çš„ä»»ä½•ä¸€ä¸ª

*   å‡ºç°åœ¨åŒå¼•å·ä¹‹é—´çš„å­—ç¬¦ç»„ä¼˜å…ˆä½œä¸ºå¤šå•è¯æ ‡è®°(å› æ­¤åŒå¼•å·æ ‡è®°åå¯ä»¥åŒ…å«é€—å·)ã€‚æœªç»“æŸçš„åŒå¼•å·å°†è¢«å¿½ç•¥ã€‚
*   å¦åˆ™ï¼Œå¦‚æœè¾“å…¥ä¸­æœ‰ä»»ä½•æœªåŠ å¼•å·çš„é€—å·ï¼Œå®ƒå°†è¢«è§†ä¸ºé€—å·åˆ†éš”ã€‚å¦åˆ™ï¼Œå®ƒå°†è¢«è§†ä¸ºç©ºæ ¼åˆ†éš”ã€‚

![django-taggit](img/45cd94f6e111a40d38700cfc14ba9d0f.png)

#### åˆ›å»ºè¡¨å•

åœ¨æ‚¨çš„**è¡¨æ ¼. py** ä¸­:

```
from django import forms
from .models import Post

class PostForm(forms.ModelForm):
    class Meta:
        model = Post
        fields = [
            'title',
            'description',
            'tags',
        ] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬åœ¨æ¨¡å‹è¡¨å•ä¸­åŠ å…¥äº†æ ‡ç­¾ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸ä¼šç”¨ Django çš„æ¨¡æ¿è¯­è¨€æ¥å‘ˆç°å®ƒã€‚

#### åˆ›å»ºè§†å›¾

è®©æˆ‘ä»¬çœ‹çœ‹ **views.py** :

```
from django.shortcuts import render, get_object_or_404
from django.template.defaultfilters import slugify

from .models import Post
from .forms import PostForm
from taggit.models import Tag

def home_view(request):
    posts = Post.objects.order_by('-published')
    # Show most common tags 
    common_tags = Post.tags.most_common()[:4]
    form = PostForm(request.POST)
    if form.is_valid():
        newpost = form.save(commit=False)
        newpost.slug = slugify(newpost.title)
        newpost.save()
        # Without this next line the tags won't be saved.
        form.save_m2m()
    context = {
        'posts':posts,
        'common_tags':common_tags,
        'form':form,
    }
    return render(request, 'home.html', context)

def detail_view(request, slug):
    post = get_object_or_404(Post, slug=slug)
    context = {
        'post':post,
    }
    return render(request, 'detail.html', context)

def tagged(request, slug):
    tag = get_object_or_404(Tag, slug=slug)
    # Filter posts by tag name  
    posts = Post.objects.filter(tags=tag)
    context = {
        'tag':tag,
        'posts':posts,
    }
    return render(request, 'home.html', context) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¿å­˜è¡¨å•æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ commit=False é€‰é¡¹ï¼Œå¹¶åœ¨ä¿å­˜å¯¹è±¡åè°ƒç”¨è¡¨å•ä¸Šçš„ save_m2m()ã€‚

æˆ‘ä»¬ä½¿ç”¨ slugify å°†æˆ‘ä»¬çš„æ–‡ç« æ ‡é¢˜(å­—ç¬¦ä¸²)è½¬æ¢ä¸ºæœ‰æ•ˆçš„ slugã€‚

æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥é€šè¿‡æ ‡ç­¾åç§°è¿‡æ»¤æ–‡ç« ï¼Œå¹¶æ˜¾ç¤ºæœ€å¸¸ç”¨çš„æ ‡ç­¾ã€‚

#### åˆ›å»ºæ¨¡æ¿

å¤ªå¥½äº†ï¼ç°åœ¨æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ¨¡æ¿äº†ã€‚

**base.html**T2ã€‘

```
<html>
    <head>
        <title>Simple Blog</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="/static/css/tagsinput.css" />
    </head>

    <body>
    {% block content %}{% endblock content %}
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="/static/js/tagsinut.js"></script>
    <script>
    $("#post-form").submit(function(e){
        e.preventDefault();
        });</script>
    </body>
</html> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**home.html**T2ã€‘

```
{% extends 'base.html' %}

{% block content %}
        <div class="container pt-5">
            <form method="POST">
                {% csrf_token %}
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" class="form-control" name="title" placeholder="Add title">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea type="text" class="form-control" name="description" placeholder="Add description"></textarea>
                </div>
                <div class="form-group">
                    <label>Tags</label>
                    <input type="text" data-role="tagsinput" class="form-control" name="tags">
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
            <p>Common Tags: 
            {% for mt in common_tags %}
                <a href="#" class="badge badge-success">{{mt}}</a>
            {% endfor %}
            </p>
            <div class="row mb-2 posts">
                    {% for post in posts %}
                    <div class="col-md-6">
                        <div class="cards">
                            <div class="row no-gutters border rounded  flex-md-row mb-4 shadow-sm h-md-250">
                                <div class="col p-4 d-flex flex-column position-static">
                                    <h3 class="my-1"><a href="{% url 'detail' post.slug %}">{{post.title}}</a></h3>
                                    <div style="display:flex">
                                        {% for tag in post.tags.all %}
                                        <a href="{% url 'tagged' tag.slug %}" class="mr-1 badge badge-info">#{{ tag }}</a>
                                        {% endfor %}
                                    </div>
                                    <p class="mb-auto">{{post.description}}</p>
                                    <p class="mb-auto text-muted">{{post.published}}</p>
                                </div>
                            </div>
                        </div>       
                    </div>
                    {% endfor %}
            </div>
        </div>    
{% endblock content %} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¡¨å•æ ‡ç­¾ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°åç§°å±æ€§ï¼Œå®ƒåªæ˜¯æˆ‘ä»¬åœ¨ HTML æ¨¡æ¿ä¸­ä½œä¸ºå±æ€§çš„è¡¨å•å­—æ®µåç§°ã€‚æˆ‘ä»¬å¿…é¡»è¦†ç›–æ ‡ç­¾è¾“å…¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ²¡æœ‰ç”¨ Django çš„æ¨¡æ¿è¯­è¨€æ¥å‘ˆç°å®ƒçš„ä¸»è¦åŸå› ã€‚

æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ jQuery æ’ä»¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç”¨äºç®¡ç†æ ‡ç­¾çš„ Twitter å¼•å¯¼ç”¨æˆ·ç•Œé¢ã€‚è¿™ä¸ªæ’ä»¶åŸºæœ¬ä¸Šå¯ä»¥å°†æ–‡æœ¬è¾“å…¥è½¬æ¢æˆçœŸæ­£çš„æ ‡ç­¾ã€‚çœ‹ä¸€çœ‹[è‡ªä¸¾æ ‡ç­¾è¾“å…¥](http://bootstrap-tagsinput.github.io/bootstrap-tagsinput/examples/)

ä»¥ä¸‹æ˜¯æœ€ç»ˆç»“æœ:

[![](img/823d1377b875c873b02629f4a532eb4b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--boQHDVVP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/443wk1si9kysdsvuoh5l.gif)

å¹¶æŒ‰æ ‡ç­¾è¿‡æ»¤å¸–å­:

[![](img/26f313136bb0d02ee959ac75bb87ac4d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--hXK41Gsz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/zkduydzwkqku80s887vq.gif)

æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ django-taggit çš„æ–‡æ¡£ã€‚

æ‚¨å¯ä»¥ä»æˆ‘çš„ GitHub å…‹éš†æˆ–ä¸‹è½½è¯¥é¡¹ç›®

## ![GitHub logo](img/75095a8afc1e0f207cda715962e75c8d.png)[the pylot](https://github.com/thepylot)/[django-taggit-tutorial](https://github.com/thepylot/django-taggit-tutorial)

### ä½¿ç”¨ django-taggit | Django è½¯ä»¶åŒ…ç³»åˆ—ä¸ºæ‚¨çš„æ¨¡å‹æ·»åŠ æ ‡ç­¾

<article class="markdown-body entry-content container-lg" itemprop="text">

# å§œæˆˆ-å¡”å‰ç‰¹-æ•™ç¨‹

ä½¿ç”¨ django-taggit | Django è½¯ä»¶åŒ…ç³»åˆ—#1 ä¸ºæ‚¨çš„æ¨¡å‹æ·»åŠ æ ‡ç­¾

## å…¥é—¨æŒ‡å—

è¿™ä¸ªé¡¹ç›®åœ¨ **Python 3+** å’Œ Django 2+ä¸Šå·¥ä½œã€‚

å®‰è£…ä¾èµ–é¡¹:

```
python3 -m pip3 install -r requirements.txt 
```

ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
python3 manage.py makemigrations posts
python3 manage.py migrate
python3 manage.py runserver 
```

</article>

[View on GitHub](https://github.com/thepylot/django-taggit-tutorial)

å°±æ˜¯è¿™æ ·ï¼è¯·åœ¨ç¤¾äº¤åª’ä½“ä¸Šåˆ†äº«å¹¶å…³æ³¨æˆ‘(ä½ çš„æ”¯æŒå¾ˆé‡è¦)ï¼:)è¿˜è¦æ£€æŸ¥[åå‘ Python](https://reversepython.net) å¹¶ä¸€å¦‚æ—¢å¾€åœ°ä¿æŒè¿æ¥ï¼ğŸš€

[ç»™æˆ‘ä¹°æ¯å’–å•¡:)](https://www.buymeacoffee.com/xT2K0N1PY)
[insta gram](https://www.instagram.com/coderasha/?hl=en)
[Twitter](https://twitter.com/coderasha?lang=en)