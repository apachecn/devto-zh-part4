# å˜å¼‚è¿˜æ˜¯ä¸å˜å¼‚ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜

> åŸæ–‡:[https://dev . to/bnevilleoneill/to-mutate-or-immutate-that-the-question-2f1m](https://dev.to/bnevilleoneill/to-mutate-or-immutate-that-is-the-question-2f1m)

[![](../Images/8a59ea2060ae5d195be4ee5b552f6d51.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--fjuoNG01--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/urfo9rqt2uix7qmf3ytc.png)

è¿™æ˜¯**å¹¶éæ‰€æœ‰ç¼–è¯‘å™¨ç”Ÿæ¥å¹³ç­‰**ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº† *TypeScript* (TS)å’Œ *PureScript (PS)* ï¼Œè¿™ä¸¤ç§é™æ€ç±»å‹è¯­è¨€ç¼–è¯‘æˆ *JavaScript (JS)* ã€‚åœ¨[çš„ç¬¬ä¸€ç¯‡æ–‡ç« ](https://dev.to/bnevilleoneill/typescript-vs-purescript-not-all-compilers-are-created-equal-12i6-temp-slug-4466128)ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†è¿™ä¸¤ç§è¯­è¨€ï¼Œå¹¶è§£é‡Šäº†å®ƒä»¬å­˜åœ¨çš„åŸå› ã€‚æˆ‘ä»¬è¿˜è®¨è®ºäº†é™åˆ¶å¦‚ä½•ä¸ºæˆ‘ä»¬æä¾›æŸäº›ä¿è¯ï¼Œä»è€Œå¢åŠ æˆ‘ä»¬å¯¹ä»£ç çš„ä¿¡å¿ƒã€‚æˆ‘ä»¬è°ˆåˆ°çš„ç¬¬ä¸€ä¸ªé™åˆ¶æ˜¯*çº¯åº¦ï¼Œ*åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦ä¸€ä¸ªé™åˆ¶:*ä¸å˜æ€§*ã€‚

ä¸–ç•Œæ€»æ˜¯åœ¨å˜åŒ–ï¼Œå¦‚æœä¸€ä¸ªè½¯ä»¶åº”ç”¨ç¨‹åºè¯•å›¾è¡¨ç°çœŸå®ä¸–ç•Œçš„æŸä¸ªæ–¹é¢ï¼Œå®ƒå°†ä¸å¾—ä¸å…·æœ‰å¯å˜çš„çŠ¶æ€ã€‚ä½†æ˜¯åœ¨åº”ç”¨ç¨‹åºçš„æŸä¸ªåœ°æ–¹ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å˜åŒ–çš„å€¼è¿›è¡Œå»ºæ¨¡ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ç¨‹åºä¸­çš„æ‰€æœ‰å€¼éƒ½åº”è¯¥è¢«å…è®¸å˜åŒ–ã€‚æˆ‘è®¤ä¸ºæ·»åŠ ä¸€ä¸ªé™åˆ¶æ¥å¤„ç†ä¸å¯å˜æ•°æ®å¯ä»¥ä¿è¯æ²¡æœ‰å€¼ä¼šå‘ç”Ÿæ„å¤–å˜åŒ–ã€‚

[![](../Images/45dac079be350779df77dd78fc0e8af1.png)T2ã€‘](https://logrocket.com/signup/)

## [](#mutable-by-default)é»˜è®¤å¯å˜

é»˜è®¤æƒ…å†µä¸‹ï¼Œ *JavaScript* å’Œ *TypeScript* éƒ½æ˜¯å¯å˜çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›è¯­è¨€ç‰¹æ€§æ¥é¿å…æ„å¤–çªå˜ï¼Œä½†æˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€äº›ç»†èŠ‚ã€‚

[![](../Images/f6a9d80b4944efeb6f9b6a232e0ad197.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--x6f2jPx_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1557523100642_Screen%2BShot%2B2019-05-10%2Bat%2B18.17.48.png)

å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå”¯ä¸€çš„ *TypeScript* ç‰¹å®šè¯­æ³•æ˜¯ç¬¬ 26 è¡Œçš„ç±»å‹å®šä¹‰ä»¥åŠç¬¬ 28 è¡Œå’Œç¬¬ 32 è¡Œçš„`as XXX`,å…¶ä½™çš„æ˜¯ç”±ç¼–è¯‘å™¨éªŒè¯çš„æ™®é€šçš„æ—§çš„ *JavaScript* ã€‚

å½“ä½¿ç”¨åƒ [Redux](https://redux.js.org/) è¿™æ ·çš„åº“æ—¶ï¼Œèƒ½å¤Ÿå°†ä¸€ä¸ªå€¼æ ‡è®°ä¸ºåªè¯»çœŸçš„å¾ˆæœ‰å¸®åŠ©ï¼Œè¿™äº›åº“ä¾èµ–äºä¸å¯å˜çš„å½’çº¦å™¨æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨æ™®é€šçš„ *JavaScript* ä¸­ï¼Œå¿½ç•¥æˆ‘ä»¬æ— æ„ä¸­æ”¹å˜ä¸€äº›æ•°æ®çš„æƒ…å†µæ˜¯å¦‚æ­¤æ™®éï¼Œä»¥è‡³äºæœ‰ä¸€ä¸ª[æ–‡æ¡£é¡µé¢](https://redux.js.org/recipes/structuring-reducers/immutable-update-patterns#common-mistake-2-only-making-a-shallow-copy-of-one-level)è§£é‡Šäº†å¸¸è§çš„é”™è¯¯å’Œä¸€äº›æ­£ç¡®å¤„ç†ä¸å¯å˜æ•°æ®ç»“æ„çš„æ¨¡å¼ã€‚é€šè¿‡ä½¿ç”¨ *TypeScript çš„* `Readonly` *ã€* `ReadonlyArray` *å’Œ* [æ–°çš„ const æ–­è¨€](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-4.html)(åœ¨ 3.4 ç‰ˆæœ¬ä¸­å‘å¸ƒ)ï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„æ€æƒ³ä»é‚£ä¸ªè´Ÿæ‹…ä¸­è§£æ”¾å‡ºæ¥ï¼Œå¹¶å°†é‡é‡æ”¾åœ¨ç¼–è¯‘å™¨ä¸Šï¼Œç›¸ä¿¡å®ƒä¼šå¼•å¯¼æˆ‘ä»¬è·å¾—æ›´å‡†ç¡®çš„ä»£ç ã€‚

ä½†æ˜¯ Redux å¹¶ä¸æ˜¯æˆ‘ä»¬ä»ä½¿ç”¨ä¸å¯å˜å€¼ä¸­è·ç›Šçš„å”¯ä¸€åœ°æ–¹ã€‚æ®è¯´å¦‚æœä½ ä¸ä»¥ X å¹´å‰å†™çš„ä»£ç ä¸ºè€»ï¼Œé‚£è¿™ X å¹´ä½ ä»€ä¹ˆéƒ½æ²¡å­¦åˆ°(è€Œæˆ‘ä» 6 å¹´å‰å†™çš„ä¸€ä¸ªæœªå®Œæˆçš„é¡¹ç›®ä¸­å­¦åˆ°äº†å¾ˆå¤šã€‚[![ğŸ˜…](../Images/a3bb6c7875a82d9ebd888100c1bd5fcb.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--I5CoQZTE--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f605.png)

è¿™æ˜¯ä¸€æ¬¾åä¸º [mddoc](https://github.com/hrajchert/mddoc) çš„å·¥å…·ï¼Œæ—¨åœ¨åŒæ­¥æ–‡æ¡£å’Œä»£ç ï¼Œè¯»å–å¼•ç”¨å…¶ä»–æ–‡ä»¶çš„æ–‡ä»¶ï¼Œæå–ä¿¡æ¯å¹¶åˆ›å»ºç”±æ’ä»¶å®šåˆ¶çš„ç½‘é¡µã€‚æœ€å¤§çš„é—®é¢˜ä¹‹ä¸€æ˜¯ç¨‹åºä¸åŒæ­¥éª¤ä¹‹é—´çš„æ²Ÿé€šã€‚æˆ‘é€‰æ‹©ä½¿ç”¨ä¸€ä¸ªæˆ‘ç§°ä¹‹ä¸º`Metadata`çš„å…±äº«å¯å˜å¯¹è±¡ã€‚

æ²¡æœ‰åƒ *TypeScript* è¿™æ ·çš„å·¥å…·ï¼Œç†è§£è¿™ä¸ªå¯¹è±¡çš„ç»“æ„æ˜¯éå¸¸å¤æ‚çš„ï¼Œå®ƒæœ‰å‡ ä¸ªåµŒå¥—çš„å±æ€§ï¼Œå¹¶ä¸éƒ½æ˜¯ç›¸å…³çš„ï¼Œæœ‰äº›æœ‰éšæ™¦çš„åå­—ï¼Œæœ‰äº›æ˜¯åæ¥ä»ä»£ç çš„ä¸åŒéƒ¨åˆ†åˆ†é…çš„ã€‚

ç®€å•åœ°å…±äº«ä¸€ä¸ªå¯¹è±¡å¹¶è‡ªç”±åœ°æ”¹å˜å®ƒåœ¨å¼€å§‹æ—¶ç¡®å®å¾ˆæœ‰å¸®åŠ©ï¼Œä½†æ˜¯éšç€é¡¹ç›®çš„å¢é•¿ï¼Œå®ƒå˜å¾—å¾ˆéš¾ç®¡ç†ã€‚æœ€ç»ˆï¼Œæˆ‘æ”¾å¼ƒäº†å®ƒï¼Œé™¤äº†å‡ ä¸ªæœˆå‰çš„ä¸€æ¬¡å°å†²åˆºï¼Œé€šè¿‡å°†é¡¹ç›®è¿ç§»åˆ°*æ‰“å­—ç¨¿*ï¼Œæˆ‘è§£å†³äº†ä¸çŸ¥é“`Metadata`å¯¹è±¡çš„ç»“æ„çš„ç—›è‹¦ï¼Œå¹¶ä¸”[å°†ä¸€äº›é—®é¢˜](https://github.com/hrajchert/mddoc/blob/50d148519e3465c822ce6fdfa67f98386c249265/src/metadata-manager.ts#L113)æ­ç¤ºåˆ°[ä¸­ï¼Œè¿™äº›é—®é¢˜](https://github.com/hrajchert/mddoc/blob/50d148519e3465c822ce6fdfa67f98386c249265/src/metadata-manager.ts#L35)ä½¿å¾—é¡¹ç›®[éš¾ä»¥ç»´æŠ¤](https://github.com/hrajchert/mddoc/blob/50d148519e3465c822ce6fdfa67f98386c249265/src/markdown-parser/markdown-file-reader.ts#L38)ã€‚

## [](#immutable-by-default)é»˜è®¤ä¸å¯å˜

é»˜è®¤æƒ…å†µä¸‹ï¼ŒPureScript æ˜¯ä¸å¯å˜çš„ï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆå¤„ç†çº¯å‡½æ•°ã€‚ç±»ä¼¼äº`const`å…³é”®å­—ï¼Œä¸€æ—¦æˆ‘ä»¬ä¸ºä¸€ä¸ªæ ‡è¯†ç¬¦è®¾ç½®äº†å€¼ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ›´æ”¹å®ƒã€‚

```
nine :: Int
nine = 9

-- Compiler error: The value nine has been defined multiple times
nine = 8 
```

ä¸€ä¸ªå¥½çš„å‰¯ä½œç”¨æ˜¯è¯­æ³•æ›´åŠ æ¸…æ™°ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åŒºåˆ†`let`å’Œ`const`ã€‚æ­¤å¤–ï¼Œä¸€æ—¦å®šä¹‰äº†å±æ€§å€¼ï¼Œå°±æ²¡æœ‰è¯­æ³•æ¥æ›´æ”¹å®ƒã€‚æˆ‘ä»¬èƒ½åšçš„æ˜¯é€šè¿‡ç®€å•åœ°å®šä¹‰æˆ‘ä»¬æƒ³è¦æ”¹å˜çš„å±æ€§ï¼Œä»æ—§å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ã€‚è¿™ç§æ¨¡å¼å¦‚æ­¤æ™®éï¼Œä»¥è‡³äºæœ‰ä¸€ä¸ªå«åš[è®°å½•æ›´æ–°](https://github.com/purescript/documentation/blob/master/language/Syntax.md#record-updates)çš„è¯­æ³•ç‰¹æ€§æ¥å¸®åŠ©æˆ‘ä»¬ä»¥ä¸€ç§ç®€æ´çš„æ–¹å¼è¡¨è¾¾è¿™ä¸€ç‚¹ã€‚

```
type Request = { url :: String, verb :: String }

-- We define a full object
defaultReq :: Request
defaultReq = { url: "", verb: "GET"}

-- And then use it to create a new one, with a changed property
googleReq :: Request
googleReq = defaultReq { url = "http://www.google.com" }
--          { url: "http://www.google.com", verb: "GET" } 
```

å¦‚æœæˆ‘ä»¬ç¡®å®æƒ³å¤„ç†å¯å˜æ•°æ®ï¼Œä¸€ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨ [ST](https://pursuit.purescript.org/packages/purescript-st/4.0.0/docs/Control.Monad.ST) å’Œ [STRef](https://pursuit.purescript.org/packages/purescript-st/4.0.0/docs/Control.Monad.ST.Ref) ç±»å‹ã€‚å¦‚æ–‡æ¡£æ‰€è¿°ï¼Œè¿™äº›ç±»å‹å…è®¸æˆ‘ä»¬åˆ›å»ºå…·æœ‰å±€éƒ¨å˜å¼‚çš„è®¡ç®—ï¼Œå³å˜å¼‚ä¸ä¼šâ€œé€ƒé€¸â€åˆ°å‘¨å›´çš„è®¡ç®—ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ç»„åˆå’Œæ‰©å±•è®¡ç®—ï¼Œå¹¶æœ€ç»ˆè¿è¡Œå®ƒä»¥è·å¾—ä¸€ä¸ªå€¼ã€‚ä¸€æ—¦æˆ‘ä»¬è¿è¡Œå®ƒï¼Œæˆ‘ä»¬å°±å¤±å»äº†å¯¹å¯å˜æ•°æ®çš„å¼•ç”¨ï¼Œå› æ­¤æœ‰äº†â€œå®‰å…¨å˜å¼‚â€ã€‚

ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™äº›ç±»å‹æ¥è¡¨ç¤ºå¯å˜æ•°æ®å’Œå®ƒä»¬çš„ *TypeScript* å‰¯æœ¬ã€‚`mutable1`ç¤ºä¾‹åˆ›å»ºä¸€ä¸ªå¯¹æ–°çš„å¯å˜å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆå§‹å€¼ä¸º 0ï¼Œç„¶åå°†è¯¥å€¼è¯»å…¥`val`æ ‡è¯†ç¬¦ï¼Œå¹¶å°†è¡¨è¾¾å¼`(val + 1)`çš„ç»“æœå†™å…¥å¯å˜å¯¹è±¡ã€‚`mutable2`ç¤ºä¾‹ä½¿ç”¨å¸¦æœ‰åŒ¿åå‡½æ•°çš„ [modify](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array.ST#v:modify) ä»¥æ›´ç®€æ´çš„æ–¹å¼åšåŒæ ·çš„äº‹æƒ…ã€‚`mutable3`å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å¾ªç¯å‡½æ•°æ¥å¾ˆå¥½åœ°å¤„ç†åƒ`for`æˆ–`while`è¿™æ ·çš„çªå˜ã€‚

[![](../Images/8720b721cb78b442b2ab3226c0697db4.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Mlrm0q1i--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1556999560419_Screen%2BShot%2B2019-05-04%2Bat%2B16.52.18.png)

åœ¨[ä¹‹å‰çš„å¸–å­](https://dev.to/bnevilleoneill/typescript-vs-purescript-not-all-compilers-are-created-equal-12i6-temp-slug-4466128)ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†ä¸€ç§èƒ½å¤Ÿå¢é•¿çš„[è¯­è¨€çš„é‡è¦æ€§ï¼Œé€šè¿‡å±•ç¤º *JavaScript çš„*](https://www.youtube.com/watch?v=_ahvzDzKdB0) [ç®¡é“æ“ä½œç¬¦](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Pipeline_operator)(ä»åœ¨å§”å‘˜ä¼šè®¨è®ºä¸­)æ˜¯ç”±[apply lipped](https://pursuit.purescript.org/packages/purescript-prelude/4.1.1/docs/Data.Function#v:applyFlipped)å‡½æ•°åœ¨ *PureScript* ç”¨æˆ·åŸŸä¸­å®ç°çš„ã€‚å¯¹è±¡å˜å¼‚ä¹Ÿæ˜¯å¦‚æ­¤ã€‚åœ¨ *TypeScriptã€*ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç‰¹æ®Šçš„è¯­è¨€ä¿®é¥°ç¬¦ï¼Œå¦‚`Readonly`ã€`ReadonlyArray`å’Œ`as const`ï¼Œè€Œåœ¨ *PureScript* ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ™®é€šçš„ç”¨æˆ·åŸŸç±»å‹(`ST`)ï¼Œå®ƒæœ‰ä¸€ä¸ª[å·§å¦™çš„](https://github.com/purescript/purescript-st/blob/master/src/Control/Monad/ST/Internal.js#L1)å¤–éƒ¨å‡½æ•°æ¥å£( [FFI](https://github.com/purescript/documentation/blob/master/guides/FFI.md) )ã€‚

## [](#representing-abstraction)ä»£è¡¨æŠ½è±¡

åœ¨æˆ‘ä»¬è§£é‡Š ST å’Œ STRef å¦‚ä½•å·¥ä½œä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆä»‹ç»ä¸€ä¸ªæˆ‘ä»¬å°†åœ¨æœ€åä¸€èŠ‚ä½¿ç”¨çš„ä¾‹å­ï¼Œå¹¶ç”¨å®ƒæ¥è§£é‡Šä¸€äº›è¯­è¨€ç‰¹æ€§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨é€’å½’å‡½æ•°å’Œä¸å¯å˜æ•°ç»„çš„ç®€å•å®ç° [QSort ç®—æ³•](https://www.youtube.com/watch?v=Hoixgm4-P4M)ã€‚

[![Recursive immutable qsort in TS (left) and PS (right)](../Images/70835faf00d35401ff6cba90a2ec4bca.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--_6V1u8Z2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1556831093351_Screen%2BShot%2B2019-05-02%2Bat%2B18.04.19.png) 

<figcaption>é€’å½’ä¸å¯å˜ qsort ä¸­ TS(å·¦)å’Œ PS(å³)</figcaption>

æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åŒºåˆ†åŸºæœ¬æƒ…å†µå’Œé€’å½’ï¼Œå¹¶å°†æ•°ç»„çš„`head`å’Œ`tail`åˆ†å¼€ã€‚åœ¨ *TypeScript ä¸­ï¼Œ*æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª *if è¯­å¥*ç”¨äºç¬¬ä¸€éƒ¨åˆ†ï¼Œä½¿ç”¨[ææ„èµ‹å€¼](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)ç”¨äºç¬¬äºŒéƒ¨åˆ†ã€‚åœ¨ *PureScript* ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†[æ¾æ•£](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array#v:uncons)å‡½æ•°ï¼Œè¯¥å‡½æ•°å‘å…·æœ‰å±æ€§`head`å’Œ`tail`çš„å¯¹è±¡è¿”å›ä¸€ä¸ª`Maybe`å€¼ã€‚ç„¶åä½¿ç”¨[æ¨¡å¼åŒ¹é…](https://github.com/purescript/documentation/blob/master/language/Pattern-Matching.md#pattern-matching)ï¼Œæˆ‘ä»¬å¯ä»¥åŒºåˆ†åŸºæœ¬æƒ…å†µå’Œé€’å½’ï¼Œå¹¶ä¸ºå¯¹è±¡å±æ€§åˆ†é…æ ‡è¯†ç¬¦ã€‚

å¯¹äºç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ•°ç»„åŸç”Ÿè¿‡æ»¤å™¨è®¡ç®—`small`ã€`mid`å’Œ`large`ã€‚åœ¨*ç±»å‹è„šæœ¬*ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨åŠŸèƒ½å—ä¸­æ·»åŠ é‚£äº›å®šä¹‰ï¼Œå¹¶åœ¨`tail`ä¸Šè°ƒç”¨**è¿‡æ»¤æ–¹æ³•**ï¼Œä¼ é€’ä¸€ä¸ªç®­å¤´å‡½æ•°ã€‚åœ¨ *PureScript* ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ [let æˆ–è€… where ç»‘å®š](https://github.com/purescript/documentation/blob/master/language/Syntax.md#let-and-where-bindings)æ¥ä»£æ›¿å—ä»£ç ã€‚ç„¶åæˆ‘ä»¬ç”¨åŒ¿åçš„[Î»](https://github.com/purescript/documentation/blob/master/language/Syntax.md#functions)å’Œ`tail`è°ƒç”¨**è¿‡æ»¤å‡½æ•°**ã€‚ä»å‘½ä»¤å¼æˆ– OOP çš„è§’åº¦æ¥çœ‹ï¼Œè¿™äº›å‚æ•°ä¼¼ä¹æ˜¯é€†åºçš„ï¼Œä½†æ˜¯æ­£å¦‚è¿™ç¯‡ Haskell æ–‡ç« æ‰€ç¤ºï¼Œè¿™æ˜¯ä¸ºäº†æ›´å¥½åœ°ç»„åˆã€‚æœ€åï¼Œä¸ºäº†åˆ›å»ºç»“æœæ•°ç»„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† TS ä¸­çš„ *JavaScript çš„* [spread æ“ä½œç¬¦](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)å’Œ PS ä¸­çš„ [append æ–¹æ³•](https://pursuit.purescript.org/packages/purescript-prelude/4.1.1/docs/Data.Semigroup#v:(%3C%3E))ã€‚

å¦‚æœä¸å¼•å…¥æŠ½è±¡çš„æ¦‚å¿µï¼Œæˆ‘ä»¬åœ¨é™æ€ç±»å‹è¯­è¨€ä¸­åªèƒ½åšåˆ°è¿™ä¸€æ­¥ã€‚å‰é¢çš„å‡½æ•°åªå¯¹æ•°å­—è¿›è¡Œå‡åºæ’åºï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›ä»¥ä»»ä½•é¡ºåºå¯¹ä»»ä½•ä¸œè¥¿è¿›è¡Œæ’åºã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå–äº† compare å‡½æ•°ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªåº”è¯¥ç”±ç”¨æˆ·æä¾›çš„å‚æ•°ã€‚ä¸ºäº†åŠ å¼ºç±»å‹æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬åœ¨*ç±»å‹è„šæœ¬*ä¸­ä½¿ç”¨[æ³›å‹](https://www.typescriptlang.org/docs/handbook/generics.html)ï¼Œåœ¨*çº¯è„šæœ¬*ä¸­ä½¿ç”¨å‚æ•°ç±»å‹ã€‚

[![](../Images/65ab1392b92e7c7c663cc3a0cc290694.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--MO4TbesP--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1556831628471_Screen%2BShot%2B2019-05-02%2Bat%2B18.13.13.png)

*TypeScript* åœ¨å‡½æ•°å‚æ•°ä¹‹å‰çš„å°–æ‹¬å·å†…å®šä¹‰æ³›å‹ç±»å‹ã€‚å— Java å’Œçš„å½±å“ã€‚NET ä¹ æƒ¯ä½¿ç”¨åƒ`T`è¿™æ ·çš„å¤§å†™å­—æ¯ï¼Œæˆ–è€…è‡³å°‘æ˜¯ä»¥å¤§å†™å­—æ¯å¼€å¤´çš„å•è¯(å³ä½¿[ä¸è¦æ±‚](https://www.typescriptlang.org/play/#src=function%20id%3Ct%3E(a%3A%20t)%20%7B%0D%0A%20%20%20%20return%20a%3B%0D%0A%7D%0D%0A%0D%0Aconst%20num%20%3D%20id(9)%3B))ã€‚ *PureScript* ï¼Œå— *Haskell* å¯å‘ï¼Œä½¿ç”¨[å…¨ç§°é‡è¯](https://en.wikipedia.org/wiki/Universal_quantification) `forall`å£°æ˜ç±»å‹å‚æ•°ã€‚å‚æ•°ç”±ç©ºæ ¼åˆ†éš”ï¼Œå¹¶æœ‰ä¸€ä¸ªç‚¹ä»¥åŒºåˆ«äºå®šä¹‰çš„å…¶ä½™éƒ¨åˆ†ã€‚ä¹ æƒ¯ä¸Šä½¿ç”¨å°å†™å­—æ¯ï¼Œå¦‚`a`ã€‚ä½ å¯ä»¥ä½¿ç”¨å•è¯ï¼Œä½†ä¸ TS ä¸åŒï¼Œå®ƒå¿…é¡»ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚ *PureScript* æ”¯æŒ unicodeï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠ`forall`æ›¿æ¢æˆå®ƒçš„æ•°å­¦ç¬¦å·`âˆ€`ã€‚

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¯¹`T`æˆ–`a`ä¸€æ— æ‰€çŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å¯¹å®ƒä»¬åšå¤ªå¤šï¼Œåªæ˜¯æŠŠå®ƒä»¬ä¼ æ¥ä¼ å»ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šä½¿ç”¨å®ƒä»¬æ¥ç¡®ä¿ compare å‡½æ•°æ¥æ”¶ä¸¤ä¸ªä¸æ•°ç»„ç›¸åŒç±»å‹çš„å€¼ã€‚åœ¨è¿™ä¸¤ç§è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬éƒ½æœ‰ä¸€ç§æ–¹å¼æ¥æ·»åŠ å¯¹ç±»å‹çš„é™åˆ¶ï¼Œè¿™ç»™äº†æˆ‘ä»¬æ›´å¤šçš„æƒåŠ›æ¥å¤„ç†å®ƒï¼Œä½†è¿™æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„æ¦‚å¿µã€‚

## [](#understanding-the-types)äº†è§£ç±»å‹

è®©æˆ‘ä»¬åˆ†æä¸€ä¸‹`mutable1`çš„ä¾‹å­ï¼Œçœ‹çœ‹è¿™äº›ç±»å‹æ˜¯å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·çš„ã€‚å¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹`new`çš„[æ–‡æ¡£](https://pursuit.purescript.org/packages/purescript-st/4.0.0/docs/Control.Monad.ST.Ref#v:new)ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç­¾åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒåˆ†æˆå››ä¸ªéƒ¨åˆ†ã€‚

```
new :: forall a r. a -> ST r (STRef r a)
-- 1) forall a r.
-- 2) a ->
-- 3) ST r (...)
-- 4) (STRef r a) 
```

é¦–å…ˆï¼Œè¯¥å‡½æ•°å®šä¹‰äº†ä¸¤ä¸ªç±»å‹å‚æ•°:`a`æ˜¯å¯å˜å€¼çš„ç±»å‹ï¼Œ`r`æ˜¯ä¸€ä¸ªâ€œå¹»å½±ç±»å‹â€ï¼Œå…¶å”¯ä¸€ç›®çš„æ˜¯é™åˆ¶å˜å¼‚çš„èŒƒå›´ã€‚é‚£ä¹ˆè¿™ä¸ªå‡½æ•°åªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹ä¸º`a`çš„åˆå§‹å€¼ã€‚å®ƒè¿”å›ä¸€ä¸ªç»‘å®šåˆ°å¹»å½±ç±»å‹çš„å¯å˜è®¡ç®—`ST r (...)`ã€‚è®¡ç®—ä¸æ˜¯é’ˆå¯¹`a`ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯é’ˆå¯¹å¯¹å€¼(`STRef r a`)çš„å¼•ç”¨ï¼Œè¯¥å€¼ä¹Ÿå—å¹»å½±ç±»å‹çš„çº¦æŸã€‚

[è¯»å–å‡½æ•°](https://pursuit.purescript.org/packages/purescript-st/4.0.0/docs/Control.Monad.ST.Ref#v:read)æ¥æ”¶å¯¹ä¸€ä¸ªå€¼çš„å¼•ç”¨ï¼Œå¹¶å‘å…¶è¿”å›ä¸€ä¸ªå¯å˜è®¡ç®—ã€‚

```
read :: forall a r. STRef r a -> ST r a
-- 1) forall a r.
-- 2) STRef r a ->
-- 3) ST r a 
```

[å†™å‡½æ•°](https://pursuit.purescript.org/packages/purescript-st/4.0.0/docs/Control.Monad.ST.Ref#v:write)æ¥æ”¶ä¸¤ä¸ªå‚æ•°:è¦å†™çš„å€¼å’Œå†™åœ¨å“ªé‡Œã€‚ç„¶åï¼Œè¯¥å‡½æ•°è¿”å›ä¸€ä¸ªå†™å…¥å€¼çš„å¯å˜è®¡ç®—ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…å†æ¬¡è¯»å–æˆ–è®¡ç®—å®ƒã€‚

```
write :: forall a r. a -> STRef r a -> ST r a
-- 1) forall a r.
-- 2) a ->
-- 3) STRef r a ->
-- 4) ST r a 
```

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`do`ç¬¦å·å°†è¿™äº›å‡½æ•°ä»¥ä¸€ç§â€œå¼ºåˆ¶æ€§çš„æ–¹å¼â€ç²˜åˆåœ¨ä¸€èµ·ã€‚è¿™ç§è¯­è¨€ç‰¹æ€§å…è®¸æˆ‘ä»¬å¤„ç†å…·æœ‰å½¢çŠ¶`M a`çš„ç±»å‹ï¼Œæ¯”å¦‚`Effect Unit`ã€`Array String`ç­‰ï¼Œåªè¦ç±»å‹`M`æ»¡è¶³æŸç§é™åˆ¶ï¼Œæˆ‘ä»¬å°±ä¸ä¼šåœ¨æœ¬æ–‡ä¸­æåŠã€‚è¯·æ”¾å¿ƒï¼Œè¿™äº›ç±»å‹å’Œè®¸å¤šå…¶ä»–ç±»å‹éƒ½ç¬¦åˆè¿™ä¸€é™åˆ¶ã€‚æ ¹æ®åº•å±‚ç±»å‹çš„ä¸åŒï¼Œ`do`ç¬¦å·ä¼šåšä¸€äº›ä¸åŒçš„äº‹æƒ…ã€‚å½“ä¸`Effect`ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è°ƒç”¨åŒæ­¥æœ‰æ•ˆè®¡ç®—ã€‚å½“ä¸`Maybe`ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ä¸åŒçš„è®¡ç®—ï¼Œå³*å¯èƒ½*äº§ç”Ÿä¸€ä¸ªå€¼ï¼Œæˆ–è€…*å¯èƒ½*ä¸ºç©ºï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªè¿”å›ç©ºï¼Œé‚£ä¹ˆæ•´ä¸ªè®¡ç®—è¿”å›ç©ºã€‚å½“ä¸`Array`ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°[æ•°ç»„ç†è§£](https://leanpub.com/purescript/read#leanpub-auto-array-comprehensions)ï¼Œå½“ä¸`ST`ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸åŒçš„è®¡ç®—æ¥æ”¹å˜æ•°æ®ã€‚

`do`ä¸­çš„æ¯ä¸ªè¡¨è¾¾å¼å¿…é¡»è¿”å›ç›¸åŒçš„`M`ï¼Œä½†æ˜¯å¯ä»¥æœ‰ä¸åŒçš„`a`ç±»å‹ã€‚é‚£äº›ä¸åŒçš„`a`å¯ä»¥ä½¿ç”¨`identifier â† expression`ç»‘å®šåˆ°ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œé™¤äº†å®šä¹‰æ•´ä¸ª`do`è¡¨è¾¾å¼ç±»å‹çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼ã€‚

```
foo :: M Int
bar :: M String
zoo :: Int -> String -> M Boolean

what :: M Boolean
what = do
  int <- foo
  str <- bar
  zoo int str 
```

å¦‚æœæˆ‘ä»¬å’Œ`Maybe String`ä¸€èµ·å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`Maybe`ä»£æ›¿`M`ï¼Œç”¨`String`ä»£æ›¿`a`ã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœæˆ‘ä»¬æœ‰`Array Number`ï¼Œæˆ‘ä»¬å¯ä»¥è¯´`M = Array`å’Œ`a = Number`ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å¤„ç†æœ‰å¤šä¸ªç±»å‹å‚æ•°çš„ç±»å‹æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬æœ‰`Either String Number`ï¼Œé‚£ä¹ˆå°±æœ‰`M = Either String`å’Œ`a = Number`ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½å¯ä»¥ç”¨ä¸åŒçš„å€¼(`a`)æˆåŠŸï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬å¤±è´¥äº†ï¼Œå®ƒä»¬å°±ä¼šä»¥`String`å¤±è´¥ã€‚å¦‚æœæˆ‘ä»¬æœ‰`ST r Number`ï¼Œé‚£ä¹ˆå°±æœ‰`M = ST r`å’Œ`a = Number`ã€‚

å¦‚æœæˆ‘ä»¬å›å¤´çœ‹çœ‹`new`ã€`read`å’Œ`write`çš„ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ª`ST r something`ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ do è¡¨è¾¾å¼çš„ç±»å‹ã€‚

```
new :: forall a r. a -> ST r (STRef r a)
read :: forall a r. STRef r a -> ST r a
write :: forall a r. a -> STRef r a -> ST r a

myDoExpr :: forall r. ST r Int
myDoExpr = do
    -- ref :: STRef r Int
    ref <- Ref.new 0
    -- val :: Int
    val <- Ref.read ref
    -- ST r Int
    Ref.write (val + 1) ref 
```

æœ€åï¼Œä¸€æ—¦æˆ‘ä»¬å»ºç«‹äº†æˆ‘ä»¬çš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒï¼Œä»¥è·å¾—å€¼äº†ã€‚

```
run :: forall a. (forall r. ST r a) -> a
myDoExpr :: forall r. ST r Int

mutable1 :: Int
mutable1 = run myDoExpr 
```

æ³¨æ„ï¼Œ`run`å‡½æ•°åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æœ‰ä¸€ä¸ª`forall`ï¼Œè¿™ä¸ªç‰¹æ€§å«åš [Rank N types](https://github.com/purescript/documentation/blob/master/language/Types.md#rank-n-types) ï¼Œå®ƒè´Ÿè´£é¿å…æ³„æ¼å˜å¼‚ã€‚

ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é—®ä¸€ä¸ªåƒå¹´é—®é¢˜:å¦‚æœä¸€ä¸ªå€¼åœ¨å‡½æ•°å†…éƒ¨å‘ç”Ÿäº†å˜å¼‚ï¼Œè€Œå¤–éƒ¨æ²¡æœ‰äººèƒ½å¤Ÿæ”¹å˜å®ƒï¼Œé‚£ä¹ˆå®ƒä¼šå‘å‡ºå£°éŸ³å—ï¼Ÿæˆ‘æ˜¯è¯´ï¼Œå®ƒè¿˜æ˜¯çº¯æ´çš„å—ï¼Ÿæˆ‘ä¼šè¯´æ˜¯çš„ï¼Œå¹¶æŒ‡å‡ºå³ä½¿æ˜¯è§£å†³æœ€ç®€å•çš„åŠ æ³•(1+1 ), ALU ä¹Ÿéœ€è¦æ”¹å˜å†…éƒ¨æ³¨å†Œè¡¨ï¼Œæ²¡æœ‰äººä¼šè´¨ç–‘å®ƒçš„çº¯åº¦ã€‚

## [](#mutable-qsort)å¯å˜ QSort

åœ¨â€œè¡¨ç¤ºæŠ½è±¡â€ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº† QSort ç®—æ³•çš„ä¸€ä¸ªç®€å•çš„ä¸å¯å˜å®ç°ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å¯å˜ç‰ˆæœ¬åœ¨ä¸¤ç§è¯­è¨€ä¸­æ˜¯ä»€ä¹ˆæ ·å­çš„(ä»è¿™ä¸ª[ä¼ªä»£ç ](https://www.geeksforgeeks.org/quick-sort/)å®ç°)ã€‚

[![Mutable QSort Algorithm in TypeScript (Left) and PureScript (Right)](../Images/2067138d8b8b6d6e3c99e626b0513508.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--EXPSz1og--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1557613145961_Screen%2BShot%2B2019-05-11%2Bat%2B19.18.31.png)

<figcaption>TypeScript(å·¦)å’Œ PureScript(å³)ä¸­çš„å¯å˜ QSort ç®—æ³•</figcaption>

åœ¨ *TypeScript* ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°`mutableQSortBy`æ¥æ”¶å¹¶è¿”å›ä¸€ä¸ª`ReadonlyArray`ï¼Œä½†æ˜¯åœ¨ä¸»ä½“å†…éƒ¨ï¼Œé€’å½’å‡½æ•°`sort`ä½¿ç”¨äº†ä¸€ä¸ªæ™®é€šçš„å¯å˜æ•°ç»„ã€‚åœ¨ç¬¬ 17 è¡Œï¼Œæˆ‘ä»¬åšäº†å”¯ä¸€çš„æ‹·è´ï¼Œæˆ‘ä»¬å°†`sort`æ”¾åœ¨é€‚å½“çš„ä½ç½®ï¼Œä¸€æ—¦å®ƒè¿”å›ï¼Œå®ƒå°†è¢«æ ‡è®°ä¸º`ReadonlyArray`ä»¥é¿å…è¿›ä¸€æ­¥çš„å˜å¼‚ã€‚åœ¨ *PureScript* ä¸­ï¼Œæˆ‘ä»¬åšäº†ç±»ä¼¼çš„äº‹æƒ…ï¼Œåœ¨ç¬¬ 6 è¡Œä¸­ï¼Œwith a[r](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array.ST#v:withArray)[ray](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array.ST#v:withArray)å‡½æ•°åœ¨ä¸å¯å˜æ•°ç»„çš„å‰¯æœ¬ä¸Šæ‰§è¡Œå¯å˜è®¡ç®—ï¼Œè¯¥è®¡ç®—ä½¿ç”¨ä¸€ä¸ªå†…éƒ¨é€’å½’`sort`å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨ä½œç”¨åŸŸä¸­å¼•ç”¨äº†å¯å˜`arr`ã€‚

åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå†…éƒ¨çš„`sort`ä½¿ç”¨äº†ä¸€ä¸ªåä¸º`partition`çš„è¾…åŠ©å‡½æ•°ï¼Œå®ƒå°†é€‰æ‹©ä¸€ä¸ªæ”¯ç‚¹ï¼Œå¹¶å°†è¾ƒä½çš„å…ƒç´ `swap`åˆ°å·¦è¾¹ï¼Œè¾ƒé«˜çš„å…ƒç´ åˆ°å³è¾¹ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ³¨é‡Šæ¥æŸ¥çœ‹ç®—æ³•çš„ä¸åŒéƒ¨åˆ†æ˜¯å¦‚ä½•ç›¸äº’å…³è”çš„ã€‚

[![](../Images/421ff6f90f0c31803957d3825517cba8.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--Fur7Zhrq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1557611826105_Screen%2BShot%2B2019-05-11%2Bat%2B18.56.32.png)

åœ¨`swap`å‡½æ•°ä¸­ï¼Œå®é™…æ‰§è¡Œæ•°ç»„çªå˜çš„å‡½æ•° *PureScript* çŸ¥é“è¯»å–æˆ–å†™å…¥éšæœºç´¢å¼•çš„å€¼ä¼šå¯¼è‡´è¶Šç•Œé”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè¿”å›ä¸€ä¸ªå€¼çš„`Maybe`çš„[å®‰å…¨ peek](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array.ST#v:peek) ï¼Œæˆ–è€…ä¸€ä¸ªå¯èƒ½å¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸çš„[ä¸å®‰å…¨ peek](https://pursuit.purescript.org/packages/purescript-arrays/5.3.0/docs/Data.Array.ST.Partial#v:peek) ã€‚æˆ‘ä»¬ä½¿ç”¨åè€…ï¼Œåè€…é€Ÿåº¦æ›´å¿«ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åŒ…è£…å’Œæ‰“å¼€å€¼ï¼Œä½†å®ƒè¦æ±‚æˆ‘ä»¬ä½¿ç”¨`unsafePartial`æ¥è¡¨æ˜æˆ‘ä»¬çŸ¥é“é£é™©ã€‚

[![](../Images/897bb14625f7d7304c2f8f6d54390258.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--FhBdq17r--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://paper-attachments.dropbox.com/s_3FA8B4DB81C1702262F976E2E8FE755602BB0FE3E5BC08FB0DE427D74C5BB95C_1556847755763_Screen%2BShot%2B2019-05-02%2Bat%2B22.37.33.png)

## [](#conclusion)ç»“è®º

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•åœ¨ *TypeScript* å’Œ *PureScript* ä¸­è¡¨ç¤ºç›¸åŒçš„å¯å˜å’Œä¸å¯å˜ç®—æ³•ï¼Œä»¥åŠè¯­è¨€çš„é»˜è®¤è®¾ç½®å¦‚ä½•æ”¹å˜äº†äººç±»å·¥ç¨‹å­¦ã€‚å³ä½¿è¿™æ˜¯ä¸»è§‚çš„ï¼Œæˆ‘ä¹Ÿè¦è¯´å¯å˜ç®—æ³•åœ¨ TypeScript ä¸­çœ‹èµ·æ¥æ›´è‡ªç„¶ï¼Œè€Œä¸å¯å˜ç®—æ³•åœ¨ *PureScript* ä¸­çœ‹èµ·æ¥æ›´è‡ªç„¶ã€‚

é€‰æ‹©æ˜¯å¦ä½¿ç”¨çªå˜å¯ä»¥å–å†³äºä¸åŒçš„å› ç´ ï¼Œä½†æˆ‘ä¸ªäººå°½é‡é¿å…çªå˜ï¼Œåªåœ¨æ–¹ä¾¿å¤§äºé£é™©çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚åœ¨[pure script-halo-real world](https://github.com/thomashoneyman/purescript-halogen-realworld/blob/d213795014a69af99dcb90cdbc8628d3f760c171/src/AppM.purs#L68)ä¸­å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæœ‰è¶£çš„ä¾‹å­ï¼Œé€šè¿‡ç»“åˆä½¿ç”¨ [Ref æ•ˆæœ](https://pursuit.purescript.org/packages/purescript-refs/4.1.0/docs/Effect.Ref)(ç±»ä¼¼äº ST)å’Œ`ReaderT`ç±»å‹ï¼Œåº”ç”¨ç¨‹åºä»¥ä¸€ç§â€œå—æ§å…¨å±€å˜é‡â€çš„æ–¹å¼å¤„ç†ç™»å½•ç”¨æˆ·ã€‚å¦‚æœè§‰å¾—æœ‰ç”¨è¯·è¯„è®ºåˆ†äº«ã€‚

* * *

### [](#plug-logrocket-a-dvr-for-web-apps)Plug: [LogRocket](https://logrocket.com/signup/) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

### [![](../Images/c62a982a2688a7db97ed1dd41271694a.png)T4ã€‘](https://logrocket.com/signup/)

LogRocket æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œå¯ä»¥è®©ä½ å›æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux æ“ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€å †æ ˆè·Ÿè¸ªã€å¸¦æœ‰å¤´+æ­£æ–‡çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®å’Œè‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

[å…è´¹è¯•ç”¨](https://logrocket.com/signup/)ã€‚

* * *

å¸–å­[æ˜¯çªå˜ï¼Œè¿˜æ˜¯ä¸å˜ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜](https://blog.logrocket.com/to-mutate-or-immutate/)é¦–å…ˆå‡ºç°åœ¨[åšå®¢](https://blog.logrocket.com)ä¸Šã€‚