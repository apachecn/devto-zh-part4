# ä¸è¦å¿˜è®°ç»™ç”¨æˆ·ä¸€ä¸ªé€‰æ‹©ğŸ’­

> åŸæ–‡:[https://dev . to/atorn blad/don-t-forget-to-give-the-user-a-choice-1f 68](https://dev.to/atornblad/don-t-forget-to-give-the-user-a-choice-1f68)

æœ¬ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæè¿°äº†æˆ‘å¦‚ä½•ä»¥åŠä¸ºä»€ä¹ˆå¼€å§‹æ„å»ºä¸¤ä¸ªåä¸º *[å«å¦ˆå¦ˆ](https://play.google.com/store/apps/details?id=se.atornblad.callmom)* å’Œ *[å«çˆ¸çˆ¸](https://play.google.com/store/apps/details?id=se.atornblad.calldad)* çš„åº”ç”¨ã€‚ç¬¬äºŒéƒ¨åˆ†ä»‹ç»äº†è¿™äº›åº”ç”¨ç¨‹åºç¬¬ä¸€ç‰ˆçš„ä¸€äº›æ–¹é¢ã€‚è¿™ä¸€éƒ¨åˆ†ç»§ç»­æè¿°å¦‚ä½•é€šè¿‡ç»™ç”¨æˆ·æä¾›é€‰æ‹©æ¥æ§åˆ¶ç”¨æˆ·ã€‚å¦‚æœä½ åªæ˜¯æƒ³è¦æ‘˜è¦å’Œä¸€äº›é“¾æ¥ï¼Œå»åº•éƒ¨çš„[æ‘˜è¦éƒ¨åˆ†](#summary)ã€‚

# [](#dont-forget-to-give-the-user-a-choice)åˆ«å¿˜äº†ç»™ç”¨æˆ·ä¸€ä¸ªé€‰æ‹©ğŸ’­

è¦å…è®¸ç”¨æˆ·ä»ä»–ä»¬çš„ç”µè¯ç°¿ä¸­é€‰æ‹©è”ç³»äººï¼Œæ¨èçš„æ–¹æ³•æ˜¯ä½¿ç”¨æ“ä½œç³»ç»Ÿæ³¨å†Œçš„è”ç³»äººé€‰æ‹©å™¨ã€‚é¦–å…ˆåˆ›å»ºä¸€ä¸ª`Intent`å¹¶è°ƒç”¨`startActivityForResult`ã€‚

```
// Select a unique identifier between 1 and 65535
private static final int PICK_CONTACT_REQUEST_ID = 12345;

private void startContactSelection() {
    // This URI is used to identify what contact picker the user has
    // picked (or the OS has defaulted) for this device
    Uri uri = Uri.parse("content://contacts/people");

    // Create an intent to start the picker
    Intent pickContactIntent = new Intent(Intent.ACTION_PICK, uri);

    // Tell the picker to only show contacts with phone numbers
    pickContactIntent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);

    // Start the activity. Use the startActivityForResult method instead of
    // the startActivity one, because we want the result of the action!
    startActivityForResult(pickContactIntent, PICK_CONTACT_REQUEST_ID);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å½“è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œæœ€å¥½æ˜¯é€šè¿‡å•å‡»æŒ‰é’®æˆ–å…¶ä»–ç”¨æˆ·äº¤äº’ï¼Œè”ç³»äººé€‰å–å™¨æ‰“å¼€ã€‚è¿™åœ¨æˆ‘æµ‹è¯•çš„æ‰€æœ‰è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨ä¸Šéƒ½è¿è¡Œå¾—å¾ˆå¥½ï¼Œä½†åæ¥å…¬å¼€å‘å¸ƒåº”ç”¨ç¨‹åºæ—¶ï¼Œè¿™ç§æ–¹æ³•å¯¼è‡´äº†ä¸€äº›æ‰‹æœºå´©æºƒã€‚

åŸæ¥æœ‰äº›è®¾å¤‡æ²¡æœ‰æ³¨å†Œä»»ä½•è”ç³»äººé€‰æ‹©å™¨ï¼Œæ‰€ä»¥`startActivityForResult`æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨é¦–å…ˆéœ€è¦æ£€æŸ¥`Intent`æ˜¯å¦çœŸçš„è§£æä¸ºä¸€ä¸ªåŠ¨ä½œã€‚å¦‚æœæ²¡æœ‰ï¼Œæ‚¨éœ€è¦ä¸ºç”¨æˆ·æä¾›ä¸€äº›å…¶ä»–æ–¹æ³•æ¥é€‰æ‹©è¦æ‹¨æ‰“çš„ç”µè¯å·ç ã€‚

```
private void startContactSelection() {
    Uri uri = Uri.parse("content://contacts/people");
    Intent pickContactIntent = new Intent(Intent.ACTION_PICK, uri);

    // Check which component the URI above is connected to
    PackageManager pm = getPackageManager();
    ComponentName component = pickContactIntent.resolveActivity(pm);
    if (component == null) {
        // This device has no contact picker
        // Show an error message to the user, or solve this
        // in some other way. Maybe let the user enter the
        // phone number to call manually in a text box.
        return;
    }

    pickContactIntent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
    startActivityForResult(pickContactIntent, PICK_CONTACT_REQUEST_ID);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#getting-the-contact-details)è·å–è”ç³»äººè¯¦ç»†ä¿¡æ¯

å½“ç”¨æˆ·ä»åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªè”ç³»äººå¹¶å…³é—­è”ç³»äººé€‰æ‹©å™¨æ—¶ï¼Œæ‚¨çš„`Activity`ç±»çš„`onActivityResult`æ–¹æ³•è¢«è°ƒç”¨ï¼Œæ‚¨å¿…é¡»é‡å†™è¯¥æ–¹æ³•æ‰èƒ½è¯»å–ç”¨æˆ·é€‰æ‹©çš„ç»“æœã€‚

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // First check if this is a result from the intent we started above
    if (requestCode != PICK_CONTACT_REQUEST_ID) return;

    // Then check if the action was successful (the user clicked OK and not Cancel)
    if (resultCode != RESULT_OK) return;

    // Get the base URI for the selected contact, if any
    Uri contactUri = data.getData();
    if (contactUri == null) return;

    // Read fields from the contact data by querying the contact, using a projection
    // The projection is where you pick what data fields you want to read
    // This projection reads the display name and the phone number
    String[] projection = new String[] {
        ContactsContract.Contacts.DISPLAY_NAME,
        ContactsContract.CommonDataKinds.Phone.NUMBER
    };

    // Query the data using a `ContentResolver`
    Cursor cursor = getContentResolver().query(contarcUti, project, null, null, null);

    // If the cursor if valid and has data, get the data field values out
    if (cursor != null && cursor.moveToFirst()) {
        String displayName = cursor.getString(0);
        String phoneNumber = cursor.getString(1);

        // TODO: Store the contact information in some form of persistant storage, to
        // be able to display the contact name, and to call the phone number later
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#creating-a-schedule-editor)åˆ›å»ºæ—¥ç¨‹ç¼–è¾‘å™¨ğŸ“…

ä¸æ˜¯æ¯ä¸ªäººéƒ½ä»¥åŒæ ·çš„é¢‘ç‡ï¼Œæˆ–è€…åœ¨ä¸€å¤©ä¸­çš„åŒä¸€æ—¶é—´ç»™çˆ¶æ¯æ‰“ç”µè¯ã€‚æˆ‘å¿…é¡»å®ç°çš„ä¸€ä»¶äº‹æ˜¯æ—¶é—´è¡¨ç¼–è¾‘å™¨ã€‚æˆ‘æƒ³è®©å®ƒçœ‹èµ·æ¥åƒä¸€äº›æ‰‹æœºä¸Šçš„é—¹é’Ÿè®¾ç½®è¾“å…¥ã€‚è¿™æ ·ï¼Œå¤§å¤šæ•°äººä¼šè§‰å¾—ç”¨æˆ·ç•Œé¢å¾ˆç†Ÿæ‚‰ï¼Œè€Œæˆ‘ä¹Ÿä¸å¿…å®Œå…¨é‡æ–°å‘æ˜ä¸€äº›æ›´æœ‰èƒ½åŠ›çš„ UX äººå·²ç»è§£å†³çš„ä¸œè¥¿ã€‚

[![HTC Alarm app screenshot](img/72cdc2892324aa29b8b7b4ce339ae412.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PB-rBBUz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://static.atornblad.se/both-alarm-settings-510.png)

*<small>æˆªå›¾ï¼Œå·¦èµ·:HTC é—¹é’Ÿï¼ŒDelightRoom Alarm</small>T3ã€‘*

## [](#pick-the-time-of-day)é€‰æ‹©ä¸€å¤©ä¸­çš„æ—¶é—´

æˆ‘é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„`Activity`ï¼Œç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé€‰æ‹©ä»–ä»¬çš„é€šè¯æ—¶é—´è¡¨ã€‚åœ¨å¸ƒå±€çš„é¡¶éƒ¨ï¼Œæˆ‘æ”¾ç½®äº†ä¸€ä¸ª[æ—¶é—´é€‰æ‹©å™¨](https://developer.android.com/reference/android/widget/TimePicker)ï¼Œç”¨äºé€‰æ‹©ä¸€å¤©ä¸­çš„å‘¼å«æ—¶é—´:

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  android:orientation="vertical">

    <TimePicker android:id="@+id/time_of_day"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" />

</LinearLayout> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä½¿ç”¨æˆ·èƒ½å¤Ÿæ­£ç¡®é€‰æ‹©ä¸€å¤©ä¸­çš„å°æ—¶å’Œåˆ†é’Ÿã€‚æ˜¾ç¤ºä¼šé€‚åº”ç”¨æˆ·çš„åŒºåŸŸè®¾ç½®ï¼Œå› æ­¤ç”¨æˆ·ä¼šæœ‰ä¸€è‡´å’Œç†Ÿæ‚‰çš„ä½“éªŒã€‚è¦ä»ä»£ç ä¸­è¯»å–ç”¨æˆ·é€‰æ‹©ï¼Œè°ƒç”¨`getHour`å’Œ`getMinute`æ–¹æ³•:

```
// Get the TimePicker view
TimePicker timeOfDayPicker = findViewById(R.id.time_of_day);

// Read the data selected by the user
int hourOfDay = timeOfDayPicker.getHour();
int minuteOfDay = timeOfDayPicker.getMinute(); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#pick-a-schedule-frequency)é€‰æ‹©ä¸€ä¸ªæ’ç­é¢‘ç‡

åœ¨`TimePicker`è§†å›¾ä¸‹é¢ï¼Œæˆ‘æ”¾ç½®äº†ä¸€ä¸ªåŒ…å«å››ä¸ª`RadioButton`è§†å›¾çš„`RadioGroup`ï¼Œç”¨äºé€‰æ‹©é‡å¤çš„ç±»å‹ã€‚æœ¬ä¾‹ä¸­çš„æ‰€æœ‰æ–‡æœ¬éƒ½æ˜¯ç¡¬ç¼–ç çš„ï¼Œä½†æ˜¯æ‚¨åº”è¯¥å§‹ç»ˆå¯¹æ–‡æœ¬å†…å®¹ä½¿ç”¨èµ„æºå¼•ç”¨ã€‚

```
 <TextView android:text="Repeat:"
      android:layout_width="match_parent"
      android:layout_height="wrap_content">

    <RadioGroup android:id="@+id/repeat_selector"
      android:orientation="vertical"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content">

        <RadioButton android:id="@+id/repeat_daily"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:text="Daily" />

        <RadioButton android:id="@+id/repeat_weekly"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:text="Weekly" />

        <RadioButton android:id="@+id/repeat_monthly"
          android:layout_width="match_parent"
          android:layout_height="wrap_content"
          android:text="Monthly" />

    </RadioGroup> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘å‘ç°ä»ä»£ç ä¸­è¯»å–ç”¨æˆ·é€‰æ‹©çš„æœ€å¥½æ–¹æ³•æ˜¯åœ¨`RadioGroup`å¯¹è±¡ä¸Šä½¿ç”¨`getCheckedRadioButtonId`æ–¹æ³•ã€‚è¿™å…è®¸æ‚¨`switch`å¹¶æ ¹æ®é€‰æ‹©çš„å•é€‰æŒ‰é’®æ‰§è¡Œä¸åŒçš„ä»»åŠ¡:

```
// Get the RadioGroup view
RadioGroup repeatSelector = findViewById(R.id.repeat_selector);

// Read the radio button id selected by the user
int checkedId = repeatSelector.getCheckedRadioButtonId();

// Act upon the user's choice
switch (checkedId) {
    case R.id.repeat_daily:
        // Put code here to hide views for picking weekday,
        // or day of month
        break;
    case R.id.repeat_weekly:
        // Put code here to show views for picking weekday
        break;
    case R.id.repeat_monthly:
        // Put code here to show views for picking day of month
        break;
    default:
        // No repetition pattern selected, show an error message
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#pick-a-weekday)æŒ‘é€‰ä¸€ä¸ªå·¥ä½œæ—¥

å¦‚æœç”¨æˆ·é€‰æ‹©æ¯å‘¨æ¨¡å¼ï¼Œä»–ä»¬å¿…é¡»èƒ½å¤Ÿé€‰æ‹©ä¸€å‘¨ä¸­çš„æŸä¸€å¤©æ‰“ç”µè¯ã€‚å…è®¸è¿™ç§é€‰æ‹©çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ª`NumberPicker`ã€‚

```
 <NumberPicker android:id="@+id/day_of_week"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" /> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`onCreate`æ–¹æ³•ä¸­å‡†å¤‡`NumberPicker`ã€‚ä¸€ä¸ªå¾ˆå¥½çš„æŠ€å·§æ˜¯ä½¿ç”¨`Calendar`å·¥ä½œæ—¥å¸¸é‡ã€‚`SUNDAY`çš„å€¼æ˜¯`1`ï¼Œè€Œ`SATURDAY`çš„å€¼æ˜¯`7`ï¼Œæ‰€ä»¥å°†æœ€å°å’Œæœ€å¤§å…è®¸å€¼è®¾ç½®ä¸ºè¿™äº›å¸¸é‡ã€‚è¦è·å¾—å·¥ä½œæ—¥çš„æ­£ç¡®åç§°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`DateFormatSymbols`æ–¹æ³•`getShortWeekdays`æˆ–`getWeekdays`ä¹‹ä¸€ã€‚

```
NumberPicker weekdayPicker = findViewById(R.id.day_of_week);
weekdayPicker.setMinValue(Calendar.SUNDAY);
weekdayPicker.setMaxValue(Calendar.SATURDAY);

// Get full weekday names, like "Sunday", "Monday", ...
String[] weekdayNames = DateFormatSymbols.getInstance().getWeekdays();

// The NumberPicker needs the first string to be at index 0, but
// because SUNDAY is defined as 1, the values in the weekdayNames
// array actually start at index 1\. So we have to copy indices 1..7
// into a new array at indices 0..6
// The final argument value of 8 is the index directly after the
// last index to copy, which might look confusing.
String[] displayNames = Arrays.copyOfRange(weekdayNames, 1, 8);

// Tell the NumberPicker to use these strings instead of the
// numeric values 1 to 7
weekdayPicker.setDisplayedValues(displayNames);
weekdayPicker.setWrapSelectorWheel(true); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#pick-a-day-of-the-month)æŒ‘é€‰ä¸€ä¸ªæœˆä¸­çš„æŸä¸€å¤©

å¯¹äº montly æ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥ä» 1 åˆ° 31 çš„`NumberPicker`ä¸­é€‰æ‹©ä¸€ä¸ªæœˆä¸­çš„æŸä¸€å¤©ï¼Œæ— éœ€ä»»ä½•ç‰¹æ®Šçš„æ˜¾ç¤ºæ–‡æœ¬è®¾ç½®ã€‚åœ¨å¸ƒå±€ xml æ–‡ä»¶ä¸­:

```
 <NumberPicker android:id="@+id/day_of_month"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" /> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç”¨`onCreate`æ–¹æ³•å‡†å¤‡æ‹¾å–å™¨:

```
NumberPicker monthDayPicker = findViewById(R.id.day_of_month);
monthDayPicker.setMinValue(1);
monthDayPicker.setMaxValue(31);
monthDayPicker.setWrapSelectorWheel(true); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#calculating-the-correct-time-for-the-next-notification)è®¡ç®—ä¸‹ä¸€æ¬¡é€šçŸ¥çš„æ­£ç¡®æ—¶é—´

æ—¥ç¨‹å®‰æ’çš„æ—¶é—´è®¡ç®—å¯èƒ½ä¼šå¾ˆæ£˜æ‰‹ï¼Œæˆ‘å·²ç»å°½åŠ›è®©è§„åˆ™å°½å¯èƒ½ç®€å•ã€‚é¦–å…ˆï¼Œæœ‰ä¸€ä¸ªåä¸º`notBefore`çš„å‚æ•°ï¼Œç”¨äºä¼ å…¥é€šçŸ¥ä¸åº”è¯¥æ˜¾ç¤ºçš„æ—¶é—´ä¹‹å‰ã€‚æˆ‘å·²ç»å†³å®šå°†è¿™ä¸ªå˜é‡è®¾ç½®ä¸ºæœ€è¿‘ä¸€æ¬¡é€šè¯åçš„ä¸€ä¸ªå°æ—¶ã€‚

ç„¶åä½¿ç”¨é‡å¤æ¨¡å¼*(æ¯å¤©ã€æ¯å‘¨æˆ–æ¯æœˆ)*è°ƒç”¨ç›¸åº”çš„ç®—æ³•ã€‚ç›®å‰ï¼Œè¿™ä¸ªè§£å†³æ–¹æ¡ˆåªæ”¯æŒ`GregorianCalendar`ã€‚

```
public class ScheduleModel {
    public final static int DAILY = 1;
    public final static int WEEKLY = 2;
    public final static int MONTHLY = 3;

    // Hour and minute of the day
    private int hour;
    private int minute;

    // Any of DAILY, WEEKLY or MONTHLY
    private int type;

    // Any of the Calendar.SUNDAY .. Calendar.SATURDAY constants
    private int dayOfWeek;

    // Anywhere between 1 and 31
    private int dayOfMonth;

    public ScheduleModel(int hour, int minute, int type, int dayOfWeek, int dayOfMonth) {
        this.hour = hour;
        this.minute = minute;
        this.type = type;
        this.dayOfWeek = dayOfWeek;
        this.dayOfMonth = dayOfMonth;
    }

    public Calendar getNextNotification(Calendar notBefore) {
        // Switch on the type and call the corresponding method
        switch (type) {
            case DAILY:
                return getDailyNext(notBefore);
            case WEEKLY:
                return getWeeklyNext(notBefore);
            case MONTHLY:
                return getMonthlyNext(notBefore);
            default:
                // Unsupported schedule type
                return notBefore;
        }
    }

    private Calendar getDailyNext(Calendar notBefore) {
        // Start at the notBefore date, with the selected time of day
        Calendar next = new GregorianCalendar(
            notBefore.get(Calendar.YEAR),
            notBefore.get(Calendar.MONTH),
            notBefore.get(Calendar.DAY_OF_MONTH),
            hour, minute);
        );

        // If that time is before the earliest allowed time to call,
        // step forward one day
        if (next.before(notBefore)) {
            next.add(Calendar.DAY_OF_YEAR, 1);
        }

        return next;
    }

    private Calendar getWeeklyNext(Calendar notBefore) {
        // Start at the notBefore date, with the selected time of day
        Calendar next = new GregorianCalendar(
            notBefore.get(Calendar.YEAR),
            notBefore.get(Calendar.MONTH),
            notBefore.get(Calendar.DAY_OF_MONTH),
            hour, minute);
        );

        // While that time is before the earliest allowed time to call,
        // or the day isn't the selected weekday, step forward one day
        while (next.get(Calendar.DAY_OF_WEEK) != dayOfWeek || next.before(notBefore)) {
            next.add(Calendar.DAY_OF_YEAR, 1);
        }

        return next;
    }

    private Calendar getMonthlyNext(Calendar notBefore) {
        // Start at the notBefore month, with the selected day of the
        // month and the selected time of day
        Calendar next = new GregorianCalendar(
            notBefore.get(Calendar.YEAR),
            notBefore.get(Calendar.MONTH),
            dayOfMonth,
            hour, minute);
        );

        // If that time is before the earliest allowed time to call,
        // step forward one month
        if (next.before(notBefore)) {
            next.add(Calendar.MONTH, 1);
        }

        return next;
    }
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`getNextNotification`æ–¹æ³•çš„ç»“æœè¢«ä¼ é€’åˆ°æŠ¥è­¦ç³»ç»Ÿï¼Œä»¥è®¾ç½®ä¸‹ä¸€æ¬¡é€šçŸ¥çš„æ—¶é—´ã€‚

```
// First get the last call time and calculate the notBefore value
Calendar notBefore = getLastCallTime();
notBefore.add(Calendar.HOUR_OF_DAY, 1);

// Get the time for the next notification
Calendar next = schedule.getNextNotification(notBefore);

// Set the alarm
myAlarmsInstance.setAlarm(next.getTimeInMillis()); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

# [](#summary)æ€»ç»“ğŸ”–

*   ä½¿ç”¨ [startActivityForResult](https://developer.android.com/training/basics/intents/result) å¯åŠ¨è”ç³»äººé€‰æ‹©å™¨
*   ä½¿ç”¨ [resolveActivity](https://developer.android.com/reference/android/content/Intent#resolveActivity(android.content.pm.PackageManager)) æ£€æŸ¥ç”¨æˆ·æ˜¯å¦çœŸçš„æ³¨å†Œäº†è”ç³»äººé€‰å–å™¨
*   é€šè¿‡è¦†ç›– [onActivityResult](https://developer.android.com/training/basics/intents/result) æ–¹æ³•è¯»å–è”ç³»äººæ•°æ®
*   å°½å¯èƒ½ä½¿ç”¨å†…ç½®çš„çª—å£å°éƒ¨ä»¶ï¼Œæ¯”å¦‚[å•é€‰æŒ‰é’®](https://developer.android.com/guide/topics/ui/controls/radiobutton)ã€[æ•°å­—é€‰æ‹©å™¨](https://developer.android.com/reference/android/widget/NumberPicker)å’Œ[æ—¶é—´é€‰æ‹©å™¨](https://developer.android.com/reference/android/widget/TimePicker)è§†å›¾
*   å¦‚æœä½ è¦å¤„ç†æ—¶é—´å’Œæ—¥æœŸï¼Œå°½é‡ä½¿æ‰€æœ‰çš„ä¿®æ”¹ç®€å•å¯è¡Œï¼Œä½¿ç”¨å†…ç½®çš„ç±»ï¼Œå¦‚[æ—¥å†](https://developer.android.com/reference/java/util/Calendar)æˆ–[æœ¬åœ°æ—¥æœŸæ—¶é—´](https://developer.android.com/reference/java/time/LocalDateTime) *(å¦‚æœä½ çš„ç›®æ ‡æ˜¯ç‰ˆæœ¬ 26 æˆ–æ›´é«˜ç‰ˆæœ¬)*

*å°é¢ç…§ç‰‡ç”±[å¸•ä¸‡Â·ç‰¹é‡Œåº“å¡”å§†](https://unsplash.com/photos/71CjSSB83Wo)åœ¨[Unsplash](https://unsplash.com/)T5 æ‹æ‘„*