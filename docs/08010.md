# ç±»å‹è„šæœ¬æ³›å‹çš„ç”¨ä¾‹

> åŸæ–‡:[https://dev . to/juliang/a-use-case-for-generics-in-typescript-20j 7](https://dev.to/juliang/a-use-case-for-generics-in-typescript-20j7)

å¯¹æŸäº›äººæ¥è¯´ï¼Œä»¥ä¸‹å†…å®¹å¯èƒ½æœ‰ç‚¹æ˜¾è€Œæ˜“è§ã€‚ä½†æ˜¯æˆ‘çªç„¶æƒ³èµ·äº†ä¸€äº›äº‹æƒ…ï¼Œæˆ‘æƒ³æˆ‘åº”è¯¥æŠŠå®ƒå†™ä¸‹æ¥ã€‚

## [](#when-generics-are-a-good-idea)å½“æ³›å‹æ˜¯ä¸ªå¥½ä¸»æ„æ—¶

å‡è®¾æˆ‘ä»¬å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›é›†åˆ/æ•°ç»„ä¸­â€œæœ€è€çš„â€é¡¹:

```
function getOldest(items: Array<{ age: number }>) {
  return items.sort((a, b) => b.age - a.age)[0];
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨ä»»ä½•ç±»å‹çš„å¯¹è±¡æ•°ç»„æ¥è°ƒç”¨ï¼Œåªè¦å®ƒä»¬åŒ…å«ç±»å‹ä¸º`number`çš„`age`å±æ€§ã€‚

ä¸ºäº†å¸®åŠ©æ¨ç†ï¼Œæˆ‘ä»¬ç»™å®ƒèµ·ä¸ªåå­—:

```
type HasAge = { age: number }; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æˆ‘ä»¬çš„å‡½æ•°å¯ä»¥è¿™æ ·æ³¨é‡Š:

```
function getOldest(items: HasAge[]): HasAge {
  return items.sort((a, b) => b.age - a.age)[0];
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**å¤ªå¥½äº†ï¼**ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹ä»»ä½•ç¬¦åˆ`HasAge`æ¥å£çš„å¯¹è±¡ä½¿ç”¨è¿™ä¸ªå‡½æ•°:

```
const things = [{ age: 10 }, { age: 20 }, { age: 15 }];
const oldestThing = getOldest(things);

console.log(oldestThing.age); // 20 âœ… 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› ä¸º`oldestThing`çš„ç±»å‹è¢«æ¨æ–­ä¸º`HasAge`ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¿é—®å®ƒçš„`.age`å±æ€§ã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ‰æ›´å¤æ‚çš„ç±»å‹å‘¢ï¼Ÿ

```
type Person = { name: string, age: number};

const people: Person[] = [
  { name: 'Amir', age: 10 }, 
  { name: 'Betty', age: 20 }, 
  { name: 'Cecile', age: 15 }
 ];

const oldestPerson = getOldest(people); // ğŸ™‚ no type errors 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**è¿™ä¸ªå·¥ä½œ**ï¼Œä½†æ˜¯ç°åœ¨`oldestPerson`çš„æ¨æ–­ç±»å‹æ˜¯`HasAge`ã€‚æˆ‘ä»¬å·²ç»å¤±å»äº†`Person`å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ— æ³•(å®‰å…¨åœ°)è®¿é—®å®ƒçš„`.name`å±æ€§ã€‚

```
console.log(oldestPerson.name); // âŒ type error: Property 'name' does not exist on type 'HasAge'. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ³¨é‡Š`oldestPerson:Person`ä¸èµ·ä½œç”¨:

```
const oldestPerson: Person = getOldest(people); // âŒ type error
// Property 'name' is missing in type 'HasAge' but required in type 'Person'. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[ç±»å‹æ–­è¨€](https://www.typescriptlang.org/docs/handbook/basic-types.html#type-assertions)ï¼Œä½†è¿™ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚([ä¸ºä»€ä¹ˆï¼Ÿ](https://basarat.gitbooks.io/typescript/docs/types/type-assertion.html#assertion-considered-harmful) )

```
const oldestPerson = getOldest(people) as Person; // ğŸš©
console.log(oldestPerson.name); // no type error 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[ä½ å¯ä»¥åœ¨ TypeScript Playground](https://www.typescriptlang.org/play/#code/PTAEHUEsBcAsHsCu1QHECmA7dAnSBjAZwChjoBPAB3VAAkBDQgQQHMaBeUAb1HrYC5QmRAFsARrlABfANykAZokz5okeJlBtoAeQA2AE3SFoAChjoRhQQ2ZsA2gF0AlNcasaXYqFA500RDga5pYAdITwOKYm9AA0oGJOoOwAfPEhfDQAtLzpbE52AAwOclKk+OrGoHCQmCyESaB2PBmCAIwF0nHNAqAATB1SXbw9rQCs0sXE5ZiV8AZG0AAqsDUsDVp6hsYm1bWETnJTFXPoIbrwLCZzW0srtbnoB6AgfR2AoOSkFNSgAAq44RpODxMPQROhBMY8LUZMNwUJRBIcNJDtNKtR4JRdHC-jgAY4GnYvNwhKC4QAiJgiSA4MlxFqgdqdInA0mCMkAIT8FFpsME-SZ3hZYLZAGF0PhIFiefSxtJiJMjjMUNcFus-JsFiZ0ZjHjCXoBeDcAQntCeBVKg0XA4CL1MTIEL20gvVEnM4XK7zYwhEFgp4vQAy5L8rdRIuRQAByb3oMOgfTwIwmlDoAAekFmGi+NDD7noYixYZCjrAqOVHugOIBgnL6jVOlLWvQGKxvrAAYzoEtEWILx+QdwFHDkejqdAVMIhFWoBqZu+YZs7mjtpQvgAjohqeh9JP0+bw1XMPnC6AAKrj2rTmiMQh9tQzMoVEs3Pc1jXbbVN3j1Pd6sD6wCVewneE0eBN0oHB6BUAh0EVcIsVdS4VWMPcvVJZsTXPdscCtHA4kXNCWHgYDQFA8DVHwC0YFgXBiCAA) è¯•è¯•è¿™ä¸ªã€‚

## [](#using-generics)ä½¿ç”¨æ³›å‹

æˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå˜æˆä¸€ä¸ª[é€šç”¨](https://www.typescriptlang.org/docs/handbook/generics.html)å‡½æ•°ã€‚

```
function getOldest<T extends HasAge>(items: T[]): T {
  return items.sort((a, b) => b.age - a.age)[0];
}

const oldestPerson = getOldest(people); // âœ… type Person 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**æˆåŠŸï¼ï¼**ç°åœ¨`oldestPerson`çš„æ¨æ–­ç±»å‹æ˜¯`Person`ï¼

å› æ­¤æˆ‘ä»¬å¯ä»¥è®¿é—®å®ƒçš„`.name`å±æ€§ã€‚

è¿™æ˜¯å¦ä¸€ä¸ªæœ‰ä¸¤ç§ä¸åŒç±»å‹çš„ä¾‹å­:

```
type Person = {name: string, age: number};
const people: Person[] = [
  { name: 'Amir', age: 10 }, 
  { name: 'Betty', age: 20 }, 
  { name: 'Cecile', age: 15 }
 ];

type Bridge = {name: string, length: number, age: number};
const bridges = [
{ name: 'London Bridge', length: 269, age: 48 },
{ name: 'Tower Bridge', length: 244, age: 125 },
{ name: 'Westminster Bridge', length: 250, age: 269 }
]

const oldestPerson = getOldest(people); // type Person
const oldestBridge = getOldest(bridges); // type Bridge

console.log(oldestPerson.name); // 'Betty' âœ…
console.log(oldestBridge.length); // '250' âœ… 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[ä½ å¯ä»¥åœ¨ TypeScript Playground](https://www.typescriptlang.org/play/#code/PTAEFUGcEsDsHNQHECmsUCdoGNICg8AXATwAcVQAJAQ0gEF4KBeUAb1GsYC5RYBXALYAjTKAC+AbgIAzPrGyFoAe1ihGhAPIAbACYpIhADwAVUCgAehNDshVaDFAD4AFNCsDIPYwG0AugEovNjxQUAwUQj4MVTcUDwA6SCUMQmdnagAaUCF-UCZHbPjOCgBaDiLGf28ABl8pMQISclAABUwk1RZ2WGoBFB4DLAQJDm5eQREMcSlsFQNQciVSLX7W9pU-PNBvELZeXtWAIjoBaAxDrOKeAEZq8Qzd7oOeQ4AhCJIL0dWAJjuxB6hJ59F4AYRQ2GgKy+V1A1wArOI8HVGmQKK8sDpGFtgatBnB4CMVghCAALHj8YSYEawymTaZ4WaweZCTGMWwsHZA-Yg0CHAAyKh0KlAGOgWJQX2J8DJPB+ADYAJyXMYAFgAHPdHjyjsYlAB3URiiVStAy8mgH6q1Uq1bXH6IgHanq8w4AdX0hFOzKsU2NjFNJItDuqtrlSqRKMZc0IoCUuk9bQwHS26m0egMzkWyxQ-hGIFATQoSY60Z9cYTBn9zDUEXTnucrPF7LzoALRdFbJQBCZSRW8S0SngznjGcIJZU8RdufzYAA5O9CCQ56BAKDkZb7KAHQ5HlcI1YHZrJrYLc5DK-XQA) è¯•è¯•è¿™ä¸ª

## [](#when-generics-are-not-needed)ä¸éœ€è¦æ³›å‹æ—¶

å³ä½¿æ‚¨çš„å‡½æ•°æ¥å—ç¬¦åˆ`HasAge`æ¥å£çš„å¯¹è±¡ï¼›åªè¦ä½ ä¸æƒ³è¿”å›ç›¸åŒçš„ç±»å‹ï¼Œä½ å°±ä¸éœ€è¦æ³›å‹ã€‚

```
function isFirstOlder<T extends HasAge>(a: T, b: T) {
  return a.age > b.age;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸Šé¢çš„å‡½æ•°ä¸éœ€è¦æ˜¯é€šç”¨çš„ã€‚æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å†™:

```
function isFirstOlder(a: HasAge, b: HasAge) {
  return a.age > b.age;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#resources)èµ„æº

*   [æ³›å‹](https://www.typescriptlang.org/docs/handbook/generics.html)(æ‰“å­—æ‰‹å†Œ)
*   ç±»å‹æ–­è¨€(ç±»å‹è„šæœ¬æ‰‹å†Œ)
*   [ç±»å‹æ–­è¨€](https://basarat.gitbooks.io/typescript/docs/types/type-assertion.html) (Basarat çš„ TypeScript æ·±æ½œ)
*   [æ‰“å­—æ“åœº](https://www.typescriptlang.org/play/)

## [](#feedback)åé¦ˆï¼Ÿ

æˆ‘å¾ˆæƒ³å¬å¬ä½ çš„æƒ³æ³•ã€‚ä½ è¿˜æœ‰å…¶ä»–çš„ç”¨ä¾‹å—ï¼Ÿä¾‹å­ï¼Ÿ

* * *

Joshua Coleman åœ¨ [Unsplash](https://unsplash.com/) ä¸Šæ‹æ‘„çš„ç…§ç‰‡