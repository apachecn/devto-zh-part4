# ã€Šä»£ç çš„å‡ºç°ã€‹â€”â€”ä»–æ²¡æœ‰å®ä¹ ç”Ÿå—ï¼Ÿè°œé¢˜ 5

> åŸæ–‡ï¼š<https://dev.to/10xlearner/advent-of-code-doesn-t-he-have-intern-elves-for-this-puzzle-5-5735>

ä½ å¥½ï¼æˆ‘æ˜¯ Xavier Jouvenotï¼Œè¿™æ˜¯å…³äºä»£ç å‡ºç°çš„[ç³»åˆ—çš„ç¬¬ä¸‰éƒ¨åˆ†ã€‚è¿™é‡Œ](https://adventofcode.com)å¯ä»¥æ‰¾åˆ°ä¸Šä¸€éƒ¨åˆ†

å¯¹äºè¿™ä¸ªæ–°å¸–å­ï¼Œæˆ‘ä»¬å°†ä» 2015 å¹´ 12 æœˆ 5 æ—¥å¼€å§‹è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåä¸ºâ€œä»–æ²¡æœ‰å®ä¹ ç”Ÿç²¾çµå—ï¼Ÿâ€ã€‚æˆ‘å°†åœ¨ C++ä¸­æå‡ºè§£å†³æ–¹æ¡ˆï¼Œä½†æ¨ç†å¯ä»¥åº”ç”¨äºå…¶ä»–è¯­è¨€ã€‚

ä½†æ˜¯é¦–å…ˆï¼Œæˆ‘æƒ³è§£å†³å‰ä¸€ä¸ªé—®é¢˜çš„ä¸€ä¸ªè¦ç‚¹ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³è·³åˆ°ç¬¬äº”å¤©çš„é—®é¢˜ï¼Œè¯·ä¾¿ã€‚

## ç¬¬ 4 å›ä¸€å¤©

Reddit ç”¨æˆ· TheFlamefire ç»™äº†æˆ‘ä¸€äº›å¾ˆå¥½çš„æ„è§ï¼Œå¸®åŠ©æˆ‘æ”¹è¿›äº†å¯¹[ç¬¬å››å¤©é—®é¢˜](//2019-06-21-AdventOfCode2015-Day4-The-Ideal-Stocking-Stuffer.md)çš„è§£å†³æ–¹æ¡ˆã€‚ä»–çš„è¯„è®ºä¸[å•ä¸€è´£ä»»åŸåˆ™](https://en.wikipedia.org/wiki/Single_responsibility_principle)äº§ç”Ÿäº†ç›´æ¥å…±é¸£ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘æƒ³åœ¨ç¬¬äº”å¤©çš„é—®é¢˜ä¸­è°ˆè®ºçš„(å¾ˆå¥½çš„å·§åˆğŸ˜„).

### å•ä¸€è´£ä»»åŸåˆ™ï¼Œé‚£æ˜¯ä»€ä¹ˆï¼Ÿ

æ­£å¦‚[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Single_responsibility_principle)æ‰€æè¿°çš„:

> å•ä¸€è´£ä»»åŸåˆ™æ˜¯ä¸€ç§è®¡ç®—æœºç¼–ç¨‹åŸåˆ™ï¼Œå®ƒè§„å®šæ¯ä¸ªæ¨¡å—ã€ç±»æˆ–å‡½æ•°éƒ½åº”è¯¥å¯¹è½¯ä»¶æä¾›çš„åŠŸèƒ½çš„å•ä¸€éƒ¨åˆ†è´Ÿè´£ï¼Œâ€¦

é€šè¿‡åº”ç”¨è¿™ä¸ªåŸåˆ™ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªæ›´åŠ æ¨¡å—åŒ–çš„ä»£ç ï¼Œä»£ç å—æ›´å°ï¼Œæ›´å®¹æ˜“ç†è§£ï¼Œä»»ä½•äººéƒ½å¯ä»¥é˜…è¯»å’Œä½¿ç”¨ã€‚é‡‡ç”¨è¿™ä¸ªåŸåˆ™è¿˜æœ‰å¾ˆå¤šå…¶ä»–å¾ˆå¤§çš„å¥½å¤„ï¼Œè¿™é‡Œå°±ä¸æè¿°äº†ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªåŸåˆ™æ˜¯[åšå®åŸåˆ™](https://en.wikipedia.org/wiki/SOLID)çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå€¼å¾—å‡ ä¸ªåšå®¢å¸–å­æ¥æ­£ç¡®è§£é‡Šå®ƒã€‚

### å•æ—¥è´£ä»»åŸåˆ™ 4

åœ¨ç¬¬ 4 å¤©çš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåä¸º`getMd5`çš„å‡½æ•°ï¼Œå®ƒå°†ç§é’¥ä¼ é€’ç»™ MD5 ç®—æ³•**å’Œ**ï¼Œå¹¶å°†ç»“æœä»æ•°ç»„`unsigned char`è½¬æ¢ä¸º`std::string`ã€‚æˆ‘å¼ºè°ƒçš„â€œå’Œâ€æ˜¯å¯ç–‘çš„ï¼Œå› ä¸ºå®ƒè¡¨æ˜è¯¥å‡½æ•°åšäº†ä¸¤ä»¶äº‹ï¼Œè¿™è¿åäº†å•ä¸€è´£ä»»åŸåˆ™ã€‚ä¸ºäº†çº æ­£å®ƒï¼Œæˆ‘å¿…é¡»å°†`getMd5`å‡½æ•°åˆ†æˆä¸¤ä¸ªå‡½æ•°:

*   `getMd5`å®ƒåªè¿”å›ç”±ç§é’¥ç”Ÿæˆçš„ MD5 å“ˆå¸Œå¯¹åº”çš„å­—èŠ‚æ•°ç»„ã€‚
*   `bytesToString`å°†ä¸€ä¸ªæ•°ç»„`unsigned char`è½¬æ¢æˆä¸€ä¸ª`std::string`

æˆ‘åªèƒ½é¼“åŠ±ä½ å»çœ‹çœ‹æˆ‘çš„ [Github](https://github.com/Xav83/AdventOfCode/tree/2015.05/2015/Day4) ä¸Šé‚£äº›åŠŸèƒ½çš„å®ç°ï¼Œç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›å…¥ç¬¬ 5 å¤©ï¼ğŸ˜ˆ

## ç¬¬ä¸€éƒ¨åˆ†

### é—®é¢˜

è¿™ä¸ªé—®é¢˜çš„å®Œæ•´ç‰ˆå¯ä»¥ç›´æ¥åœ¨[é™ä¸´ä»£ç ç½‘ç«™](https://adventofcode.com/2015/day/5)ä¸Šæ‰¾åˆ°ï¼Œæˆ‘åœ¨è¿™é‡Œåªæè¿°é—®é¢˜çš„æœ¬è´¨:

åœ£è¯è€äººéœ€è¦å¸®åŠ©æ¥æ‰¾å‡ºä»–çš„æ–‡æœ¬æ–‡ä»¶ä¸­å“ªäº›å­—ç¬¦ä¸²æ˜¯é¡½çš®çš„ï¼Œå“ªäº›æ˜¯å–„è‰¯çš„ã€‚å¥½çš„å­—ç¬¦ä¸²å…·æœ‰ä»¥ä¸‹æ‰€æœ‰å±æ€§:

*   å®ƒè‡³å°‘åŒ…å«ä¸‰ä¸ªå…ƒéŸ³
*   å®ƒè‡³å°‘åŒ…å«ä¸€ä¸ªè¿ç»­å‡ºç°ä¸¤æ¬¡çš„å­—æ¯
*   å®ƒä¸åŒ…å«å­—ç¬¦ä¸²`ab`ã€`cd`ã€`pq`æˆ–`xy`

### è§£

å’Œç¬¬ 4 å¤©çš„è§‚ç‚¹ä¸€æ ·ï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[å•ä¸€è´£ä»»åŸåˆ™](https://en.wikipedia.org/wiki/Single_responsibility_principle)ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªé—®é¢˜éå¸¸é€‚åˆå¼•å…¥å®ƒï¼Œå› ä¸ºå¥½çš„å­—ç¬¦ä¸²å±æ€§åˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹ç›®ç¬¦å·éƒ½å¯ä»¥æ”¾åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œæ‰¿æ‹…ä¸€ä¸ªè´£ä»»ã€‚æ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæœ‰ä¸‰ä¸ªåŠŸèƒ½:

*   `bool hasThreeVowels(const std::string_view str)`
*   `bool hasLettersAppearingTwiceInRow(const std::string_view str)`
*   `bool hasForbiddenSubString (const std::string_view str)`

è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°æŒ–æ˜è¿™äº›åŠŸèƒ½ã€‚

é¦–å…ˆå¯¹äº`hasThreeVowels`å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨`std::count_if`ç®—æ³•å¾—åˆ°æ­£ç¡®çš„è¡Œä¸ºï¼Œæ¯”å¦‚:

```
 return 3 <= std::count_if(std::begin(str), std::end(str), 
    {
        return letter == 'a' || letter == 'e' || letter == 'i' || letter == 'o' ||letter == 'u';
    }); 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†éµå®ˆå•ä¸€è´£ä»»åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°`isVowel`,è€Œä¸æ˜¯åœ¨è¿™é‡Œä½¿ç”¨çš„ lambda ä¸­ç›´æ¥åŒ…å«æ¡ä»¶ã€‚

å¯¹äºç¬¬äºŒä¸ªå‡½æ•°`hasLettersAppearingTwiceInRow`ï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ª std ç®—æ³•è®©æˆ‘æœ‰ä¸€ä¸ªæ–¹ä¾¿çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œä½¿ç”¨äº†ä¸€ä¸ªåŸºäºèŒƒå›´çš„å¾ªç¯:

```
char previousCharacter = CHAR_MIN;
for(const auto& character : str)
{
    if(character == previousCharacter) { return true; }
    previousCharacter = character;
}
return false; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¹äºæœ€åä¸€ä¸ªå‡½æ•°`hasForbiddenSubString`ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`std::string_view::find`æ–¹æ³•:

```
 return str.find("ab") != std::string_view::npos ||
           str.find("cd") != std::string_view::npos ||
           str.find("pq") != std::string_view::npos ||
           str.find("xy") != std::string_view::npos; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æˆ‘ä»¬æœ‰äº†è¿™ä¸‰ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸¤ä»¶äº‹è¦åšã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥å®šä¹‰ä»€ä¹ˆæ˜¯å¥½çš„å­—ç¬¦ä¸²ï¼Œé€šè¿‡åœ¨ä¸€ä¸ªæ¡ä»¶ä¸­ç»„åˆå‰é¢çš„å‡½æ•°:

```
bool isNice(const std::string_view str)
{
    return hasThreeVowels(str) &&
           hasLettersAppearingTwiceInRow(str) &&
           ! hasForbiddenSubString(str);
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶å°†æ­¤å‡½æ•°åº”ç”¨äºæ¯è¡Œè¾“å…¥:

```
auto numberOfNiceString{0};
foreachLineIn(fileContent, [&numberOfNiceString](const std::string& str)
{
    if(isNice(str))
    {
        ++numberOfNiceString;
    }
});
std::cout << numberOfNiceString; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¼‚äº®çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒåœ¨å¯»æ‰¾åœ£è¯è€äººæ¼‚äº®çš„ç»³å­æ—¶åº”ç”¨äº†å•ä¸€è´£ä»»åŸåˆ™ã€‚ğŸ‘¼

## ç¬¬äºŒéƒ¨åˆ†

### é—®é¢˜

å®é™…ä¸Šï¼Œåœ£è¯è€äººçŠ¯äº†ä¸€äº›é”™è¯¯ï¼Œç”¨æ¥å¯»æ‰¾æ·˜æ°”å’Œå¯çˆ±çš„ç»³å­çš„æ ‡å‡†æ˜¯é”™è¯¯çš„ã€‚äº‹å®ä¸Šï¼Œä¸€ä¸ªå¥½çš„å­—ç¬¦ä¸²å…·æœ‰ä»¥ä¸‹å±æ€§:

*   å®ƒåŒ…å«åœ¨å­—ç¬¦ä¸²ä¸­è‡³å°‘å‡ºç°ä¸¤æ¬¡ä¸”æ²¡æœ‰é‡å çš„ä»»æ„ä¸¤ä¸ªå­—æ¯çš„å¯¹
*   å®ƒåŒ…å«è‡³å°‘ä¸€ä¸ªå­—æ¯ï¼Œä¸¤ä¸ªå­—æ¯ä¹‹é—´æ­£å¥½æœ‰ä¸€ä¸ªå­—æ¯é‡å¤

### è§£

è¯¥æ­»ï¼Œæ‰€ä»¥ä½ å‘Šè¯‰æˆ‘æˆ‘ä»¬å¿…é¡»å†åšä¸€æ¬¡ï¼Ÿï¼ğŸ˜®

å®é™…ä¸Šæ²¡æœ‰ã€‚å› ä¸ºæˆ‘ä»¬åº”ç”¨äº†å•ä¸€è´£ä»»åŸåˆ™ï¼Œæˆ‘ä»¬ç¨‹åºçš„é€»è¾‘ä¿æŒä¸å˜ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ä½¿ç”¨ä¸¤ä¸ªæ–°å‡½æ•°æ¥ä¿®æ”¹`isNice`æ–¹æ³•ï¼Œæ¯ä¸ªå‡½æ•°å¯¹åº”ä¸€ä¸ªå¥½å­—ç¬¦ä¸²çš„å±æ€§:

```
bool isNice(const std::string_view str)
{
    return hasTwiceAPairOfLetters(str) &&     
           hasOneLetterAppearingTwiceWithOnlyOneLetterBetween(str);
} 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯å®ç°è¿™äº›åŠŸèƒ½ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹`hasTwiceAPairOfLetters`å®ç°:

```
for(size_t i = 0; i < str.size() - 2; ++i)
{
    std::string_view str_toSearch(&str[i], 2); // The first 2 elements of the string
    std::string_view str_toSearchIn(&str[i + 2], str.size() - i - 2); // The rest of the string
    if(str_toSearchIn.find(str_toSearch) != std::string_view::npos)
    {
        return true;
    }
}
return false; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¹äºè¿™ä¸ªå®ç°æˆ‘æ²¡æœ‰å¤ªå¤šè¦è¯´çš„ï¼Œé™¤äº†`std::string_view`åšå¾—éå¸¸å¥½ğŸ˜ƒ

ç°åœ¨ï¼Œå‡½æ•°`hasOneLetterAppearingTwiceWithOnlyOneLetterBetween` :

```
for(size_t i = 0; i < str.size() - 2; ++i)
{
    if(str[i] == str[i + 2]) { return true; }
}
return false; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ€åï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªè®©åœ£è¯è€äººæ»¡æ„çš„æ¼‚äº®ç»³å­çš„å®šä¹‰ğŸ…

## ç»“è®º

å’Œå¾€å¸¸ä¸€æ ·ï¼Œä½ å¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™ç¯‡æ–‡ç« ä¸­å†™çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶æ²¡æœ‰åŒ…æ‹¬æ‰€æœ‰ä½¿ç¨‹åºè¿è¡Œçš„æºç ï¼Œè€Œåªæ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„æºç ä¸­æœ‰è¶£çš„éƒ¨åˆ†ã€‚å¦‚æœä½ æƒ³ä»å¤´åˆ°å°¾çœ‹è¿™äº›èŠ‚ç›®ï¼Œä½ å¯ä»¥ç™»å½•æˆ‘çš„ [GitHub è´¦æˆ·](https://github.com/Xav83/AdventOfCode/tree/2015.05/2015/Day5)ï¼Œæ¢ç´¢å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œæ·»åŠ è¯„è®ºæˆ–æé—®ã€‚

è¿™é‡Œæ˜¯æˆ‘ä»¬ä½¿ç”¨è¿‡çš„ std æ–¹æ³•å’Œå®¹å™¨çš„åˆ—è¡¨ï¼Œæˆ‘éå¸¸é¼“åŠ±ä½ å»çœ‹çœ‹å®ƒä»¬çš„å®šä¹‰:

*   [std::string_view](https://en.cppreference.com/w/cpp/string/basic_string_view)
*   [std::string_view::find](https://en.cppreference.com/w/cpp/string/basic_string_view/find)
*   [STD::string _ view::NPO](https://en.cppreference.com/w/cpp/string/basic_string_view/npos)
*   [std::count_if](https://en.cppreference.com/w/cpp/algorithm/count)

æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¸Œæœ›ä½ å–œæ¬¢ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œæˆ‘å–œæ¬¢è¿™æ ·åšğŸ˜ƒ

ç›´åˆ°ä¸‹ä¸€éƒ¨åˆ†ï¼Œäº«å—å­¦ä¹ å’Œæˆé•¿çš„ä¹è¶£ã€‚