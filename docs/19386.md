# ä½¿ç”¨ Gridsome å’Œ GraphQL æ„å»ºå’Œéƒ¨ç½² Vue.js é™æ€ç«™ç‚¹

> åŸæ–‡:[https://dev . to/hasurahq/build-and-deploy-vue-js-static-sites-using-grid some-and-graph QL-f7c](https://dev.to/hasurahq/build-and-deploy-vue-js-static-sites-using-gridsome-and-graphql-f7c)

**TLï¼›DR:** ä»æ‚¨ç°æœ‰çš„ postgres æ•°æ®åº“ä¸­ä¸ºæ‚¨çš„ Gridsome é™æ€ç«™ç‚¹è·å–æºæ•°æ®ã€‚å³æ—¶è®¾ç½®ã€‚æ•™ç¨‹/æ ·æ¿æ–‡ä»¶ğŸ‘‰[grid some-postgres-graph QL](https://github.com/hasura/graphql-engine/tree/master/community/sample-apps/gridsome-postgres-graphql)

<figure>[![](../Images/bae67f9aa850b4ad63f2afa69ce69ed0.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--7BP1Yp3n--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.hasura.io/content/images/2019/06/Gridsome_blog_1.png)

<figcaption>grid some<-graph QL<-Hasura<-Postgres</figcaption>

</figure>

[Gridsome](https://github.com/gridsome/gridsome) å€ŸåŠ© Vue.js çš„åŠ›é‡ï¼Œè½»æ¾æ„å»ºç°ä»£ JAMStack ç½‘ç«™å’Œ pwaï¼Œé€Ÿåº¦å¿«ï¼Œæ¥å— GraphQL ç­‰è‡ªå®šä¹‰æ•°æ®æºã€‚å¦‚æœæ‚¨ç†Ÿæ‚‰ Reactï¼Œé‚£ä¹ˆæ„å»ºé™æ€ç«™ç‚¹çš„ç­‰æ•ˆæ¡†æ¶åº”è¯¥æ˜¯ Gatsbyã€‚

### [](#deploy-hasura)éƒ¨ç½² Hasura

[Hasura](https://hasura.io/) æ˜¯ä¸€ä¸ª[å¼€æº](https://github.com/hasura/graphql-engine)å¼•æ“ï¼Œä¸ºæ‚¨æä¾›æ–°çš„æˆ–ç°æœ‰ Postgres æ•°æ®åº“ä¸Šçš„å®æ—¶ graph QL APIï¼Œå†…ç½®æ”¯æŒæ‹¼æ¥å®šåˆ¶ graph QL API å’Œåœ¨æ•°æ®åº“æ›´æ”¹æ—¶è§¦å‘ webhooksã€‚

æŒ‰ç…§[è‡ªè¿°æ–‡ä»¶](https://github.com/hasura/graphql-engine/blob/master/community/sample-apps/gridsome-postgres-graphql/README.md)ä¸­çš„è¯´æ˜éƒ¨ç½² Hasuraï¼Œå¹¶åˆ›å»º app æ‰€éœ€çš„è¡¨æ ¼**ä½œè€…**å’Œ**æ–‡ç« **ã€‚æ³¨æ„ GraphQL ç«¯ç‚¹çš„ Heroku URLã€‚æ‚¨å°†åœ¨åº”ç”¨ç¨‹åºä¸­å¯¹æ­¤è¿›è¡Œé…ç½®ã€‚

### [](#clone-and-run-app)å…‹éš†å¹¶è¿è¡Œ app

[æ¼”ç¤ºåº”ç”¨](https://github.com/hasura/graphql-engine/tree/master/community/sample-apps/gridsome-postgres-graphql)å¸¦ä½ æ„å»ºä¸€ä¸ªç®€å•çš„åšå®¢åº”ç”¨ï¼Œåœ¨ä¸»é¡µåˆ—å‡ºæ‰€æœ‰ä½œè€…ï¼Œåœ¨æ–‡ç« é¡µé¢åˆ—å‡ºæ‰€æœ‰æ–‡ç« ã€‚æ‚¨å¯ä»¥å…‹éš†å¹¶è¿è¡Œè¯¥åº”ç”¨ç¨‹åºè¿›è¡Œæ¼”ç¤ºã€‚

```
$ git clone git@github.com:hasura/graphql-engine.git
$ cd graphql-engine/community/sample-apps/gridsome-postgres-graphql
$ yarn install 
```

**æ³¨æ„:**è¿™ä¸ªåº”ç”¨ç¨‹åºæ˜¯ä½¿ç”¨ gridsome-cli åˆ›å»ºçš„ï¼Œå®ƒç”Ÿæˆä¸€ä¸ªæ ·æ¿ hello world åº”ç”¨ç¨‹åºã€‚

å®‰è£…ä¹‹åï¼Œæ‚¨å¿…é¡»é…ç½®ä¸Šé¢ä» Heroku è·å¾—çš„ GraphQL ç«¯ç‚¹ã€‚

æ‰“å¼€`gridsome.config.js`ï¼Œé…ç½®`url`æŒ‡å‘ heroku app graphql ç«¯ç‚¹ã€‚å­—æ®µåè¢«é…ç½®ä¸ºæ ¹çº§åˆ«çš„`hasura`ï¼Œä»¥é¿å…ä¸å…¶ä»–æ•°æ®æºå†²çªã€‚

```
module.exports = {
  siteName: 'Gridsome',
  plugins: [{
      use: '@gridsome/source-graphql',
      options: {
        url: 'http://localhost:8080/v1/graphql',
        fieldName: 'hasura',
        headers: {
          // Authorization: `Bearer ${process.env.AUTH_TOKEN}`,
        },
      },
    }]
} 
```

ç°åœ¨è¿è¡Œ app:

```
yarn start 
```

æ‚¨åº”è¯¥ä¼šçœ‹åˆ° Gridsome åº”ç”¨ç¨‹åºä¸»é¡µå¦‚ä¸‹æ‰€ç¤º:

<figure>[![](../Images/a155a447602a0c8dcf816df94d3649b5.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--VbW-lsr---/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://blog.hasura.io/content/images/2019/06/gridsome-homepage.png)

<figcaption>grid some sample app with graph QL</figcaption>

</figure>

å¦‚æœæ‚¨å·²ç»å‘ readme ä¸­æåˆ°çš„ä½œè€…å’Œæ–‡ç« æ·»åŠ äº†ç¤ºä¾‹æ•°æ®ï¼Œæ‚¨å¯ä»¥å¯¼èˆªåˆ° **/articles** å¹¶åœ¨ UI ä¸ŠæŸ¥çœ‹æ•°æ®æ¨¡æ¿ã€‚

## [](#graphql-data-fetching)å›¾ QL æ•°æ®æå–

æ—¢ç„¶æ‚¨å·²ç»æŸ¥çœ‹äº†æ¼”ç¤ºåº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¹•åå‘ç”Ÿäº†ä»€ä¹ˆã€‚å¯¹äºè¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬éœ€è¦ä» Postgres è·å–æ•°æ®ï¼Œå¹¶åœ¨ Vue ç»„ä»¶ä¸Šå°†å…¶æ¨¡æ¿åŒ–ã€‚è¦æå–çš„æ•°æ®å¾ˆç®€å•ï¼›æ–‡ç« å’Œä½œè€…åˆ—è¡¨ã€‚

è·å–æ‰€æœ‰ä½œè€…çš„ GraphQL æŸ¥è¯¢ç±»ä¼¼äº

```
query {
  hasura {
    author {
      id
      name
    }
  }
} 
```

è·å–æ‰€æœ‰æ–‡ç« ä»¥åŠä¸æ–‡ç« ç›¸å…³çš„ä½œè€…çš„æŸ¥è¯¢å¦‚ä¸‹æ‰€ç¤º:

```
query {
  hasura {
    article {
      id
      title
      author {
        name
      }
    }
  }
} 
```

ä¸Šé¢çš„æŸ¥è¯¢åˆ©ç”¨å…³ç³»æ¥è·å–æ–‡ç« çš„ç›¸å…³æ•°æ®(åœ¨æœ¬ä¾‹ä¸­æ˜¯ä½œè€…)ã€‚

åŸºäº`pages`ç›®å½•ä¸­çš„æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆè·¯çº¿ã€‚

## [](#production-build)ç”Ÿäº§æ„å»º

é™æ€ç«™ç‚¹å¯ä»¥ä½¿ç”¨ gridsome build ç”Ÿæˆï¼Œå®ƒç”Ÿæˆ html å’Œ javascript åŒ…ã€‚

è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»ºèµ„äº§:

```
yarn build 
```

è¿™å°†åœ¨`dist`ç›®å½•ä¸‹ä¸º app çš„æ‰€æœ‰é™æ€é¡µé¢ç”Ÿæˆ htmlã€js å’Œ css åŒ…ã€‚

ç°åœ¨ï¼Œä½¿ç”¨å‘½ä»¤
ä¸ºç”Ÿäº§åº”ç”¨ç¨‹åºæä¾›æœåŠ¡

```
gridsome serve 
```

è¿™å°†æœåŠ¡äºç«¯å£ 8080 çš„ç”Ÿäº§æ„å»ºã€‚

## [](#deployment)éƒ¨ç½²

é™æ€ app å¯ä»¥å…è´¹éƒ¨ç½²åˆ° **Netlify** ä¸Šã€‚ç‚¹å‡»`New site from git`å¹¶ä¸ºæ­¤åº”ç”¨ç¨‹åºé€‰æ‹©ä»¥ä¸‹è®¾ç½®ã€‚

*   **æ„å»ºå‘½ä»¤:** `gridsome build`
*   **å‘å¸ƒç›®å½•:** `dist`

## [](#final-thoughts)æœ€åçš„æƒ³æ³•

å¦‚æœæ‚¨å¯¹ Vue æ„Ÿå…´è¶£ï¼Œå¹¶ä¸”å¸Œæœ›æ„å»ºé™æ€ç«™ç‚¹ï¼ŒGridsome æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚é€šè¿‡è‡ªå®šä¹‰æ•°æ®æºæ”¯æŒå’Œä¸ä¸åŒ GraphQL æºçš„æ¨¡å¼æ‹¼æ¥ï¼Œå®ƒæä¾›äº†ä¸€ç§å¼ºå¤§è€Œçµæ´»çš„æ–¹å¼æ¥æ„å»ºç°ä»£é™æ€ç«™ç‚¹ã€‚

æˆ‘å·²ç»æŠŠæ ·æ¿å’Œæ•™ç¨‹æ”¾åœ¨ä¸€èµ·ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å¿«é€Ÿå¼€å§‹äº†ï¼

åœ¨ [github](https://github.com/hasura/graphql-engine/tree/master/community/sample-apps/gridsome-postgres-graphql) ä¸ŠæŸ¥çœ‹ã€‚

é˜…è¯»æ›´å¤šå…³äº [JAMStack](https://jamstack.org) çš„å†…å®¹ï¼Œäº†è§£ CDN å‰é™æ€ç«™ç‚¹çš„ä¼˜åŠ¿ã€‚

è¯•ç©ä¸€ä¸‹ï¼Œè®©æˆ‘ä»¬çŸ¥é“ä½ çš„æƒ³æ³•ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–é‡åˆ°ä»»ä½•éº»çƒ¦ï¼Œè¯·éšæ—¶é€šè¿‡ [twitter](https://twitter.com/hasurahq) ã€ [github](https://github.com/hasura/graphql-engine) æˆ–æˆ‘ä»¬çš„ [discord æœåŠ¡å™¨](https://discord.gg/vBPpJkS)è”ç³»æˆ‘ä»¬ã€‚