# ğŸ¤–æ‹¿ä¸Šä½ çš„é…’ã€‚æ˜¯æ—¶å€™æ­å¼€ ML å’Œ NLP çš„ç¥ç§˜é¢çº±äº†ğŸ·

> åŸæ–‡:[https://dev . to/azure/grab-your-wine-it-time-to-demystify-ml-and-NLP-47f 7](https://dev.to/azure/grab-your-wine-it-s-time-to-demystify-ml-and-nlp-47f7)

[![graph](../Images/1d5f67641bb8276cd10b09b3135591f1.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--9GZ-EKO_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/wordcloud.PNG)

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ ML ä»æ–‡æœ¬æè¿°ä¸­é¢„æµ‹è‘¡è„é…’çš„ä»·æ ¼ã€ç‚¹æ•°å’Œå“ç§ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨åº“ [SciKit Learn](https://scikit-learn.org/stable/) å¤„ç†è‘¡è„é…’æè¿°æ–‡æœ¬ï¼Œä»¥åˆ›å»ºä¸€ä¸ªè¯è¢‹é€»è¾‘å›å½’å¤šåˆ†ç±»æ¨¡å‹ã€‚å¦‚æœè¿™æ²¡æœ‰æ„ä¹‰ï¼Œé‚£ä¹ˆä½ æ¥å¯¹åœ°æ–¹äº†ï¼å¦‚æœæœ‰æ„ä¹‰ï¼Œç»§ç»­è¯»ä¸‹å»ï¼Œå› ä¸ºé…’ã€‚

## [](#configure-your-ml-dev-environment)é…ç½®æ‚¨çš„ ML å¼€å‘ç¯å¢ƒ

### [](#there-are-two-options-cloud-or-local)æœ‰ä¸¤ç§é€‰æ‹©:äº‘ç«¯æˆ–è€…æœ¬åœ°ã€‚

Azure äº‘è®¾ç½®-ä½¿ç”¨ Azure æœºå™¨å­¦ä¹ å·¥ä½œåŒºå’Œé›†æˆçš„äº‘ç¬”è®°æœ¬è™šæ‹Ÿæœºã€‚Workspace ä¸ºæ‚¨æä¾›äº†è®¸å¤šåŠŸèƒ½ï¼Œæˆ‘å¼ºçƒˆæ¨èæ‚¨ä½¿ç”¨å®ƒã€‚

1.  å¦‚æœä½ è¿˜æ²¡æœ‰çš„è¯ï¼Œåˆ›å»ºä¸€ä¸ªå…è´¹çš„ Azure è´¦æˆ·ã€‚
2.  éµå¾ª[åˆ›å»ºå·¥ä½œç©ºé—´](https://docs.microsoft.com/en-us/azure/machine-learning/service/quickstart-run-cloud-notebook?WT.mc_id=ca-0000-cassieb)æ•™ç¨‹ä¸­çš„â€œåˆ›å»ºç¬”è®°æœ¬è™šæ‹Ÿæœºâ€æ­¥éª¤
3.  ä»ç¬”è®°æœ¬ç”µè„‘è™šæ‹Ÿæœºå¯¼èˆªä¸­å•å‡»â€œJupyter Labâ€
4.  ç„¶ååœ¨ç»ˆç«¯ä¸­è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä» GitHub å…‹éš†ç¬”è®°æœ¬ã€‚

[![](../Images/bf9d1abed8411bb3a5c46b3db75ddbbb.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--KLHpuub8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/launchnotebook.png)T3ã€‘

```
#CTRL+SHIFT+V to paste
curl https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/winereview-nlp.ipynb --output winereview-nlp.ipynb 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æœ¬åœ°è®¾ç½®

*   [ä¸‹è½½ Jupyter](https://jupyter.org/) ç¬”è®°æœ¬
*   [ä¸‹è½½èŸ’è›‡](https://www.anaconda.com/distribution/)
*   è¿è¡Œæœ¨æ˜Ÿç¬”è®°æœ¬

ä¸€æ—¦æ‚¨è®¾ç½®äº†ä¸Šè¿°ç¯å¢ƒé…ç½®ä¹‹ä¸€ï¼Œå°±è¯¥å¼€å§‹æ„å»ºäº†ï¼

## [](#import-packages-and-data)å¯¼å…¥åŒ…å’Œæ•°æ®

å¦‚æœä½ å¾—åˆ°ä¸€ä¸ªé”™è¯¯â€œæ²¡æœ‰å‘½åçš„æ¨¡å—â€ï¼Œç”¨å‘½ä»¤`!pip install wordcloud`å®‰è£…å®ƒã€‚ç”¨é”™è¯¯æ¶ˆæ¯ä¸­çš„æ¨¡å—åç§°æ›¿æ¢`wordcloud`ã€‚

```
#This package need to be installed first !pip install wordcloud 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import math
from sklearn.model_selection import train_test_split
from sklearn.metrics import precision_recall_curve
from sklearn.linear_model import LogisticRegression
from sklearn.feature_extraction.text import CountVectorizer
from joblib import dump, load 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬éœ€è¦æ•°æ®ï¼æˆ‘ç”¨äº†åœ¨ Kaggle ä¸Šæ‰¾åˆ°çš„æ•°æ®é›†ã€‚Kaggle æ˜¯ä¸€ä¸ªç”±æ•°æ®ç§‘å­¦å®¶ç»„æˆçš„åœ¨çº¿ç¤¾åŒºã€‚ä» github repo æˆ– kaggle ä¸‹è½½æ•°æ®é›†ã€‚

*   [æ¥è‡ªå›è´­çš„è‘¡è„é…’æ•°æ®é›†](https://github.com/cassieview/intro-nlp-wine-reviews/blob/master/dataset)
*   [Kaggle æ•°æ®é›†](https://www.kaggle.com/zynicide/wine-reviews) ![data](../Images/b4beae727eb5dc7abb6ac05d5b790029.png)

å°†æ•°æ®å¯¼å…¥ä¸º[ç†ŠçŒ«](https://pandas.pydata.org/pandas-docs/stable/)æ•°æ®å¸§

```
#File path to the csv file csv_file = "https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/dataset/winemag-review.csv"

# Read csv file into dataframe df = pd.read_csv(csv_file)

# Print first 5 rows in the dataframe df.head() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![graph](../Images/fa1ae9939df54af379cecbafc7973210.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--83jq6kPH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/dfhead.PNG)

## [](#visualize-the-data)å°†æ•°æ®å¯è§†åŒ–

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æ•°æ®ï¼Œå°±è¯¥åˆ†æå®ƒï¼Œå¹¶åšä¸€äº›[åŠŸèƒ½é€‰æ‹©å’Œå·¥ç¨‹](https://docs.microsoft.com/en-us/azure/machine-learning/team-data-science-process/create-features?WT.mc_id=ca-0000-cassieb)ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ [Seaborn](https://seaborn.pydata.org/) æ¥å¯è§†åŒ–æˆ‘ä»¬çš„æ•°æ®ã€‚è¿™å°†è®©æˆ‘ä»¬çœ‹åˆ°ä¸åŒæ•°æ®ç‚¹ä¹‹é—´æ˜¯å¦æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§ï¼Œå¹¶å¸®åŠ©æˆ‘ä»¬å›ç­”æœ‰å…³æˆ‘ä»¬æ•°æ®çš„é—®é¢˜ã€‚ç”±äºæˆ‘ä»¬æœ€åˆçš„é—®é¢˜æ˜¯æ ¹æ®`description`é¢„æµ‹`price`ã€`points`æˆ–`variety`ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“æˆ‘ä»¬çš„ç‰¹å¾å°†æ˜¯`description`ï¼Œæˆ‘ä»¬çš„æ ‡ç­¾å°†æ˜¯`price`ã€`points`æˆ–`variety`ã€‚ç‰¹å¾æ˜¯æˆ‘ä»¬ç”¨æ¥è¿›è¡Œé¢„æµ‹çš„æ•°æ®ï¼Œæ ‡æ³¨æ˜¯æˆ‘ä»¬æ­£åœ¨é¢„æµ‹çš„å†…å®¹ã€‚æ¯ä¸ªæ ‡ç­¾å°†æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ¨¡å‹ï¼Œæ‰€ä»¥å¦‚æœæ‚¨é€‰æ‹©å»ºç«‹æ‰€æœ‰ä¸‰ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œå°†æœ‰ä¸‰ä¸ªæ¨¡å‹ã€‚

ä¸ºäº†å¥½ç©ï¼Œæˆ‘ä»¬æ¥é—®ä¸€äº›å…³äºæ•°æ®çš„é—®é¢˜ï¼Œå¹¶é€šè¿‡ç”¨ Seaborn å°†å…¶å›¾å½¢åŒ–æ¥å›ç­”ã€‚

ä»·æ ¼å’Œç§¯åˆ†æœ‰å…³è”å—ï¼Ÿ

```
sns.barplot(x = 'points', y = 'price', data = df) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/b34e694126a3bfbfa7bb99271f23c261.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--dPljfICX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/priceandpoints.PNG)T3ã€‘

```
sns.boxplot(x = 'points', y = 'price', data = df) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/176db78a26aafacd7d9ca8e4843f6ecd.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--PY6RGhcU--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/priceandpoints2.PNG)

ä¸€ä¸ªé…’è¯„å®¶çš„è¯„åˆ†ä¼šæ¯”å…¶ä»–äººé«˜å—ï¼Ÿ

```
sns.catplot(x = 'points', y = 'taster_name', data = df) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/1cef2a7a67ebd47070402fa477a19b4b.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0tPUV-Hz--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/tasterpoints.PNG)

è®©æˆ‘ä»¬æ¥çœ‹çœ‹`description`æ–‡æœ¬
çš„æ–‡å­—äº‘

```
from wordcloud import WordCloud, STOPWORDS
import matplotlib.pyplot as plt
text = df.description.values
wordcloud = WordCloud(
    width = 3000,
    height = 2000,
    background_color = 'black',
    stopwords = STOPWORDS).generate(str(text))
fig = plt.figure(
    figsize = (40, 30),
    facecolor = 'k',
    edgecolor = 'k')
plt.imshow(wordcloud, interpolation = 'bilinear')
plt.axis('off')
plt.tight_layout(pad=0)
plt.show() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![graph](../Images/1d5f67641bb8276cd10b09b3135591f1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--9GZ-EKO_--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/wordcloud.PNG) 
<small>æˆ‘å–œæ¬¢æŠŠè¿™ä¸ªè¯äº‘æƒ³è±¡æˆå“å°è‘¡è„é…’æ—¶ä½¿ç”¨çš„æè¿°æ€§è¯æ±‡çš„å¤‡å¿˜å•ï¼Œè®©è‡ªå·±å¬èµ·æ¥åƒä¸ªè‘¡è„é…’ä¸“å®¶ğŸ˜ƒ</small>

é€šè¿‡ç»˜åˆ¶è¿™äº›æ•°æ®ï¼Œä½ è¿˜èƒ½æå‡ºå’Œå›ç­”å“ªäº›é—®é¢˜ï¼Ÿ
[![graph](../Images/fa1ae9939df54af379cecbafc7973210.png)T3ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--83jq6kPH--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/dfhead.PNG)

## [](#create-calculated-columns-for-labels)ä¸ºæ ‡ç­¾åˆ›å»ºè®¡ç®—åˆ—

è¿™å°†æ˜¯è‘¡è„é…’è¯„è®ºå®¶å¯¹è‘¡è„é…’çš„ä»·æ ¼ç‚¹æˆ–è‘¡è„å“ç§çš„å¤šåˆ†ç±»ã€‚ç°åœ¨æˆ‘ä»¬çš„ç‚¹æ•°å’Œä»·æ ¼æ˜¯æ•°å­—ç‰¹å¾ã€‚è¿™éœ€è¦æ›´æ–°ä¸ºæ–‡æœ¬è¦ç´ ç±»åˆ«ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªå‡½æ•°æ¥æ ¹æ® points å’Œ price åˆ—ä¸­çš„å€¼ç”Ÿæˆè®¡ç®—åˆ—ï¼Œä»¥ç”¨ä½œæˆ‘ä»¬çš„æ ‡ç­¾ã€‚

åˆ›å»º`quality`åˆ—ï¼Œå°†åˆ†å€¼åˆ†ä¸ºå·®ã€å¥½ã€å¥½å’Œä¼˜ç§€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºç‚¹å€¼è¿”å›å­—ç¬¦ä¸²`quality`çš„å‡½æ•°ã€‚

```
def getQuality(points):
    if(points <= 85):
        return 'bad'
    elif(points<=90 ):
        return 'ok'
    elif(points<=95):
        return 'good'
    elif(points<=100):
        return 'great'
    else:
        return 'If this gets hit, we did something wrong!' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥å°†è¯¥å‡½æ•°åº”ç”¨äºæ•°æ®å¸§çš„ points åˆ—ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåä¸º`quality`çš„æ–°åˆ—ã€‚

```
df['quality'] = df['points'].apply(getQuality) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åƒæˆ‘ä»¬ä¸Šé¢æ‰€åšçš„é‚£æ ·ï¼Œæ ¹æ® price åˆ—å¯è§†åŒ–æ–°åˆ—ã€‚

```
sns.catplot(x = 'quality', y = 'price', data = df) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/990d1bb24f941959384cecab87e6f3b9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--UJBzciBr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/pricequality.PNG)T3ã€‘

```
sns.barplot(x = 'quality', y = 'price', data = df) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/f41001009979c04b98381ab5dab88d64.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--QVwqUmb8--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/pricequality2.PNG)

å¯¹äºæœ‰ NaN çš„åˆ—ï¼Œä»`1-30`ã€`31-50`ã€`51-100`ã€`Above 100`ã€`0`çš„ä»·æ ¼åˆ—åˆ›å»ºä»·æ ¼èŒƒå›´åˆ—ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåŸºäºä»·æ ¼å€¼è¿”å›å­—ç¬¦ä¸² priceRange çš„å‡½æ•°ã€‚

```
def getPriceRange(price):
    if(price <= 30):
        return '1-30'
    elif(price<=50):
        return '31-50'
    elif(price<=100): 
        return '51-100'
    elif(math.isnan(price)):
        return '0'
    else:
        return 'Above 100' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å°†è¯¥å‡½æ•°åº”ç”¨äºæ•°æ®å¸§çš„ç‚¹åˆ—ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªåä¸º`priceRange`çš„æ–°åˆ—ã€‚

```
df['priceRange'] = df['price'].apply(getPriceRange) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‰“å°æ¯ä¸ªæŒ‡å®šä»·æ ¼èŒƒå›´çš„æ€»æ•°ï¼ŒæŸ¥çœ‹æ ‡ç­¾æ˜¯å¦‚ä½•åˆ†å¸ƒçš„

```
df.groupby(df['priceRange']).size()
Output: priceRange
        0             8996
        1-30         73455
        31-50        27746
        51-100       16408
        Above 100     3366
        dtype: int64 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬ç°åœ¨æœ‰äº†é¢„æµ‹è´¨é‡ã€ä»·æ ¼èŒƒå›´å’Œè‘¡è„å“ç§çš„æ¨¡å‹æ ‡ç­¾ã€‚

## [](#process-description-text-with-the-library-scikit-learn-to-create-a-bagofwords-using-the-countvectorizer-functionality)ä½¿ç”¨åº“ SciKit å¤„ç†æè¿°æ–‡æœ¬å­¦ä¹ ä½¿ç”¨[è®¡æ•°çŸ¢é‡å™¨](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html)åŠŸèƒ½åˆ›å»ºå•è¯åŒ…ã€‚

æ–‡æ¡£å¾ˆå¥½åœ°è§£é‡Šäº† CountVectorizerã€‚æˆ‘å»ºè®®é€šè¯»å®ƒä»¬ï¼Œä»¥å…¨é¢äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œä½†æ˜¯æˆ‘å°†åœ¨è¿™é‡Œå›é¡¾ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚

åœ¨é«˜å±‚æ¬¡ä¸Šï¼ŒCountVectorizer è·å–æè¿°çš„æ–‡æœ¬ï¼Œåˆ é™¤åœç”¨è¯(å¦‚â€œtheâ€ã€â€œaâ€ã€â€œanâ€ã€â€œinâ€)ï¼Œåˆ›å»ºå•è¯çš„æ ‡è®°åŒ–ï¼Œç„¶ååˆ›å»ºè¡¨ç¤ºæè¿°çš„æ•°å­—å‘é‡ã€‚æ–‡æœ¬æè¿°ç°åœ¨ç”¨æ•°å­—è¡¨ç¤ºï¼Œåªæœ‰æˆ‘ä»¬å…³å¿ƒçš„å•è¯ï¼Œå¯ä»¥ç”±è®¡ç®—æœºå¤„ç†æ¥è®­ç»ƒæ¨¡å‹ã€‚è®°ä½è®¡ç®—æœºç†è§£æ•°å­—ï¼Œå•è¯å¯ä»¥ç”¨æ•°å­—æ¥è¡¨ç¤ºï¼Œè¿™æ ·è®¡ç®—æœºå°±èƒ½â€œç†è§£â€äº†ã€‚

è¿™æ˜¯å•è¯å˜æˆæ•°å­—çš„ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬å°†é€šè¿‡æ•°æ®é›†ä¸­çš„ä¸€ä¸ªä¾‹å­æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸€ç‚¹ã€‚

[![graph](../Images/daacba18b2c7f840acce602546753e70.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--qveZ_g7d--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/vectorchart.PNG)

åœ¨æˆ‘ä»¬è¿›å…¥ CountVectorizer ä»£ç å’ŒåŠŸèƒ½ä¹‹å‰ã€‚æˆ‘æƒ³åˆ—å‡ºä¸€äº›æœ¯è¯­ï¼Œå¹¶æŒ‡å‡º CountVectorizer *å¹¶ä¸*ä¸ºæ‚¨åšå¼•ç†åŒ–æˆ–è¯å¹²åŒ–ã€‚

*   åœç”¨è¯:åœç”¨è¯å¯ä»¥æ˜¯åœ¨ç‰¹å®šè¯­è¨€ä¸­æœ‰æ„ä¹‰çš„è¯ã€‚ä¾‹å¦‚ï¼Œåœ¨è‹±è¯­ä¸­ï¼Œè¯¸å¦‚â€œaâ€ã€â€œandâ€ã€â€œisâ€å’Œâ€œtheâ€ä¹‹ç±»çš„è¯è¢«æ’é™¤åœ¨å…¨æ–‡ç´¢å¼•ä¹‹å¤–ï¼Œå› ä¸ºå·²çŸ¥å®ƒä»¬å¯¹æœç´¢æ²¡æœ‰ç”¨å¤„ã€‚åœç”¨è¯ä¹Ÿå¯ä»¥æ˜¯æ²¡æœ‰è¯­è¨€æ„ä¹‰çš„æ ‡è®°ã€‚
*   [N-Gram](https://docs.microsoft.com/en-us/dotnet/machine-learning/resources/glossary#n-gram?WT.mc_id=ca-0000-cassieb) :æ–‡æœ¬æ•°æ®çš„ç‰¹å¾æå–æ–¹æ¡ˆ:ä»»æ„ N ä¸ªå•è¯çš„åºåˆ—å˜æˆä¸€ä¸ªç‰¹å¾å€¼ã€‚
    T3![](../Images/8a4f8a3e41852ad743f29f44309f360d.png)T5ã€‘

*   [è¯æ±‡åŒ–](https://docs.microsoft.com/en-us/azure/machine-learning/studio-module-reference/preprocess-text#module-overview?WT.mc_id=ca-0000-cassieb):å°†å¤šä¸ªç›¸å…³å•è¯è½¬æ¢æˆä¸€ä¸ªè§„èŒƒå½¢å¼(â€œfruityâ€ã€â€œfruitinessâ€å’Œâ€œfruitsâ€éƒ½å°†å˜æˆâ€œfruitâ€)

*   è¯å¹²åŒ–:ç±»ä¼¼äºè¯æ±‡åŒ–ï¼Œä½†æ›´å…·ä¾µç•¥æ€§ï¼Œä¼šä½¿å•è¯å˜å¾—æ”¯ç¦»ç ´ç¢ã€‚

### [](#lets-take-a-look-at-how-to-use-the-countvectorizer)æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ CountVectorizerã€‚

è¿™äº›éƒ½æ˜¯å¯ä»¥åœ¨ CountVectorizer ä¸­è®¾ç½®çš„å±æ€§ã€‚å®ƒä»¬ä¸­çš„è®¸å¤šéƒ½æ˜¯é»˜è®¤çš„ï¼Œæˆ–è€…å¦‚æœè®¾ç½®çš„è¯ä¼šè¦†ç›– CountVectorizer çš„å…¶ä»–éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†ä¿ç•™å¤§éƒ¨åˆ†é»˜è®¤è®¾ç½®ï¼Œç„¶åå°è¯•æ›´æ”¹å…¶ä¸­ä¸€äº›è®¾ç½®ï¼Œä»¥è·å¾—æ›´å¥½çš„æ¨¡å‹ç»“æœã€‚

```
CountVectorizer( 
  input='content', encoding='utf-8', decode_error='strict', 
  strip_accents=None, lowercase=True, preprocessor=None, tokenizer=None, 
  stop_words=None, token_pattern='(?u)\b\w\w+\b', ngram_range=(1, 1), 
  analyzer='word', max_df=1.0, min_df=1, max_features=None, 
  vocabulary=None, binary=False, dtype=<class 'numpy.int64'>
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åˆ›å»ºä»`description`ç‰¹å¾ä¸­è·å–çŸ¢é‡å’Œå‘é‡çš„å‡½æ•°ã€‚

æœ‰ä¸åŒçš„ CountVectorizer é…ç½®è¢«æ³¨é‡Šæ‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸åŒçš„é…ç½®ï¼Œçœ‹çœ‹å®ƒå¦‚ä½•æ”¹å˜æˆ‘ä»¬çš„ç»“æœã€‚æ­¤å¤–ï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸ªæè¿°ï¼Œå¹¶æ‰¾å‡º CountVectorizer ä¸­å®é™…å‘ç”Ÿçš„æƒ…å†µã€‚

```
def get_vector_feature_matrix(description):
    vectorizer = CountVectorizer(lowercase=True, stop_words="english", max_features=5)
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english")
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english",ngram_range=(1, 2), max_features=20) 
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english", tokenizer=stemming_tokenizer) 
    vector = vectorizer.fit_transform(np.array(description))
    return vector, vectorizer 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¹äºç¬¬ä¸€æ¬¡è¿è¡Œï¼Œæˆ‘ä»¬å°†æœ‰ä¸‹é¢çš„é…ç½®ã€‚è¿™å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ–‡æœ¬è½¬æ¢ä¸ºå°å†™ï¼Œåˆ é™¤è‹±è¯­åœç”¨è¯ï¼Œæˆ‘ä»¬åªéœ€è¦ 5 ä¸ªå•è¯ä½œä¸ºç‰¹å¾æ ‡è®°ã€‚

```
vectorizer = CountVectorizer(lowercase=True, stop_words="english", max_features=5) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
#Optional: remove any rows with NaN values. 
#df = df.dropna() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°ï¼Œå¹¶ä»æ•°æ®å¸§ä¼ å…¥æè¿°åˆ—ã€‚

è¿™å°†è¿”å›`vector`å’Œ`vectorizer`ã€‚`vectorizer`æ˜¯æˆ‘ä»¬åº”ç”¨äºæˆ‘ä»¬çš„æ–‡æœ¬ä»¥åˆ›å»ºæˆ‘ä»¬æ–‡æœ¬çš„æ•°å­—`vector`è¡¨ç¤ºï¼Œä»¥ä¾¿æœºå™¨å­¦ä¹ æ¨¡å‹å¯ä»¥å­¦ä¹ ã€‚

```
vector, vectorizer = get_vector_feature_matrix(df['description']) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæˆ‘ä»¬æ‰“å°çŸ¢é‡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„å½“å‰é»˜è®¤å‚æ•°ã€‚

```
print(vectorizer)
Output: CountVectorizer(analyzer='word', binary=False, decode_error='strict',
        dtype=<class 'numpy.int64'>, encoding='utf-8', input='content',
        lowercase=True, max_df=1.0, max_features=5, min_df=1,
        ngram_range=(1, 1), preprocessor=None, stop_words='english',
        strip_accents=None, token_pattern='(?u)\\b\\w\\w+\\b',
        tokenizer=None, vocabulary=None) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ£€æŸ¥æˆ‘ä»¬çš„å˜é‡å’Œæ•°æ®ï¼Œäº†è§£è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚

```
print(vectorizer.get_feature_names())
Output: ['aromas', 'flavors', 'fruit', 'palate', 'wine'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œæˆ‘ä»¬å¾—åˆ°äº†çŸ¢é‡å™¨çš„ç‰¹æ€§ã€‚å› ä¸ºæˆ‘ä»¬å‘Šè¯‰ CountVectorizer æœ‰ä¸€ä¸ª`max_feature = 5`,å®ƒå°†æ„å»ºä¸€ä¸ªè¯æ±‡è¡¨ï¼Œè¯¥è¯æ±‡è¡¨åªè€ƒè™‘åœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­æŒ‰è¯é¢‘æ’åºçš„é¡¶çº§ç‰¹å¾è¯ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬çš„`description`å‘é‡å°†*åªæœ‰*åŒ…å«è¿™äº›å•è¯ï¼Œå½“å®ƒä»¬è¢«æ ‡è®°æ—¶ï¼Œæ‰€æœ‰å…¶ä»–çš„å•è¯å°†è¢«å¿½ç•¥ã€‚

æ‰“å°å‡ºæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª`description`å’Œç¬¬ä¸€ä¸ª`vector`æ¥çœ‹çœ‹è¿™æ˜¯æ€ä¹ˆè¡¨ç¤ºçš„ã€‚

```
print(vector.toarray()[0])
Output: [1 0 1 1 0] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
df['description'].iloc[0]
Output: "_Aromas_ include tropical _fruit_, broom, brimstone and dried herb. The _palate_ isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity." 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å‘é‡æ•°ç»„(`[1 0 1 1 0]`)ï¼Œè¡¨ç¤ºè¯­æ–™åº“ä¸­ç¬¬ä¸€ä¸ªæè¿°ä¸­çš„çŸ¢é‡åŒ–ç‰¹å¾(`['aromas', 'flavors', 'fruit', 'palate', 'wine']`)ã€‚1 è¡¨ç¤ºåœ¨çŸ¢é‡åŒ–è¦ç´ çš„é¡ºåºä¸­å­˜åœ¨ï¼Œ0 è¡¨ç¤ºä¸å­˜åœ¨ã€‚

ä½¿ç”¨ä¸åŒçš„å‘é‡ç´¢å¼•å’Œæè¿°ã€‚ä½ ä¼šæ³¨æ„åˆ°æ²¡æœ‰è¯æ±‡åŒ–ï¼Œæ‰€ä»¥åƒ`fruity`å’Œ`fruits`è¿™æ ·çš„è¯è¢«å¿½ç•¥äº†ï¼Œå› ä¸ºåªæœ‰`fruit`è¢«åŒ…å«åœ¨å‘é‡ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹æè¿°è¿›è¡Œè¯æ±‡åŒ–ä»¥å°†å®ƒä»¬è½¬æ¢æˆå®ƒä»¬çš„è¯æ ¹ã€‚

## [](#train-the-model)è®­ç»ƒæ¨¡å‹

æ›´æ–°å‡½æ•°ï¼Œä»¥ä¾¿ä½¿ç”¨ç¬¬äºŒä¸ªçŸ¢é‡å™¨é…ç½®ã€‚

```
def get_vector_feature_matrix(description):
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english", max_features=5)
    vectorizer = CountVectorizer(lowercase=True, stop_words="english", max_features=1000)
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english",ngram_range=(1, 2), max_features=1000)
    #vectorizer = CountVectorizer(lowercase=True, stop_words="english", tokenizer=stemming_tokenizer) 
    vector = vectorizer.fit_transform(np.array(description))
    return vector, vectorizer 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶è°ƒç”¨å‡½æ•°æ¥æ›´æ–°çŸ¢é‡å™¨

```
vector, vectorizer = get_vector_feature_matrix(df['description']) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨åˆ›å»ºæˆ‘ä»¬çš„ç‰¹å¾çŸ©é˜µã€‚å¦‚æœè¿™é‡Œå‡ºç°å†…å­˜é”™è¯¯ï¼Œè¯·å‡å°‘ CountVectorizer ä¸­çš„ max_featuresã€‚

```
features = vector.todense() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æœ‰ä¸‰ç§ä¸åŒå‹å·çš„ä¸‰ç§ä¸åŒæ ‡ç­¾ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬åˆ†é…æ ‡ç­¾å˜é‡ï¼Œé¦–å…ˆä½¿ç”¨`quality`æ ‡ç­¾ã€‚

```
label = df['quality'] 
#label = df['priceRange']
#label = df['variety'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ç‰¹å¾å’Œæ ‡ç­¾å˜é‡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æ‹†åˆ†æ•°æ®æ¥è®­ç»ƒå’Œæµ‹è¯•ã€‚

æˆ‘ä»¬å°† 80%ç”¨äºåŸ¹è®­ï¼Œ20%ç”¨äºæµ‹è¯•ã€‚è¿™å°†å…è®¸æˆ‘ä»¬ä»è®­ç»ƒä¸­è·å¾—å‡†ç¡®æ€§ä¼°è®¡ï¼Œä»¥æŸ¥çœ‹æ¨¡å‹çš„æ‰§è¡Œæƒ…å†µã€‚

```
X, y = features, label
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½¿ç”¨[é€»è¾‘å›å½’](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)ç®—æ³•è®­ç»ƒæ¨¡å‹å¹¶æ‰“å°ç²¾ç¡®åº¦ã€‚

```
lr = LogisticRegression(multi_class='ovr',solver='lbfgs')
model = lr.fit(X_train, y_train)

accuracy = model.score(X_test, y_test)
print ("Accuracy is {}".format(accuracy))
Output: "Accuracy is 0.7404885554914407" 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ˜¯ä¸€ä¸ªä¸é”™çš„ç²¾åº¦ï¼Œä½†æˆ‘ç›¸ä¿¡å®ƒå¯ä»¥å¾—åˆ°æ”¹å–„ï¼åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œè¶³å¤Ÿå¥½â€,è¿™æ˜¯ä¸€ä¸ªä½ æ›¾ç»æ„å»ºçš„æ¯ä¸ªæ¨¡å‹éƒ½éœ€è¦åšå‡ºçš„å†³å®šï¼

## [](#test-the-model)æµ‹è¯•æ¨¡å‹

å½“ä½ é€‰æ‹©ä¸€ä¸ªå€™é€‰æ¨¡å‹æ—¶ï¼Œå®ƒåº”è¯¥æ€»æ˜¯åœ¨çœ‹ä¸è§çš„æ•°æ®ä¸Šè¢«æµ‹è¯•ã€‚å¦‚æœä¸€ä¸ªæ¨¡å‹å¯¹å®ƒçš„æ•°æ®è¿‡åº¦æ‹Ÿåˆï¼Œé‚£ä¹ˆå®ƒåœ¨è‡ªå·±çš„æ•°æ®ä¸Šä¼šè¡¨ç°å¾ˆå¥½ï¼Œè€Œåœ¨æ–°æ•°æ®ä¸Šè¡¨ç°å¾ˆå·®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯¹çœ‹ä¸è§çš„æ•°æ®è¿›è¡Œæµ‹è¯•éå¸¸é‡è¦ã€‚

æˆ‘ä»è‘¡è„é…’æ‚å¿—ç½‘ç«™ä¸Šæ‰¾åˆ°äº†è¿™ç¯‡è¯„è®ºã€‚è¿™æ˜¯ä¸€ä¸ª 95 åˆ†å’Œ 60 ç¾å…ƒä¸€ç“¶çš„è‘¡è„é…’è¯„è®ºã€‚

```
test = "This comes from the producer's coolest estate near the town of Freestone. White pepper jumps from the glass alongside accents of lavender, rose and spice. Compelling in every way, it offers juicy raspberry fruit that's focused, pure and undeniably delicious."

x = vectorizer.transform(np.array([test]))
proba = model.predict_proba(x)
classes = model.classes_
resultdf = pd.DataFrame(data=proba, columns=classes)
resultdf 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![testresult](../Images/e0a1a214964a74031e9e5394eb4fd367.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VxyH15cw--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://raw.githubusercontent.com/cassieview/intro-nlp-wine-reviews/master/imgs/testresult.PNG)

# [](#this-is-a-correct-prediction)è¿™æ˜¯æ­£ç¡®çš„é¢„æµ‹ï¼ğŸ‰

æŸ¥çœ‹ç»“æœçš„å¦ä¸€ç§æ–¹å¼æ˜¯è½¬ç½®ã€æ’åºï¼Œç„¶åæ‰“å°å¤´ï¼Œäº§ç”Ÿå‰ 5 ä¸ªé¢„æµ‹çš„åˆ—è¡¨ã€‚

```
topPrediction = resultdf.T.sort_values(by=[0], ascending = [False])
topPrediction.head() 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#other-things-to-try)å…¶ä»–äº‹æƒ…è¦å°è¯•

1.  æ›´æ”¹æ ‡ç­¾å¹¶å†æ¬¡è¿è¡Œä»·æ ¼æ¡¶é¢„æµ‹æˆ–è‘¡è„å“ç§ã€‚
2.  å°è¯•ä½¿ç”¨ä¸åŒçš„ç®—æ³•ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥å¾—åˆ°æ›´å¥½çš„ç»“æœ
3.  å‘æè¿°æ–‡æœ¬ä¸­æ·»åŠ é™„åŠ è¦ç´ ä»¥æé«˜å‡†ç¡®æ€§ã€‚ä»·æ ¼å’Œç§¯åˆ†ä¹‹é—´æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§ã€‚ä¹Ÿè®¸åŠ ä¸Šè¿™äº›ä¼šæé«˜å‡†ç¡®ç‡ï¼Ÿ
4.  ä½¿ç”¨ [NLTK](https://www.nltk.org/) ä¸ºæ–‡æœ¬æ·»åŠ è¯æ±‡åŒ–ä»¥æé«˜åˆ†æ•°
5.  å°è¯•åœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šè¿›è¡Œæ–‡æœ¬åˆ†ç±»ã€‚

æ•°æ®ç§‘å­¦æ˜¯ä¸€ä¸ªåå¤è¯•éªŒçš„è¿‡ç¨‹ã€‚æˆ‘ç¡®ä¿¡æœ‰åŠæ³•æ”¹è¿›è¿™ä¸ªæ¨¡å‹å’Œå‡†ç¡®æ€§ã€‚åˆ°å¤„ç©ç©çœ‹èƒ½ä¸èƒ½å¾—åˆ°æ›´å¥½çš„ç»“æœï¼

## [](#other-helpful-links)å…¶ä»–æœ‰ç”¨çš„é“¾æ¥

[æœºå™¨å­¦ä¹ ç®—æ³•å¤‡å¿˜å•](https://docs.microsoft.com/en-us/azure/machine-learning/studio/algorithm-choice#the-machine-learning-algorithm-cheat-sheet?WT.mc_id=ca-0000-cassieb)

ã€Azure æœºå™¨å­¦ä¹ å·¥ä½œå®¤å¦‚ä½•é€‰æ‹©ç®—æ³•

[å®Œæ•´çš„ GitHub å›è´­](https://github.com/cassieview/intro-nlp-wine-reviews)

<center>CHEERS! ğŸ¥‚</center>

[![](../Images/30886189eec419776ed60378a85f2b1c.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--9DudeEPX--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/5uzwtn3ltbn9jxi4nfj5.jpg)

<center>ğŸ·ğŸ¤–ğŸ’šDrinking wine and hanging out with bots. ğŸ·ğŸ¤–ğŸ’š</center>