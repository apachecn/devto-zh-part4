# ç”¨ Nodeã€GraphQL å’Œ React ç®€åŒ– CRUD

> åŸæ–‡:[https://dev . to/bnevilleoneill/make-crud-simple-with-node-graphql-and-react-1h8p](https://dev.to/bnevilleoneill/make-crud-simple-with-node-graphql-and-react-1h8p)

**ç”±[avathika meenakshi](https://blog.logrocket.com/author/avanthikameenakshi/)T3]æ’°å†™**

GraphQL é€šè¿‡å°†æ‰€æœ‰è¯·æ±‚æŠ½è±¡åˆ°ä¸€ä¸ªç«¯ç‚¹æ¥é™ä½æ„å»º API çš„å¤æ‚æ€§ã€‚ä¸ä¼ ç»Ÿçš„ REST APIs ä¸åŒï¼Œå®ƒæ˜¯å£°æ˜æ€§çš„ï¼›æ— è®ºè¯·æ±‚ä»€ä¹ˆéƒ½ä¼šè¢«è¿”å›ã€‚

å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„é¡¹ç›®éƒ½éœ€è¦ graph QLâ€”â€”å®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ•´åˆæ•°æ®çš„å·¥å…·ã€‚å®ƒæœ‰å®šä¹‰è‰¯å¥½çš„æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è‚¯å®šä¸ä¼šè¿‡åº¦æå–ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªç¨³å®šçš„ RESTful API ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¾èµ–äºæ¥è‡ªå•ä¸€æ•°æ®æºçš„æ•°æ®ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ GraphQL äº†ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æ­£åœ¨ä¸ºè‡ªå·±åˆ›å»ºä¸€ä¸ªåšå®¢ï¼Œæˆ‘ä»¬å†³å®šåœ¨ä¸€ä¸ª MongoDB æ•°æ®åº“ä¸­å­˜å‚¨ã€æ£€ç´¢å’Œäº¤æµæ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰åšä»»ä½•æ¶æ„ä¸Šå¤æ‚çš„äº‹æƒ…ï¼Œä¹Ÿä¸éœ€è¦ GraphQLã€‚

å¦ä¸€æ–¹é¢ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå®Œå…¨æˆç†Ÿçš„äº§å“ï¼Œå®ƒä¾èµ–äºæ¥è‡ªå¤šä¸ªæ¥æºçš„æ•°æ®(ä¾‹å¦‚ï¼ŒMongoDBã€MySQLã€Postgres å’Œå…¶ä»– API)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹© GraphQLã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨ä¸ºè‡ªå·±è®¾è®¡ä¸€ä¸ª portfolio ç«™ç‚¹ï¼Œæˆ‘ä»¬æƒ³è¦æ¥è‡ªç¤¾äº¤åª’ä½“å’Œ GitHub çš„æ•°æ®(ä»¥æ˜¾ç¤ºè´¡çŒ®)ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿæœ‰è‡ªå·±çš„æ•°æ®åº“æ¥ç»´æŠ¤ä¸€ä¸ªåšå®¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ GraphQL æ¥ç¼–å†™ä¸šåŠ¡é€»è¾‘å’Œæ¨¡å¼ã€‚å®ƒå°†æŠŠæ•°æ®æ•´åˆä¸ºå•ä¸€çš„çœŸå®æ¥æºã€‚

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†å°†æ­£ç¡®çš„æ•°æ®åˆ†å‘åˆ°å‰ç«¯çš„è§£æå™¨åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿè½»æ¾åœ°ç®¡ç†å•ä¸ªæ•°æ®æºä¸­çš„æ•°æ®ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ GraphQL å®ç°ç®€å•çš„ç«¯åˆ°ç«¯ CRUD æ“ä½œã€‚

[![LogRocket Free Trial Banner](../Images/4aa67f42a82d61c79b61acb13eae9479.png)T2ã€‘](https://logrocket.com/signup/)

## [](#crud-with-graphqlserver)CRUD ä¸ graphql-server

### [](#setting-up-our-server)è®¾ç½®æˆ‘ä»¬çš„æœåŠ¡å™¨

æˆ‘ä»¬å°†ä½¿ç”¨ [express-graphql](https://www.npmjs.com/package/express-graphql) å‰¥ç¦»ä¸€ä¸ªç®€å•çš„ GraphQL æœåŠ¡å™¨ï¼Œå¹¶å°†å…¶è¿æ¥åˆ° MySQL æ•°æ®åº“ã€‚æºä»£ç å’Œ MySQL æ–‡ä»¶éƒ½åœ¨è¿™ä¸ª[ä»“åº“](https://github.com/AvanthikaMeenakshi/graphqlReactBoilerplate)ä¸­ã€‚

GraphQL æœåŠ¡å™¨æ„å»ºåœ¨æ¨¡å¼å’Œè§£æå™¨ä¹‹ä¸Šã€‚ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªæ¨¡å¼(å®šä¹‰ç±»å‹ã€æŸ¥è¯¢ã€å˜å¼‚å’Œè®¢é˜…)ã€‚è¿™ä¸ªæ¨¡å¼æè¿°äº†æ•´ä¸ªåº”ç”¨ç¨‹åºçš„ç»“æ„ã€‚

å…¶æ¬¡ï¼Œå¯¹äºæ¨¡å¼ä¸­å®šä¹‰çš„å†…å®¹ï¼Œæˆ‘ä»¬æ­£åœ¨æ„å»ºå„è‡ªçš„è§£æå™¨æ¥è®¡ç®—å’Œåˆ†å‘æ•°æ®ã€‚è§£æå™¨å°†åŠ¨ä½œä¸åŠŸèƒ½è¿›è¡Œæ˜ å°„ï¼›å¯¹äº typedef ä¸­å£°æ˜çš„æ¯ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè§£æå™¨æ¥è¿”å›æ•°æ®ã€‚

æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å®šä¹‰ç«¯ç‚¹å’Œä¼ é€’é…ç½®æ¥å®ŒæˆæœåŠ¡å™¨è®¾ç½®ã€‚æˆ‘ä»¬å°†`/graphql`åˆå§‹åŒ–ä¸ºåº”ç”¨ç¨‹åºçš„ç«¯ç‚¹ã€‚æˆ‘ä»¬å°†æ„å»ºçš„æ¨¡å¼å’Œæ ¹è§£æå™¨ä¼ é€’ç»™`graphqlHTTP`ä¸­é—´ä»¶ã€‚

é™¤äº†æ¨¡å¼å’Œæ ¹è§£æå™¨ï¼Œæˆ‘ä»¬è¿˜å¯ç”¨äº† [GraphiQL](https://www.npmjs.com/package/graphiql) æ¸¸ä¹åœºã€‚GraphQL æ˜¯ä¸€ä¸ªäº¤äº’å¼æµè§ˆå™¨å†… GraphQL IDEï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬å¤„ç†æˆ‘ä»¬æ„å»ºçš„ GraphQL æŸ¥è¯¢ã€‚

```
var express = require('express');
var graphqlHTTP = require('express-graphql');
var { buildSchema } = require('graphql');

var schema = buildSchema(`
  type Query {
    hello: String
  }
`);

var root = {
  hello: () => "World"
};

var app = express();

app.use('/graphql', graphqlHTTP({
  schema: schema,
  rootValue: root,
  graphiql: true,
}));

app.listen(4000);

console.log('Running a GraphQL API server at localhost:4000/graphql'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€æ—¦æœåŠ¡å™¨å‡†å¤‡å°±ç»ªï¼Œç”¨`node index.js`è¿è¡Œåº”ç”¨ç¨‹åºå°†åœ¨`http://localhost:4000/graphql`å¯åŠ¨æœåŠ¡å™¨ã€‚æˆ‘ä»¬å¯ä»¥æŸ¥è¯¢ hello å¹¶å¾—åˆ°å­—ç¬¦ä¸²â€œWorldâ€ä½œä¸ºå“åº”ã€‚

### [](#connecting-the-database)è¿æ¥æ•°æ®åº“

æˆ‘å°†å»ºç«‹ä¸ MySQL æ•°æ®åº“çš„è¿æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
var mysql = require('mysql');

app.use((req, res, next) => {
  req.mysqlDb = mysql.createConnection({
    host     : 'localhost',
    user     : 'root',
    password : '',
    database : 'userapp'
  });
  req.mysqlDb.connect();
  next();
}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å¯ä»¥è¿æ¥å¤šä¸ªæ•°æ®åº“/æºï¼Œå¹¶åœ¨è§£æå™¨ä¸­æ•´åˆå®ƒä»¬ã€‚æˆ‘åœ¨è¿™é‡Œè¿æ¥åˆ°ä¸€ä¸ª MySQL æ•°æ®åº“ã€‚æˆ‘åœ¨æœ¬æ–‡ä¸­ä½¿ç”¨çš„æ•°æ®åº“è½¬å‚¨åœ¨ GitHub å­˜å‚¨åº“ä¸­ã€‚

### [](#reading-and-writing-data-with-graphql)ç”¨ GraphQL è¯»å†™æ•°æ®

æˆ‘ä»¬ä½¿ç”¨æŸ¥è¯¢å’Œå˜å¼‚æ¥è¯»å–å’Œä¿®æ”¹æ•°æ®æºä¸­çš„æ•°æ®ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„ queryDB å‡½æ•°æ¥å¸®åŠ©æŸ¥è¯¢æ•°æ®åº“ã€‚

#### [](#queries)æŸ¥è¯¢

åˆ—å‡ºå’ŒæŸ¥çœ‹æ•°æ®çš„æ‰€æœ‰ SELECT è¯­å¥(æˆ–è¯»æ“ä½œ)éƒ½æ”¾åœ¨`type Query` typedef ä¸­ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ªæŸ¥è¯¢:ä¸€ä¸ªåˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰ç”¨æˆ·ï¼Œå¦ä¸€ä¸ªæŒ‰ id æŸ¥çœ‹å•ä¸ªç”¨æˆ·ã€‚

1.  **åˆ—å‡ºæ•°æ®:**ä¸ºäº†åˆ—å‡ºç”¨æˆ·ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º`User`çš„ GraphQL æ¨¡å¼å¯¹è±¡ç±»å‹ï¼Œå®ƒè¡¨ç¤ºæˆ‘ä»¬å¯ä»¥ä»`getUsers`æŸ¥è¯¢ä¸­è·å–æˆ–æœŸæœ›çš„å†…å®¹ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰`getUsers`æŸ¥è¯¢æ¥è¿”å›ä¸€ç»„ç”¨æˆ·ã€‚
2.  **æŸ¥çœ‹å•ä¸ªè®°å½•:**ä¸ºäº†æŸ¥çœ‹å•ä¸ªè®°å½•ï¼Œæˆ‘ä»¬å°†`id`ä½œä¸ºæˆ‘ä»¬å®šä¹‰çš„`getUserInfo`æŸ¥è¯¢çš„å‚æ•°ã€‚å®ƒåœ¨æ•°æ®åº“ä¸­æŸ¥è¯¢è¯¥ç‰¹å®š idï¼Œå¹¶å°†æ•°æ®è¿”å›ç»™å‰ç«¯ã€‚

[![GraphiQL Demo Returning Array Of Users](../Images/1b0936df12b46e8697eb9ee2db5817a9.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--HthI9cHr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2019/08/graphiql-demo.gif%3Fresize%3D730%252C333%26ssl%3D1)

ç°åœ¨æˆ‘ä»¬å·²ç»å°†è·å–æ‰€æœ‰è®°å½•å’ŒæŒ‰ id æŸ¥çœ‹è®°å½•çš„æŸ¥è¯¢æ”¾åœ¨ä¸€èµ·ï¼Œå½“æˆ‘ä»¬è¯•å›¾ä» GraphiQL ä¸­æŸ¥è¯¢ç”¨æˆ·æ—¶ï¼Œå®ƒå°†åœ¨å±å¹•ä¸Šåˆ—å‡ºä¸€ç»„ç”¨æˆ·ï¼[ğŸ™‚](https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f642.png)

```
var schema = buildSchema(`
  type User {
    id: String
    name: String
    job_title: String
    email: String
  }
  type Query {
    getUsers: [User],
    getUserInfo(id: Int) : User
  }
`);

const queryDB = (req, sql, args) => new Promise((resolve, reject) => {
    req.mysqlDb.query(sql, args, (err, rows) => {
        if (err)
            return reject(err);
        rows.changedRows || rows.affectedRows || rows.insertId ? resolve(true) : resolve(rows);
    });
});

var root = {
  getUsers: (args, req) => queryDB(req, "select * from users").then(data => data),
  getUserInfo: (args, req) => queryDB(req, "select * from users where id = ?", [args.id]).then(data => data[0])
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### [](#mutations)çªå˜

æ•°æ®åº“çš„å†™æ“ä½œâ€”â€”åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤â€”â€”é€šå¸¸åœ¨çªå˜ä¸‹å®šä¹‰ã€‚GraphQL å¼•æ“ä»¥è¿ç»­çš„æ–¹å¼æ‰§è¡Œå˜å¼‚ã€‚æŸ¥è¯¢æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ã€‚

1.  åˆ›å»ºæ•°æ®:æˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸€ä¸ªå˜ä½“`createUser`ï¼Œå®ƒé‡‡ç”¨æŒ‡å®šçš„å‚æ•°åœ¨ MySQL æ•°æ®åº“ä¸­åˆ›å»ºæ•°æ®ã€‚
2.  æ›´æ–°æˆ–åˆ é™¤æ•°æ®:ç±»ä¼¼äºæŸ¥çœ‹è®°å½•ï¼Œæ›´æ–°(`updateUserInfo`)å’Œåˆ é™¤(`deleteUser`)ä»¥ id ä¸ºå‚æ•°ï¼Œä¿®æ”¹æ•°æ®åº“ã€‚

è¿™äº›å‡½æ•°ç”¨ä¸€ä¸ªå¸ƒå°”å€¼æ¥è¡¨ç¤ºæ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ã€‚

```
var schema = buildSchema(`
  type Mutation {
    updateUserInfo(id: Int, name: String, email: String, job_title: String): Boolean
    createUser(name: String, email: String, job_title: String): Boolean
    deleteUser(id: Int): Boolean
  }
`);

var root = {
  updateUserInfo: (args, req) => queryDB(req, "update users SET ? where id = ?", [args, args.id]).then(data => data),
  createUser: (args, req) => queryDB(req, "insert into users SET ?", args).then(data => data),
  deleteUser: (args, req) => queryDB(req, "delete from users where id = ?", [args.id]).then(data => data)
}; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ—¢ç„¶æˆ‘ä»¬å·²ç»è®¾ç½®å¹¶æ’åºäº†æœåŠ¡å™¨ç«¯çš„ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬å°è¯•å°†åç«¯è¿æ¥åˆ°æˆ‘ä»¬çš„ React åº”ç”¨ç¨‹åºã€‚

## [](#crud-with-graphqlclient)CRUD ä¸ graphql-client

ä¸€æ—¦æˆ‘ä»¬æœ‰äº†æœåŠ¡å™¨ï¼Œåˆ›å»ºå®¢æˆ·æœºé€»è¾‘æ¥æ˜¾ç¤ºå’Œæ”¹å˜æ•°æ®å°±å¾ˆå®¹æ˜“äº†ã€‚Apollo å®¢æˆ·ç«¯æœ‰åŠ©äºçŠ¶æ€ç®¡ç†å’Œç¼“å­˜ã€‚å®ƒä¹Ÿæ˜¯é«˜åº¦æŠ½è±¡å’Œå¿«é€Ÿçš„:æ‰€æœ‰ç”¨äºæ£€ç´¢æ•°æ®ã€è·Ÿè¸ªåŠ è½½å’Œé”™è¯¯çŠ¶æ€ä»¥åŠæ›´æ–° UI çš„é€»è¾‘éƒ½ç”±`useQuery`é’©å­å°è£…ã€‚

### [](#connecting-to-graphqlserver)è¿æ¥åˆ° graphql-server

æˆ‘åˆ›å»ºäº†ä¸€ä¸ª CRA æ ·æ¿æ–‡ä»¶ï¼Œå¹¶å®‰è£…äº† [GraphQL](https://www.npmjs.com/package/graphql) ã€ [apollo-boost](https://www.npmjs.com/package/apollo-boost) å’Œ [@apollo/react-hooks](https://www.npmjs.com/package/@apollo/react-hooks) ã€‚æˆ‘ä»¬åˆå§‹åŒ– Apollo å®¢æˆ·æœºï¼Œå¹¶è®©å®ƒæŒ‚é’©ä½œå‡ºååº”ã€‚

```
import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';
import ApolloClient from 'apollo-boost';
import { ApolloProvider } from '@apollo/react-hooks';

const client = new ApolloClient({
  uri: 'http://localhost:4000/graphql'
});

ReactDOM.render(
  <ApolloProvider client={client}>
    <App />
  </ApolloProvider>,
  document.getElementById('root')
); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

### [](#reading-and-mutating-data)è¯»å–å’Œå˜å¼‚æ•°æ®

æˆ‘å·²ç»åœ¨æˆ‘çš„æºä»£ç çš„`Queries`æ–‡ä»¶å¤¹ä¸­ç®¡ç†äº†æ‰€æœ‰çš„ GraphQL æŸ¥è¯¢ã€‚æˆ‘å°†ä½¿ç”¨`useQuery`é’©å­ä»æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œè¯¥é’©å­æ„å»ºåœ¨ React é’©å­ API ä¹‹ä¸Šã€‚å®ƒæœ‰åŠ©äºå°†æ•°æ®å¼•å…¥ UIã€‚

GraphQL æŸ¥è¯¢é€šå¸¸åŒ…è£…åœ¨`gql`å‡½æ•°ä¸­ã€‚`gql`å¸®åŠ©å°†æŸ¥è¯¢å­—ç¬¦ä¸²è½¬æ¢æˆæŸ¥è¯¢æ–‡æ¡£ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­å®šä¹‰æŸ¥è¯¢ã€‚

```
import { gql } from 'apollo-boost';

export const GET_USERS = gql`
  {
    getUsers {
      id,
      name,
      job_title,
      email
    }
  }
`;

export const VIEW_USERS = gql`
  query ($id: Int){
    getUserInfo(id: $id) {
      id,
      name,
      job_title,
      email
    }
  }
`;

export const ADD_USER = gql`
  mutation($name: String, $email: String, $job_title: String) {
    createUser (name: $name, email: $email, job_title: $job_title)
  }
`;

export const EDIT_USER = gql`
  mutation($id: Int, $name: String, $email: String, $job_title: String) {
    updateUserInfo (id: $id, name: $name, email: $email, job_title: $job_title)
  }
`;

export const DELETE_USER = gql`
  mutation($id: Int) {
    deleteUser(id: $id)
  }
` 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸€æ—¦è®¾ç½®äº†`ApolloProvider`,æˆ‘ä»¬å°±å¯ä»¥ä»æˆ‘ä»¬çš„ GraphQL æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æˆ‘ä»¬å°†è¯•å›¾è¿›è¡Œçš„æŸ¥è¯¢ä¼ é€’ç»™`useQuery`é’©å­ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬æä¾›ç»“æœã€‚

æˆ‘åšäº†ä¸¤ä¸ªæœ‰å‚æ•°å’Œæ²¡æœ‰å‚æ•°çš„æŸ¥è¯¢ï¼Œæ¥å±•ç¤ºæˆ‘ä»¬åº”è¯¥å¦‚ä½•åœ¨å‰ç«¯å¤„ç†æŸ¥è¯¢å’Œå˜å¼‚ã€‚`useQuery`ä¸ºæˆ‘ä»¬è·Ÿè¸ª`error`å’Œ`loading`çŠ¶æ€ï¼Œå¹¶å°†åæ˜ åœ¨å…³è”å¯¹è±¡ä¸­ã€‚ä¸€æ—¦æœåŠ¡å™¨å‘é€ç»“æœï¼Œå®ƒå°†é€šè¿‡æ•°æ®å±æ€§åæ˜ å‡ºæ¥ã€‚

```
import React from 'react';
import { useQuery } from '@apollo/react-hooks';
import { GET_USERS, VIEW_USERS } from "./Queries";
import { Card, CardBody, CardHeader, CardSubtitle, Spinner } from 'reactstrap';

function App() {
  const getAllUsers = useQuery(GET_USERS);
  const userInfo = useQuery(VIEW_USERS, { variables: { id: 1 }});
  if (getAllUsers.loading || userInfo.loading) return <Spinner color="dark" />;
  if (getAllUsers.error || userInfo.error) return <React.Fragment>Error :(</React.Fragment>;

  return (
    <div className="container">
      <Card>
        <CardHeader>Query - Displaying all data</CardHeader>
        <CardBody>
          <pre>
            {JSON.stringify(getAllUsers.data, null, 2)}
          </pre>
        </CardBody>
      </Card>
      <Card>
        <CardHeader>Query - Displaying data with args</CardHeader>
        <CardBody>
          <CardSubtitle>Viewing a user by id</CardSubtitle>
          <pre>
            {JSON.stringify(userInfo.data, null, 2)}
          </pre>
        </CardBody>
      </Card>
    </div>
  )
}

export default App; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸æŸ¥è¯¢ç±»ä¼¼ï¼Œå˜å¼‚å°†ä½¿ç”¨ç›¸åŒçš„`useQuery`é’©å­ï¼Œå¹¶å°†æ•°æ®ä½œä¸ºå˜é‡ä¼ é€’ç»™æŸ¥è¯¢ã€‚

```
const deleteMutation = useQuery(DELETE_USER, { variables: { id: 8 }});
const editMutation = useQuery(EDIT_USER, { variables: { id: 9, name: "Username", email: "email", job_title: "job" }});
const createMutation = useQuery(ADD_USER, { variables: { name: "Username", email: "email", job_title: "job" }}); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#conclusion)ç»“è®º

å“’å“’ï¼æˆ‘ä»¬åªæ˜¯ç”¨ GraphQL åšäº†ç«¯åˆ°ç«¯çš„ CRUD æ“ä½œã€‚åœ¨å®¢æˆ·ç«¯ï¼Œå¼•å…¥ React é’©å­åï¼Œè¯»å–å’Œæ”¹å˜æ•°æ®å˜å¾—éå¸¸ç®€å•ã€‚Apollo Client è¿˜æä¾›äº†èº«ä»½éªŒè¯ã€æ›´å¥½çš„é”™è¯¯å¤„ç†ã€ç¼“å­˜å’Œä¹è§‚ UIã€‚

è®¢é˜…æ˜¯ GraphQL ä¸­å¦ä¸€ä¸ªæœ‰è¶£çš„æ¦‚å¿µã€‚æœ‰äº†è¿™ä¸ªåº”ç”¨ç¨‹åºä½œä¸ºæ ·æ¿ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è¯•éªŒå…¶ä»–ç±»ä¼¼çš„æ¦‚å¿µï¼

ç¼–ç å¿«ä¹ï¼

* * *

**ç¼–è€…æŒ‰:**çœ‹åˆ°è¿™ä¸ªå¸–å­æœ‰é—®é¢˜ï¼Ÿä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ­£ç¡®çš„ç‰ˆæœ¬ã€‚

## [](#plug-logrocket-a-dvr-for-web-apps)Plug: [LogRocket](https://logrocket.com/signup/) ï¼Œä¸€æ¬¾é€‚ç”¨äºç½‘ç»œåº”ç”¨çš„ DVR

[![LogRocket Dashboard Free Trial Banner](../Images/0abf868fe5ccbed99d71cb8d9e81ed98.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--6FG5kvEL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://i2.wp.com/blog.logrocket.com/wp-content/uploads/2017/03/1d0cd-1s_rmyo6nbrasp-xtvbaxfg.png%3Fresize%3D1200%252C677%26ssl%3D1)

[log rocket](https://logrocket.com/signup/)æ˜¯ä¸€ä¸ªå‰ç«¯æ—¥å¿—å·¥å…·ï¼Œè®©ä½ é‡æ”¾é—®é¢˜ï¼Œå°±åƒå®ƒä»¬å‘ç”Ÿåœ¨ä½ è‡ªå·±çš„æµè§ˆå™¨ä¸­ä¸€æ ·ã€‚LogRocket ä¸éœ€è¦çŒœæµ‹é”™è¯¯å‘ç”Ÿçš„åŸå› ï¼Œä¹Ÿä¸éœ€è¦å‘ç”¨æˆ·è¯¢é—®æˆªå›¾å’Œæ—¥å¿—è½¬å‚¨ï¼Œè€Œæ˜¯è®©æ‚¨é‡æ”¾ä¼šè¯ä»¥å¿«é€Ÿäº†è§£å“ªé‡Œå‡ºé”™äº†ã€‚å®ƒå¯ä»¥ä¸ä»»ä½•åº”ç”¨ç¨‹åºå®Œç¾é…åˆï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Œå¹¶ä¸”æœ‰æ’ä»¶å¯ä»¥è®°å½•æ¥è‡ª Reduxã€Vuex å’Œ@ngrx/store çš„é¢å¤–ä¸Šä¸‹æ–‡ã€‚

é™¤äº†è®°å½• Redux åŠ¨ä½œå’ŒçŠ¶æ€ï¼ŒLogRocket è¿˜è®°å½•æ§åˆ¶å°æ—¥å¿—ã€JavaScript é”™è¯¯ã€stacktracesã€å¸¦æœ‰å¤´+ä½“çš„ç½‘ç»œè¯·æ±‚/å“åº”ã€æµè§ˆå™¨å…ƒæ•°æ®ã€è‡ªå®šä¹‰æ—¥å¿—ã€‚å®ƒè¿˜ä½¿ç”¨ DOM æ¥è®°å½•é¡µé¢ä¸Šçš„ HTML å’Œ CSSï¼Œç”šè‡³ä¸ºæœ€å¤æ‚çš„å•é¡µé¢åº”ç”¨ç¨‹åºé‡æ–°åˆ›å»ºåƒç´ çº§å®Œç¾è§†é¢‘ã€‚

[å…è´¹è¯•ç”¨](https://logrocket.com/signup/)ã€‚

* * *

å¸–å­[ç”¨ Nodeã€GraphQL å’Œ React](https://blog.logrocket.com/crud-with-node-graphql-react/) ç®€åŒ– CRUD æœ€æ—©å‡ºç°åœ¨ [LogRocket åšå®¢](https://blog.logrocket.com)ä¸Šã€‚