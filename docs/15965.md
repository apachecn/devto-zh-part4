# äº†è§£ Dart ä¸­çš„åå°„å’Œæ³¨é‡Š

> åŸæ–‡ï¼š<https://dev.to/graphicbeacon/understanding-reflection-and-annotations-in-dart-4kn1>

*æœ€åˆå‘å¸ƒäº[creativebracket.com](https://creativebracket.com/understanding-reflection-and-annotations-in-dart/)T3ã€‘*

åœ¨è¿™ä¸ªè§†é¢‘ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨åå°„çš„ä¸»é¢˜ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒæ¥ç¼–å†™æ›´å¹²å‡€çš„è½¯ä»¶ã€‚åå°„å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œä¿®æ”¹ç¨‹åºçš„ç»“æ„å’Œè¡Œä¸ºã€‚æˆ‘ä»¬å°†ä½¿ç”¨åŒ…å«å¸®åŠ©ç±»å’Œå‡½æ•°çš„ **dart:mirrors** åº“æ¥å®ç°è¿™ä¸€ç‚¹ã€‚æœ€åï¼Œæˆ‘ä»¬å°†çœ‹ä¸€ä¸ªå¸¦æœ‰**æ³¨é‡Š**çš„å¸¸è§ç”¨ä¾‹ã€‚

[https://www.youtube.com/embed/_2yjPLVEGs4](https://www.youtube.com/embed/_2yjPLVEGs4)

## ç”¨åå°„çš„åŸºæœ¬ä¾‹å­

åˆ›å»ºä¸€ä¸ª`main.dart`æ–‡ä»¶ï¼Œä»å¯¼å…¥ **dart:mirrors** åº“å¼€å§‹ã€‚åœ¨æˆ‘ä»¬å®ç°æˆ‘ä»¬çš„åå°„é€»è¾‘ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç”¨æˆ‘ä»¬å¸Œæœ›è°ƒç”¨çš„æ–¹æ³•å®šä¹‰ä¸€ä¸ªç±»:

```
import 'dart:mirrors';

main() {
  // TODO: Implement Reflection logic
}

// Our example class to reflect on
class Endpoint {
  handle() => print('Request received');
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†åæ˜ ç±»å‹å’Œå¯¹è±¡ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨:

1.  åå°„():åå°„ä¸€ä¸ªç±»çš„å®ä¾‹
2.  **reflectClass()** :åœ¨ç±»å£°æ˜ä¸Šåå°„
3.  **reflectType()** :åå°„ä½œä¸ºå‚æ•°ä¼ å…¥çš„ç±»å‹

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`reflect()`ã€‚è®©æˆ‘ä»¬å®ä¾‹åŒ–`Endpoint`å¹¶é€šè¿‡åå°„è°ƒç”¨å¥æŸ„æ–¹æ³•:

```
main() {
  var reflectedClass = reflect(Endpoint());

  // invoke the handle() method
  reflectedclass.invoke(Symbol'handle'), []);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åè®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæ–‡ä»¶:

```
$ dart /path/to/main.dart 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åå°„ä¸€ä¸ªå®ä¾‹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå…¬å¼€`invoke()`æ–¹æ³•çš„`InstanceMirror`ã€‚æˆ‘ä»¬å®ä¾‹çš„æˆå‘˜è¢«æè¿°ä¸º`Symbol`ç±»å‹ã€‚ä¸Šé¢çš„ä¾‹å­é€šè¿‡ä¼ é€’å®ƒçš„`Symbol` ic åå’Œä¸€ä¸ªä½ç½®å‚æ•°æ•°ç»„(å¦‚æœæŒ‡å®šäº†çš„è¯)æ¥è°ƒç”¨ handle æ–¹æ³•ã€‚

ä¸ºäº†ä¼ é€’å‚æ•°ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹`handle()`æ–¹æ³•çš„ç­¾å:

```
handle(String a) => print('Request received $a'); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¹¶å°†å…¶ä¼ é€’ç»™è°ƒç”¨:

```
reflectedClass.invoke(Symbol('handle'), ['argument 1']);
// => Request received argument 1 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å¯ä»¥ä½¿ç”¨`handle()`æ–¹æ³•çš„å­—é¢å½¢å¼:

```
reflectedClass.invoke(#handle, ['argument 1']); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ–¹æ³•åæ˜¯ä»æ“ä½œä¸­ä½œä¸ºå€¼æ¥æ”¶çš„ï¼Œæˆ–è€…æ˜¯ä½œä¸ºç”¨æˆ·è¾“å…¥æä¾›çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨`Symbol('methodName')`æ–¹æ³•ã€‚*ç†æƒ³æƒ…å†µä¸‹ï¼Œå½“**ä¸**é¢„å…ˆçŸ¥é“è¦è°ƒç”¨çš„æ–¹æ³•æ—¶ã€‚*

è§‚çœ‹ä¸Šé¢çš„å®Œæ•´æ•™ç¨‹è§†é¢‘ã€‚

â†’ [**è·å–æºä»£ç **](https://gist.github.com/graphicbeacon/9fb6c6a951168d6a31d9b2cc442bcbe2)

## è¿›ä¸€æ­¥é˜…è¯»

*   [**é•–:é•œ**åº“æ–‡æ¡£](https://api.dart.dev/stable/2.4.0/dart-mirrors/dart-mirrors-library.html)
*   [Dart å’Œ MongoDB æ•™ç¨‹#1:ä½¿ç”¨ mongo_dart åŒ…](https://creativebracket.com/dart-and-mongodb-tutorial-1)

* * *

## æœ€åä¸€ä»¶äº‹...

æˆ‘å¾ˆé«˜å…´åœ°å®£å¸ƒï¼Œæˆ‘å·²ç»åœ¨ dev.to ä¸Šç‚¹å‡»äº†**è¶…è¿‡ 7000 åå…³æ³¨è€…**ã€‚éå¸¸æ„Ÿè°¢æ‰€æœ‰ä¸æ–­å¢é•¿çš„å…´è¶£ã€æ”¯æŒå’Œæˆ‘æ”¶åˆ°çš„åé¦ˆï¼

æœ‰é‰´äºæ­¤ï¼Œæˆ‘ä»Šå¤©å°†æ¨å‡º [**å®˜æ–¹å•†åŸ**](////bit.ly/creativebracketmerch) ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šæˆä¸ºè¿åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¿æŒç«ç„°ğŸ”¥çœŸå®çš„è¿™å°†æ¨åŠ¨é«˜è´¨é‡å†…å®¹çš„ç”Ÿäº§ï¼Œæ¶µç›–çš„ä¸»é¢˜å°†è¶…è¶Šâ€œhello worldâ€åº”ç”¨ã€‚

æˆ‘è¿˜åœ¨ YouTube é¢‘é“ä¸Šç‚¹å‡»äº† 800 å¤šä¸ªè®¢æˆ·ã€‚ [**ç‚¹å‡»è®¢é˜…å¹¶å“é“ƒé€šçŸ¥**](https://youtube.com/CreativeBracket) å¦‚æœä½ è¿˜æ²¡æœ‰ã€‚æˆ‘è®¡åˆ’å¾ˆå¿«åšä¸€ä¸ªå…³äºä»£ç ç”Ÿæˆçš„ç³»åˆ—æ–‡ç« ã€‚

æœ€åï¼Œæˆ‘åœ¨ creativebracket.com çš„åšå®¢ä¸Šæœ‰æ›´å¤šçš„æ•™ç¨‹ã€‚ä¸€å®šè¦å»çœ‹çœ‹ã€‚

**å–œæ¬¢ã€åˆ†äº«å¹¶å…³æ³¨**æˆ‘ï¼Œäº†è§£ Dart çš„æ›´å¤šå†…å®¹ã€‚*è°¢è°¢ã€‚*