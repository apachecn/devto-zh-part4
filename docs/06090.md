# åˆ›å»ºã€å¼€å‘å’Œéƒ¨ç½² Twilio åŠŸèƒ½çš„æ–°æ–¹æ³•

> åŸæ–‡:[https://dev . to/twilio/the-new-way-to-create-develop-deploy-twilio-functions-2892](https://dev.to/twilio/the-new-way-to-create-develop-and-deploy-twilio-functions-2892)

[ä¿¡å·](https://signal.twilio.com)ï¼Œæˆ‘ä»¬çš„å®¢æˆ·å’Œå¼€å‘è€…å¤§ä¼šï¼Œå°±åœ¨å‡ å¤©å‰ã€‚å¦‚æœä½ é”™è¿‡äº†ï¼Œä½ å¯ä»¥çœ‹çœ‹æ¥è‡ª[ç¬¬ä¸€å¤©](https://youtu.be/TTo37IRoMz4)å’Œ[ç¬¬äºŒå¤©](https://www.youtube.com/watch?v=WFNegpSsMlM)çš„ä¸»é¢˜æ¼”è®²ï¼Œä»¥åŠ YouTube ä¸Šçš„è®¸å¤š[äº§å“ä¼šè®®](https://www.youtube.com/watch?v=VAKe521Hryk&list=PLqrz4nXepkz5ZT-bRpdhmqrpu4fiLckfu&index=1)ã€‚

è™½ç„¶æœ‰è®¸å¤šæ¿€åŠ¨äººå¿ƒçš„äº§å“å‘å¸ƒï¼Œä½†æœ‰äººçŸ¥é“å—ï¼Ÿ)ï¼Œæœ‰ä¸€ä»¶äº‹è®©æˆ‘ä»æ¤…å­ä¸Šç«™èµ·æ¥å¤§å–Šâ€œåœ°ç‹±è€¶â€ï¼

ç°åœ¨å¯ä»¥é€šè¿‡ API éƒ¨ç½² Twilio åŠŸèƒ½ï¼Œè¿™æ”¹å˜äº†ä½¿ç”¨ Twilio å¼€å‘çš„äººæ•°ã€‚

åœ¨æ— æœåŠ¡å™¨ç¯å¢ƒä¸­è¿›è¡Œå¼€å‘å¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå¹¶ä¼šå¼•å‘è®¸å¤šé—®é¢˜ã€‚å¦‚ä½•åœ¨æœ¬åœ°å¼€å‘æ— æœåŠ¡å™¨é¡¹ç›®ï¼Ÿå¦‚ä½•å°†æ‚¨çš„åŠŸèƒ½éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ï¼Ÿé¦–å…ˆï¼Œæ‚¨å¦‚ä½•æ„å»ºæ‚¨çš„ä»£ç ï¼Ÿ

å¹¸è¿çš„æ˜¯ï¼Œä¸¤ä¸ªäº§å“å…¬å‘Šå›ç­”äº†æ‰€æœ‰è¿™äº›é—®é¢˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸‹[æ–°çš„æ— æœåŠ¡å™¨å·¥å…·åŒ…](https://www.twilio.com/docs/labs/serverless-toolkit)å’Œ[æ–°çš„ Twilio è¿è¡Œæ—¶ API](https://www.twilio.com/docs/runtime) å°†å¦‚ä½•æ”¹å˜ Twilio å‡½æ•°çš„åˆ›å»ºã€å¼€å‘å’Œéƒ¨ç½²æµç¨‹ã€‚

## [](#before-we-get-started)å¼€å§‹ä¹‹å‰â€¦

è¦å¼€å‘å’Œéƒ¨ç½² Twilio åŠŸèƒ½ï¼Œæ‚¨éœ€è¦:

*   ä¸€ä¸ªå…è´¹çš„ Twilio è´¦æˆ·
*   å·²å®‰è£…çš„ [Twilio CLI](https://www.twilio.com/docs/twilio-cli/quickstart)

æ‚¨å¯ä»¥ä½¿ç”¨ npm åŒ… [twilio-run](https://www.npmjs.com/package/twilio-run) å½¢å¼çš„æ— æœåŠ¡å™¨å·¥å…·åŒ…ä½œä¸ºç‹¬ç«‹å·¥å…·ï¼Œä½†æ˜¯ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡[Twilio æ— æœåŠ¡å™¨æ’ä»¶](https://github.com/twilio-labs/plugin-serverless)å°†å…¶é›†æˆåˆ° Twilio CLI ä¸­ã€‚Twilio CLI æ¶µç›–äº†æ•°ç™¾ä¸ª Twilio åŠŸèƒ½å’Œ API ç«¯ç‚¹ï¼Œå°†å…¶ä¸æ— æœåŠ¡å™¨æ’ä»¶é…å¯¹ï¼Œæ‚¨å°±æ‹¥æœ‰äº†ä¸€ä¸ªæä¾›æ‚¨æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½çš„å·¥å…·ã€‚

å®‰è£… CLI åï¼Œæ‚¨çš„ç¯å¢ƒä¸­å°±æœ‰äº†`twilio`å‘½ä»¤ã€‚é€šè¿‡åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç¡®ä¿æ‚¨å¾—åˆ°æˆæƒ:

```
twilio login 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*å¦‚æœæ‚¨éœ€è¦æ›´å¤šå…³äºå¦‚ä½•å¼€å§‹ä½¿ç”¨ Twilio CLI çš„ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ Twilio è§†é¢‘æç¤º**[â€œTwilio CLI ç®€ä»‹ï¼â€](https://youtu.be/iFTy8HTbpEI)* *ã€‚*

å…¨æ–°å®‰è£…åï¼ŒTwilio CLI ç¼ºå°‘`serverless`å‘½ä»¤ã€‚è¦æ·»åŠ è¿™äº›å‘½ä»¤ï¼Œè¯·ä» Twilio CLI æœ¬èº«å®‰è£…æ— æœåŠ¡å™¨æ’ä»¶ã€‚è¿è¡Œ`plugin:install`å‘½ä»¤:

```
twilio plugins:install @twilio-labs/plugin-serverless 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ’ä»¶å®‰è£…å®Œæˆåï¼Œåƒ`twilio serverless:deploy`å’Œ`twilio serverless:start`è¿™æ ·çš„æ–°å‘½ä»¤å˜å¾—è§¦æ‰‹å¯åŠã€‚ğŸ‰

**å…³äºæ’ä»¶çš„å¿«é€Ÿè¯´æ˜ï¼›**Twilio CLI ä¸ä»…èƒ½å®‰è£…æ’ä»¶ï¼Œè¿˜èƒ½æä¾›ä¿æŒæ’ä»¶æœ€æ–°çš„åŠŸèƒ½ã€‚æ— æœåŠ¡å™¨æ’ä»¶ä»ç„¶å¾ˆæ–°â€”â€”ç¡®ä¿ä¸æ—¶è¿è¡Œ`twilio plugins:update`æ¥æ¥æ”¶æ›´æ–°ã€‚

## [](#create-a-new-serverless-project)æ–°å»ºä¸€ä¸ªæ— æœåŠ¡å™¨é¡¹ç›®

è¦å¼€å§‹ä¸€ä¸ªæ–°çš„ Twilio è¿è¡Œæ—¶é¡¹ç›®ï¼Œåªéœ€è¦ä¸€ä¸ªå‘½ä»¤ã€‚

```
twilio serverless:init your-project-name 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`twilio serverless:init`åˆ›å»ºæ–°çš„ç›®å½•å’Œå¼ºåˆ¶æ–‡ä»¶ã€‚å®ƒè¿˜ä¸€æ¬¡æ€§å®‰è£…äº†æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹ã€‚

```
twilio serverless:init serverless-tryout
âœ” Creating project directory
âœ” Creating project directories and files
âœ” Downloading .gitignore file
âœ” Installing dependencies
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                                                                              â”‚
â”‚   Success!                                                                   â”‚
â”‚                                                                              â”‚
â”‚   Created serverless-tryout at /your/dir                                     â”‚
â”‚                                                                              â”‚
â”‚   Inside that directory, you can run the following command:                  â”‚
â”‚                                                                              â”‚
â”‚   npm start                                                                  â”‚
â”‚     Serves all functions in the ./functions subdirectory and assets in the   â”‚
â”‚     ./assets directory                                                       â”‚
â”‚                                                                              â”‚
â”‚   Get started by running:                                                    â”‚
â”‚                                                                              â”‚
â”‚   cd your-project-name                                                       â”‚
â”‚   npm start                                                                  â”‚
â”‚                                                                              â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¯¼èˆªåˆ°æ–°ç›®å½•å¹¶æŸ¥çœ‹åŒ…å«çš„æ–‡ä»¶ã€‚å®ƒåº”è¯¥çœ‹èµ·æ¥ç±»ä¼¼äºä¸‹é¢çš„æ ‘ã€‚

```
.
â”œâ”€â”€ assets
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ message.private.js
â”‚   â””â”€â”€ style.css
â”œâ”€â”€ functions
â”‚   â”œâ”€â”€ hello-world.js
â”‚   â”œâ”€â”€ private-message.js
â”‚   â”œâ”€â”€ sms
â”‚   â””    â””â”€â”€ reply.protected.js
â”œâ”€â”€ node_modules
â”‚   â”œâ”€â”€...
â”‚   â”œâ”€â”€...
â”‚   â””â”€â”€...
â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”œâ”€â”€ .nvmrc
â”œâ”€â”€ package-lock.json
â””â”€â”€ package.json 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ–°é¡¹ç›®åŒ…æ‹¬é…ç½®æ–‡ä»¶å’Œä¸¤ä¸ªä¸»ç›®å½•:`assets`å’Œ`functions`ã€‚è¿™äº›ç›®å½•ä¸­åŒ…å«çš„æ–‡ä»¶å°†[æ˜ å°„åˆ° Twilio å‡½æ•°å’Œèµ„äº§](https://www.twilio.com/docs/runtime#functions-assets-beta)ï¼Œåœ¨æ‚¨éƒ¨ç½²æœ¬åœ°æ–‡ä»¶åï¼Œå®ƒä»¬å°†åœ¨çº¿å¯ç”¨ã€‚ä¾‹å¦‚ï¼ŒJavaScript æ–‡ä»¶`./functions/hello-world.js`å°†åœ¨`/hello-world`å¯ç”¨ã€‚

### æ–‡ä»¶åå†³å®šäº†ä¸€åˆ‡â€”â€”å…¬å…±è®¿é—®ã€ç§äººè®¿é—®å’Œå—ä¿æŠ¤çš„è®¿é—®

ä¸€äº›ç”Ÿæˆçš„å‡½æ•°å’Œèµ„äº§åœ¨å®ƒä»¬çš„æ–‡ä»¶åä¸­åŒ…å«ä¸€ä¸ª`protected`æˆ–`private`å…³é”®å­—ã€‚æ— æœåŠ¡å™¨å·¥å…·åŒ…ä½¿ç”¨æ–‡ä»¶åè¯„ä¼°è®¿é—®æƒé™ï¼Œå¹¶åœ¨éƒ¨ç½²åçœç•¥å…¬å…± URL ä¸­çš„å…³é”®å­—ã€‚æ–‡ä»¶`/functions/sms/reply.protected.js`å°†äº§ç”Ÿä¸€ä¸ª`/sms/reply`ç«¯ç‚¹ã€‚

åŠŸèƒ½çš„è®¿é—®çº§åˆ«åŒ…æ‹¬:

*   `public`(é»˜è®¤)â€“å…¬å¼€å‘å¸ƒ
*   `protected`â€“ä»…å¯ç”± Twilio é€šè¿‡ webhooks ç­‰æ–¹å¼è®¿é—®

èµ„äº§çš„è®¿é—®çº§åˆ«æ˜¯:

*   `public` -å…¬å¼€å‘å¸ƒ
*   `private` -åªèƒ½é€šè¿‡ [`Runtime.getAssets()`](https://www.twilio.com/docs/runtime/client) è¿›å…¥åŠŸèƒ½å†…éƒ¨

æ‚¨å¯ä»¥åœ¨æ–‡æ¡£ä¸­æŸ¥çœ‹[åŠŸèƒ½](https://www.twilio.com/docs/runtime/functions-assets-api/api/function-version)å’Œ[èµ„äº§](https://www.twilio.com/docs/runtime/functions-assets-api/api/asset-version#assetversion-properties)çš„æ‰€æœ‰é…ç½®ã€‚

è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¿™ä¸ªæ–°é¡¹ç›®ï¼Œå®ƒåŒ…æ‹¬:

*   ä¸‰é¡¹èµ„äº§(å…¶ä¸­ä¸€é¡¹æ˜¯`private`ï¼Œä¸ä¼šå…¬å¼€è®¿é—®)
*   ä¸‰ä¸ªå‡½æ•°(å…¶ä¸­ä¸€ä¸ªæ˜¯`protected`ï¼Œä¸èƒ½å…¬å¼€è®¿é—®)

ç°åœ¨æ˜¯æ—¶å€™çœ‹çœ‹ä»–ä»¬éƒ½åšäº›ä»€ä¹ˆï¼Œå¹¶åœ¨æœ¬åœ°è¿è¡Œè¿™ä¸ªé¡¹ç›®äº†ï¼

## [](#a-fresh-twilio-runtime-right-on-your-computer)ä¸€ä¸ªå…¨æ–°çš„ Twilio åœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œ

å¼€å‘æœ¬åœ°æ— æœåŠ¡å™¨é¡¹ç›®æ€»æ˜¯ä¸€ä»¶ç—›è‹¦çš„äº‹æƒ…ã€‚å¹¸è¿çš„æ˜¯ï¼Œç°åœ¨æœ‰ä¸€ä¸ªå‘½ä»¤å¯ä»¥åœ¨æ‚¨çš„æœºå™¨ä¸Šæ¨¡æ‹Ÿ Twilio è¿è¡Œæ—¶ï¼Œä½¿å¾—å¼€å‘æ›´åŠ æ–¹ä¾¿ã€‚

åœ¨é¡¹ç›®å†…éƒ¨è¿è¡Œ`twilio serverless:start`ã€‚

```
twilio serverless:start
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                    â”‚
â”‚   Twilio functions available:                                      â”‚
â”‚   â”œâ”€â”€ /hello-world | http://localhost:3000/hello-world             â”‚
â”‚   â”œâ”€â”€ /private-message | http://localhost:3000/private-message     â”‚
â”‚   â””â”€â”€ [protected] /sms/reply | http://localhost:3000/sms/reply     â”‚
â”‚                                                                    â”‚
â”‚   Twilio assets available:                                         â”‚
â”‚   â”œâ”€â”€ /index.html | http://localhost:3000/index.html               â”‚
â”‚   â”œâ”€â”€ /style.css | http://localhost:3000/style.css                 â”‚
â”‚   â””â”€â”€ [private] /message.js | Runtime.getAssets()['/message.js']   â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

`twilio serverless:start`å‘½ä»¤å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œåˆ›å»ºå°†åœ¨è¿è¡Œæ—¶éƒ¨ç½²çš„ç«¯ç‚¹ï¼Œå¹¶é€šè¿‡æä¾›ç±»ä¼¼ [`Runtime`å®¢æˆ·ç«¯](https://www.twilio.com/docs/runtime/client)çš„ä¸œè¥¿æ¥æ¨¡æ‹Ÿç¯å¢ƒã€‚ä½ çš„`localhost`å°†ä¼šåƒ Twilio çš„åŸºç¡€è®¾æ–½ä¸€æ ·è¿è½¬ï¼ğŸ‰

å½“ä½ è®¿é—®æœ¬åœ°ç«¯ç‚¹æ—¶ï¼Œä½ ä¼šå‘ç°æ‰€æœ‰çš„å‡½æ•°éƒ½ç”¨ä¸€äº› [TwiML](https://www.twilio.com/docs/glossary/what-is-twilio-markup-language-twiml) æ¥å“åº”ï¼Œæ¶µç›–äº†æ—¥å¸¸ç”¨ä¾‹ï¼Œæ¯”å¦‚[å¯¹æ”¶åˆ°çš„çŸ­ä¿¡](https://www.twilio.com/docs/sms/twiml/message)è¿›è¡Œå›å¤ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›å‡½æ•°å¹¶æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œè°ƒæ•´ã€‚

[![Two browser windows â€“ one showing localhost:3000/index.html responding with instructions and localhost:3000/private-message returning some TwiML](../Images/eaf82d738d84c2c806f5690fea762ebe.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--0WyjOlrF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/T1p-QyhjOH6sVN2Y1JsNKL3p-cj09_u_n5hdLBxN6zLVG-.width-800.jpg)

å¦‚éœ€è¿›ä¸€æ­¥çš„è¯´æ˜å’Œè§£é‡Šï¼Œè¯·å¯¼èˆªè‡³åŒ…å«çš„èµ„äº§`[http://localhost:3000/index.html](http://localhost:3000/index.html)`ã€‚ç¤ºä¾‹ HTML é¡µé¢è®©æ‚¨æ›´æ·±å…¥åœ°äº†è§£æ— æœåŠ¡å™¨æ’ä»¶çš„åŠŸèƒ½ã€èµ„äº§å’ŒåŸºç¡€â€”â€”åº•å±‚å·¥å…·ï¼›twilio-run ã€‚

å…³äºæœ¬åœ°å¼€å‘çš„æœ€åä¸€ä»¶äº‹æ˜¯â€”`twilio serverless:start`æä¾›äº†è®¸å¤šæ ‡å¿—ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å¤„ç†ç¯å¢ƒå˜é‡ã€è°ƒè¯•å’Œå®æ—¶é‡è½½ã€‚å®ƒç”šè‡³å†…ç½®äº†æœ¬åœ°éš§é“å·¥å…· [ngrok](https://ngrok.com) ã€‚ç¡®ä¿ç”¨å‘½ä»¤`twilio serverless:start --help`æŸ¥çœ‹æ‰€æœ‰é€‰é¡¹æˆ–é˜…è¯»[è¿™ç¯‡æ–‡ç« ](https://www.twilio.com/blog/locally-developing-and-debugging-twilio-functions)ã€‚

åªéœ€ä¸¤ä¸ªå‘½ä»¤ï¼Œæ‚¨å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªæ–°çš„æœ¬åœ°æ— æœåŠ¡å™¨é¡¹ç›®ï¼Œè¯¥é¡¹ç›®å¯ä»¥æ ¹æ®ç‰¹å®šéœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚ä½†æ˜¯ä½ å¦‚ä½•æ‰©å±•è¿™ä¸ªé¡¹ç›®ï¼Œåˆ›å»ºæ–°çš„åŠŸèƒ½ï¼Œå¹¶åœ¨ä¸€ä¸ªæ— æœåŠ¡å™¨çš„ä¸–ç•Œä¸­è·å¾—ä¸€äº›å¦‚ä½•æ§åˆ¶ Twilio æœåŠ¡çš„çµæ„Ÿå‘¢ï¼Ÿ

## [](#create-new-functions-for-other-use-cases)ä¸ºå…¶ä»–ç”¨ä¾‹åˆ›å»ºæ–°åŠŸèƒ½

å¢åŠ æ›´å¤šåŠŸèƒ½çš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨`functions`æˆ–`assets`ç›®å½•ä¸­åˆ›å»ºé¢å¤–çš„æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹åƒæ‰‹å·¥æ“ä½œã€‚å¦‚æœæˆ‘å‘Šè¯‰ä½ æœ‰ä¸€ç§æ›´å¿«çš„æ–¹æ³•æ¥è®¾ç½®å‡½æ•°ï¼Œä½ ä¼šæ€ä¹ˆæƒ³ï¼Ÿ

å‘½ä»¤`twilio serverless:new`æœ‰åŠ©äºå‡å°‘é‡å¤ä»»åŠ¡çš„æ•°é‡ï¼Œå¹¶æä¾›äº†ä¸€ç§ä½¿ç”¨é¢„å®šä¹‰æ¨¡æ¿åˆ›å»ºæ–°åŠŸèƒ½çš„æ–¹æ³•ã€‚

```
twilio serverless:new 
? Select a template
  Hello Voice - Function to get you started with Twilio Prog. Voice
  Hello Messaging - Function to get you started with Twilio Prog. Messaging
  Never gonna give you up - Never gonna let you down. Plays a song to a phone call
â¯ Forward Call - Forwards an incoming call to another number
  Forward Message - Forwards incoming messages to another number
  Forward Message to Multiple Numbers - Forwards incoming messages to a set of numbers
  Forward Message to Email via SendGrid - Uses SendGrid to forward incoming messages via email
(Move up and down to reveal more choices) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é€‰æ‹©æ¨¡æ¿å’Œå‘½åç©ºé—´ç›®å½•åï¼Œå®‰è£…è¿‡ç¨‹å°†åˆ›å»ºæ–°æ–‡ä»¶ï¼Œå¹¶ç»™å‡ºå…¶ä»–å®‰è£…æ“ä½œçš„æç¤ºã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„æ¨¡æ¿éœ€è¦å®šä¹‰æŸä¸ªç¯å¢ƒå˜é‡ã€‚

```
twilio serverless:new
? Select a template Forward Call - Forwards an incoming call to another number
? What should be the namespace your function(s) are placed under? private
  âœ” Configuring Environment Variables in .env
  âœ” Installing Dependencies
  âœ” Creating function: forward-call.js
INFO Make sure to configure MY_PHONE_NUMBER in the .env file
SUCCESS Downloaded new template into the "new-service" subdirectories 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ‚¨å¸Œæœ›çœ‹åˆ°å“ªäº›åŠŸèƒ½ç”¨ä¾‹ï¼Ÿæ‰€æœ‰çš„åŠŸèƒ½æ¨¡æ¿éƒ½å¯ä»¥åœ¨ GitHub *ä¸Šæ‰¾åˆ°å¹¶ç¼–è¾‘*[â€”â€”æˆ‘ä»¬å¾ˆæƒ³å¬å¬ä½ çš„æƒ³æ³•ï¼](https://github.com/twilio-labs/function-templates)

åˆ›å»ºæ–°åŠŸèƒ½åï¼Œé€šè¿‡å†æ¬¡è¿è¡Œ`twilio serverless:start`é‡å¯æœ¬åœ°æœåŠ¡å™¨ã€‚æ–°ç«¯ç‚¹å°†åœ¨æœ¬åœ°å¯ç”¨ã€‚å¯¹äºä¸Šé¢çš„å‡½æ•°ï¼Œè¿™ä¸ªç«¯ç‚¹å°±æ˜¯`/private/forward-call`ã€‚

æœ¬åœ°å¼€å‘åªæ˜¯æ•…äº‹çš„ä¸€åŠâ€”â€”æ‚¨å¦‚ä½•å°†åŠŸèƒ½éƒ¨ç½²åˆ°äº‘ä¸­ï¼Œä»¥ä¾¿éšæ—¶æ‰©å±•ï¼Ÿ

## show timeâ€“éƒ¨ç½²ï¼Œéƒ¨ç½²ï¼Œéƒ¨ç½²ï¼

å½“æ‚¨å¯¹æœ¬åœ°åŠŸèƒ½å’Œèµ„äº§æ»¡æ„æ—¶ï¼Œè¿è¡Œ`twilio serverless:deploy`æ¥éƒ¨ç½²å®ƒä»¬ã€‚

```
twilio serverless:deploy

Deploying functions & assets to the Twilio Runtime

Account         SK6b3e6df6812298f87594567895e55ede
Token           kegH****************************
Service Name    serverless-tryout
Environment     dev
Root Directory  /private/tmp/serverless-tryout
Dependencies
Env Variables   MY_PHONE_NUMBER

âœ” Serverless project successfully deployed

Deployment Details
Domain: serverless-tryout-6774-dev.twil.io
Service:
   serverless-tryout (ZSc...)
Environment:
   dev (ZEa...)
Build SID:
   ZB8...
Functions:
   [protected] https://foo-6774-dev.twil.io/sms/reply
   https://serverless-tryout-6774-dev.twil.io/hello-world
   https://serverless-tryout-6774-dev.twil.io/forward-call/forward-call
   https://serverless-tryout-6774-dev.twil.io/private-message
Assets:
   [private] Runtime.getAssets()['/message.js']
   https://serverless-tryout-6774-dev.twil.io/index.html
   https://serverless-tryout-6774-dev.twil.io/style.css 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸€æ¡å‘½ä»¤å°†ä»£ç éƒ¨ç½²åˆ°äº‘ä¸­ï¼Œå¹¶åˆ›å»ºå…¬å…±å¯ç”¨çš„èµ„äº§å’ŒåŠŸèƒ½ç«¯ç‚¹ã€‚

å¦‚æœæ‚¨æƒ³è¦æ£€æŸ¥å·²éƒ¨ç½²çš„è¿è¡Œæ—¶ï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨`twilio serverless:list`å‘½ä»¤:

```
twilio serverless:list functions --service-sid=ZSc7...
Account      SK6b...
Token        kegH****************************
Service      ZSc7...
Environment  dev

Functions for environment ZEa5...

â”‚ /sms/reply [Visibility protected]
â”‚ /hello-world
â”‚ /private-message
â”‚ /forward-call/forward-call 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¯¥å‘½ä»¤æ¥å—å‡ ä¸ªé…ç½®é€‰é¡¹ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æ£€æŸ¥æ‚¨æ„Ÿå…´è¶£çš„ç¡®åˆ‡åŒºåŸŸã€‚å¦‚æœä½ æƒ³çœ‹çœ‹æœ‰å“ªäº›æ——å¸œï¼Œè®°ä½`--help`æ——å¸œå°†æ˜¯ä½ çš„æœ‹å‹ã€‚

å¦ä¸€ç§æ–¹æ³•æ˜¯å‰å¾€ Twilio æ§åˆ¶å°ä¸­çš„[å‡½æ•° API åŒºåŸŸï¼Œå¹¶åœ¨é‚£é‡ŒæŸ¥çœ‹ã€‚](https://www.twilio.com/console/functions/api)

[![Twilio Console showing the read-only UI for Twilio API deployed functions](../Images/a4f01b46487310410496e2a5fe0751e6.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--DVRL7AZl--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s3.amazonaws.com/com.twilio.prod.twilio-docs/images/zZZBlxVYo3EMuT7UyTLP-LB0I2cLM0vzsNS-R1Zqx5v2e2.width-800.jpg)

å¯¹åˆ›å»ºçš„ç«¯ç‚¹åŠå…¶æ–°åŸŸçš„æ›´æ·±å…¥çš„è§‚å¯Ÿæ¸…æ¥šåœ°æ˜¾ç¤ºäº†æ–°çš„ [å‡½æ•°å’Œèµ„äº§ API](https://www.twilio.com/docs/runtime/functions-assets-api) æ˜¯å¦‚ä½•æ„é€ çš„ï¼Œä»¥åŠå®ƒä¸ä»…æ”¯æŒ UI çš„[Twilio å‡½æ•°](https://www.twilio.com/docs/runtime/functions)æœ‰ä½•ä¸åŒã€‚è®©æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ã€‚

### [](#new-power-and-flexibility-with-environments)æ–°åŠŸèƒ½å’Œç¯å¢ƒé€‚åº”æ€§

æ–°éƒ¨ç½²çš„æœåŠ¡çš„é¢†åŸŸæ­ç¤ºäº†ä¸€ä¸ªé‡è¦çš„æ”¹è¿›ï¼Œè¿™æ˜¯ä»¥å‰æ²¡æœ‰çš„æ–° API å¸¦æ¥çš„ã€‚

```
 Random number
                          \  /
https://serverless-tryout-6774-dev.twil.io/sms/reply
        \        /             \ /
       Service name        Environment
                          Domain suffix 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ— æœåŠ¡å™¨ API æ”¯æŒT4ã€‘ç¯å¢ƒã€‚å½“æ‚¨åœ¨å‡ åˆ†é’Ÿå‰éƒ¨ç½²æ‚¨çš„é¡¹ç›®æ—¶ï¼ŒCLI ä½¿ç”¨é»˜è®¤å€¼ä½œä¸ºç¯å¢ƒâ€”`dev`ã€‚æ¯ä¸ªç¯å¢ƒéƒ½ç”±å®ƒè‡ªå·±çš„åŸŸæ¥è¡¨ç¤ºã€‚è¦éƒ¨ç½²å¦ä¸€ä¸ªç¯å¢ƒï¼Œä½¿ç”¨å¸¦æœ‰`serverless:deploy`å‘½ä»¤çš„`--environment`æ ‡å¿—ã€‚

ç¯å¢ƒç‰¹æ€§ç°åœ¨çœ‹èµ·æ¥å¯èƒ½æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼Œä½†åœ¨å°†æ¥ï¼Œå®ƒä¼šæ˜¯ä¸€ä¸ªå¤§é—®é¢˜ã€‚å½“æ‚¨è¿è¡Œå¤§å‹é¡¹ç›®ï¼Œè®¸å¤šå¼€å‘äººå‘˜åœ¨åŒä¸€ä¸ªæ— æœåŠ¡å™¨ä»£ç åº“ä¸Šå·¥ä½œæ—¶ï¼Œç¯å¢ƒæ˜¯è‡³å…³é‡è¦çš„ã€‚

ç”±äºæœ‰äº†ç¯å¢ƒï¼Œæ‚¨å¯ä»¥åœ¨ä¸å½±å“æ‚¨çš„ç”Ÿäº§è®¾ç½®çš„æƒ…å†µä¸‹ï¼Œåœ¨å®ƒä»¬è‡ªå·±çš„åŸŸä¸­æµ‹è¯•å’Œéƒ¨ç½²å˜æ›´ã€‚ç„¶åï¼Œåªæœ‰å½“æ‚¨å‡†å¤‡å¥½åˆ‡æ¢æ—¶ï¼Œæ‚¨æ‰å¯ä»¥ä½¿ç”¨å‘½ä»¤`twilio serverless:activate`å°†ä¸€ä¸ªç¯å¢ƒå‡çº§åˆ°å¦ä¸€ä¸ªç¯å¢ƒ(ä¾‹å¦‚`dev`åˆ°`prod`)ã€‚ç¯å¢ƒæ˜¯å‘è‡ªåŠ¨åŒ–å’Œå®æ–½é€‚å½“çš„ CI/CD å·¥ä½œæµè¿ˆå‡ºçš„ä¸€å¤§æ­¥ï¼Œå½“æ‚¨åœ¨æ›´å¤§è§„æ¨¡ä¸Šè¿è¡Œæ—¶ï¼Œè¿™ä¸¤ä¸ªè¿‡ç¨‹éƒ½æ˜¯å¼ºåˆ¶æ€§çš„ã€‚

å¦‚æœä½ æƒ³çœ‹çœ‹æ–° API çš„æ‰€æœ‰éƒ¨åˆ†æ˜¯å¦‚ä½•ç»„åˆåœ¨ä¸€èµ·çš„ï¼Œçœ‹çœ‹å‚è€ƒæ–‡æ¡£æˆ–å›´ç»•ä¸»é¢˜çš„[å¼ ç§€å¤Â·æ˜†å¾·å°”æ–¯çš„æ¼”è®²ã€‚](https://speakerdeck.com/dkundel/signal-19-leveraging-the-serverless-api-to-manage-your-deployment-process)

### Twilio è®¾ç½®çš„è‡ªåŠ¨åŒ–

æ–°çš„ Twilio è¿è¡Œæ—¶ API ä¸æ— æœåŠ¡å™¨å·¥å…·åŒ…ç›¸ç»“åˆï¼Œæ˜¯åœ¨ç°æœ‰åŸºç¡€æ¶æ„ä¸­è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ï¼Œç”šè‡³ä»å¤´å¼€å§‹åˆ›å»ºæ–°å®‰è£…çš„ç¼ºå¤±éƒ¨åˆ†ã€‚

å¦‚æœæˆ‘å‘Šè¯‰ä½ ï¼Œä½ ç°åœ¨å¯ä»¥ [è´­ä¹°å·ç ](https://www.twilio.com/docs/phone-numbers)ï¼Œåˆ›å»º [åŒæ­¥æœåŠ¡](https://www.twilio.com/sync)ï¼Œé€šè¿‡è¿è¡Œå•ä¸ªå‘½ä»¤çš„åŠŸèƒ½è¿æ¥ä½ çš„é€šä¿¡æ¸ é“ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œåªéœ€è¿è¡Œä¸€ä¸ª shell è„šæœ¬å°±å¯ä»¥å®Œæˆæ‰€æœ‰ä¸ Twilio ç›¸å…³çš„äº‹æƒ…ã€‚å—¯â€¦â€¦å‡ å¤©å‰æˆ‘å°±è¿™ä¹ˆåšäº†ï¼Œè¿™è®©æˆ‘ä»æ¤…å­ä¸Šç«™èµ·æ¥è¯´ï¼Œâ€œå¤ªå¥½äº†ï¼â€ã€‚æ³¨æ„ç©ºé—´ï¼Œæˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­å‘Šè¯‰ä½ å¦‚ä½•ç¼–å†™ Twilio è®¾ç½®è„šæœ¬ã€‚ğŸ‘‹

å¦‚æœä½ å’Œæˆ‘ä¸€æ ·å¯¹è¿™ä¸ªæ–° API æ„Ÿåˆ°å…´å¥‹ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ¸ é“è”ç³»åˆ°æˆ‘ã€‚

*   Email: [sjudis@twilio.com](//mailto:sjudis@twilio.com)
*   Github: [å¸æå](https://github.com/stefanjudis)
*   æ¨ç‰¹:t0 @ stefanjudisï¿¥t1