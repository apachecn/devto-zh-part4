# åˆ†å—åƒç†Š

> åŸæ–‡:[https://dev.to/thekashey/eat-bear-in-parts-3f0o](https://dev.to/thekashey/eat-bear-in-parts-3f0o)

> åˆ†éƒ¨åˆ†åƒç†Š=== **ä¸€æ­¥ä¸€ä¸ªè„šå°**

æˆ‘å¼€å§‹å†™è¿™ç¯‡æ–‡ç« å·²ç»æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå‡ºäºå¶ç„¶â€”â€”åªæ˜¯æƒ³åˆ†äº«ä¸€ä¸ªç®€å•çš„æ¦‚å¿µã€‚æˆ‘æŠŠã€Šæ–°ç”Ÿçš„æ–‡ç« ã€‹ç§°ä¸ºâ€œè®© Redux å†æ¬¡å˜å¾—ä¼Ÿå¤§â€ï¼Œå®ƒä»ç„¶æœ‰ä¸€éƒ¨åˆ†æ˜¯å…³äºå®ƒçš„â€”â€”è®©ä¸€äº›ä¸œè¥¿å˜å¾—æ›´å¥½ï¼Œå°±åƒå®ƒåº”è¯¥çš„é‚£æ ·ã€‚

æˆ‘æ­£åœ¨å†™è¿™ç¯‡æ–‡ç« ï¼Œè¿™é‡Œçš„ä¸€ä»¶äº‹ï¼Œæˆ–è€…é‚£é‡Œçš„å¦ä¸€ä»¶äº‹ï¼Œéœ€è¦ä¸€äº›â€œæ¾„æ¸…â€ã€‚é€šè¿‡è§£é‡Šç»†å¾®å·®åˆ«å’Œä½¿ç”¨çš„æœ¯è¯­ï¼Œæˆ–è€…æä¾›ä¸€äº›ä¾‹å­ï¼Œæˆ‘ä½¿è¿™ç¯‡æ–‡ç« æ¯”æˆ‘æ›¾ç»è®¡åˆ’çš„è¦å¤§å¾—å¤šã€‚æˆ‘åˆ›é€ äº†ä¸€ä¸ªå¤§çš„ğŸ»ç†ŠğŸ»ï¼Œå³ä½¿å½“æ—¶çš„æƒ³æ³•æ˜¯~æ‰“~åƒã€‚

è¿™ç¯‡æ–‡ç« ä»¥ç®€å•çš„å»ºè®®å¼€å§‹ï¼Œä½†å®ƒèƒŒåçš„ä¸»è¦æ€æƒ³ä»ç„¶æ˜¯å¦‚ä½•ä¿æŒäº‹æƒ…ç®€å•çš„å»ºè®®ã€‚ä¸æ˜¯ç®€å•çš„å¤§å»ºè®®ï¼Œè€Œæ˜¯ç”±ç®€å•çš„å»ºè®®æ„æˆçš„ã€‚

ä½ çŸ¥é“ï¼Œä½ è§£å†³ä¸äº†å¤§é—®é¢˜ï¼Œå¤§é—®é¢˜å¤ªå¤§äº†ï¼Œæ— æ³•è§£å†³ã€‚ä¹Ÿè®¸ä½ åº”è¯¥è§£å†³è¾ƒå°çš„é—®é¢˜â€”â€”åˆ†è€Œæ²»ä¹‹ï¼Œè§£å†³è¾ƒå¤§çš„é—®é¢˜ï¼Œæˆ–è€…åº”ç”¨è¢«ç§°ä¸º"[è´ªå©ª](https://en.wikipedia.org/wiki/Greedy_algorithm)"çš„æ¨¡å¼ã€‚

> è´ªå©ªç®—æ³•æ˜¯ä¸€ç§ç®—æ³•èŒƒä¾‹ï¼Œå®ƒéµå¾ªåœ¨æ¯ä¸ªé˜¶æ®µåšå‡ºå±€éƒ¨æœ€ä¼˜é€‰æ‹©çš„é—®é¢˜è§£å†³å¯å‘ï¼Œç›®çš„æ˜¯æ‰¾åˆ°å…¨å±€æœ€ä¼˜...ä½†æ˜¯å°½ç®¡å¦‚æ­¤ï¼Œè´ªå©ªè¯•æ¢æ³•å¯ä»¥åœ¨åˆç†çš„æ—¶é—´å†…äº§ç”Ÿè¿‘ä¼¼å…¨å±€æœ€ä¼˜è§£çš„å±€éƒ¨æœ€ä¼˜è§£ã€‚(è°¢è°¢ç»´åŸºç™¾ç§‘)

æ¢å¥è¯è¯´-ğŸ»**åˆ†ä»½åƒç†Š**ğŸ»ã€‚

* * *

Redux...æˆ‘ä¸çŸ¥é“è¿™å¯¹ä½ æ¥è¯´æ˜¯ä¸æ˜¯ä¸€ä¸ªå¥½è¯ï¼Œæˆ–è€…ï¼Œä½ çŸ¥é“ï¼Œâ€œr å­—â€...Redux æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„ä¸œè¥¿ï¼ŒRedux åšäº†ä¸€äº›é©å‘½ï¼ŒRedux è¢«è®¤ä¸ºæ˜¯æœ‰å®³çš„ï¼Œä½ ä¸éœ€è¦ Reduxã€‚å¼ºçƒˆçš„è§‚ç‚¹ï¼Œå¾®å¼±çš„æ”¯æŒã€‚

äººä»¬ç»å¸¸æŠ±æ€¨â€”â€”Redux å¸¦æ¥çš„æ˜¯ç—›è‹¦ï¼Œè€Œä¸æ˜¯å¿«ä¹ã€‚ä»–ä»¬åæ‚”æ›¾ç»ä½¿ç”¨å®ƒï¼Œå¹¶å‡†å¤‡å°½å¿«æŠ›å¼ƒå®ƒã€‚

...ä½†æ˜¯è®©æˆ‘ä»¬ä»”ç»†æ£€æŸ¥ä¸€äº›äº‹æƒ…ã€‚

> è¿™ç¯‡æ–‡ç« ä¸æ˜¯å…³äº Reduxï¼Œè€Œæ˜¯å…³äºâ€œRedux ä¹‹é“â€ã€‚ä½ å¿…é¡»**æ€è€ƒ**çš„æ–¹å¼ï¼Œè®©æˆ‘ä»¬ç§°ä¹‹ä¸ºï¼Œå¯¹å®ƒæ„Ÿåˆ°æ»¡æ„ã€‚

## [](#selectors)é€‰æ‹©å™¨

æ²¡æœ‰é€‰æ‹©å™¨çš„ Redux éå¸¸æ…¢ï¼Œæœ‰äº†é€‰æ‹©å™¨ä¹Ÿä¸ä¼šå¥½åˆ°å“ªé‡Œå»ï¼Œåªè¦æˆ‘ä»¬çš„é€‰æ‹©å™¨å¹¶ä¸æ€»æ˜¯è¢«æ­£ç¡®å®šä¹‰(å¯¹è‡ªå·±è¯šå®)ã€‚åˆ›å»ºå®Œç¾çš„é€‰æ‹©å™¨å¹¶ä¸å®¹æ˜“ï¼Œå°¤å…¶æ˜¯ä½¿ç”¨æˆ‘ä»¬ç°æœ‰çš„åº“å’Œæ¨¡å¼ã€‚

å¦‚æœæ²¡æœ‰åˆé€‚çš„é€‰æ‹©å™¨ï¼Œå°±æ— æ³•è¾¾åˆ°åˆé€‚çš„è®°å¿†çº§åˆ«ï¼ŒRedux ä¼šå¯¼è‡´é”™è¯¯çš„è‚¯å®šæ›´æ–°ä¼ æ’­ã€‚è¿™å°±æ˜¯å®ƒçš„è®¾è®¡å·¥ä½œæ–¹å¼ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªé‡å¤çš„é—®é¢˜â€”â€”ä»»ä½•â€œå•ä¸€æ¥æºäº‹ä»¶ä¼ æ’­â€çš„ä¸œè¥¿(æˆ‘çœ‹ç€ä½ ï¼Œååº”ä¸Šä¸‹æ–‡)éƒ½æ˜¯å—å®³è€…ã€‚

é—®é¢˜ä¸åœ¨äº`memoization`æœ¬èº«ï¼Œè€Œåœ¨äºâ€œä½ â€â€”â€”ä½ çš„æœŸæœ›(ä½ å¸Œæœ›å®ƒå¼€ç®±å³ç”¨)ï¼Œä»¥åŠä½ å¿…é¡»è‡ªå·±åŒ¹é…çš„æœŸæœ›(Redux ç”¨æˆ·ä¼šä»¥é€‚å½“çš„æ–¹å¼ä½¿ç”¨ Redux åº“)ã€‚

> Redux çŠ¯äº†ä¸€ç‚¹å°é”™è¯¯ã€‚å®ƒåº”è¯¥è°ƒç”¨ä¸¤æ¬¡`mapStateToProps`å¹¶æ¯”è¾ƒç»“æœã€‚å¦‚æœç»“æœä¸åŒ¹é…ï¼Œé‚£ä¹ˆ`mapStateToProps`å°±ä¸åƒå®ƒé¢„æœŸçš„é‚£æ ·çº¯å‡€ï¼Œé‚£å°±æ˜¯ä½ åšé”™äº†ã€‚JFYI React å¯¹é’©å­åšäº†å®Œå…¨ç›¸åŒçš„äº‹æƒ…ï¼Œ*ä¿æŠ¤*ä½ ã€‚

é€šå¸¸â€”â€”è¿™æ˜¯é‡è¦çš„ä¸€éƒ¨åˆ†â€”â€”æ£€æŸ¥è®°å¿†çš„è´¨é‡(æˆ–å­˜åœ¨)ï¼Œå—¯...ï¼Œè·³è¿‡ã€‚æˆ–è€…å¼€å‘äººå‘˜æœªèƒ½ä¿®å¤ä¸€äº›è¾¹ç¼˜æƒ…å†µï¼Œå¹¶æ”¾å¼ƒäº†å®ƒã€‚ç»“æœå¹¶ä¸ä»¤äººæ•¬ç•â€”â€”ä½ å’Œä½ çš„ç”¨æˆ·éƒ½ä¸é«˜å…´ã€‚

å¸¸è§çš„è®°å¿†é—®é¢˜æœ‰:

*   å•ä¸€é«˜é€Ÿç¼“å­˜è¡Œã€‚å‡ ä¹æ‰€æœ‰çš„è®°å¿†åº“éƒ½åªå­˜å‚¨æœ€åçš„ç»“æœï¼Œè¿™(å³ä½¿æ˜¯æ­£ç¡®çš„å†³å®š)ä¸â€œç»„ä»¶æ–¹æ³•â€ä¸å¤ªå…¼å®¹ã€‚
*   APIã€‚ä¾‹å¦‚ï¼Œ`reselect`çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§â€”â€”è®°å¿†çº§è”â€”â€”è¦æ±‚**æ‰€æœ‰çš„**é€‰æ‹©å™¨æ‹¥æœ‰ç›¸åŒçš„æ¥å£ã€‚å—¯â€”â€”è¿™è®©ä¸€åˆ‡éƒ½å˜å¾—è‚®è„...ç ´ç¢äº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå”¯ä¸€çš„å…¬å…±æ¥å£æ˜¯`props`â€”â€”ä½ å¿…é¡»ä¼ é€’ä¸€ä¸ªå¡«å……äº† *everything* çš„å¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè€Œå®ƒ**åº”è¯¥æ˜¯ä¸€ä¸ªç±»å‹ä¸º number çš„`todoId`ã€‚è¿™ä¸ä»…æ˜¯æŸç§æŠ½è±¡çš„æ³„æ¼ï¼Œè€Œä¸”åœ¨æ²¡æœ‰æ”¹å˜å±æ€§æ¯”è¾ƒå‡½æ•°çš„æƒ…å†µä¸‹(é»˜è®¤æ˜¯ shallow equal)ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è¡Œä¸é€šçš„ã€‚ä½ å¯ä»¥åœ¨ Mark Erikson çš„[æƒ¯ç”¨çš„ Redux:ä½¿ç”¨é‡é€‰é€‰æ‹©å™¨å®ç°å°è£…å’Œæ€§èƒ½](https://blog.isquaredsoftware.com/2017/12/idiomatic-redux-using-reselect-selectors/)ä¸­è¯»åˆ°æ›´å¤šï¼Œä½†æ˜¯ï¼Œä¸å¹¸çš„æ˜¯ï¼Œé‚£é‡Œæ²¡æœ‰ç­”æ¡ˆã€‚**

ä½†æ˜¯æœ‰åå‡ ç§å…¶ä»–çš„æ–¹æ³•å¯ä»¥â€œä¿®å¤â€è®°å¿†ï¼Œä½ åº”è¯¥çŸ¥é“:

*   [redux-views](https://github.com/josepot/redux-views) å¯ä»¥åœ¨å‡ è¡Œä¸­ä»¥â€œé‡æ–°é€‰æ‹©â€çš„æ–¹å¼ä¿®å¤æ‚¨çš„é‡æ–°é€‰æ‹©ã€‚åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šç»†èŠ‚- [æˆ‘ä»¬éœ€è¦æ›´å¥½çš„å†—ä½™é€‰æ‹©å™¨](https://medium.com/@josepot/we-need-better-redux-selectors-457a1ed10732)
*   ç¾ä¸½-ååº”-è¿˜åŸæˆ–[ååº”-ååº”-è¿˜åŸ](https://github.com/dai-shi/reactive-react-redux)æ ¹æœ¬ä¸éœ€è¦ä»»ä½•é€‰æ‹©å™¨ï¼Œä¸¤è€…éƒ½ä½¿ç”¨ç›¸åŒçš„åŸºäºä»£ç†çš„è·Ÿè¸ªã€‚
*   éšæ„é˜…è¯»æ›´å¤šå…³äºè®°å¿†é—®é¢˜çš„æ–‡ç« [è®°å¿†é—å¿˜ç‚¸å¼¹](https://dev.to/thekashey/memoization-forget-me-bomb-34kh)

ä½†æ˜¯ä½ åº”è¯¥æ˜ç™½å…³äº`selectors`çš„ä¸€ä»¶äº‹â€”â€”å®ƒä»¬ä¸ä»…ä»…æ˜¯ä¸ºäº†è®°å¿†ï¼Œè®°å¿†åœ¨è¿™é‡Œåªæ˜¯ä¸€ä¸ªå®ç°ç»†èŠ‚ã€‚é€‰æ‹©å™¨åœ¨è¿™é‡Œä»æ•°æ®ä¸­æŠ½è±¡å‡ºç”¨æˆ·ç•Œé¢ã€‚åœ¨ [redux-starter-kit](https://github.com/reduxjs/redux-starter-kit) æˆ– [Dan Abramov çš„â€œæƒ¯ç”¨ reduxâ€è§†é¢‘ç³»åˆ—](https://egghead.io/lessons/javascript-redux-colocating-selectors-with-reducers)ä¸­ï¼Œä½ ç”šè‡³å¯ä»¥æœŸæœ›*å°†*å‡é€Ÿå™¨å’Œé€‰æ‹©å™¨æ”¾åœ¨*ç‰‡*ä¸­ã€‚

é€‰æ‹©å™¨æ˜¯ä¸ºäº†ä¿æŒä½ çš„ UI ç»„ä»¶ç®€å•ï¼Œå³ä½¿ä½ çš„æ•°æ®å¹¶ä¸ç®€å•ã€‚

> UI-è¿æ¥-å­˜å‚¨ã€‚åƒ 1-2-3 ä¸€æ ·ç®€å•ã€‚

ä½†æ˜¯äººä»¬å¿˜è®°äº†è¿™ä»¶äº‹ã€‚

## [](#data)æ•°æ®

å…³äºé€‰æ‹©å™¨çš„ç¬¬äºŒä¸ªé‡è¦æ—¶åˆ»æ˜¯**å®ƒä»¬è¿”å›çš„æ˜¯ä»€ä¹ˆ**â€”`data`ï¼Œå¹¶ä¸”`data`æ˜¯å†…å­˜åŒ–é—®é¢˜çš„æ¥æºâ€”â€”ä½ å¿…é¡»æ€»æ˜¯è¿”å›ç›¸åŒçš„ç»“æœã€‚

æˆ‘ä»¬åˆšåˆšå°±è®°å¿†åŒ–è¿›è¡Œäº†ä¸€æ¬¡å¯¹è¯ï¼Œè¿™æ¬¡æˆ‘æƒ³é—®å¦ä¸€ä¸ªé—®é¢˜â€”â€”â€œä½ éœ€è¦é‚£äº›æ•°æ®å—â€ï¼Ÿ

ä¸€ä¸ªç®€å•çš„ä¾‹å­â€”â€”`Todo List`â€”â€”å®ƒéœ€è¦ä»€ä¹ˆä½œä¸ºè¾“å…¥ï¼Ÿtodos æ•°ç»„ï¼Ÿæ•°ç»„ä»€ä¹ˆçš„ï¼Ÿåªæ˜¯æ•°ç»„çš„é•¿åº¦ï¼Ÿ

â€œè§†æƒ…å†µè€Œå®šâ€(æœ‰å²ä»¥æ¥æœ€å¥½çš„å›ç­”ï¼Œbtw):

*   åœ¨ç°å®ä¸­ï¼Œè®¸å¤šâ€œå®¹å™¨â€åªéœ€è¦`length`æ¥å†³å®šå®ƒä»¬è¦æ¸²æŸ“ä»€ä¹ˆ- `ListOfElements` + `Pagination`ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½ä¸ç”¨åšã€‚
*   æ¯” TodoList å°ä¸¤å€çš„`ListOfElements`ï¼Œå¯èƒ½éœ€è¦`ids`ä¸ªå…ƒç´ æ¥æ¸²æŸ“ï¼ŒåŸºæœ¬ä¸Šæ˜¯ç”¨å®ƒä»¬ä½œä¸º`keys`æ¥æé«˜æ¸²æŸ“æ•ˆç‡ã€‚
*   æœ‰ä»€ä¹ˆä¸œè¥¿éœ€è¦æ•°ç»„`Todos`ï¼Ÿæ²¡æœ‰ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚é™¤äº†`Todo`æœ¬èº«ã€‚

å‡ ä¹æ¯ä¸ªäººéƒ½çŠ¯è¿‡è¿™æ ·çš„é”™è¯¯â€”â€”æä¾›å¤æ‚çš„å¯¹è±¡ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™æ³„éœ²åº•å±‚ç»“æ„(å’ŒæŠ½è±¡)ç»™ UIã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„ä»£ç 

```
const TodoHeader = () => (
 <section>
   <button>Add todo</button>  <section>
);

const TodoFooter = ({count}) => (
 <section>
   There is {count} todos found, have a great day!
 <section>
);

const TodoList = ({todos}) => (
 <>
  <TodoHeader />
  {todos.map(todo => <Todo key={todo.id} action={todo.action} />)}
  <TodoFooter count={todos.length} />
 </>  );

<TodoList todos={[allMyTodos]} /> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

çœ‹èµ·æ¥ä¸é”™ï¼Œç»å¯¹æ ‡å‡†ã€‚æˆ‘æƒ³è¿™å°±æ˜¯ä½ çš„é›¶ä»¶çš„æ ·å­ã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬åªæ”¹å˜ä¸€è¡Œå‘¢ï¼Ÿ

```
const TodoList = ({count, children}) => (
 <>
  <TodoHeader />
  {children} // this line
  <TodoFooter count={count} />
 </>  );

<TodoList todoCount={allMyTodos.length}>
 {allMyTodos.map(todo => <Todo key={todo.id} action={todo.action} />)} </TodoList> 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™æ ·æ›´ç®€å•å—ï¼Ÿå¥½ç‚¹äº†å—ï¼Ÿæˆ‘å·²ç»ä»ä¸€ä¸ªç»„ä»¶åˆ›å»ºäº†ä¸¤ä¸ªç»„ä»¶ï¼Œæˆ‘å¯èƒ½åº”è¯¥è§£é‡Šä¸€ä¸‹è‡ªå·±â€”â€”â€œä¸ºä»€ä¹ˆæˆ‘è¦æŠŠç®€å•ä»£ç å˜å¾—æ›´å¤æ‚ï¼Ÿâ€ã€‚

> è¿™å®é™…ä¸Šæ˜¯â€œæ§åˆ¶åè½¬â€(IoT)ï¼Œåœ¨è¿™é‡Œä½ æ˜¯*â€œå°†æ§åˆ¶æƒäº¤è¿˜ç»™ä½ çš„ç»„ä»¶çš„ç”¨æˆ·ï¼Œä»¥ä»–ä»¬è®¤ä¸ºåˆé€‚çš„æ–¹å¼å®ç°å’Œå®šåˆ¶å®ƒâ€*ã€‚æƒ³æƒ³çœ‹â€”â€”`children`é‡Œé¢çš„`TodoList`è¢«å®šä¹‰åœ¨äº†ç»å¯¹ä¸åŒçš„åœ°æ–¹ã€‚æ‚¨ä¸å¿…æ‰§è¡Œ**é“å…·é’»å­”**æ¥ä¸ºå¦ä¸€ä¸ªç»„ä»¶å†…çš„ç»„ä»¶æä¾›é¢å¤–çš„é“å…·ï¼Œåªè¦è¯¥ç»„ä»¶ğŸ™€**æ˜¯å¤–é¢çš„**ğŸ™€ã€‚æ‰¾åˆ°äº†[è¿™é‡Œ](https://medium.com/the-non-traditional-developer/your-react-components-are-doing-too-much-16e65968f419)ï¼Œä½ å¯ä»¥é˜…è¯»æ›´å¤šå…³äº[æ”¯æŸ±é’»å­”è¿™é‡Œ](https://kentcdodds.com/blog/prop-drilling)ã€‚

è¿™é‡Œæ­£ç¡®çš„é—®é¢˜åº”è¯¥æ˜¯[ä½•æ—¶å°†ä¸€ä¸ªç»„ä»¶åˆ†è§£æˆå¤šä¸ªç»„ä»¶](https://kentcdodds.com/blog/when-to-break-up-a-component-into-multiple-components)ã€‚æˆ‘æŒ‡çš„æ˜¯è‚¯ç‰¹Â·cÂ·å¤šå…¹çš„æ–‡ç« ï¼ŒåŒæ ·ï¼Œè¿™ç¯‡æ–‡ç« æ²¡æœ‰æä¾›ä»»ä½•*å¯è¡Œçš„*ç­”æ¡ˆã€‚

æ‰“ç ´ç»„ä»¶æ˜¯ä¸€ä¸ªéå¸¸å›ºæ‰§å·±è§çš„è¿‡ç¨‹-æœ‰æ—¶æ›´å®¹æ˜“ç†è§£ç²—ç³™çš„ç»„ä»¶ï¼Œä½†æœ‰æ—¶æ›´å¤šçš„â€œå£°éŸ³å’Œå°–é”â€ä¼šæ›´æ–¹ä¾¿ã€‚è¿™ä¸ä¸ªäººå–œå¥½æ— å…³ï¼Œè¿™ä¸ä½ è„‘æµ·ä¸­çš„â€œå›¾ç‰‡â€çš„å¤§å°æœ‰å…³ã€‚å—¯ï¼Œäººç±»çš„å¤§è„‘å¯¹æ­¤å¹¶ä¸æ“…é•¿ã€‚

ä½†æˆ‘è‡³å°‘æœ‰ 3 ä¸ªå¥½ç­”æ¡ˆç»™ä½ :

*   **ç¬¬ä¸€ä¸ª**æ˜¯ä¸€ä¸ªåˆ†è£‚ï¼Œç„¶åå®ƒæ˜¯ä¸€ä¸ªä»¥ä¸Šçš„ç»„ä»¶ã€‚å¦‚ä½•æ£€æµ‹ï¼Ÿå—¯ï¼Œå¤šä¸ªè¿”å›ç‚¹æ˜¯ä¸€ä¸ªç”œèœœç‚¹ã€‚

> ![Dinesh profile image](../Images/aac4da05efbfdaee5f51c9a1b778b55c.png)Dinesh[@ flexdinesh](https://dev.to/flexdinesh)![twitter logo](../Images/4c8a2313941dda016bf4d78d103264aa.png)React Todayâ€”
> 
> å¦‚æœä½ ä¸èƒ½æŠŠæ‰€æœ‰çš„ jsx æ”¾åœ¨ä¸€èµ·ï¼Œå°±æŠŠå®ƒä»¬è§£å‹æˆå•ç‹¬çš„ç»„ä»¶ã€‚ä¸è¦ç¼–å†™æœ‰æ¡ä»¶åœ°è¿”å›ä¸åŒ JSX çš„æ–¹æ³•ã€‚è¿™è®©è°ƒè¯•å˜æˆäº†ä¸€åœºå™©æ¢¦ã€‚2019 å¹´ 7 æœˆ 24 æ—¥ä¸Šåˆ 00:38[![Twitter reply action](../Images/44d8b042100e231770330321e5b63d65.png)](https://twitter.com/intent/tweet?in_reply_to=1153826744920489985)[![Twitter retweet action](../Images/93d9c70ccc54851d2e8e881b53c21dae.png)](https://twitter.com/intent/retweet?tweet_id=1153826744920489985)[![Twitter like action](../Images/2e93f7775eadefab8bcd34a4542cc5a7.png)](https://twitter.com/intent/like?tweet_id=1153826744920489985)

> ç„¶è€Œï¼Œè¿™ä¸ªå»ºè®®å¹¶ä¸å®Œå…¨é€‚ç”¨äºç±»ç»„ä»¶ï¼Œåœ¨ç±»ç»„ä»¶ä¸­ï¼Œä½ å¯èƒ½æœ‰è®¸å¤šç±»æ–¹æ³•ï¼Œåšå®ƒä»¬çš„å°å·¥ä½œæ¥ä¸ºä¸€ä¸ªå¤§çš„`render`å‡½æ•°ç»„è£…ç»“æœã€‚åŒæ ·çš„å¤šä¸ªç»„ä»¶â€”â€”å®ƒä»¬ç”šè‡³çœ‹èµ·æ¥æ˜¯åŒæ ·çš„å°åŠŸèƒ½â€”â€”åªèƒ½å¤Ÿä½¿ç”¨ä¸€ä¸ª`this.props`å’Œä¸€ä¸ªä¸ºæ‰€æœ‰äººå…±äº«çš„`this.state`ã€‚

*   ç¬¬äºŒä¸ªï¼Œä¹Ÿæ˜¯æœ€æ£’çš„ä¸€ä¸ªâ€”â€”**å‹¾æ‰‹**ã€‚é’©å­æœ‰ä¸€ä¸ªç®€å•çš„è§„åˆ™- **é’©å­è§„åˆ™** -å½“ä½ ä¸èƒ½æ”¹å˜å®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ—¶ã€‚ç”¨ä¸€ç§*é¡ºå‘é€»è¾‘å’Œ*é¡ºå‘é€»è¾‘ä½ èƒ½åˆ›é€ å¤šå°‘ï¼Ÿå¾ˆæ¸…æ¥š-ä¸å¤šã€‚é’©å­é¼“åŠ±ä½ æŠŠäº‹æƒ…ä¿æŒåœ¨ä¸€ä¸ªåˆç†çš„ç•Œé™å†…ï¼Œä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹ï¼Œåœ¨é‚£é‡Œä½ ä¸ä¼šç»•è¿‡å®ƒä»¬çš„æ³•åˆ™ã€‚åŸºäºé’©å­çš„ç»„ä»¶å‡ ä¹æœ‰å¤©ç”Ÿçš„å¤æ‚æ€§é™åˆ¶ã€‚

*   æœ€åä¸€ä¸ªï¼Œ**ç¬¬ä¸‰ä¸ª**ï¼Œç­”æ¡ˆæ˜¯**æ•°æ®**â€”â€”å¦‚æœä½ çš„ç»„ä»¶çš„ä¸åŒéƒ¨åˆ†éœ€è¦ä¸åŒçš„æ•°æ®ï¼Œæˆ–è€…ä»–ä»¬éœ€è¦çš„æ•°æ®æ˜¯ä»å¦ä¸€ä¸ªæ•°æ®æ´¾ç”Ÿå‡ºæ¥çš„ï¼Œå› æ­¤ä»–ä»¬å®é™…ä¸Šéœ€è¦ä¸åŒçš„ä¸œè¥¿â€”â€”é‚£ä¹ˆå¯èƒ½æ˜¯å‡ ä¸ªä¸åŒçš„ç»„ä»¶åˆå¹¶åœ¨ä¸€èµ·ã€‚ä¸ºä»€ä¹ˆ

è®©æˆ‘ä»¬å›å¿†ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç :

```
// That's not a "list" - it has Menu at the Header
const TodoContainer = ({count, children}) => (
 <>
  <TodoHeader />
  {children}
  <TodoFooter count={count} />
 </>  );

const TodoList = ({todos}) => (
 todos.map(todo => <Todo key={todo.id} action={todo.action} /> )

// we are "deriving" `todoCount` from `allMyTodos.length`
const Todos = ({ todos }) => (
  <TodoContainer todoCount={todos.length}>
   <TodoList todos={todos} />
  </TodoContainer >  ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿›è¡Œä¸‹ä¸€æ­¥ï¼Œç¨å¾®é‡æ„ä¸€ä¸‹è¿™æ®µä»£ç :

```
// just add one more prop - `displayCount`
// "derived" props are "derived" elsewhere, not here.
- const Todos = ({ todos }) => ( + const Todos = ({ displayCount, todos }) => (
  <TodoContainer todoCount={displayCount}>
    <TodoList todos={todos} />
  </TodoContainer > 
);

export default connect(
 state => ({
   displayCount: state.todos.length, // imagine a selector
   todos: state.todos, // imagine a selector
}))(Todos) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨æ¯ä¸ªéƒ¨åˆ†åªæ¶ˆè€—å®ƒæ‰€éœ€è¦çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä¸å†æ··åˆä¸œè¥¿ï¼Œå¹¶å¯¹æˆ‘ä»¬çš„ç”¨æˆ·ç•Œé¢æœ‰æ›´å¤šçš„æ§åˆ¶ã€‚

å¯èƒ½ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆ`displayCount`åº”è¯¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„é“å…·æå–ï¼Œæ‰€ä»¥å¯ä»¥å›ç­”ä¸€ä¸ªç®€å•çš„é—®é¢˜â€”â€”å¦‚æœ`todo.length`è¾¾åˆ° 10000 ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘å¸Œæœ›-åˆ†é¡µã€‚ä½ å°†å¦‚ä½•å®ç°åˆ†é¡µï¼Œæˆ–è€…æ›´å…·ä½“åœ°è¯´ï¼Œåœ¨å“ªé‡Œâ€”â€”åœ¨`Todos`çº§è¿˜æ˜¯`TodoList`çº§ï¼Ÿåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œ`todo.length`ä»ç„¶ä¼šåæ˜ â€œæ­£ç¡®â€çš„ä»·å€¼ï¼Œä½†æ˜¯åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šã€‚

ä½ ä¼šé€‰æ‹©å“ªç§æƒ…å†µï¼ŸæŠ±æ­‰ï¼Œä½†æˆ‘ä¸ç›¸ä¿¡ä»»ä½•é¥è¿œçš„æœªæ¥é¢„æµ‹ï¼Œå› æ­¤å¦ä¸€ä¸ªé—®é¢˜â€”â€”å“ªç§æƒ…å†µæ›´èƒ½è¯æ˜æœªæ¥*çš„ä¸å¯é¢„æµ‹æ€§ï¼ŸWell - where `displayCount`æ²¡æœ‰ç»‘å®šåˆ°`todos`ã€‚è¿™ç§æƒ…å†µä¸‹æ›´**ä¼˜åŒ–çš„å˜åŒ–**ã€‚*

> å¦‚æœæ‚¨å°†åœ¨æœåŠ¡å™¨ç«¯å®ç°åˆ†é¡µä¼šæ€æ ·ï¼Ÿä½ å°†ä»ä¸€ä¸ªç«¯ç‚¹å¾—åˆ° N ä¸ª todosï¼Œæ¯”å¦‚`/todos/get/:page`ï¼Œä»ç±»ä¼¼`/todos/stat`çš„åœ°æ–¹å¾—åˆ°æ€»æ•°ã€‚ğŸ˜‰â€œä¸ºå˜åŒ–è€Œä¼˜åŒ–â€

ä½†æ˜¯è®©æˆ‘ä»¬æŒ‘é€‰å¦ä¸€ä¸ªä¾‹å­ï¼Œä»ä¸€ä¸ªç¨å¾®ä¸åŒçš„è§’åº¦æ¥å°è¯•è¿™ä¸ªé—®é¢˜â€”â€”è®©æˆ‘ä»¬**è·å–ä¸€äº›å…³äºç»„ä»¶å®‰è£…çš„æ•°æ®**ã€‚

```
const Component = ({page, pageData}) => {
  useEffect(() => 
    dispatchDataLoading(page.id);
  }, [page.id]

  return <Page>{pageData}</Page> }

// connect this Component somehow 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™é‡Œæˆ‘ä»¬ç”¨*å¯¹`page.id`å€¼çš„*ä½œå‡ºååº”ï¼Œåˆ†æ´¾ä¸€äº›äº‹ä»¶æ¥è·å–æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼Œå¹¶æœ€ç»ˆç”¨è·å–çš„æ•°æ®å‘ˆç°è¿™ä¸ªç»„ä»¶ã€‚
å’Œ**ä¸¤æ¬¡**æˆ‘ä»¬éƒ½åœ¨åšä¸¤å€äºæˆ‘ä»¬éœ€è¦çš„äº‹æƒ…â€”â€”è¯•å›¾æ¸²æŸ“ä¸å†å­˜åœ¨çš„æ•°æ®ï¼Œæˆ–è€…è¯•å›¾åŠ è½½æˆ‘ä»¬è¿˜ä¸éœ€è¦çš„ä¸œè¥¿ã€‚

ç®€è€Œè¨€ä¹‹â€”â€”è¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„ç»„ä»¶â€”â€”ä¸€ä¸ªè§†å›¾ç»„ä»¶å’Œä¸€ä¸ªâ€œå…„å¼Ÿæ•ˆåº”â€ç»„ä»¶ã€‚

```
const SiblingEffectComponent = ({page}) => {
  useEffect(() => 
    dispatchDataLoading(page.id);
  }, [page.id]

}

const ViewComponent = ({pageData}) => {
  return <Page>{pageData}</Page> }

const Component = ({page, pageData}) => (
  <>
   <SiblingEffectComponent page={page}/>
   <ViewComponent data={data} />
  </> );
// connect this Component somehow 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ç§é‡æ„è¿˜æœ‰å¦ä¸€ä¸ªæœ‰è¶£çš„æ•ˆæœâ€”â€”ç°åœ¨ä½ å¯ä»¥åœ¨æ¸²æŸ“è§†å›¾ä¹‹å‰åœ¨å…„å¼Ÿ**ä¸­æ‰§è¡Œæ•ˆæœâ€”â€”å®ƒä»¬ä¸å†ç›¸äº’ç»‘å®šã€‚ç„¶è€Œï¼Œå®ƒä»ç„¶æ˜¯ç›¸åŒçš„â€œæ¸²æŸ“å‘¨æœŸâ€ã€‚
æ•°æ®æ›´æ–°ä¼ æ’­ä¹Ÿæ˜¯åˆ†å¼€çš„ï¼Œç°åœ¨æ‚¨å¯ä»¥ç”¨`React.memo`åŒ…è£…ä¸¤ä¸ªç»„ä»¶ï¼Œè¿™æ¬¡**å¯ä»¥å·¥ä½œ**ï¼Œå› ä¸ºé•¿æ•°æ®æ›´æ–°ä¹Ÿæ˜¯åˆ†å¼€çš„ã€‚**

å°†ä¸€äº›å‰¯ä½œç”¨*æ”¾åˆ°ä¸€è¾¹*â€”â€”è¿™æ˜¯ä¸€ä¸ªç®€å•ä¸”éå¸¸å¼ºå¤§çš„è§£å†³æ€§èƒ½é—®é¢˜çš„æ¨¡å¼ï¼Œè®©åº”ç”¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†åªå“åº”å®ƒä»¬éœ€è¦çš„ä¸œè¥¿ã€‚å…„å¼Ÿå§å¦¹ç»„æˆäº†å®¶åº­ã€‚

> ä¿æŒ UI ç®€å•â€”â€”ä¿æŒæ•°æ®ç®€å•ã€‚è¿™å¯èƒ½éœ€è¦åˆ›å»ºä¸¤æ¬¡ä»¥ä¸Šçš„é€‰æ‹©å™¨ï¼Œä½†æ˜¯...ä½†æ˜¯è¿™æœ‰å¸®åŠ©å—ï¼Ÿ

## [](#storybook)æ•…äº‹ä¹¦

å¾ˆå¤šæ¬¡å¬åˆ°å…³äº`Redux`å’Œ`Storybook`çš„æŠ±æ€¨ã€‚å°±åƒå¾ˆéš¾ç»™`story`æä¾›åˆé€‚çš„å˜²è®½`Store`ã€‚æˆ–è€…ï¼Œå¦‚æœä¸æä¾›ï¼Œé‚£ä¹ˆç»´æŒã€‚çœŸå®æ•…äº‹ï¼

è™½ç„¶æœ‰å¤§çš„â€œç«¯åˆ°ç«¯â€çš„æ•…äº‹ï¼Œä¸‹é¢æœ‰ä¸€ä¸ªçœŸå®çš„çŠ¶æ€ï¼Œä½†è¿™æ˜¯å¾ˆå¥½çš„â€”â€”ä½ ä¸å¿…åœ¨ä»»ä½•äº‹æƒ…ä¸Šéƒ½ä½¿ç”¨(å¥½å§ï¼Œä½ ä¸èƒ½ä½¿ç”¨)è¿™ç§æ•…äº‹ã€‚é—®é¢˜ä¸åœ¨äº`redux`æˆ–`components`â€”â€”é—®é¢˜åœ¨äº*çš„å¤æ‚æ€§*â€”â€”æœ‰å¤ªå¤šç§»åŠ¨çš„æ£‹å­ã€‚

è®©æˆ‘ä»¬æƒ³è±¡ä½ åšçš„æ¯ä»¶äº‹éƒ½æ˜¯å¯¹çš„ã€‚æˆ‘ä»¬ä¼šå¯¹æ•…äº‹ä¹¦æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ

*   å°† UI ç»„ä»¶å¼€å‘ä¸º UI ç»„ä»¶ã€‚ä½ æ‡‚çš„â€”â€”**æ— çŠ¶æ€å“‘ç»„ä»¶**ã€‚è€Œä¸”ä¸ä»…ä»…æ˜¯æ— çŠ¶æ€ï¼Œè€Œæ˜¯â€œç®€å•â€ã€‚
*   ä½¿ç”¨`selectors`å°†è¿™äº› UI ç»„ä»¶è¿æ¥åˆ°åº•å±‚çš„`Store`ï¼Œè¿™å°†æ‰®æ¼”ä¸€ä¸ªç»å…¸ 3 å±‚ç³»ç»Ÿçš„æŠ½è±¡å±‚çš„è§’è‰²ã€‚

> ğŸ‘¨â€ğŸ”¬UI-è¿æ¥-å­˜å‚¨ã€‚åƒ 1-2-3 ä¸€æ ·ç®€å•ã€‚

*   å¦‚æœåº•å±‚(å•†åº—)å‘ç”Ÿå˜åŒ–ï¼Œä½ åªéœ€è¦æ”¹å˜é€‰æ‹©å™¨ã€‚
*   å¦‚æœä»¥åç”¨æˆ·ç•Œé¢å‘ç”Ÿäº†å˜åŒ–ï¼Œä½ åªéœ€è¦æ”¹å˜é€‰æ‹©å™¨ã€‚
*   è¯·ä¿æŒå±‚æ¬¡åˆ†ç¦»ï¼Œè¿™å°†æœ‰åŠ©äºä½ å¾ˆå¤šã€‚

ç„¶åâ€”â€”æä¾›æ­£ç¡®çš„çŠ¶æ€ä¼šæ›´å®¹æ˜“ï¼Œåªè¦ä½ çš„ UI ç»„ä»¶æ˜¯å®Œå…¨æŠ½è±¡å’Œç®€å•çš„ã€‚

ä½†æ˜¯ï¼Œä½ çŸ¥é“ï¼Œä½ çš„*æ•…äº‹é‡Œçš„ç¬¬ä¸€ä¸ª`connected component`*æ˜¯ä¸ªæ‰«å…´çš„äººã€‚å®ƒå°†å°è¯•è¿æ¥åˆ°å•†åº—ï¼Œä»ä¸­è¯»å–ä¸€äº›å†…å®¹ï¼Œæœ€ç»ˆä¼šå¤±è´¥ã€‚æˆ–è€…ï¼Œè‡³å°‘ï¼Œä¸ä¼šä»£è¡¨æ‚¨éœ€è¦çš„â€œçŠ¶æ€â€ã€‚å› ä¸ºåœ¨â€œé™æ€â€æ•…äº‹ä¹¦ä¸­æ²¡æœ‰çœŸæ­£çš„å­˜å‚¨ï¼Œä¸ºä¸åŒçš„æ•…äº‹æä¾›æ­£ç¡®çš„çŠ¶æ€åªæ˜¯ä¸€ä¸ªå°šæœªè§£å†³çš„é—®é¢˜(ä¸€èˆ¬æ¥è¯´)ã€‚

> æƒ³è±¡ä¸€ä¸ªé€‰æ‹©å™¨ã€‚æ‰€æœ‰ UI ç»„ä»¶æ¶ˆè€—ç®€å•ç±»å‹ï¼Œæ§åˆ¶é€‰æ‹©å™¨(è°è¯´å˜²è®½ï¼Ÿ)ä½ å¯ä»¥æ§åˆ¶ä¸€åˆ‡ã€‚ä½ å¯ä»¥æ§åˆ¶é€‰æ‹©å™¨ï¼Œ[å˜²è®½åœ¨æ•…äº‹ä¹¦](https://medium.com/@antonkorzunov/rewrite-a-storybook-ae4682176cc3)é‡Œæœ‰ï¼Œä½†è¿™æ˜¯æ­£ç¡®çš„æ–¹å¼å—ï¼Ÿ

æ— è®ºå¦‚ä½•â€”â€”æ•…äº‹ä¹¦ä»ç„¶æ˜¯ä¸ªé—®é¢˜ï¼Œä¸Šé¢çš„ä»»ä½•ä¸œè¥¿éƒ½ä¸èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
å¦‚æœä»å¦ä¸€ä¸ªè§’åº¦å¤„ç†è¿™ä¸ªé—®é¢˜ä¼šæ›´å¥½**ä¼šæ€ä¹ˆæ ·ï¼Ÿ**

 **## [](#dependency-injection)ä¾èµ–æ³¨å…¥

å°šæœªè§£å†³çš„é—®é¢˜æ˜¯â€œä¿æŒç»„ä»¶ç®€å•â€ï¼Œä»¥åŠâ€œæœ‰å¤ªå¤šçš„ç§»åŠ¨éƒ¨ä»¶â€ã€‚æˆ‘çš„æ„æ€æ˜¯â€”â€”ä½ å¯ä»¥é€šè¿‡ç®€åŒ–æ¥ç®€åŒ–ä½ çš„ç”¨æˆ·ç•Œé¢ï¼Œéšç€ç”¨æˆ·ç•Œé¢çš„æˆé•¿â€”â€”æ‰€æœ‰çš„ç®€å•æ€§éƒ½ä¼šæ¶ˆå¤±ã€‚äº‹æƒ…å¯èƒ½å¾ˆç®€å•ï¼Œä½†åªæ˜¯åœ¨å®ƒä»¬å¾ˆå°çš„æ—¶å€™â€”â€”å¤§è€Œç®€å•çš„äº‹æƒ…ç”šè‡³æ¯”å¤§è€Œå¤æ‚çš„äº‹æƒ…æ›´ç³Ÿç³•ã€‚

è§£å†³æ–¹æ¡ˆ-ç”¨æ›´å¤§çš„éƒ¨ä»¶åˆ¶é€ æ›´å°çš„éƒ¨ä»¶ã€‚å°±åƒæˆ‘ä»¬å¯¹å¾…åŠäº‹é¡¹åˆ—è¡¨æ‰€åšçš„ä¸€æ ·ã€‚

ä½†æ˜¯æˆ‘ä»¬åˆ›é€ çš„è§£å†³æ–¹æ¡ˆå¤ªï¼Œå§‘ä¸”ç§°ä¹‹ä¸ºï¼Œ- *çº ç»“*ã€‚è®©æˆ‘ä»¬è§£å¼€å®ƒï¼

*   è¿™æ˜¯æˆ‘ä»¬æœ€åˆçš„æ‰˜å¤šæ–¯ã€‚è¿™æ˜¯ä¸€ä¸ªå•ä¸€çš„ç»„æˆéƒ¨åˆ†ã€‚

```
const Todos = ({ displayCount, todos }) => (
  <TodoContainer todoCount={displayCount}>
    <TodoList todos={todos} />
  </TodoContainer >  );

export default connect(
 state => ({
   displayCount: state.todos.length, // imagine a selector
   todos: state.todos, // imagine a selector
}))(Todos) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*   è¿™å°±æ˜¯é­”æ³•...å®ƒä»ç„¶æ˜¯å•ä¸€çš„æˆåˆ†ï¼Œä½†æ˜¯*åœ¨ç©ºé—´ä¸­åˆ†æ•£*ã€‚

```
// removing "tangled" TodoList from here, replacing it by {todoList}
const Todos = ({ displayCount, todoList }) => (
  <TodoContainer todoCount={displayCount}>
    {todoList} // or just "children"
  </TodoContainer >  );

export default connect(
// map state to props
 state => ({
   displayCount: state.todos.length, // imagine a selector
   todos: state.todos, // imagine a selector
}), 
// map dispatch to props
null,
// merge props
(stateProps) => ({
  displayCount: stateProps.displayCount, // keep this prop
  todoList: <TodoList todos={todos} />, // WHAT???
});
)(Todos) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

*é­”æ³•*â€”â€”æˆ‘ä»¬åˆšåˆšä»`connect`å¼€å§‹ç»™æˆ‘ä»¬çš„ TodoContainer æ³¨å…¥äº†å†…éƒ¨æ„ä»¶ã€‚è¿™æ˜¯ä¸€ç§çº¯ç²¹çš„ä¾èµ–æ³¨å…¥æ¨¡å¼ï¼Œä½†æ˜¯ä»¥ä¸€ç§*ç»„ä»¶*çš„å½¢å¼ã€‚

ä½ å¯èƒ½ä¼šé—®â€”â€”å¥½å§ï¼Œé‚£ä¹ˆè¿™æ”¹å˜äº†ä»€ä¹ˆï¼Ÿ(é™¤äº†æˆ‘ä»¬ä¹‹å‰è°ˆè¿‡çš„æ§åˆ¶åè½¬)

## [](#finite-components)æœ‰é™æ„ä»¶

è¿™æ”¹å˜äº†ä½ æ§åˆ¶ç»„ä»¶çš„èƒ½åŠ›ã€‚è¿™ä½¿å¾—å®ƒä»¬æ˜¯â€œæœ‰é™çš„â€ã€‚åªè¦é‚£äº›*æ— é™çš„*å†…éƒ¨æ„ä»¶è¢«æä¾›ä½œä¸ºé“å…·ï¼Œä»»ä½•ç»„ä»¶éƒ½ä¸ä¼šåœ¨å…¶ä¸­å‘ˆç°æŸäº›ä¸œè¥¿ï¼Œâ€œç›´åˆ°æœ€åâ€ã€‚

æ¯ä¸ªâ€œä¸‹ä¸€æ­¥â€éƒ½æ˜¯ä½œä¸º`slot`(å„¿ç«¥)é“å…·æä¾›çš„ã€‚æ¯ä¸€ä¸ªæ²¡æœ‰æä¾›`slots`çš„ç»„ä»¶éƒ½æ˜¯*æœ‰é™çš„*â€”â€”å®ƒå°†ä»€ä¹ˆéƒ½ä¸å‘ˆç°ã€‚è¿™å°†æ˜¯ç´§å‡‘å’Œç®€å•çš„ï¼Œå› ä¸ºå®ƒä¸€ç›´è¢«æœŸå¾…ã€‚

[![thekashey](../Images/638fcfb14e5c451b9d2dc31d89e5b034.png)](/thekashey) [## æœ‰é™æˆ˜äº‰

### å®‰ä¸œÂ·ç§‘å°”ç¥–è¯ºå¤« 1 æœˆ 1 æ—¥ 196 åˆ†é’Ÿé˜…è¯»

#react #testing #javascript](/thekashey/infinite-war-995)

è¿™ä½¿å¾—(å•å…ƒ)æµ‹è¯•æ›´ç®€å•ï¼Œå¼€å‘æ›´ç®€å•ï¼Œæ•…äº‹ä¹¦æ›´ç®€å•ï¼Œç»™ä½ å®Œå…¨ä¸åŒçš„å¯é‡ç”¨æ€§çº§åˆ«ï¼Œä½ éœ€è¦çš„ä¸€åˆ‡â€”â€”å°±æ˜¯æ­£ç¡®åœ°è¿æ¥ç»„ä»¶ã€‚

> PS:è¿˜æœ‰æƒ³æƒ³ BEM æ¶æ„ã€‚ä»ç°åœ¨å¼€å§‹å¬èµ·æ¥å¯èƒ½ä¼šå¾ˆæœ‰è¶£ã€‚**ç»å¯¹ç‹¬ç«‹å—**æ„å‘³ç€ä»€ä¹ˆ(BEM æŠ€æœ¯çš„ç¬¬ä¸€ä¸ªåå­—)

#### [](#does-it-heal-the-storybook)æ˜¯å¦æ²»æ„ˆæ•…äº‹ä¹¦ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹ä½ æœ‰ä¸€ä¸ªæ•…äº‹ç»™ ComponentAã€‚å‡ºäºæ•…äº‹ä¹¦çš„ç›®çš„ï¼Œä½ æä¾›äº†æ‰€æœ‰ä½ éœ€è¦çš„ä¸œè¥¿ä½œä¸ºé“å…·ï¼Œç”šè‡³ç”¨`Provider`åŒ…è£…ä½ çš„ç»„ä»¶ï¼Œæä¾›äº†â€œæ­£ç¡®çš„â€çŠ¶æ€ã€‚

> ä½ æœ‰ä½ çš„`StorybookedComponentA`ã€‚

ç°åœ¨å‡è®¾ä½ æœ‰ä¸€ä¸ª ComponentB çš„æ•…äº‹ï¼Œå®ƒåœ¨é‡Œé¢çš„æŸä¸ªåœ°æ–¹ä½¿ç”¨äº† ComponentAã€‚

*   åœ¨*çœŸå®çš„*åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å°†*ä»è¿æ¥å‡½æ•°ä¸­æä¾›*ä½œä¸º`componentA`æ’æ§½ï¼Œå°±åƒä¸Šé¢çš„ä¾‹å­ä¸€æ ·ã€‚
*   åœ¨æ•…äº‹ä¹¦ä¸­ï¼Œä½ å¯ä»¥ä¸ºç»„ä»¶ A æä¾›ä¸€ä¸ª*æ•…äº‹ï¼Œå³`StorybookedComponentA`ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªâ€œçœŸå®ç»„ä»¶â€ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä»å¦ä¸€ä¸ªæ•…äº‹ä¸­**æ„å»ºä¸€ä¸ªæ•…äº‹ğŸ¤“ã€‚***

å†è¯´ä¸€æ¬¡â€”â€”æ•…äº‹æ˜¯ä¸€ä¸ªâ€œæƒ…å¢ƒâ€,ä½ å¯ä»¥ä»ä¸€ä¸ªå°çš„æƒ…å¢ƒä¸­æ§åˆ¶ä¸€ä¸ªå¤§çš„æƒ…å¢ƒï¼Œ

æ–°çš„[æ•…äº‹ä¹¦ç»„ä»¶æ ¼å¼](https://medium.com/storybookjs/component-story-format-66f4c32366df)å°†å¸®åŠ©ä½ :

åªè¦åˆ†å—åƒç†Šï¼Œç†Šå°±ä¼šè¢«åƒæ‰ï¼

## [](#fire-wire)ç«çº¿

ç°åœ¨æˆ‘ä»¬æ­£æ¥è¿‘ç»“è®ºâ€”â€”Smart/Dump**å…³æ³¨ç‚¹åˆ†ç¦»**ï¼Œè¿™æ˜¯å½“ä»ŠçœŸæ­£çš„â€œs å­—â€ã€‚

å…³æ³¨ç‚¹çš„åˆ†ç¦»ä¸ºæ‚¨æä¾›äº†:

*   å¹¶è¡Œå¼€å‘ç‰¹æ€§çš„èƒ½åŠ›ã€‚ä¸€ç±»å¼€å‘äººå‘˜(UI)ä¼šåˆ›å»º UIï¼Œè€Œå¦ä¸€ç±»å¼€å‘äººå‘˜ä¼šå®ŒæˆçŠ¶æ€ç®¡ç†ã€‚ç›¸ä¿¡æˆ‘ï¼Œè¿™äº›ä»»åŠ¡éœ€è¦**ä¸åŒçš„**æŠ€èƒ½ï¼Œæ‰€ä»¥æœ€å¥½ä½¿ç”¨ä¸åŒä¸“ä¸šçš„å¼€å‘äººå‘˜æ¥è·å¾—æ›´å¥½çš„ç»“æœã€‚
*   æ›´æ”¹ UI å’Œåº•å±‚çŠ¶æ€ç®¡ç†çš„æ›´ç®€å•çš„æ–¹æ³•â€”â€”å®ƒä»¬å¹¶ä¸ç›¸äº’ç»‘å®šã€‚
*   æ›´å¥½çš„åˆ’åˆ†å’Œåˆ›å»ºç»„ä»¶çš„è§„åˆ™ï¼Œæ›´å¥½çš„å…¨å±€çŠ¶æ€å’Œå±€éƒ¨çŠ¶æ€çš„è¾¹ç•Œã€‚å¦‚æœç»™ä½ ä¸€ä¸ªâ€œåˆ›å»º UIâ€çš„ä»»åŠ¡ï¼Œä½ ä¼šæ¸…æ¥šåœ°çŸ¥é“å“ªäº›å˜é‡åº”è¯¥åŒ…å«åœ¨ä½ çš„è§£å†³æ–¹æ¡ˆä¸­ï¼Œå“ªäº›åº”è¯¥æ˜¯å¤–éƒ¨çš„ã€‚
*   é”™è¯¯ç‡æ›´ä½ã€‚å³ä½¿å‡ºç°é”™è¯¯ï¼Œä¹Ÿæ›´å®¹æ˜“å¤„ç†ã€‚ä¸€åˆ‡éƒ½æ˜¯å°çš„ã€åˆ†ç¦»çš„ã€å­¤ç«‹çš„ï¼Œå°±åƒ...å–œæ¬¢`hooks`ã€‚

åªè¦æˆ‘ä»¬è¯´çš„æ˜¯`Redux`â€”â€”æˆ‘ä»¬è¯´çš„æ˜¯`connect`åŠŸèƒ½ï¼Œå¹¶ä¸â€œèŠ±å“¨â€ã€‚è€Œ`reselect`å¹¶ä¸â€œèŠ±å“¨â€ã€‚åªæœ‰`Hooks`æ˜¯èŠ±é‡Œèƒ¡å“¨çš„ï¼

é’©å­èƒ½æ‹¯æ•‘ä¸–ç•Œå—ï¼Ÿ

## [](#v7)v7

Redux v7 æ˜¯æ¸¸æˆæ”¹å˜è€…ã€‚å®ƒç»™ä½ é’©å­ã€‚è€å®è¯´â€”â€”è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åå¯¹â€”â€”æˆ‘å¸Œæœ›åœ¨æˆ‘çš„â€œååº”â€ç»„ä»¶ä¸­å°½å¯èƒ½å°‘åœ°ä½¿ç”¨é€»è¾‘ã€‚ä½†æ˜¯åæ¥ï¼Œä½ çŸ¥é“ï¼Œæˆ‘ä¹ æƒ¯äº†ã€‚

`useCallback`ã€`useMemo`â€”â€”è¿˜æœ‰å…¶ä»–ä½ ç”¨ä¸åˆ°çš„ä¸œè¥¿â€”â€”å¤ªç¾äº†ï¼

```
const Todos = ({ displayCount, todoList }) => (
  <TodoContainer todoCount={displayCount}>
    {todoList} // or just "children"
  </TodoContainer >  );

// the same `connect`, this time with `useMemo`
// and, the main, in a "common" form.
const TodoConnected = () => {
  const displayCount = useSelector(state => state.todos.length);
  const todos = useSelector(state => state.todos);
  const todoList = useMemo(() => <TodoList todos={todos} />, [todos]) 
  return <Todos displayCount={displayCount} todoList={todoList} /> } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜â€”â€”**reselect**ä¸æ˜¯é’©å­å…¼å®¹çš„ã€‚ä»»ä½•è®°å¿†çº§è”ï¼Œæ²¡æœ‰è¿™ç§æ¨¡å¼é‡é€‰éƒ½ä¸ä¼šå¥½ï¼Œéƒ½ä¸ç¬¦åˆé’©å­å®šå¾‹â€”â€”åªè¦å®ƒä»¬å¯èƒ½å¯¹ä¸€ä¸ªé€‰æ‹©å™¨çš„ä¸åŒéƒ¨åˆ†è¿›è¡Œä¸åŒçš„è®°å¿†(å®ƒä»¬å¯èƒ½æœ‰è®°å¿†ï¼Œè¿™å·²ç»è¶³å¤Ÿäº†)â€”â€”å®ƒä»¬å°±ä¼šè¿åé’©å­çš„**è§„åˆ™**ã€‚

> æ²¡æœ‰è¿™ç§æ¨¡å¼ï¼Œä»»ä½•è®°å¿†çº§è”å’Œé‡é€‰éƒ½æ˜¯ä¸ç¬¦åˆé’©å­å®šå¾‹çš„

æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ [redux-views](https://github.com/josepot/redux-views) æˆ–è€…[userselect](https://github.com/theKashey/useReselect)ï¼Œä½†æ˜¯åŒæ ·çš„ï¼Œä»–ä»¬åœ¨å®ç°ä¸Šå­˜åœ¨äº‰è®®ã€‚

æ›´ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯*æ¯”ä½ æƒ³è±¡çš„æ›´ç®€å•çš„*â€”â€”åªéœ€æ›¿æ¢ v7 çš„`useSelector`buy[useTrackedSelector](https://github.com/dai-shi/reactive-react-redux#useselector)ï¼Œè¿™å°†è®©ä½ **è·³è¿‡ä»»ä½•å¯èƒ½çš„è®°å¿†**é—®é¢˜ã€‚

è€å®è¯´â€”â€”æˆ‘ä¸æ¨èä½¿ç”¨åŸºäº[é’©å­çš„è®°å¿†é€‰æ‹©å™¨](https://react-redux.js.org/next/api/hooks#using-memoizing-selectors)ä½œä¸ºå®ƒæå‡ºçš„ react-reduxâ€”â€”å®ƒåˆä¸€æ¬¡å—åˆ°äº†é‡æ–°é€‰æ‹©çš„é™åˆ¶ã€‚

ä½¿ç”¨è¿½è¸ªæœ‰å…¶è‡ªèº«çš„å±€é™æ€§ã€‚

### [](#4th-answer-to-a-component-splitting)ç¬¬ 4 ä¸ªç­”æ¡ˆä¸€ä¸ªç»„ä»¶æ‹†åˆ†

ä½¿ç”¨è¿½è¸ªæœ‰å…¶è‡ªèº«çš„å±€é™æ€§ã€‚å®ƒåªæ˜¯è·Ÿè¸ªä½ ä»çŠ¶æ€ä¸­è¯»å–çš„å˜é‡ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚å®ƒä½¿ç”¨äº†ä¸€äº›éå¸¸ç¬¦åˆé€»è¾‘çš„å‡è®¾ï¼Œè¿™äº›å‡è®¾æ˜¯...ä»–ä»¬åªæœ‰ä¸€ä¸ªæˆ‘ä»¬æœ‰çš„:

*   å¦‚æœä½ é˜…è¯»`props.a` -ä½ éœ€è¦`props.a`
*   å¦‚æœä½ è¯»`props.a.b`â€”â€”ä½ éœ€è¦`props.a.b`ï¼Œä½†ä½ ä¸â€œéœ€è¦â€`props.a`â€”â€”å®ƒæ˜¯ä½ éœ€è¦çš„å®å˜é‡çš„ä¸€ä¸ªâ€œæŒæœ‰è€…â€ã€‚åƒ`state`åªæ˜¯ä¸€ä¸ªâ€œæŒæœ‰è€…â€ã€‚å‡è®¾æ˜¯â€”â€”ä½ åªéœ€è¦æœ€æ·±å±‚çš„â€œçœŸå®â€å˜é‡ï¼Œè€Œä¸éœ€è¦ä¸­é—´å˜é‡ã€‚
*   æ‰€ä»¥å¦‚æœä½ çœŸçš„éœ€è¦åŒæ—¶å¾—åˆ°`props.a`å’Œ`props.a.b` **çš„å€¼**â€”â€”ä½ å¿…é¡»**åˆ†ç¦»**ç»„ä»¶ï¼Œæˆ–è€…**éš”ç¦»**é€‰æ‹©å™¨ä¸­çš„è¿™äº›è¯»å–ã€‚

åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœ`state.todos.length`ä¿æŒæ—§å€¼ï¼Œåˆ™`state.todos`æ”¹å˜æ—¶ä¸ä¼šè§¦å‘æ›´æ–°ã€‚

```
const Component = () => {
  const state = useTrackedState(context);

  return (
    <div>
     I have {state.todos.length} things todo:
     <TodoList todos={state.todos} />
    </div>
  ) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è§£å†³æ–¹æ¡ˆ:æ‹†åˆ†ç»„ä»¶ï¼Œéš”ç¦»è¯»å–ï¼Œæˆ–è€…â€œåœ¨å…¶ä»–åœ°æ–¹æ´¾ç”Ÿé“å…·â€(æˆ‘ä»¬ä»¥å‰å°±è¿™ä¹ˆåšè¿‡)

å†è¯´ä¸€æ¬¡â€”â€”ä½ å¿…é¡»ç†è§£ä½ çš„ç»„ä»¶ä¸­çš„â€œè¾¹ç•Œâ€ï¼Œå¹¶ä¸”*åˆ†ç¦»*è¿™äº›*å…³æ³¨ç‚¹*â€”â€”å¦åˆ™é­”æ³•å°†ä¸èµ·ä½œç”¨ã€‚

ä¸‹é¢æ˜¯ä¸€äº›èƒŒåçš„ç†è®º:

[![thekashey](../Images/638fcfb14e5c451b9d2dc31d89e5b034.png)](/thekashey) [## æˆ‘å¦‚ä½•ç¼–å†™ä¸–ç•Œä¸Šæœ€å¿«çš„è®°å¿†åº“

### å®‰ä¸œÂ·ç§‘å°”ç¥–è¯ºå¤« 4 æœˆ 16 æ—¥ 19 æ—¶ 11 åˆ†é˜…è¯»

#memoization #javascript #proxy #weakmap](/thekashey/how-i-wrote-the-world-s-fastest-memoization-library-34io)

å¦‚ä»Šï¼Œä¾é è‡ªåŠ¨ä½¿ç”¨è·Ÿè¸ªæ¯”ä¾é ä½ è‡ªå·±çš„æŠ€èƒ½æ›´å¥½ã€‚æˆ–è€…ç”¨ MobXã€‚æˆ‘æ˜¯è®¤çœŸçš„ã€‚

> ![unknown tweet media content](../Images/4e7ef08a2c2cd0f0654ff0d316962181.png)![Play butt](../Images/980e9fb12d58fa9423fc94c33003fc4f.png)<video loop="" controls=""><source src="https://video.twimg.com/tweet_video/EAGflD6WsAYWpGk.mp4" type="video/mp4"></video>![Kitze profile image](../Images/2a7c68f8967f91cc03bc37e09f5a1e60.png)Kitze[@ the Kitze](https://dev.to/thekitze)![twitter logo](../Images/4c8a2313941dda016bf4d78d103264aa.png)[@ mweststrate](https://twitter.com/mweststrate)For the gazzilion ç¬¬ä¸€æ¬¡æˆ‘å¾ˆç”Ÿæ°”ï¼Œäººä»¬éƒ½å¿½ç•¥äº† mobx-state-tree æ˜¯å¤šä¹ˆçš„ç¥å¥‡ã€‚è¿™æ˜¯æ£µä»–å¦ˆçš„è¡¨æ¼”æ ‘ã€‚*MADE*ç”¨äºå­˜å‚¨æ‚¨çš„å…¨å±€çŠ¶æ€ã€‚æ²¡æœ‰é‡é€‰ï¼Œæ²¡æœ‰é“å…·è®­ç»ƒï¼Œæ²¡æœ‰ä¿å§†ä¸Šä¸‹æ–‡ã€‚ç”¨äº†å°±å¥½ï¼Œæ—©ç‚¹å›å®¶ã€‚æˆ‘æ“ã€‚2019 å¹´ 7 æœˆ 22 æ—¥ä¸‹åˆ 18:57[![Twitter reply action](../Images/44d8b042100e231770330321e5b63d65.png)](https://twitter.com/intent/tweet?in_reply_to=1153378446099255298)[![Twitter retweet action](../Images/93d9c70ccc54851d2e8e881b53c21dae.png)](https://twitter.com/intent/retweet?tweet_id=1153378446099255298)[![Twitter like action](../Images/2e93f7775eadefab8bcd34a4542cc5a7.png)](https://twitter.com/intent/like?tweet_id=1153378446099255298)

-

# [](#redux-of-not)ä¸æ˜¯çš„ç¿»ç‰ˆï¼Ÿ

å¦ä¸€ä¸ªè¦å›ç­”çš„å¤§é—®é¢˜æ˜¯ï¼ŒRedux ç”¨åœ¨å“ªé‡Œï¼Œå“ªé‡Œçš„**é’©å­ï¼Œä¸Šä¸‹æ–‡**ï¼Œå¥½å‹åº”è¯¥æ˜¯**é¦–é€‰**ã€‚

åŒæ ·ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„é—®é¢˜ã€‚åŒæ ·ï¼Œæ­£ç¡®çš„é—®é¢˜åº”è¯¥æ˜¯å…³äºç•Œé™çš„ã€‚

> å½“ä¸€ä¸ªçŠ¶æ€ç®¡ç†ç³»ç»Ÿåº”è¯¥ç»“æŸæ—¶ï¼Œå¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†ç³»ç»Ÿå¼€å§‹ã€‚

è¿™ä¸æ˜¯ Redux å’Œæœ¬åœ°çŠ¶æ€ä¹‹é—´çš„è¾¹ç•Œç‚¹â€”â€”å®ƒå¯èƒ½æ˜¯`One Redux`å’Œ`Another Redux`ä¹‹é—´çš„ä¸€ä¸ªç‚¹ã€‚è¿™æ›´å¤šçš„æ˜¯å…³äº[åˆ†å½¢çŠ¶æ€](https://blog.cloudboost.io/the-state-of-the-state-of-the-state-f93c8bdc6b1b)å’Œ**å¾®å‰ç«¯**è€Œä¸æ˜¯ Redux æœ¬èº«ã€‚è€Œä¸æ˜¯**éš”ç¦»**ã€‚

è€ƒè™‘ä¸€ä¸‹æ‚¨åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•æ„å»ºçš„ã€‚

*   åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†æ˜¯ç”±æŒ‰é’®(åŸå­)ã€æŒ‰é’®å½¢å¼å½¢å¼(åˆ†å­)å’Œé¡µé¢(æœ‰æœºä½“)ç»„æˆçš„ã€‚é€šå¸¸ä¸‹å±‚æ£‹å­æ²¡æœ‰ä»»ä½•çŠ¶æ€ï¼Œç”±å®ƒä»¬æ§åˆ¶`owner`ã€‚ä¸šä¸»ä¹Ÿåœ¨è¿™ä¹ˆåšã€‚è¿™æ˜¯ä½ æ­£åœ¨æ„å»ºä½ çš„â€œå¯é‡ç”¨â€å…ƒç´ ï¼Œå®ƒåªæ˜¯*æœä»*ï¼Œæ²¡æœ‰ä»»ä½•â€œè‡ªå·±çš„â€æ„è§ã€‚
*   è¿˜æœ‰ä½ çš„åº”ç”¨ç¨‹åºçš„â€œæƒ³æ³•â€ï¼Œä»¥åŠå®ç°å®ƒçš„ä¸»è¦æ•°æ®â€”â€”â€œçŠ¶æ€â€ã€‚è¿™ç§çŠ¶æ€å­˜åœ¨äºé¡¶éƒ¨ï¼Œå¹¶å‘ä¸‹æµåŠ¨ã€‚It å’Œä¸â€œitâ€ä¸€èµ·å·¥ä½œçš„ç»„ä»¶ç¡®å®æœ‰ä»–ä»¬â€œè‡ªå·±â€çš„è§‚ç‚¹ã€‚
*   ä¸­é—´æœ‰å¤æ‚çš„æƒ…å†µï¼Œåœ¨ saga æˆ–å…¶ä»–ä¸­é—´ä»¶çš„åé¢å¯èƒ½éœ€è¦â€œæœ¬åœ°â€çŠ¶æ€å˜é‡ã€‚æœ‰æ—¶ä½ å¯èƒ½åªæ˜¯å°†å®ƒä½œä¸ºä½ çš„â€œåŠ¨ä½œâ€çš„ä¸€éƒ¨åˆ†å‘é€ï¼Œä½†æœ‰æ—¶æ›´å®¹æ˜“â€œåŒæ­¥â€`local`å’Œ`global`å˜é‡ã€‚

> çœŸçš„ï¼Œå¦‚æœå¯ä»¥æ§åˆ¶`input`çš„`value`å¹¶æ›´æ–°æœ¬åœ°çŠ¶æ€`onChange`â€”â€”ä¸ºä»€ä¹ˆä¸èƒ½åœ¨ redux æ–¹é¢åšåŒæ ·çš„äº‹æƒ…å‘¢ï¼Ÿè®¸å¤šè¡¨å•ç®¡ç†åº“ä¹Ÿåœ¨åšåŒæ ·çš„äº‹æƒ…ã€‚
> PS:åå‘åŒæ­¥ä¹Ÿä¸æ˜¯å¤§é—®é¢˜ã€‚
> PPS:çœŸç†çš„å•ä¸€æ¥æºï¼Ÿå•å‘åŒæ­¥æ²¡æœ‰é—®é¢˜ã€‚

# [](#so)æ‰€ä»¥ï¼Ÿï¼

æ‰€ä»¥æˆ‘ä¼šç”¨æ›´å¤šçš„ä¾‹å­æ¥ä¿®æ”¹è¿™ç¯‡æ–‡ç« ï¼Œåˆ°æ—¶å€™å®ƒä¼šå˜å¾—è¶Šæ¥è¶Šå¥½ã€‚

æˆ‘å¯ä»¥ç»™ä½ ä¸€äº›å»ºè®®:

*   è¯•ç€â€œçœ‹åˆ°â€å¤æ‚æ€§ï¼Œç„¶åè¯•ç€é¿å…å®ƒã€‚å¦‚æœæŸä»¶äº‹å¯¹ä½ æ¥è¯´ä¸æ˜¯å¾ˆå¤æ‚ï¼Œå¯¹å¦ä¸€ä¸ªäººæ¥è¯´å¯èƒ½ä¼šå¾ˆå¤æ‚ï¼ŒåŒ…æ‹¬æ˜å¤©çš„ä½ ã€‚
*   å°½é‡ä½¿ç”¨ POD(æ™®é€šæ—§æ•°æ®)ç±»å‹â€”â€”ä¸è¦è®©å¤æ‚çš„ç»“æ„æ¸—é€åˆ°ä½ çš„åº”ç”¨ç¨‹åºä¸­ã€‚å¦‚æœä¸€äº›æ•°æ®(ä¸€ä¸ªä¸œè¥¿)åº”è¯¥æ˜¯å¤æ‚ï¼Œé‚£ä¹ˆâ€œå¤æ‚â€å¯¹è±¡ä»ç„¶æœ‰ä¸€äº›ä½ç½®ï¼Œä½†æ˜¯å°è¯•ä»ç›®æ ‡ UI æˆ–é€»è¾‘è¦ä½¿ç”¨çš„æ•°æ®ä¸­*å¯¼å‡º*æ›´ç®€å•(å’Œæ›´åˆç†)çš„å€¼ã€‚
*   â€œç›´å‘¼å…¶åâ€ã€‚å¦‚æœä½ éœ€è¦æ˜¾ç¤ºä½ æœ‰å¤šå°‘ todos é‚£æ˜¯`todoCount`ï¼Œä¸æ˜¯`todos.length`ã€‚
*   ä½¿ç”¨ç‰©è”ç½‘æ¨¡å¼æ¶ˆé™¤ç»„ä»¶ç»„åˆçš„å¤æ‚æ€§ã€‚å…¶å®å°±æ˜¯æˆåˆ†æ„æˆã€‚
*   å°è¯•å°† UIã€çŠ¶æ€ç®¡ç†å’Œæ•°æ®è®¿é—®åˆ†å¼€ã€‚
*   åˆ†è£‚å’Œå¾æœè€…ã€‚æ¯å½“é—®é¢˜å˜å¾—å¤ªå¤§è€Œæ— æ³•è§£å†³æ—¶â€”â€”æ‰“ç ´å®ƒï¼Œåˆ†è§£å®ƒã€‚
*   åŒæ—¶â€”â€”é¿å…å¼•å…¥æ— æ„ä¹‰çš„å°ç‰‡æ®µï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ„å¤§åˆ©é¢æ¡å¼çš„ä»£ç ï¼Œæˆ–è€…åªæ˜¯åœ¨ä½ çš„å¤´è„‘ä¸­ä¸é€‚åˆæ‰€æœ‰çš„éƒ¨åˆ†ã€‚
*   è¯•ç€æ€è€ƒäº‹æƒ…ã€‚åœ¨åŸŸä¸­ã€‚åœ¨å±‚æ¬¡å’Œéœ€æ±‚ä¸­(å—¯[è¿™é‡Œæœ‰æ›´å¤šå…³äºå®ƒçš„å†…å®¹](https://dev.to/thekashey/prefer-integration-tests-think-twice-1l6d))ã€‚
*   å°½é‡è®©ä¸€åˆ‡éƒ½åœ¨æŒæ§ä¹‹ä¸­ã€‚

ä½†æ˜¯ä½ åº”è¯¥å·²ç»æ˜ç™½åƒä½ çš„ç†Šçš„å”¯ä¸€æ–¹æ³•æ˜¯ğŸ»**åˆ†ä»½åƒèŠ‚æ‹**ğŸ»ã€‚**