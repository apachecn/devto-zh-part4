# WebAssembly æ¨¡å—çš„æ— æœåŠ¡å™¨åŠŸèƒ½

> åŸæ–‡:[https://dev . to/IBM developer/server less-functions-with-web assembly-modules-343 e](https://dev.to/ibmdeveloper/serverless-functions-with-webassembly-modules-343e)

çœ‹äº†[æ—å…‹æ‹‰å…‹](https://twitter.com/linclark)å’Œ[æå°”æ–½è€å¾·ç‘ç‰¹](https://twitter.com/tschneidereit)æœ€è¿‘å…³äº [WebAssembly](https://webassembly.org/) (Wasm)çš„ä¸€ä¸ª[æ¼”è®²ï¼Œå¯å‘æˆ‘å¼€å§‹å°è¯•ä½¿ç”¨æ¥è‡ª](https://london.serverlessdays.io/speakers/lin/)[æ— æœåŠ¡å™¨å‡½æ•°](https://en.wikipedia.org/wiki/Serverless_computing)çš„ WebAssembly [æ¨¡å—](https://webassembly.org/docs/modules/)ã€‚

è¿™ç¯‡åšæ–‡æ¼”ç¤ºäº†å¦‚ä½•ä» Node.js æ— æœåŠ¡å™¨å‡½æ•°ä¸­è°ƒç”¨ç”¨ C ç¼–å†™çš„å‡½æ•°ã€‚C è¯­è¨€çš„æºä»£ç è¢«ç¼–è¯‘æˆ Wasm æ¨¡å—ï¼Œæ†ç»‘åœ¨éƒ¨ç½²åŒ…ä¸­ã€‚Node.js ä»£ç å®ç°æ— æœåŠ¡å™¨å¹³å°å¤„ç†ç¨‹åºï¼Œå¹¶åœ¨è°ƒç”¨æ—¶è°ƒç”¨æœ¬æœºå‡½æ•°ã€‚

è¿™äº›ç¤ºä¾‹åº”è¯¥å¯ä»¥åœ¨ä»»ä½•æ”¯æŒä» zip æ–‡ä»¶éƒ¨ç½² Node.js å‡½æ•°çš„æ— æœåŠ¡å™¨å¹³å°ä¸Šå·¥ä½œ(ç»è¿‡ä¸€äº›ä¿®æ”¹)ã€‚æˆ‘å°†ä½¿ç”¨ [IBM äº‘å‡½æ•°](https://cloud.ibm.com/functions/)([Apache open whish](https://openwhisk.apache.org/))ã€‚

## web ç»„è£…

> WebAssembly(ç¼©å†™ä¸º *Wasm* )æ˜¯ä¸€ç§åŸºäºå †æ ˆçš„è™šæ‹Ÿæœºçš„äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ã€‚Wasm è¢«è®¾è®¡ä¸º C/C++/Rust ç­‰é«˜çº§è¯­è¨€ç¼–è¯‘çš„å¯ç§»æ¤ç›®æ ‡ã€‚
> 
> [https://webassembly.org/](https://webassembly.org/)

Wasm æœ€åˆæ˜¯ä¸€ä¸ªåœ¨æµè§ˆå™¨ä¸­è¿è¡Œä½çº§è¯­è¨€çš„é¡¹ç›®ã€‚è¿™æ˜¯ä¸€ç§åœ¨å®¢æˆ·ç«¯æ‰§è¡Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡çš„æ–¹å¼ï¼Œä¾‹å¦‚å›¾åƒå¤„ç†ã€æœºå™¨å­¦ä¹ ã€å›¾å½¢å¼•æ“ã€‚ä¸ä½¿ç”¨ JavaScript ç›¸æ¯”ï¼Œè¿™å°†æé«˜è¿™äº›ä»»åŠ¡çš„æ€§èƒ½ã€‚

WebAssembly å°† Cã€C++å’Œ Rust ç­‰è¯­è¨€ç¼–è¯‘æˆå¯ç§»æ¤çš„æŒ‡ä»¤æ ¼å¼ï¼Œè€Œä¸æ˜¯ç‰¹å®šäºå¹³å°çš„æœºå™¨ä»£ç ã€‚ç¼–è¯‘çš„ Wasm æ–‡ä»¶ç”±æµè§ˆå™¨æˆ–å…¶ä»–è¿è¡Œæ—¶ä¸­çš„ Wasm VM è§£é‡Šã€‚[API è¢«å®šä¹‰ä¸º](https://developer.mozilla.org/en-US/docs/WebAssembly/Using_the_JavaScript_API)æ”¯æŒä» JavaScript è¿è¡Œæ—¶å¯¼å…¥å’Œæ‰§è¡Œ Wasm æ¨¡å—ã€‚è¿™äº› API å·²ç»åœ¨å¤šä¸ªæµè§ˆå™¨å’Œæœ€è¿‘çš„ Node.js ç‰ˆæœ¬(v8.0.0+)ä¸­å®ç°ã€‚

**è¿™æ„å‘³ç€ Node.js æ— æœåŠ¡å™¨å‡½æ•°ï¼Œä½¿ç”¨ 8.0.0 ä»¥ä¸Šè¿è¡Œæ—¶ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ WebAssemblyï¼**

### [](#wasm-modules-serverless)Wasm æ¨¡å—+æ— æœåŠ¡å™¨

*â€œä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨ Node.js æ— æœåŠ¡å™¨å‡½æ•°ä¸­çš„ WebAssembly æ¨¡å—ï¼Ÿâ€*ğŸ¤”

#### [](#performance)è¡¨ç°

å¯¹äºæ— æœåŠ¡å™¨å¹³å°ï¼Œæ—¶é—´å°±æ˜¯é‡‘é’±ã€‚ä»£ç æ‰§è¡Œå¾—è¶Šå¿«ï¼ŒèŠ±è´¹å°±è¶Šå°‘ã€‚ä½¿ç”¨ Cã€C++æˆ– Rust ä»£ç ï¼Œç¼–è¯‘æˆ Wasm æ¨¡å—ï¼Œå¯¹äºè®¡ç®—å¯†é›†å‹ä»»åŠ¡[å¯ä»¥æ¯”ç”¨ JavaScript å®ç°çš„ç›¸åŒç®—æ³•å¿«å¾—å¤šã€‚](https://medium.com/@torch2424/webassembly-is-fast-a-real-world-benchmark-of-webassembly-vs-es6-d85a23f8e193)

#### [](#easier-use-of-native-libraries)æ›´å®¹æ˜“ä½¿ç”¨åŸç”Ÿåº“

Node.js å·²ç»[æœ‰åŠæ³•](https://github.com/nodejs/node-gyp)ä»è¿è¡Œæ—¶ä½¿ç”¨æœ¬åœ°åº“(C æˆ– C++)ã€‚è¿™é€šè¿‡åœ¨ NPM å®‰è£…è¿‡ç¨‹ä¸­ç¼–è¯‘æœ¬æœºä»£ç æ¥å®ç°ã€‚æ†ç»‘åœ¨éƒ¨ç½²åŒ…ä¸­çš„åº“éœ€è¦é’ˆå¯¹æ— æœåŠ¡å™¨å¹³å°è¿è¡Œæ—¶è¿›è¡Œç¼–è¯‘ï¼Œè€Œä¸æ˜¯å¼€å‘ç¯å¢ƒã€‚

å¼€å‘äººå‘˜ç»å¸¸æ±‚åŠ©äºä½¿ç”¨ä¸“ç”¨å®¹å™¨æˆ–[è™šæ‹Ÿæœº](https://aws.amazon.com/blogs/compute/nodejs-packages-in-lambda/)ï¼Œè¯•å›¾åŒ¹é…è¿è¡Œæ—¶ç¯å¢ƒï¼Œè¿›è¡Œåº“ç¼–è¯‘ã€‚è¿™ä¸ªè¿‡ç¨‹å®¹æ˜“å‡ºé”™ï¼Œå¾ˆéš¾è°ƒè¯•ï¼Œå¹¶ä¸”å¯¹äºä¸ç†Ÿæ‚‰æ— æœåŠ¡å™¨çš„å¼€å‘äººå‘˜æ¥è¯´æ˜¯ä¸€ä¸ªé—®é¢˜çš„æ¥æºã€‚

Wasm æ˜¯æœ‰æ„ç‹¬ç«‹äºå¹³å°çš„ã€‚è¿™æ„å‘³ç€æœ¬åœ°ç¼–è¯‘çš„ Wasm ä»£ç å¯ä»¥åœ¨ä»»ä½• Wasm è¿è¡Œæ—¶ä¸Šè¿è¡Œã€‚å†ä¹Ÿä¸ç”¨æ‹…å¿ƒæœ¬åœ°åº“çš„å¹³å°æ¶æ„å’Œå¤æ‚çš„å·¥å…·é“¾äº†ï¼

#### [](#additional-runtime-support)é™„åŠ è¿è¡Œæ—¶æ”¯æŒ

ç°åœ¨æœ‰å‡ åç§è¯­è¨€æ”¯æŒç¼–è¯‘æˆ WebAssemblyã€‚

æƒ³ç”¨ Rustï¼ŒCï¼Œæˆ–è€… Lua å†™æ— æœåŠ¡å™¨å‡½æ•°ï¼Ÿæ²¡é—®é¢˜ï¼é€šè¿‡ç”¨ä¸€ä¸ªå°çš„ Node.js å¤„ç†å‡½æ•°åŒ…è£… Wasm æ¨¡å—ï¼Œå¼€å‘äººå‘˜å¯ä»¥ç”¨ä»»ä½•æ”¯æŒâ€œç¼–è¯‘æˆ Wasmâ€çš„è¯­è¨€ç¼–å†™ä»–ä»¬çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚

å¼€å‘äººå‘˜ä¸å¿…å—é™äºå¹³å°æä¾›çš„è¿è¡Œæ—¶ã€‚

### node . JS ä¸­çš„ JS APIs

ä¸‹é¢æ˜¯ä» Node.js åŠ è½½ Wasm æ¨¡å—æ‰€éœ€çš„ä»£ç ã€‚Wasm æ¨¡å—åˆ†å¸ƒåœ¨`.wasm`æ–‡ä»¶ä¸­ã€‚é€šè¿‡æä¾›å¯é…ç½®çš„è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŠ è½½çš„æ¨¡å—è¢«å®ä¾‹åŒ–ä¸ºå®ä¾‹ã€‚ä» Wasm æ¨¡å—å¯¼å‡ºçš„å‡½æ•°å¯ä»¥åœ¨è¿™äº›å®ä¾‹ä¸Šä» Node.js è°ƒç”¨

```
const wasm_module = 'library.wasm'
const bytes = fs.readFileSync(wasm_module)
const wasmModule = new WebAssembly.Module(bytes);
const wasmMemory = new WebAssembly.Memory({initial: 512});
const wasmInstance = new WebAssembly.Instance(wasmModule, { env: { memory: wasmMemory } }}) 
```

#### [](#calling-functions)è°ƒç”¨å‡½æ•°

å¯¼å‡ºçš„ Wasm å‡½æ•°åœ¨`wasmInstance`çš„`exports`å±æ€§ä¸Šå¯ç”¨ã€‚è¿™äº›å±æ€§å¯ä»¥ä½œä¸ºæ™®é€šå‡½æ•°è°ƒç”¨ã€‚

```
const result = wasmInstance.exports.add(2, 2) 
```

#### [](#passing-amp-returning-values)é€šè¿‡&è¿”å›å€¼

å¯¼å‡ºçš„ Wasm å‡½æ•°åªèƒ½æ¥æ”¶å’Œè¿”å›[åŸç”Ÿ Wasm ç±»å‹](https://webassembly.github.io/spec/core/syntax/types.html)ã€‚è¿™([ç›®å‰ä¸º](https://github.com/WebAssembly/reference-types))ä»…æŒ‡æ•´æ•°ã€‚

å¯ä»¥è¡¨ç¤ºä¸ºä¸€ç³»åˆ—æ•°å­—çš„å€¼ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²æˆ–æ•°ç»„ï¼Œå¯ä»¥ä» Node.js ç›´æ¥å°†[å†™å…¥](https://stackoverflow.com/questions/41875728/pass-a-javascript-array-as-argument-to-a-webassembly-function)Wasm å®ä¾‹å†…å­˜å †ã€‚å †å†…å­˜å¼•ç”¨å¯ä»¥ä½œä¸ºå‡½æ•°å‚æ•°å€¼ä¼ é€’ï¼Œå…è®¸ Wasm ä»£ç è¯»å–è¿™äº›å€¼ã€‚ä¸æ”¯æŒæ›´å¤æ‚çš„ç±»å‹(ä¾‹å¦‚ JS å¯¹è±¡)ã€‚

è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥åè¿‡æ¥ä½¿ç”¨[ï¼ŒWasm å‡½æ•°è¿”å›å †å¼•ç”¨ï¼Œç”¨å‡½æ•°ç»“æœä¼ å›å­—ç¬¦ä¸²æˆ–æ•°ç»„ã€‚](https://stackoverflow.com/questions/41353389/how-can-i-return-a-javascript-string-from-a-webassembly-function)

æœ‰å…³ Web Assembly ä¸­å†…å­˜å¦‚ä½•å·¥ä½œçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§æ­¤[é¡µ](https://hacks.mozilla.org/2017/07/memory-in-webassembly-and-why-its-safer-than-you-think/)ã€‚

## [](#examples)ä¾‹å­

äº†è§£äº†åŸºç¡€çŸ¥è¯†ä¹‹åï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€äº›ä¾‹å­...

æˆ‘å°†ä»ä» Node.js æ— æœåŠ¡å™¨å‡½æ•°è°ƒç”¨ä¸€ä¸ª[ç®€å• C å‡½æ•°å¼€å§‹ã€‚è¿™å°†æ¼”ç¤ºç¼–è¯‘å’Œä½¿ç”¨ä¸€ä¸ªå°å‹ C ç¨‹åºä½œä¸º Wasm æ¨¡å—æ‰€éœ€çš„å®Œæ•´æ­¥éª¤ã€‚ç„¶åæˆ‘å°†çœ‹ä¸€ä¸ªæ›´çœŸå®çš„ç”¨ä¾‹ï¼Œ](https://gist.github.com/jthomas/5de757fd36b3c6904e5c5f12c8264b41)[åŠ¨æ€å›¾åƒå¤§å°è°ƒæ•´](https://github.com/jthomas/openwhisk-image-resize-wasm)ã€‚è¿™å°†ä½¿ç”¨ç¼–è¯‘æˆ Wasm çš„ C åº“æ¥æé«˜æ€§èƒ½ã€‚

ç¤ºä¾‹å°†è¢«éƒ¨ç½²åˆ° [IBM äº‘åŠŸèƒ½](https://cloud.ibm.com/functions)([Apache open whish](https://openwhisk.apache.org/))ã€‚å®ƒä»¬åº”è¯¥å¯ä»¥åœ¨å…¶ä»–æ— æœåŠ¡å™¨å¹³å°ä¸Šå·¥ä½œ(æ”¯æŒ Node.js è¿è¡Œæ—¶),åªéœ€å¯¹å¤„ç†å‡½æ•°çš„æ¥å£åšä¸€äº›å°çš„ä¿®æ”¹ã€‚

### [](#simple-function-calls)ç®€å•å‡½æ•°è°ƒç”¨

#### [](#create-source-files)åˆ›å»ºæºæ–‡ä»¶

*   åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶`add.c`:

```
int add(int a, int b) {
  return a + b;
} 
```

*   ç”¨ä»¥ä¸‹å†…å®¹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶(`index.js`):

```
'use strict';
const fs = require('fs');
const util = require('util')

const WASM_MODULE = 'add.wasm'
let wasm_instance 

async function load_wasm(wasm_module) {
  if (!wasm_instance) {
    const bytes = fs.readFileSync(wasm_module);
    const memory = new WebAssembly.Memory({initial: 1});
    const env = {
      __memory_base: 0, memory
    }

    const { instance, module } = await WebAssembly.instantiate(bytes, { env });
    wasm_instance = instance
  }

  return wasm_instance.exports._add
}

exports.main = async function ({ a = 1, b = 1 }) {
  const add = await load_wasm(WASM_MODULE)
  const sum = add(a, b)
  return { sum }
} 
```

*   ç”¨ä»¥ä¸‹å†…å®¹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶(`package.json`):

```
{  "name":  "wasm",  "version":  "1.0.0",  "main":  "index.js"  } 
```

#### [](#compile-wasm-module)ç¼–è¯‘ Wasm æ¨¡å—

æ­¤ C æºæ–‡ä»¶éœ€è¦ç¼–è¯‘ä¸º WebAssembly æ¨¡å—ã€‚æœ‰ä¸åŒçš„é¡¹ç›®æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æˆ‘å°†ä½¿ç”¨ [Emscripten](https://emscripten.org/) ï¼Œå®ƒä½¿ç”¨ LLVM å°† C å’Œ C++ç¼–è¯‘æˆ WebAssemblyã€‚

*   [å®‰è£…](https://emscripten.org/docs/getting_started/downloads.html)[å·¥å…·é“¾](https://emscripten.org/)ã€‚

*   è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç”Ÿæˆ Wasm æ¨¡å—ã€‚

```
emcc -s WASM=1 -s SIDE_MODULE=1 -s EXPORTED_FUNCTIONS="['_add']" -O1 add.c -o add.wasm 
```

*`SIDE_MODULE`é€‰é¡¹å‘Šè¯‰ç¼–è¯‘å™¨ Wasm æ¨¡å—å°†ä½¿ç”¨ JS APIs æ‰‹åŠ¨åŠ è½½ã€‚è¿™å°†åœæ­¢ Emscripten è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„ JS æ–‡ä»¶æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚Wasm æ¨¡å—ä¸Šæ˜¾ç¤ºçš„åŠŸèƒ½ç”±`EXPORTED_FUNCTIONS`é…ç½®å‚æ•°æ§åˆ¶ã€‚*

#### [](#deploy-serverless-function)éƒ¨ç½²æ— æœåŠ¡å™¨åŠŸèƒ½

*   ç”¨æºæ–‡ä»¶åˆ›å»ºéƒ¨ç½²åŒ…ã€‚

```
zip action.zip index.js add.wasm package.json 
```

*   ä»éƒ¨ç½²åŒ…åˆ›å»ºæ— æœåŠ¡å™¨åŠŸèƒ½ã€‚

```
ibmcloud wsk action create wasm action.zip --kind nodejs:10 
```

*   è°ƒç”¨æ— æœåŠ¡å™¨åŠŸèƒ½æµ‹è¯• Wasm æ¨¡å—ã€‚

```
$ ibmcloud wsk action invoke wasm -r -p a 2 -p b 2
{
    "sum": 4
} 
```

æœ‰ç”¨ï¼ğŸ‰ğŸ‰ğŸ‰

è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½†å®ƒæ¼”ç¤ºäº†å°† C æºæ–‡ä»¶ç¼–è¯‘æˆ Wasm æ¨¡å—å¹¶ä» Node.js æ— æœåŠ¡å™¨å‡½æ•°è°ƒç”¨å¯¼å‡ºå‡½æ•°æ‰€éœ€çš„å·¥ä½œæµã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ›´ç°å®çš„ä¾‹å­...

### [](#dynamic-image-resizing)åŠ¨æ€è°ƒæ•´å›¾åƒå¤§å°

è¿™ä¸ª[åº“](https://github.com/jthomas/openwhisk-image-resize-wasm)åŒ…å«ä¸€ä¸ªæ— æœåŠ¡å™¨å‡½æ•°ï¼Œä½¿ç”¨ä¸€ä¸ªé€šè¿‡ WebAssembly è°ƒç”¨çš„ C åº“æ¥è°ƒæ•´å›¾åƒçš„å¤§å°ã€‚å®ƒæ˜¯ Cloudflare ä¸ºä»–ä»¬çš„å·¥äººå¹³å°åˆ›å»ºçš„[åŸå§‹ä»£ç ](https://github.com/cloudflare/cloudflare-workers-wasm-demo)çš„ä¸€ä¸ªåˆ†æ”¯ã€‚æœ‰å…³å­˜å‚¨åº“åŒ…å«çš„å†…å®¹ä»¥åŠæ–‡ä»¶å¦‚ä½•å·¥ä½œçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§åŸå§‹å­˜å‚¨åº“ã€‚

#### [](#checkout-repository)æ£€å‡ºå­˜å‚¨åº“

*   é€šè¿‡ç­¾å‡ºè¿™ä¸ª[å­˜å‚¨åº“](https://github.com/jthomas/openwhisk-image-resize-wasm)æ¥æ£€ç´¢æºæ–‡ä»¶ã€‚

```
git clone https://github.com/jthomas/openwhisk-image-resize-wasm 
```

è¿™ä¸ªåº“åŒ…å«é¢„ç¼–è¯‘çš„ Wasm æ¨¡å—(`resize.wasm`)ï¼Œéœ€è¦ä½¿ç”¨ [stb åº“](https://github.com/nothings/stb)æ¥è°ƒæ•´å›¾åƒå¤§å°ã€‚è¯¥æ¨¡å—å…¬å¼€äº†ä¸¤ä¸ªå‡½æ•°:`init`å’Œ`resize`ã€‚

`init`å‡½æ•°[è¿”å›ä¸€ä¸ªå †å¼•ç”¨](https://github.com/jthomas/openwhisk-image-resize-wasm/blob/master/main.c#L29-L38)å°†ç”¨äºå¤„ç†[çš„å›¾åƒå­—èŠ‚å†™å…¥](https://github.com/jthomas/openwhisk-image-resize-wasm/blob/master/worker.js#L59)ã€‚ç”¨ä¸¤ä¸ªå€¼è°ƒç”¨`resize` [å‡½æ•°](https://github.com/jthomas/openwhisk-image-resize-wasm/blob/master/main.c#L49)ï¼Œå›¾åƒå­—èŠ‚æ•°ç»„é•¿åº¦å’Œæ–°å®½åº¦å€¼ã€‚å®ƒä½¿ç”¨è¿™äº›å€¼ä»å †ä¸­è¯»å–å›¾åƒå­—èŠ‚ï¼Œå¹¶è°ƒç”¨åº“å‡½æ•°å°†å›¾åƒè°ƒæ•´åˆ°æ‰€éœ€çš„å®½åº¦ã€‚è°ƒæ•´å¤§å°çš„å›¾åƒå­—èŠ‚è¢«å†™å›åˆ°å †ä¸­ï¼Œå¹¶è¿”å›æ–°çš„å­—èŠ‚æ•°ç»„é•¿åº¦ã€‚

#### [](#deploy-serverless-function)éƒ¨ç½²æ— æœåŠ¡å™¨åŠŸèƒ½

*   ä»æºæ–‡ä»¶åˆ›å»ºéƒ¨ç½²åŒ…ã€‚

```
zip action.zip resizer.wasm package.json worker.js 
```

*   ä»éƒ¨ç½²åŒ…åˆ›å»ºæ— æœåŠ¡å™¨åŠŸèƒ½ã€‚

```
ibmcloud wsk action update resizer action.zip --kind nodejs:10 --web true 
```

*   æ£€ç´¢ Web æ“ä½œçš„ HTTP URLã€‚

```
ibmcloud wsk action get resizer --url 
```

*è¿™åº”è¯¥ä¼šè¿”å›ä¸€ä¸ªç½‘å€åƒ:* `https://<region>.cloud.ibm.com/api/v1/web/<ns>/default/resizer`

*   æ‰“å¼€æ‰©å±•åä¸º`.http`çš„ Web æ“ä½œ URLã€‚

```
https://<region>.cloud.ibm.com/api/v1/web/<ns>/default/resizer.http 
```

è¿™å°†è¿”å›ä¸‹é¢çš„å›¾ç‰‡ï¼Œå°ºå¯¸ä» 900 åƒç´ è°ƒæ•´åˆ° 250 åƒç´ ã€‚

[![Pug with Ice-cream](../Images/0034b27166fdc64ab09cd09caf71ad46.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--VTGm4vh6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://bit.ly/2ZlP838)

URL æŸ¥è¯¢å‚æ•°(`url`å’Œ`width`)å¯ç”¨äºä¿®æ”¹å›¾åƒæºæˆ–ä¸‹ä¸€å¹…å›¾åƒçš„è¾“å‡ºå®½åº¦ï¼Œä¾‹å¦‚

```
https://<region>.cloud.ibm.com/api/v1/web/<ns>/default/resizer.http?url=<IMG_URL>&width=500 
```

## [](#conclusion)ç»“è®º

WebAssembly å¯èƒ½æ˜¯ä½œä¸ºä¸€ç§åœ¨æµè§ˆå™¨ä¸­è¿è¡Œæœ¬æœºä»£ç çš„æ–¹å¼è€Œå¼€å§‹çš„ï¼Œä½†å¾ˆå¿«æ‰©å±•åˆ°äº† Node.js ç­‰æœåŠ¡å™¨ç«¯è¿è¡Œæ—¶ç¯å¢ƒã€‚WebAssembly æ¨¡å—åœ¨ä»»ä½•å…·æœ‰ Node.js v8.0.0+è¿è¡Œæ—¶çš„æ— æœåŠ¡å™¨å¹³å°ä¸Šéƒ½å—æ”¯æŒã€‚

Wasm æä¾›äº†ä¸€ç§å¿«é€Ÿã€å®‰å…¨å’Œå¯é çš„æ–¹å¼æ¥ä»ç¼–è¯‘è¯­è¨€ä¸­è¿é€å¯ç§»æ¤æ¨¡å—ã€‚å¼€å‘äººå‘˜ä¸å¿…æ‹…å¿ƒæ¨¡å—æ˜¯å¦ä¸ºæ­£ç¡®çš„å¹³å°æ¶æ„ç¼–è¯‘ï¼Œæˆ–è€…æ˜¯å¦é“¾æ¥åˆ°ä¸å¯ç”¨çš„åŠ¨æ€åº“ã€‚è¿™å¯¹äº Node.js ä¸­çš„æ— æœåŠ¡å™¨å‡½æ•°å°¤å…¶æœ‰ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºç”Ÿäº§è¿è¡Œæ—¶ç¼–è¯‘æœ¬æœºåº“å¯èƒ½ä¼šå¾ˆå›°éš¾ã€‚

Wasm æ¨¡å—å¯ç”¨äºæé«˜è®¡ç®—å¯†é›†å‹è®¡ç®—çš„æ€§èƒ½ï¼Œå‡å°‘è°ƒç”¨æ—¶é—´ï¼Œä»è€Œé™ä½æˆæœ¬ã€‚å®ƒè¿˜æä¾›äº†ä¸€ç§åœ¨æ— æœåŠ¡å™¨å¹³å°ä¸Šåˆ©ç”¨é¢å¤–è¿è¡Œæ—¶çš„ç®€å•æ–¹æ³•ï¼Œè€Œæ— éœ€å¹³å°æä¾›å•†è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚