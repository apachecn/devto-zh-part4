# Unity ä¸­ä»£ç†å’Œäº‹ä»¶çš„æ•ˆç”¨

> åŸæ–‡ï¼š<https://dev.to/timrodz/the-utility-of-delegates-and-events-in-unity-48k1>

*æœ€åˆå‘è¡¨äº[timrodz.com](http://www.timrodz.com/blog/the-utility-of-delegates-and-events-in-unity/)ã€‚*

**æ›´æ–°** : [@damagefilter](https://twitter.com/damagefilter/) å†™äº†ä¸€ä¸ªæ›´é«˜çº§çš„å…³äº Unity äº‹ä»¶çš„æ•™ç¨‹ã€‚å»çœ‹çœ‹[è¿™é‡Œ](http://www.indiedb.com/members/damagefilter/blogs/event-and-unity)ğŸ˜„ã€‚

ä½ å¥½ã€‚æˆ‘çš„åå­—æ˜¯èƒ¡å®‰Â·ç½—å¾·é‡Œæ ¼æ–¯ã€‚æˆ‘æ˜¯ä¸€åå·´æ‹¿é©¬æ•°æ®&æ¸¸æˆå¼€å‘è€…å’Œç¨‹åºå‘˜ï¼Œä½åœ¨æ–°è¥¿å…°ã€‚è¿™ç¯‡åšæ–‡æ˜¯ä¸º [notGDC](http://www.notgdc.fun/) å†™çš„ï¼Œå› ä¸ºæˆ‘æƒ³å‘ç¤¾åŒºè´¡çŒ®æˆ‘çš„ä¸€äº›çŸ¥è¯†ã€‚å®ƒé’ˆå¯¹çš„æ˜¯é‚£äº›å¸Œæœ›ä» Unity ä¸­è·å¾—æœ€å¤§æ”¶ç›Šçš„ç¨‹åºå‘˜ï¼Œä¸ç®¡ä»–ä»¬çš„æŠ€èƒ½æ°´å¹³å¦‚ä½•ã€‚åˆå§‹é˜¶æ®µå°†æ˜¯ç›¸å½“åŸºç¡€çš„ï¼Œå› ä¸ºæˆ‘å¸Œæœ›æ¯ä¸ªäººéƒ½ç†è§£è¿™ä¸ªæ•™ç¨‹ï¼Œæ‰€ä»¥è¯·éšæ„è·³è¿‡ä½ å¸Œæœ›çš„éƒ¨åˆ†ï¼(æˆ–è€…ç›´æ¥æŠ“å–[æºä»£ç ](https://github.com/timrodz/unity-callback_examples))ã€‚æˆ‘ç”¨çš„å·¥å…·æ˜¯ Unity [2017.3.1p2](https://unity3d.com/unity/qa/patch-releases/2017.3.1p2) å’Œ [Visual Studio ä»£ç ](https://code.visualstudio.com/)ã€‚

# ğŸ“©ä»€ä¹ˆ

åœ¨æ¸¸æˆä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å¸Œæœ›é€šçŸ¥å¯¹è±¡æ­£åœ¨å‘ç”Ÿçš„äº‹ä»¶ï¼Œè€Œä¸å¿…å°†å®ƒä»¬è”ç³»åœ¨ä¸€èµ·ã€‚è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹æƒ…å†µã€‚æ‚¨çš„ UI ç³»ç»Ÿå…·æœ‰:

*   ç”¨äºç¼–å†™æ¶ˆæ¯çš„è¾“å…¥å­—æ®µã€‚
*   å‘é€æ¶ˆæ¯çš„æŒ‰é’®ã€‚
*   æ˜¾ç¤ºå·²å‘é€æ¶ˆæ¯çš„å­—æ®µã€‚

å½“ç”¨æˆ·ç‚¹å‡»'*å‘é€æ¶ˆæ¯*'æŒ‰é’®æ—¶ï¼Œä½ æƒ³é€šçŸ¥ UI æ§åˆ¶å™¨ä¸€ä¸ªæ–°çš„æ¶ˆæ¯å·²ç»è¢«å‘é€ã€‚æ­¤åï¼Œæ‚¨å°†ç”¨æ–°é‚®ä»¶æ›¿æ¢å½“å‰é‚®ä»¶ã€‚æœ€åï¼Œè¾“å…¥å­—æ®µå°†è¢«æ¸…é™¤ã€‚

è¿™æ˜¯æ¸¸æˆçš„ GIF å›¾ç‰‡:

[![Simple, but works.](img/ed42e577a9b1df8d74ee3a3ab9693f0e.png)](https://res.cloudinary.com/practicaldev/image/fetch/s---TySc8k5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://raw.githubusercontent.com/Mad-Hyrax/blog/gh-pages/assets/img/posts/notgdc_intro.gif)

# ğŸ“¤æ€ä¹ˆ

ä¸ºäº†å®ç°æœŸæœ›çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†é€šè¿‡å®ç°**å§”æ‰˜**æ¥å¤„ç†è§£å†³æ–¹æ¡ˆã€‚å§”æ‰˜å…è®¸æˆ‘ä»¬å°†æ–¹æ³•è§†ä¸ºå˜é‡ï¼Œå®ƒä»¬å°±åƒé‚®ä»¶åˆ—è¡¨ä¸€æ ·å·¥ä½œã€‚è®¢æˆ·å°†æ”¶åˆ°ç”µå­é‚®ä»¶ï¼Œå¹¶å¯ä»¥éšæ—¶é€‰æ‹©é€€å‡ºã€‚**æ³¨æ„**:ä½ å¯ä»¥è®¢é˜…ä»»æ„å¤šçš„æ–¹æ³•ã€‚**äº‹ä»¶**éå¸¸ç›¸ä¼¼ã€‚ä¸»è¦çš„åŒºåˆ«æ˜¯ä»–ä»¬åœ¨**å§”æ‰˜**å®ä¾‹ä¸Šå¢åŠ äº†ä¸€å±‚æŠ½è±¡å’Œä¿æŠ¤ã€‚è¿™ç§ä¿æŠ¤é˜²æ­¢å§”æ‰˜çš„å®¢æˆ·ç«¯é‡ç½®å§”æ‰˜åŠå…¶è°ƒç”¨åˆ—è¡¨ï¼Œå¹¶ä¸”åªå…è®¸åœ¨è°ƒç”¨åˆ—è¡¨ä¸­æ·»åŠ æˆ–åˆ é™¤ç›®æ ‡([æº](https://stackoverflow.com/questions/29155/what-are-the-differences-between-delegates-and-events))ã€‚

åœ¨ç¼–ç¨‹æ–¹é¢ï¼Œæˆ‘ä»¬å°†æœ‰ä¸¤ä¸ªè„šæœ¬:ä¸€ä¸ªäº‹ä»¶æ§åˆ¶å™¨å’Œä¸€ä¸ª UI æ§åˆ¶å™¨ã€‚äº‹ä»¶æ§åˆ¶å™¨å°†ä½œä¸ºæˆ‘ä»¬çš„é‚®ä»¶åˆ—è¡¨ï¼Œå®ƒå°†æœ‰ä¸€ä¸ªäº‹ä»¶: **OnMessageUpdateRequest** ã€‚å› ä¸ºæˆ‘ä»¬æƒ³ç”¨å½“å‰çš„æ¶ˆæ¯æ›¿æ¢è¾“å…¥å­—æ®µçš„æ¶ˆæ¯ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¼šå‘å‡ºæ–°çš„æ¶ˆæ¯æ›´æ–°è¯·æ±‚ã€‚

UI æ§åˆ¶å™¨å°†æœ‰ä¸€ä¸ªè®¢é˜…äº† **OnMessageUpdateRequest** äº‹ä»¶çš„ **UpdateMessage** æ–¹æ³•ï¼Œå®ƒå°†ä½œä¸ºä¸€ä¸ª*ç›‘å¬å™¨*å·¥ä½œã€‚æ­¤å¤–ï¼Œä¸ºäº†å‘æ‚¨ä»‹ç» UnityEventsï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„æŒ‰é’®å’Œå®ƒçš„åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬å°†åœ¨ç¨åè®¨è®ºã€‚æœ¬è´¨ä¸Š:å§”æ‰˜ã€äº‹ä»¶å’Œ UnityEvents éå¸¸ç›¸ä¼¼ã€‚

# ğŸ“¨å±¥è¡Œ

åœ¨ Unity ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°åœºæ™¯ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ ä»¥ä¸‹å¯¹è±¡:

*   ä¸¤ä¸ªç©ºçš„æ¸¸æˆå¯¹è±¡ã€‚åˆ†åˆ«å°†å…¶é‡å‘½åä¸º' *UI æ§åˆ¶å™¨*å’Œ'*äº‹ä»¶æ§åˆ¶å™¨*ã€‚
*   å³é”®å•å‡»å±‚æ¬¡è§†å›¾:
    *   é€‰æ‹© **UI** â†’ **æŒ‰é’®**ã€‚
    *   é€‰æ‹© **UI** â†’ **è¾“å…¥** **å­—æ®µ**ã€‚
    *   é€‰æ‹© **UI** â†’ **æ–‡æœ¬**ã€‚

> **æ³¨æ„**:æ–°çš„ UI å¯¹è±¡ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ª**ç”»å¸ƒ**å’Œä¸€ä¸ª**äº‹ä»¶ç³»ç»Ÿ**ï¼Œå¦‚æœä½ çš„åœºæ™¯ä¸­è¿˜æ²¡æœ‰å®ƒä»¬çš„è¯ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º**ç”»å¸ƒ**æ˜¾ç¤º UI å…ƒç´ ï¼Œè€Œ **EventSystem** å¤„ç†æ¥è‡ªéæŒ‰é”®è¾“å…¥çš„äº¤äº’â€”â€”å®ƒä»¬æ˜¯ä»»ä½• UI ç³»ç»Ÿå·¥ä½œæ‰€å¿…éœ€çš„ã€‚

æ‚¨çš„åœºæ™¯åº”è¯¥ç±»ä¼¼äºä¸‹å›¾:

[![A very simple scene.](img/494436449f0f0156bbb0ae77039bda10.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--kJgXS1NG--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/1000/0%2A_T31weY-0J-2ovBf.png)

# åº”ç”¨æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆ

å®Œæˆåœºæ™¯è®¾ç½®åï¼Œå°±è¯¥åˆ›å»ºä»¥ä¸‹ C#è„šæœ¬äº†:

*   **UIController.cs**
*   **EventController.cs**

è¿™äº›è„šæœ¬ä¸æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ç©ºæ¸¸æˆå¯¹è±¡åŒåã€‚å®ƒä»¬å°†ä½œä¸ºç»„ä»¶é™„åŠ åˆ°å®ƒä»¬ä¸Šé¢ã€‚

## UIController.cs

ä¸€æ—¦åˆ›å»ºäº†è¿™ä¸ªç±»ï¼Œå®ƒåº”è¯¥ç±»ä¼¼äºä¸‹é¢çš„ä»£ç ç‰‡æ®µ:

```
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class UIController : MonoBehaviour
{
    // Use this for initialization
    void Start() {}

    // Update is called once per frame
    void Update() {}
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ UIï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åŒ…å« *UnityEngineã€‚UI* åº“ï¼Œä»¥ä¾¿è®¿é—® UI å…ƒç´ çš„åŠŸèƒ½ã€‚åœ¨è¡Œ **3** å’Œ **5** ä¹‹é—´ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ç‰‡æ®µ:

```
using UnityEngine.UI; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å®Œæˆä¹‹åï¼Œç§»é™¤ **Update** æ–¹æ³•â€”â€”æˆ‘ä»¬ä¸å†éœ€è¦å®ƒã€‚ç°åœ¨æˆ‘ä»¬å·²ç»å¯¼å…¥äº† UI åº“ï¼Œæˆ‘ä»¬å°†ç»§ç»­åœ¨åœºæ™¯ä¸­åˆ›å»ºå¯¹ UI å¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨ UIController ç±»ä¸­ï¼Œåœ¨ **Start** æ–¹æ³•ä¹‹å‰æ·»åŠ ä»¥ä¸‹å£°æ˜:

```
public Button ButtonSendMessage;
public InputField InputField;
public Text MessageDisplay; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–¹æ³•: **SendMessageUpdateRequest** å’Œ **UpdateMessage** ã€‚åœ¨ UIController.cs ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç è¡Œ:

```
void SendMessageUpdateRequest() {}

void UpdateMessage(string _message) {} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ‚¨æ­£ç¡®åœ°éµå¾ªäº†è¿™äº›æ­¥éª¤ï¼Œé‚£ä¹ˆæ‚¨çš„ç±»ç°åœ¨åº”è¯¥æ˜¯è¿™æ ·çš„: [Gist url](https://gist.github.com/timrodz/db92598bed64de07ff71a1e772df79a2) ã€‚

å» Unity ç£å¯Ÿé‚£é‡Œã€‚ç‚¹å‡» **UI æ§åˆ¶å™¨**æ¸¸æˆå¯¹è±¡ï¼Œç„¶åç‚¹å‡»â€œæ·»åŠ ç»„ä»¶â€ï¼Œä»è¿™é‡Œä½ å°†æ·»åŠ *UI æ§åˆ¶å™¨*è„šæœ¬ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥å°†è„šæœ¬æ‹–æ”¾åˆ°æ¸¸æˆå¯¹è±¡ä¸­ã€‚æ·»åŠ åï¼ŒUI æ§åˆ¶å™¨ç»„ä»¶å°†æœ‰ä¸‰ä¸ªå¯è§çš„å˜é‡ã€‚ä¹‹åï¼Œç»§ç»­å°†åŒ¹é…çš„ç»„ä»¶æ‹–æ”¾åˆ°**ç”»å¸ƒ**å¯¹è±¡ä¸­ã€‚

> **æ³¨æ„**:UI æ§åˆ¶å™¨ **GameObject** æŒæœ‰**ç»„ä»¶**æ¯”å¦‚ Transformã€‚UIController è„šæœ¬å¯ä»¥ä½œä¸º**ç»„ä»¶**é™„åŠ åˆ°ä»»ä½•**æ¸¸æˆå¯¹è±¡**ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å…¶é™„åŠ åˆ° UI æ§åˆ¶å™¨æ¸¸æˆå¯¹è±¡ã€‚

[![Adding our components to the UI Controller.](img/17976ef20e9f59b6044e97742ea01124.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--m2Ws-_U9--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2ANvRgBceLTzj7ZQ39gkHFCA.gif)

åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¨è®ºä¸€ä¸‹ **UnityEvents** ä»¥åŠæˆ‘ä»¬å¦‚ä½•åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨å®ƒä»¬ã€‚å¦‚æœæ‚¨å•å‡»ç”»å¸ƒå†…çš„æŒ‰é’®ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹ç»„ä»¶:

[![A buttonâ€™s view in the Unity inspector.](img/a5d23dd5e8fcb2c06fca771c87c4b0ea.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--X7AwboYV--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/800/1%2AKp3DWqTH84BeIZrMrBx9eA.png)

åœ¨ç»„ä»¶è§†å›¾çš„åº•éƒ¨ï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªå¸¦æœ‰ç©ºåˆ—è¡¨å’Œä¸€ä¸ª **+** / **-** ç¬¦å·çš„ **On Click ()** å­—æ®µã€‚è¿™æ˜¯ä¸€ä¸ª **UnityEvent** :å®ƒä»¬å…è®¸ä½ åœ¨å½“å‰åœºæ™¯ä¸­æ·»åŠ å¯¹è±¡çš„æ–¹æ³•ï¼å› æ­¤ï¼Œæ— è®ºæ‚¨åœ¨è¿™é‡Œæ·»åŠ ä»€ä¹ˆæ–¹æ³•ï¼Œå½“æŒ‰é’®æ”¶åˆ°ç‚¹å‡»æ—¶éƒ½ä¼šè¢«è°ƒç”¨( **onClick** )ã€‚

å¦‚æœæ‚¨åˆ†é…çš„æ–¹æ³•ä¸ç»„ä»¶(åœ¨æœ¬ä¾‹ä¸­æ˜¯æˆ‘ä»¬çš„æŒ‰é’®)ä¸åœ¨åŒä¸€ä¸ªå±‚æ¬¡ç»“æ„ä¸­ï¼Œé‚£ä¹ˆå®ƒçš„å¼•ç”¨å¯èƒ½ä¼šä¸¢å¤±ã€‚è¿™å¯èƒ½ä¼šäº§ç”Ÿè®¸å¤šä¸å¸Œæœ›çš„æƒ…å†µï¼Œæ‚¨å¿…é¡»ä¸€æ¬¡åˆä¸€æ¬¡åœ°é‡æ–°åˆ†é…æ–¹æ³•ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä»£ç å‘æŒ‰é’®çš„ **onClick** äº‹ä»¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨ã€‚åœ¨**å¯åŠ¨**æ–¹æ³•çš„å†…éƒ¨ï¼Œæ·»åŠ ä¸‹é¢ä¸€è¡Œ:

```
ButtonSendMessage.onClick.AddListener(SendMessageUpdateRequest); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**AddListener** æ–¹æ³•å…è®¸æˆ‘ä»¬å°†ä»»ä½•ç±»çš„å‡½æ•°è®¢é˜…åˆ°æ‰€éœ€çš„äº‹ä»¶ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ **onClick** ã€‚æ‰€é‡‡ç”¨çš„å‚æ•°æ˜¯ç±»å‹ *UnityAction* ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯æ ¹æ® Unity è¢«è®¤ä¸ºæ˜¯æ–¹æ³•çš„ä»»ä½•ä¸œè¥¿ã€‚ç°åœ¨ï¼Œæ¯æ¬¡æ‚¨å•å‡»'*å‘é€æ¶ˆæ¯*æŒ‰é’®ï¼Œæ— è®ºå†…å®¹å¦‚ä½•ï¼Œéƒ½ä¼šè°ƒç”¨ **SendMessageUpdateRequest** æ–¹æ³•ã€‚

> **æ³¨æ„**:**AddListener**æ–¹æ³•åªæ¥å—ä¸å¸¦å‚æ•°çš„ UnityEventsï¼Œé™¤éä½ é€šè¿‡ Lambda è¡¨è¾¾å¼æ·»åŠ å®ƒä»¬ã€‚

## äº‹ä»¶æ§åˆ¶å™¨. cs

åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜æˆ‘ä»¬çš„å§”æ‰˜å¹¶å®ç°å®ƒçš„åŠŸèƒ½ã€‚
åœ¨ EventController.cs ä¸­æ·»åŠ ä»¥ä¸‹å£°æ˜(åœ¨**å¯åŠ¨**æ–¹æ³•ä¹‹å‰):

```
public delegate void OnMessageUpdateRequestDelegate(string _message); 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å£°æ˜æˆ‘ä»¬çš„å§”æ‰˜**OnMessageUpdateRequestDelegate**ã€‚åœ¨å£°æ˜çš„è¿™ä¸€éƒ¨åˆ†ï¼Œæ‚¨æŒ‡å®šå®ƒå°†æ‹¥æœ‰çš„å‚æ•°(æ²¡æœ‰å‚æ•°ä¹Ÿæ˜¯æœ‰æ•ˆçš„)ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ä¸²*æ¶ˆæ¯ã€‚*

```
public static OnMessageUpdateRequestDelegate OnMessageUpdateRequest; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°† **OnMessageUpdateRequest** å£°æ˜ä¸º*OnMessageUpdateRequestDelegate*ã€‚è¿™æ˜¯å› ä¸ºå§”æ‰˜æ˜¯è¢«è§†ä¸ºå˜é‡çš„æ–¹æ³•ã€‚æ­¤å¤–ï¼Œå®ƒæ˜¯é™æ€çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿä»å…¶ä»–ç±»è®¿é—®å®ƒï¼Œè€Œä¸å¿…ä¿å­˜å¯¹ EventController çš„å¼•ç”¨(è¿™å®Œå…¨æ˜¯å¯é€‰çš„ï¼Œå¹¶ä¸”å®ƒå°†ä¸æ‚¨çš„å®ç°/ç¼–ç å®è·µæœ‰å¾ˆå¤§çš„ä¸åŒ)ã€‚

ç°åœ¨ï¼Œå°†**å¼€å§‹**çš„æ–¹æ³•æ›¿æ¢ä¸ºä»¥ä¸‹ä¸€ç§:

```
public static void Event_OnMessageUpdateRequest(string _message)
{
    Debug.LogFormat("-- EventController // Received a request to update message: {0}", _message);

    OnMessageUpdateRequest(_message);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**Final EventController . cs**
å¦‚æœä½ æŒ‰ç…§æ­¥éª¤æ­£ç¡®ï¼Œä½ çš„ event controller ç±»åº”è¯¥æ˜¯è¿™æ ·çš„: [Gist url](https://gist.github.com/timrodz/21e7339f8dab8d3a0ac532b8012f274f) ã€‚

## å› UIController.cs

ç°åœ¨æˆ‘ä»¬çš„ EventController ä»£ç å·²ç»å‡†å¤‡å¥½äº†ï¼Œæ˜¯æ—¶å€™ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„å®ç°äº†ã€‚æˆ‘ä»¬ç°åœ¨æƒ³ä¸º EventController çš„ **OnMessageUpdateRequest** å§”æ‰˜è®¢é˜…æˆ‘ä»¬çš„ **UpdateMessage** æ–¹æ³•ã€‚åœ¨ Start æ–¹æ³•ä¸­ï¼Œæ·»åŠ è¿™è¡Œä»£ç :

`EventController.OnMessageUpdateRequest += UpdateMessage;`

> **æ³¨æ„**:æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ AddListenerï¼Œå› ä¸ºä»£ç†/äº‹ä»¶å¯ä»¥é€šè¿‡ **+=** / **-=** æ“ä½œç¬¦ç®€å•åœ°æ·»åŠ /åˆ é™¤ç›‘å¬å™¨ã€‚åŒæ ·ï¼Œå§”æ‰˜å¯ä»¥ç­‰äº(=)ä¸€ä¸ªæ–¹æ³•ï¼Œè€Œäº‹ä»¶ä¸èƒ½ï¼Œå®ƒä»¬éœ€è¦ä½¿ç”¨ **+=** / **-=** èµ‹å€¼æ“ä½œç¬¦ã€‚

åœ¨æˆ‘ä»¬çš„ SendMessageUpdateRequest æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å°†æ¶ˆæ¯å­˜å‚¨åœ¨ä¸€ä¸ªä¸´æ—¶å­—ç¬¦ä¸²ä¸­ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å°†è°ƒç”¨ EventController çš„**Event _ OnMessageUpdateRequest**æ–¹æ³•:

```
void SendMessageUpdateRequest()
{
    // Store the input field's text into a string
    string message = InputField.text;

    EventController.Event_OnMessageUpdateRequest(message);
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¦‚æœæ‚¨è°ƒç”¨ EventController.csï¼Œ**Event _ OnMessageUpdateRequest**æ–¹æ³•çš„å†…å®¹è°ƒç”¨ OnMessageUpdateRequest å§”æ‰˜ã€‚å› ä¸º **SendMessageUpdateRequest** è°ƒç”¨äº†äº‹ä»¶ï¼Œè€Œ **UpdateMessage** è®¢é˜…äº†äº‹ä»¶ï¼Œæ‰€ä»¥ä¹Ÿä¼šè¢«è°ƒç”¨ã€‚

## ğŸ—³æ³•è°ƒç”¨é¡ºåº

1.  æŒ‰é’®'*å‘é€æ¶ˆæ¯*'**onClick***unity event*è°ƒç”¨**SendMessageUpdateRequest**(*è®¢æˆ·*)ã€‚
2.  **SendMessageUpdateRequest***æ–¹æ³•*è°ƒç”¨**äº‹ä»¶ _OnMessageUpdateRequest** ã€‚
3.  **Event _ OnMessageUpdateRequest***æ–¹æ³•*è°ƒç”¨ **OnMessageUpdateRequest** ã€‚
4.  **on message update request***delegate*è°ƒç”¨**update message**(*subscriber*)ã€‚

è¿™å¯èƒ½ä¼šä»¤äººå›°æƒ‘ï¼Œæ‰€ä»¥è®©æˆ‘ä»¥ä¸€ç§æ›´æ˜“è¯»çš„æ–¹å¼é‡æ–°è¡¨è¿°å®ƒä»¬:å› ä¸º*æ–¹æ³•***SendMessageUpdateRequest**è®¢é˜…äº† Button çš„**onClick***UnityEvent*ï¼Œæ‰€ä»¥æ¯æ¬¡ onClick ä¹Ÿè¢«è°ƒç”¨æ—¶éƒ½ä¼šè¢«è°ƒç”¨ã€‚æ•°å­— 4 ä¹Ÿæ˜¯å¦‚æ­¤:å› ä¸º*æ–¹æ³•* **UpdateMessage** è¢«è®¢é˜…ç»™å§”æ‰˜ **OnMessageUpdateRequest** ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨ **OnMessageUpdateRequest** æ—¶éƒ½ä¼šè¢«è°ƒç”¨ã€‚å¸Œæœ›äº‹æƒ…ä¼šæœ‰æ‰€ç¼“è§£ï¼

æœ€åï¼Œæˆ‘ä»¬éµå¾ªæœ€åçš„æ­¥éª¤:æ›¿æ¢æ¶ˆæ¯ï¼Œå¹¶æ¸…é™¤è¾“å…¥å­—æ®µã€‚

```
void UpdateMessage(string _message)
{
    // Print the message
    Debug.LogFormat("-- UIController // Updating message: {0}", _message);

    // Replace our message display text with the contents of the message variable
    MessageDisplay.text = _message;

    // Reset the text of our input field
    InputField.text = "";
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

**Final UIController.cs**
å¦‚æœä½ æ­£ç¡®åœ°éµå¾ªäº†æ‰€æœ‰çš„æ­¥éª¤ï¼Œä½ çš„ UIController ç±»åº”è¯¥æ˜¯è¿™æ ·çš„: [Gist url](https://gist.github.com/timrodz/10534c89b7832a50d57dad7a54222a83)

ç°åœ¨ï¼ŒæŒ‰æ’­æ”¾é”®ï¼Œç„¶å**äº¤å‰æ‰‹æŒ‡ã€‚**å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ­å–œä½ ï¼å¦‚æœæ²¡æœ‰ï¼Œè¯·è®©æˆ‘çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬ä¼šè§£å†³å®ƒï¼

# ğŸ’Œæ‘˜è¦

* * *

æˆ‘ä»¬å·²ç»äº†è§£äº† Unity ä¸­çš„ä»£è¡¨ã€äº‹ä»¶å’Œäº‹ä»¶ã€‚å®ƒä»¬æ˜¯æœ‰ç”¨çš„å˜é‡ï¼Œå¯ä»¥å¸®åŠ©å…‹æœè®¸å¤šç¼–ç¨‹æŒ‘æˆ˜ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡åšæ–‡ã€‚