# æ”¹é€  Jumbalaya:ä¸€è¾¹æ¼”å¥ EtherCalcï¼Œä¸€è¾¹æŠŠå“‘é“ƒæ‰“æˆæ–œå¡å›¾

> åŸæ–‡:[https://dev . to/hrbrmstr/æ”¹å¤´æ¢é¢-jumbalaya-beating-dumblengs-into-slopegraphs-while-orchestration-ether calc-2d7j](https://dev.to/hrbrmstr/makeover-jumbalaya-beating-dumbbells-into-slopegraphs-whilst-orchestrating-ethercalc-2d7j)

ä»Šå¤©æ—©ä¸Šï¼Œ [@kairyssdal](http://twitter.com/kairyssdal) å‘äº†ä¸€å¼ æ¥è‡ª [@axios](http://twitter.com/axios) çš„å›¾ç‰‡:

> ä»¤äººå›°æƒ‘ï¼Œä½†å¾ˆæœ‰è¶£ã€‚
> 
> æ•°æ®æ˜¾ç¤ºæˆ‘ä»¬æ˜¯ä¸€ä¸ªæ–°é—»æ¶ˆè´¹ä¼ªå›å­çš„å›½å®¶â€”â€”Axios[https://t.co/O0lPSc4OV3](https://t.co/O0lPSc4OV3)
> 
> â€” Kai Ryssdal ( [@kairyssdal](http://twitter.com/kairyssdal) ) [June 11, 2019](https://twitter.com/kairyssdal/status/1138405440578961408?ref_src=twsrc%5Etfw)

å¦‚æœä½ åœ¨åšæ­£ç¡®çš„äº‹æƒ…ï¼Œé˜»æ­¢é‚ªæ¶çš„ç¤¾äº¤åª’ä½“ javascriptï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° Axios çš„æ•…äº‹[å’Œä¸‹å›¾:](https://www.axios.com/news-consumption-read-topics-56467fe6-81bd-4ae5-9173-cdff9865deda.html)

[![](../Images/6499561ebf43b92a4648f071b74c9d78.png)T2ã€‘](https://i2.wp.com/rud.is/b/wp-content/uploads/2019/06/axios-01.png?ssl=1)

æˆ‘è¦è¯´:å›¾è¡¨ä»¤äººå›°æƒ‘ã€‚æˆ‘çŸ¥é“ä»–ä»¬æƒ³åšä»€ä¹ˆï¼Œä½†è¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å­ï¼Œå…¶ä¸­æ–œç‡å›¾è‚¯å®šæ˜¯æ¯”æ–¹å‘å“‘é“ƒå›¾æ›´å¥½çš„é€‰æ‹©ã€‚å½“æ—¶æˆ‘æœ‰å¤§çº¦ 5 åˆ†é’Ÿçš„ç©ºé—²æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘[åšäº†ä¸€ä¸ªå¿«é€Ÿæ”¹é€ ](https://twitter.com/hrbrmstr/status/1138413330236878848?s=20)å’Œ[ä¸€ä¸ªç®€çŸ­çš„æ“ä½œæŒ‡å—](https://twitter.com/hrbrmstr/status/1138416265020747776?s=20)ã€‚è¿™ç¯‡æ–‡ç« æ˜¯å¯¹ä¸Šè¿°ä¸»é¢˜çš„æ‰©å±•ï¼Œå¦‚æœä½ æ­£å¤„äºå†³å®šæ˜¯é˜…è¯»è¿˜æ˜¯ç»§ç»­å‰è¿›çš„è¿‡ç¨‹ä¸­ï¼Œä¸‹é¢æ˜¯æˆ‘ä»¬å°†è¦ä»‹ç»çš„å†…å®¹:

*   åœ¨æŠ“å–æˆ–æ‰‹åŠ¨æ•°æ®è¾“å…¥ä¹‹é—´åšå‡ºé€‰æ‹©
*   å¿«é€Ÿä»‹ç»[ä»¥å¤ªè®¡ç®—å™¨](https://ethercalc.net)
*   ä¸ºä»€ä¹ˆæ‚¨ä¼šè€ƒè™‘ä½¿ç”¨ EtherCalc åœ¨ Excel æˆ– Google Sheets ä¸Šæ‰‹å·¥è¾“å…¥æ•°æ®
*   å°†æ•°æ®ä» EtherCalc æ‹‰å…¥ R
*   ç”¨æ•è·çš„æ•°æ®åˆ¶ä½œå¡åº¦å›¾
*   ç”¨æ•è·çš„æ•°æ®å®šåˆ¶æ–œç‡å›¾ï¼Œä»¥è®²è¿°ä¸€ä¸ªæˆ–å¤šä¸ªæ•…äº‹

å¦‚æœä½ æ„Ÿå…´è¶£çš„è¯ï¼Œè¯·ç»§ç»­è¯»ä¸‹å»ã€‚

### [](#to-scrape-or-not-to-scrape)åˆ®è¿˜æ˜¯ä¸åˆ®

å³ä½¿æˆ‘æƒ³æŠ“å–è¿™ä¸ªç½‘ç«™ï¼ŒAxios [å¾ˆæ¸…æ¥šåœ°è¡¨æ˜ä»–ä»¬ä¸æ˜¯ä»€ä¹ˆå¥½äºº](https://www.axios.com/legal),å› ä¸ºâ€”â€”è™½ç„¶å®ƒæ²¡æœ‰æåˆ°æŠ“å–â€”â€”ToS é“¾æ¥ç¡®å®è¡¨æ˜äº†è¿™ä¸€ç‚¹:

> (a)æ‚¨ä¸å¾—è®¸å¯ã€å‡ºå”®ã€å‡ºç§Ÿã€ç§Ÿèµã€è½¬è®©ã€åˆ†é…ã€åˆ†å‘ã€æ‰˜ç®¡æˆ–ä»¥å…¶ä»–æ–¹å¼å•†ä¸šåˆ©ç”¨æœ¬ç½‘ç«™æˆ–æœ¬ç½‘ç«™ä¸Šæ˜¾ç¤ºçš„ä»»ä½•å†…å®¹ï¼›(b)æ‚¨ä¸å¾—å¯¹ç½‘ç«™çš„ä»»ä½•éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ã€è¡ç”Ÿä½œå“ã€åæ±‡ç¼–ã€åå‘ç¼–è¯‘æˆ–åå‘å·¥ç¨‹ï¼›(c)æ‚¨ä¸ä¼šä¸ºäº†å»ºç«‹ç±»ä¼¼æˆ–ç«äº‰æ€§ç½‘ç«™ã€äº§å“æˆ–æœåŠ¡è€Œè®¿é—®æœ¬ç½‘ç«™ï¼›ä»¥åŠ(d)é™¤éåœ¨æ­¤æ˜ç¡®è¯´æ˜ï¼Œå¦åˆ™ä¸å¾—ä»¥ä»»ä½•å½¢å¼æˆ–æ‰‹æ®µå¤åˆ¶ã€å¤åˆ¶ã€åˆ†å‘ã€å†ç‰ˆã€ä¸‹è½½ã€å±•ç¤ºã€å¼ è´´æˆ–ä¼ æ’­æœ¬ç½‘ç«™çš„ä»»ä½•éƒ¨åˆ†ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™ç½‘ç«™åŠŸèƒ½çš„ä»»ä½•æœªæ¥ç‰ˆæœ¬ã€æ›´æ–°æˆ–æ·»åŠ éƒ½å°†å—è¿™äº›æ¡æ¬¾çš„çº¦æŸã€‚ç½‘ç«™(æˆ–ç½‘ç«™ä¸Šå±•ç¤ºçš„ä»»ä½•å†…å®¹)ä¸Šçš„æ‰€æœ‰ç‰ˆæƒå’Œå…¶ä»–æ‰€æœ‰æƒå£°æ˜å¿…é¡»ä¿ç•™åœ¨æ‰€æœ‰å‰¯æœ¬ä¸Šã€‚

(å“¦ï¼Œä¸ï¼Œæˆ‘æ˜¯ä»ä»–ä»¬çš„ç½‘ç«™ä¸Šå¤åˆ¶çš„ï¼Œæ‰€ä»¥æˆ‘å·²ç»è¿åäº†ä»–ä»¬çš„[ä¸å¯æ‰§è¡Œçš„]æ¡æ¬¾ï¼)

æœ‰ä¸€ä¸ªå«åš[â€œåˆç†ä½¿ç”¨â€](https://fairuse.stanford.edu/overview/fair-use/what-is-fair-use/)çš„ä¸œè¥¿ï¼Œæˆ‘æ­£åœ¨åšçš„è¿™ä¸ªæ”¹é€  100%åŒ…æ‹¬åœ¨é‡Œé¢ã€‚Axios ToS å’Œè®¸å¤šå…¶ä»–ç½‘ç«™çš„ ToS è¯•å›¾ç¦æ­¢è¿™ç§åˆç†ä½¿ç”¨ï¼Œä»–ä»¬é€šå¸¸ä¼šåœ¨æ³•åº­ä¸Šè¾“æ‰è¿™åœºæˆ˜æ–—ã€‚æˆ‘å·²ç»å¹¶å°†åœ¨è¿™ç¯‡æ–‡ç« ä¸­å¼•ç”¨å®ƒä»¬ä½œä¸ºæ¥æºï¼Œè¿™ç¯‡æ–‡ç« æœ¬èº«å±äºâ€œè¯„è®ºå’Œæ‰¹è¯„â€ã€‚ä¸è®¸å¤šä¸é“å¾·çš„æœé›†è€…ä¸åŒï¼Œä»–ä»¬åªæ˜¯åœ¨æ”¶é›†ä»–ä»¬æ²¡æœ‰å·¥ä½œå¯åšçš„æ•°æ®ï¼Œä»–ä»¬çš„å·¥ä½œä¸ä¼šä¸ºä¸€èˆ¬ç¤¾åŒºçš„æ›´å¥½åˆ©ç›ŠæœåŠ¡ï¼Œè¿™ç¯‡æ–‡ç« å®Œå…¨è‡´åŠ›äºåˆ†äº«å’Œæ•™è‚²ã€‚

äº‹å®ä¸Šï¼ŒAxios å¾ˆå¯èƒ½æœ‰å¦‚æ­¤ä¸¥å‰çš„ ToSï¼Œå› ä¸ºæ‰€æœ‰å¯æ€•çš„ä¸é“å¾·çš„åˆ®æ¿è°åªæ˜¯æƒ³è¦å…è´¹çš„ï¼Œæœªå¼•ç”¨çš„æ–°é—»å†…å®¹ã€‚

*æ— è®ºå¦‚ä½•* â€¦

å³ä½¿æˆ‘èƒ½æŠ“å–ï¼Œä»–ä»¬ä¹Ÿæ²¡æœ‰åµŒå…¥ javascript æ•°æ®å¯¹è±¡ï¼Œä¹Ÿæ²¡æœ‰åŠ è½½ XHR JSON æ•°æ®å—æ¥åˆ¶ä½œå›¾å½¢ã€‚ä»–ä»¬ä½¿ç”¨åŠ è½½åŸºç¡€å›¾åƒçš„ä¹ è¯­ï¼Œç„¶åé€šè¿‡æ ‡è®°æ‰§è¡Œæ³¨é‡Š:

[![](../Images/d7fd3adebeb57616f812edc102d54a27.png)T2ã€‘](https://i0.wp.com/rud.is/b/wp-content/uploads/2019/06/axios-graphic-1.png?ssl=1)

ä½¿å¾—ä¸å€¼å¾—èŠ±æ—¶é—´å»åˆ®ã€‚

è¿™æ„å‘³ç€æ•°æ®è¾“å…¥ã€‚[![ğŸ™](../Images/af4e4a9fa45afec8aa151b7ea52f04bf.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--IwZUrXu3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://s.w.org/images/core/emoji/12.0.0-1/72x72/1f641.png)

### [](#using-ethercalc-for-fun-and-profit-data-entry)ä½¿ç”¨ EtherCalc è¿›è¡Œ~~ä¹è¶£å’Œåˆ©æ¶¦~~æ•°æ®å½•å…¥

æˆ‘ä¸å–œæ¬¢ Microsoft Excel(å³ä½¿æ˜¯å®ƒçš„ç°ä»£ç‰ˆæœ¬),å› ä¸ºå®ƒå¯¹æ•°æ®è¾“å…¥æ¥è¯´å¤ªè¿‡åˆ†äº†ã€‚æˆ‘ä¹Ÿä¸å–œæ¬¢åœ¨è°·æ­Œè¡¨å•ä¸­è¾“å…¥æ•°æ®ï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘éœ€è¦ä¸äº‘è¿æ¥ã€‚å› æ­¤ï¼Œå¯¹äºå°å‹çš„æœ¬åœ°æ•°æ®è¾“å…¥éœ€æ±‚ï¼Œæˆ‘ä¼šæ±‚åŠ©äº [EtherCalc](https://ethercalc.net) ã€‚ä¸éœ€è¦äº’è”ç½‘æ¥å…¥ï¼Œä¹Ÿæ²¡æœ‰è‡ƒè‚¿çš„åº”ç”¨ç¨‹åºè¿è¡Œã€‚

EtherCalc æ˜¯ä¸€ä¸ªå¤šç”¨æˆ·çš„åŸºäºæµè§ˆå™¨çš„ç”µå­è¡¨æ ¼ï¼Œç”± javascript æ”¯æŒ(æµè§ˆå™¨å†…å’Œåç«¯)ã€‚ä½ å¯ä»¥ç”¨
å®‰è£…å®ƒ

```
$ npm install -g ethercalc 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå·¥ä½œçš„ [Node.js](https://nodejs.org/en/) è®¾ç½®å’Œ [npm](https://www.npmjs.com/) ã€‚

å½“ä½ è·‘æ­¥:

```
$ ethercalc 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½ ä¼šå¾—åˆ°ä¸€ä¸ªå¯ä»¥ç”¨ä½ çš„æµè§ˆå™¨ç‚¹å‡»çš„ URLã€‚ä¸‹é¢æ˜¯æˆ‘çš„æ•°æ®è¾“å…¥å®Œæˆåçš„æ ·å­:

[![](../Images/7fb0205c6d8082195397bfc20ef520e8.png)T2ã€‘](https://i2.wp.com/rud.is/b/wp-content/uploads/2019/06/ethercalc-1.png?ssl=1)

å®ƒå¯ä»¥ä½¿ç”¨ Redis æˆ–æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä½œä¸ºæŒä¹…å±‚ï¼Œå¹¶æ”¯æŒå¤šäººåŒæ—¶ç¼–è¾‘åŒä¸€æ–‡æ¡£ã€‚

æ­¤æ—¶ï¼Œæˆ‘å¯ä»¥æ‰‹åŠ¨å°†å®ƒä¿å­˜åˆ°ä¸€ä¸ª CSV æ–‡ä»¶ä¸­ï¼Œå¹¶ä»¥ä¼ ç»Ÿçš„æ–¹å¼è¯»å–å®ƒï¼Œä½†æ˜¯ EtherCalc æœ‰ä¸€ä¸ª API ï¼æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`{httr}`è°ƒç”¨æ¥è·å–æ•°æ®ï¼Œå°±åƒè¿™æ ·:

```
library(hrbrthemes)
library(tidyverse)

httr::GET(
  url = "http://localhost:8000/a983kmmne1i7.csv"
) -> res

(xdf <- httr::content(res))
## # A tibble: 14 x 3
## topic actually_read say_want_covered
## <chr> <dbl> <dbl>
## 1 Health care 7 1
## 2 Climate change 5 2
## 3 Education 11 3
## 4 Economics 6 4
## 5 Science 10 7
## 6 Technology 14 8
## 7 Business 13 11
## 8 National Security 1 5
## 9 Politics 2 10
## 10 Sports 3 14
## 11 Immigration 4 6
## 12 Arts & entertainment 8 13
## 13 U.S. foreign policy 9 9
## 14 Religion 12 12 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å…¶ä¸­`a983kmmne1i7`æ˜¯æ´»åŠ¨æ–‡æ¡£æ ‡è¯†ç¬¦ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†æ•°æ®ï¼Œæ˜¯æ—¶å€™å¼€å§‹æ”¹å¤´æ¢é¢äº†ã€‚

### [](#stage-1-a-basic-slopegraph)ç¬¬ä¸€é˜¶æ®µ:åŸºæœ¬å¡åº¦å›¾

(å¦‚æœä½ éœ€è¦ä¸€æœ¬å…³äº slopegraphs çš„å…¥é—¨ä¹¦ï¼Œä¸€å®šè¦é€šè¿‡[@ visualing data](http://twitter.com/visualisingdata)æŸ¥çœ‹[è¿™ä¸ªèµ„æº](http://www.visualisingdata.com/2013/12/in-praise-of-slopegraphs/)ã€‚)

æˆ‘ä»¬éœ€è¦å¯¹æ–œå¡ä¸Šçš„æƒ…å†µåšå‡ºå†³å®šã€‚æˆ‘é€‰æ‹©å°†å›ç­”è€…*å®é™…é˜…è¯»çš„å†…å®¹*æ”¾åœ¨å·¦è¾¹ï¼Œç„¶åå°†ä»–ä»¬*è¯´ä»–ä»¬æƒ³è¦è¦†ç›–çš„å†…å®¹*æ”¾åœ¨å³è¾¹ã€‚ä¸è€ƒè™‘é¡ºåºï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›æ•°æ®äº‰è®ºæ¥å°è¯•å›¾è¡¨:

```
ggplot() +
  # draw the slope lines
  geom_segment(
    data = xdf,
    aes(
      x = "Actually read", y = actually_read,
      xend = "Say they\nwant covered", yend = say_want_covered
    )
  ) +
  # left and right vertical bars
  geom_vline(aes(xintercept = c(1, 2)), color = "#b2b2b2") +
  # left and right category text
  geom_text(data = xdf, aes("Actually read", actually_read, label = topic)) +
  geom_text(data = xdf, aes("Say they\nwant covered", say_want_covered, label = topic)) +
  scale_x_discrete(position = "top") 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/4290e85db23ed895099bda51a4f6acb9.png)T2ã€‘](https://i0.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-01a.png?ssl=1)

è¿™å¼ å›¾è¡¨ä¸ä¼šå¾ˆå¿«èµ¢å¾—ä»»ä½•(å¥½)å¥–é¡¹ã€‚é™¤äº†ä¸å¯¹é½çš„ç±»åˆ«æ ‡ç­¾ï¼Œç±»åˆ«æ²¡æœ‰æŒ‰ç…§ä¼ ç»Ÿçš„é¡ºåºæ’åˆ—(æ’å#1 åœ¨å·¦è¾¹çš„é¡¶éƒ¨)ï¼Œè€Œä¸”æˆ‘ä»¬è‚¯å®šéœ€è¦å›¾è¡¨ä¸Šçš„æ›´å¤šä¿¡æ¯(æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€é¢˜æ³¨ç­‰)ã€‚).æˆ‘ä»¬å°†é‡æ–°æ’åˆ—æ ‡ç­¾ï¼Œå»æ‰ä¸€äº›ç¾å­¦é—®é¢˜ï¼Œå¹¶åˆ‡æ¢ä¸»é¢˜:

```
xdf <- mutate(xdf, dir = factor(sign(actually_read - say_want_covered))) # get the category order right
xdf <- mutate(xdf, actually_read = -actually_read, say_want_covered = -say_want_covered) # reverse the Y axis

ggplot() +
  geom_segment(
    data = xdf,
    aes(
      "Actually read", actually_read,
      xend = "Say they\nwant covered", yend = say_want_covered
    ),
    size = 0.25, color = "#b2b2b2"
  ) +
  geom_vline(aes(xintercept = c(1, 2)), color = "#b2b2b2") +
  geom_text(
    data = xdf,
    aes("Actually read", actually_read, label = topic),
    family = font_rc, size = 4, hjust = 1, nudge_x = -0.01
  ) +
  geom_text(
    data = xdf,
    aes("Say they\nwant covered", say_want_covered, label = topic),
    family = font_rc, size = 4, hjust = 0, nudge_x = 0.01
  ) +
  scale_x_discrete(position = "top") +
  labs(
    x = NULL, y = NULL,
    title = "14 Topics Ranked by What Americans Read vs Want Covered",
    subtitle = "'Read' rank from Parse.ly May 2019 data.\n'Want covered' rank from Axios/SurveyMonkey poll conducted May 17-20, 2019",
    caption = "Source: Axios <https://www.axios.com/news-consumption-read-topics-56467fe6-81bd-4ae5-9173-cdff9865deda.html>\nMakeover by @hrbrmstr"
  ) +
  theme_ipsum_rc(grid="") +
  theme(axis.text = element_blank()) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/8d16e9b388b5304da8986d057dd2e31d.png)T2ã€‘](https://i1.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-02a.png?ssl=1)

è¿™çœ‹èµ·æ¥å¥½å¤šäº†ï¼Œç”±äºåˆå§‹çº¿ç¨‹çš„æ—¶é—´é™åˆ¶ï¼Œæˆ‘å°±æ­¤æ‰“ä½ã€‚ç„¶è€Œï¼Œå¡åº¦çº¿å¾€å¾€å¾ˆéš¾è·Ÿè¸ªï¼Œæˆ‘ä»¬çœŸçš„åº”è¯¥ç”¨å®ƒä»¬æ¥è®²è¿°ä¸€ä¸ªæ•…äº‹ã€‚ä½†æ˜¯æˆ‘ä»¬æƒ³å…³æ³¨ä»€ä¹ˆæ•…äº‹å‘¢ï¼Ÿ

### [](#story-time)æ•…äº‹æ—¶é—´

ä¸ç®¡æ•…äº‹å¦‚ä½•ï¼Œæˆ‘ä»¬æƒ³è¦ç«‹å³ä¿®æ”¹çš„ä¸€ä¸ªç¾å­¦å…ƒç´ æ˜¯çº¿æ¡é¢œè‰²ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`dir`åˆ—æ¥è¡¨ç¤º:

```
ggplot() +
  geom_segment(
    data = xdf,
    aes(
      "Actually read", actually_read,
      xend = "Say they\nwant covered", yend = say_want_covered,
      color = dir, size = dir
    )
  ) +
  geom_vline(aes(xintercept = c(1, 2)), color = "#b2b2b2") +
  geom_text(
    data = xdf,
    aes("Actually read", actually_read, label = topic),
    family = font_rc, size = 4, hjust = 1, nudge_x = -0.01, lineheight = 0.875
  ) +
  geom_text(
    data = xdf,
    aes("Say they\nwant covered", say_want_covered, label = topic),
    family = font_rc, size = 4, hjust = 0, nudge_x = 0.01, lineheight = 0.875
  ) +
  scale_x_discrete(position = "top") +
  scale_size_manual(
    values = c(
      `-1` = 0.2,
      `0` = 0.2,
      `1` = 0.2
    ),
  ) +
  scale_color_manual(
    name = NULL,
    values = c(
      `-1` = ft_cols$red,
      `0` = "#2b2b2b",
      `1` = ft_cols$blue
    ),
    labels = c(
      `-1` = "Topics Readers Want Covered < Topics Read",
      `0` = "Topics Read The Same Amount As They Want Covered",
      `1` = "Topics Read < Topics Readers Want Covered"
    )
  ) +
  guides(
    size = FALSE
  ) +
  labs(
    x = NULL, y = NULL,
    title = "14 Topics Ranked by What Americans Read vs Want Covered",
    subtitle = "'Read' rank from Parse.ly May 2019 data.\n'Want covered' rank from Axios/SurveyMonkey poll conducted May 17-20, 2019",
    caption = "Source: Axios <https://www.axios.com/news-consumption-read-topics-56467fe6-81bd-4ae5-9173-cdff9865deda.html>\nMakeover by @hrbrmstr"
  ) +
  theme_ipsum_rc(grid="") +
  theme(axis.text = element_blank()) +
  theme(legend.position = "bottom") +
  theme(legend.direction = "vertical") 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/7387c4880cf45ec7819313f66bf784a3.png)T2ã€‘](https://i2.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-03.png?ssl=1)

æŒ‘é€‰æ•…äº‹ä»ç„¶æœ‰äº›å›°éš¾ï¼Œä¼ è¯´å¯èƒ½æœ‰ç”¨ï¼Œä½†å¹¶ä¸ç†æƒ³ã€‚è®©æˆ‘ä»¬ç”¨é¢œè‰²çªå‡ºæ˜¾ç¤ºä¸åŒçš„æ–œå¡ç±»å‹ï¼Œç›´æ¥æ³¨é‡Šå®ƒä»¬ï¼Œçœ‹çœ‹ä¼šå‡ºç°ä»€ä¹ˆ:

```
library(hrbrthemes)
library(tidyverse)

httr::GET(
  url = "http://localhost:8000/a983kmmne1i7.csv"
) -> res

(xdf <- httr::content(res))

xdf <- mutate(xdf, dir = factor(sign(actually_read - say_want_covered)))
xdf <- mutate(xdf, actually_read = -actually_read, say_want_covered = -say_want_covered)

arw <- arrow(length = unit(5, "pt"), type = "closed")
# x = c(1.2, 1.8, 1.9),
# y = -c(1, 13, 14),
# xend = c(1.05, 1.7, 1.6),
# yend = -c(1.125, 13, 14)
# ),
# aes(x, y , xend=xend, yend=yend),

ggplot() +
  geom_segment(
    data = xdf,
    aes(
      "Actually read", actually_read,
      xend = "Say they\nwant covered", yend = say_want_covered,
      color = dir, size = dir
    ), show.legend = FALSE
  ) +
  geom_vline(aes(xintercept = c(1, 2)), color = "#b2b2b2") +
  geom_text(
    data = xdf,
    aes("Actually read", actually_read, label = topic),
    family = font_rc, size = 4, hjust = 1, nudge_x = -0.01, lineheight = 0.875
  ) +
  geom_text(
    data = xdf,
    aes("Say they\nwant covered", say_want_covered, label = topic),
    family = font_rc, size = 4, hjust = 0, nudge_x = 0.01, lineheight = 0.875
  ) +
  geom_curve(
    data = data.frame(), 
    aes(x = 1.2, y = -1, xend = 1.05, yend = -1.125), 
    color = ft_cols$red, arrow = arw
  ) +
  geom_segment(
    data = data.frame(), aes(x = 1.6, xend = 1.6, yend = -12.1, y = -12.9), 
    color = "#2b2b2b", arrow = arw
  ) +
  geom_curve(
    data = data.frame(), aes(x = 1.2, y = -14.1, xend = 1.1, yend = -13.6),
    curvature = -0.5, color = ft_cols$blue, arrow = arw
  ) +
  geom_text(
    data = data.frame(
      x = c(1.15, 1.6, 1.2),
      y = -c(1.2, 13, 14),
      hjust = c(0, 0.5, 0),
      vjust = c(0.5, 1, 0.5),
      lab = c(
        "Topics Readers Want Covered < Topics Read",
        "Topics Read The Same Amount\nAs They Want Covered",
        "Topics Read < Topics Readers Want Covered"
      ),
      stringsAsFactors = FALSE
    ),
    aes(x, y, hjust = hjust, vjust = vjust, label = lab),
    family = font_rc, size = 2.5, lineheight = 0.875
  ) +
  scale_x_discrete(position = "top") +
  scale_size_manual(
    values = c(
      `-1` = 0.75,
      `0` = 0.2,
      `1` = 0.2
    )
  ) +
  scale_color_manual(
    name = NULL,
    values = c(
      `-1` = ft_cols$red,
      `0` = "#2b2b2b",
      `1` = ft_cols$blue
    )
  ) +
  labs(
    x = NULL, y = NULL,
    title = "14 Topics Ranked by What Americans Read vs Want Covered",
    subtitle = "'Read' rank from Parse.ly May 2019 data.\n'Want covered' rank from Axios/SurveyMonkey poll conducted May 17-20, 2019",
    caption = "Source: Axios <https://www.axios.com/news-consumption-read-topics-56467fe6-81bd-4ae5-9173-cdff9865deda.html>\nMakeover by @hrbrmstr"
  ) +
  theme(axis.text.x = element_text(size = 12, face = "bold", color = "black")) +
  theme(axis.text.y = element_blank()) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/cc34266194b52344d451d9c527b78f09.png)T2ã€‘](https://i0.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-04.png?ssl=1)

ç¬¬ä¸€ä¸ªæ•…äº‹è¡¨æ˜äº†å—è®¿è€…æ½œåœ¨çš„ç¤¾ä¼šæœŸæœ›åè§ï¼Œå› ä¸ºä»–ä»¬å£°ç§°æ›´å…³å¿ƒåŒ»ç–—ä¿å¥ã€æ°”å€™å˜åŒ–å’Œæ•™è‚²ï¼Œä½†å®é™…ä¸Šæ›´å…³å¿ƒæ›´çç¢çš„äº‹æƒ…(ä½“è‚²)ã€åŸºç¡€äº‹æƒ…(æ”¿æ²»)å’Œä»–ä»¬å‡ ä¹æ— æ³•æ§åˆ¶çš„äº‹æƒ…(å›½å®¶å®‰å…¨)ã€‚

è®©æˆ‘ä»¬åˆ‡æ¢ç„¦ç‚¹(åªæ˜¾ç¤ºä¿®æ”¹åçš„ç¾å­¦ä»¥é¿å…ä»£ç  DoS):

```
 scale_size_manual(
    values = c(
      `-1` = 0.2,
      `0` = 0.2,
      `1` = 0.75
    )
  ) + 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/e9be160faaa57b8de201db949f00bcff.png)T2ã€‘](https://i1.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-05.png?ssl=1)

ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›â€œæœŸæœ›è¦†ç›–èŒƒå›´â€çš„ä¸»é¢˜åœ¨ä¼˜å…ˆçº§åˆ—è¡¨ä¸­åˆ°åº•æ’åœ¨ä»€ä¹ˆä½ç½®ã€‚è‡³å°‘åŒ»ç–—ä¿å¥ä¸æ˜¯æœ€å·®çš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ç§‘æŠ€åœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ§åˆ¶äº†æˆ‘ä»¬çš„ç”Ÿæ´»ï¼Œçœ‹åˆ°è¿™ç§æƒ…å†µå‡ºç°åœ¨æœ€å·®çš„åœ°æ–¹æœ‰ç‚¹ä»¤äººä¸å®‰ã€‚

ç­‰çº§æ²¡æœ‰å·®åˆ«çš„ç±»åˆ«å‘¢:

```
 scale_size_manual(
    values = c(
      `-1` = 0.2,
      `0` = 0.75,
      `1` = 0.2
    )
  ) + 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

[![](../Images/4157cc737c03db9da79a747fb5cc300f.png)T2ã€‘](https://i2.wp.com/rud.is/b/wp-content/uploads/2019/06/slope-06.png?ssl=1)

ä½ å’Œæˆ‘ä¸€æ ·çŒœæµ‹ä¸ºä»€ä¹ˆäººä»¬å¯¹è¿™äº›è¯„ä»·ç›¸åŒ(å‡è®¾è°ƒæŸ¥ä½¿ç”¨äº†ç›¸ä¼¼çš„è¯­è¨€)ã€‚

### [](#fin)é³

ç°åœ¨ä½ å·²ç»å¾—åˆ°äº†æ•°æ®(å“¦ï¼Œå¯¹äº†ï¼Œæˆ‘å¿˜äº†è¿™ä¹ˆåš):

```
structure(list(topic = c("Health care", "Climate change", "Education", 
"Economics", "Science", "Technology", "Business", "National Security", 
"Politics", "Sports", "Immigration", "Arts & entertainment", 
"U.S. foreign policy", "Religion"), actually_read = c(7, 5, 11, 
6, 10, 14, 13, 1, 2, 3, 4, 8, 9, 12), say_want_covered = c(1, 
2, 3, 4, 7, 8, 11, 5, 10, 14, 6, 13, 9, 12)), class = c("spec_tbl_df", 
"tbl_df", "tbl", "data.frame"), row.names = c(NA, -14L), spec = structure(list(
    cols = list(topic = structure(list(), class = c("collector_character", 
    "collector")), actually_read = structure(list(), class = c("collector_double", 
    "collector")), say_want_covered = structure(list(), class = c("collector_double", 
    "collector"))), default = structure(list(), class = c("collector_guess", 
    "collector")), skip = 1), class = "col_spec")) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å’Œä¸€äº›ä¸åŒçš„è§‚ç‚¹ï¼Œä¹Ÿè®¸ä½ æœ‰æ›´å¥½çš„æ–¹å¼æ¥çœ‹å¾…å®ƒã€‚è¯·åœ¨è¯„è®ºä¸­ç•™ä¸‹æ‚¨çš„ä»»ä½•åˆ›ä½œæˆ–å»ºè®®ï¼Œä»¥æ”¹è¿›æ­¤å¤„æ˜¾ç¤ºçš„æœ€ç»ˆç‰ˆæœ¬ã€‚