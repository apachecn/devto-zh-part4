# ä½œä¸ºæ„å»ºå·¥å…·çš„ NPM è„šæœ¬

> åŸæ–‡:[https://dev.to/nervewax/npm-scripts-as-a-build-tool-n4](https://dev.to/nervewax/npm-scripts-as-a-build-tool-n4)

æ„å»ºå·¥å…·é€šè¿‡è‡ªåŠ¨åŒ–ä»»åŠ¡æ¥å¸®åŠ©å¼€å‘äººå‘˜èŠ‚çœæ—¶é—´ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è§£é‡Šæˆ‘å¦‚ä½•ä½¿ç”¨ npm è„šæœ¬ä½œä¸ºæ„å»ºå·¥å…·ï¼Œé€šè¿‡ç›´æ¥è¿è¡ŒåŒ…ï¼Œè€Œä¸æ˜¯é€šè¿‡ Gruntã€Gulpã€Webpackã€packages ç­‰ç­‰ã€‚

å¯¹äºé‚£äº›å·²ç»ç†Ÿæ‚‰ä¸Šè¿°å·¥å…·çš„äººæ¥è¯´ï¼Œæˆ‘å¸Œæœ›è¿™æä¾›äº†ä¸€ä¸ªæ›´ç®€å•çš„é€‰æ‹©ã€‚å¯¹äºé‚£äº›ä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡æ„å»ºå·¥å…·çš„äººæ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªç®€å•çš„åˆ‡å…¥ç‚¹ï¼Œå› ä¸ºå³ä½¿åªæœ‰åŸºæœ¬çš„ç†è§£ä¹Ÿå¯ä»¥å®Œæˆå¾ˆå¤šå·¥ä½œã€‚

## [](#whats-npm)ä»€ä¹ˆæ˜¯ npmï¼Ÿ

èŠ‚ç‚¹åŒ…ç®¡ç†å™¨æ˜¯ä¸€ä¸ªè½¯ä»¶æ³¨å†Œè¡¨ï¼Œè®¸å¤šå¼€å‘è€…é€šå¸¸é€šè¿‡ [npm å‘½ä»¤è¡Œç•Œé¢](https://docs.npmjs.com/cli/npm)ä¸‹è½½ä»–ä»¬å–œæ¬¢çš„åŒ…å’Œå·¥å…·ã€‚

è¦ä½¿ç”¨ npmï¼Œ[åœ¨æ‚¨çš„æœºå™¨ä¸Šå®‰è£… Node.js](https://nodejs.org/) ï¼Œç„¶åæ‚¨å¯ä»¥é€šè¿‡é”®å…¥`npm`åœ¨æ‚¨çš„ shell ä¸­è®¿é—® npm cliã€‚

å¦è¯·å‚è§[â€œä¸‹è½½å¹¶å®‰è£… Node.js å’Œ NPMâ€](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm)ã€‚

## [](#scripts-example)è„šæœ¬ç¤ºä¾‹

ä¸€æ—¦ä½ åœ¨ä½ çš„æœºå™¨ä¸Šæœ‰äº† npmï¼Œæ·»åŠ ä¸€ä¸ª`package.json`æ–‡ä»¶åˆ°ä½ çš„é¡¹ç›®æ ¹ç›®å½•æˆ–è€…è¿è¡Œ`npm init`ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†å…³äºä½ çš„é¡¹ç›®ã€ä½ æ·»åŠ çš„åŒ…å’Œå®šä¹‰çš„è„šæœ¬çš„ä¿¡æ¯ã€‚ä¸€ä¸ªåŸºæœ¬çš„ package.json åº”è¯¥æ˜¯è¿™æ ·çš„:

```
{  "name":  "test-project",  "version":  "1.0.0",  "scripts":  {  "test":  "echo \"Test works!\""  }  } 
```

â€œè„šæœ¬â€ä¸‹æ˜¯æˆ‘ä»¬æ‰€æœ‰ npm è„šæœ¬çš„å®šä¹‰ä½ç½®ã€‚ç”¨è¿™ä¸ª package.json åœ¨ç›®å½•é‡Œé¢è¿è¡Œ`npm test`ä¼šåœ¨ shell é‡Œé¢è¿”å›`Test works!`ï¼Œè‡ªå·±è¯•è¯•å§ï¼

## [](#npm-as-a-build-tool)npm ä½œä¸ºæ„å»ºå·¥å…·

ä½¿ç”¨ npm è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ›´å¤æ‚çš„ä»»åŠ¡æ”¾åœ¨ä¸€èµ·ï¼Œç±»ä¼¼äºæ‚¨å¯èƒ½åœ¨å…¶ä»–æ„å»ºå·¥å…·ä¸­æ‰¾åˆ°çš„ä»»åŠ¡ã€‚ç„¶åï¼Œåœ¨ä¸€äº›å®ç”¨ç¨‹åºåŒ…çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»»åŠ¡æŒ‰é¡ºåºæˆ–å¹¶è¡Œè¿è¡Œï¼Œå¹¶åœ¨ç‰¹å®šæ–‡ä»¶å‘ç”Ÿæ›´æ”¹æ—¶è§¦å‘ã€‚

åœ¨ GitHub ä¸Šï¼Œæˆ‘ç”¨è‡ªå·±çš„ [package.json](https://github.com/nervewax/npm-compiler/blob/master/package.json) åˆ›å»ºäº†ä¸€ä¸ª repoï¼Œå…¶ä¸­åŒ…å«äº†æ„æˆåŸºæœ¬æ„å»ºè¿‡ç¨‹çš„è„šæœ¬ã€‚

åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘æ·»åŠ äº†åƒ`build`ã€`clean`å’Œ`watch`è¿™æ ·çš„ä»»åŠ¡ï¼Œå®ƒä»¬è¿è¡Œé€šè¿‡å…³é”®å­—åˆ†ç»„çš„å…¶ä»–å­ä»»åŠ¡ã€‚ä¾‹å¦‚`watch:*`æŒ‡çš„æ˜¯ä»`watch:`å¼€å§‹çš„æ‰€æœ‰ä»»åŠ¡ã€‚ä½¿ç”¨è¿™äº›ä»»åŠ¡ï¼Œè¯¥å·¥å…·å¯ä»¥å®Œæˆä»¥ä¸‹ä»»åŠ¡:

*   å°† sass æ–‡ä»¶ç¼–è¯‘æˆ CSS æ–‡ä»¶ã€‚
*   ç¼©å° CSS å’Œ JS æ–‡ä»¶ã€‚
*   å‹ç¼©å›¾åƒå’Œ SVG æ–‡ä»¶ï¼Œä¸ºç°åœºç›´æ’­åšå¥½å‡†å¤‡ã€‚
*   ä¿å­˜æ›´æ”¹å¹¶åˆ·æ–°æµè§ˆå™¨åè¿è¡Œä¸Šè¿°ä»»åŠ¡ã€‚

**[github.com/nervewax/npm ç¼–è¯‘å™¨](https://github.com/nervewax/npm-compiler)**

å¦‚æœæ‚¨æƒ³è‡ªå·±å¼€å§‹ä½¿ç”¨ npm è„šæœ¬ï¼Œè¯·å°è¯•ä¸‹è½½ repo å¹¶è¿è¡Œå…¶ä¸­çš„ä¸€äº›ä»»åŠ¡ã€‚ä¸€æ—¦æ‚¨æ›´åŠ ç†Ÿæ‚‰è¿™äº›ï¼Œæ‚¨å°±å¯ä»¥ç»„è£…è‡ªå·±çš„æ„å»ºè¿‡ç¨‹æ¥æ»¡è¶³æ‚¨çš„éœ€æ±‚ã€‚

ä¸‹é¢æˆ‘åˆ—å‡ºäº†åœ¨æˆ‘çš„å›è´­ä¸­æ‰¾åˆ°çš„åŒ…ä»¥åŠå®ƒä»¬çš„ä½œç”¨ã€‚æ¯ä¸ªè½¯ä»¶åŒ…éƒ½æœ‰è‡ªå·±çš„è¯´æ˜ï¼Œå¯ä»¥åœ¨ç›¸åº”é“¾æ¥çš„ npm é¡µé¢çš„è‡ªè¿°æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚

### [](#utilities)å®ç”¨ç¨‹åº

åˆ›å»ºä¸€ä¸ªç›®å½•å’Œä»»ä½•å­ç›®å½•ï¼Œè¿™åœ¨ä½ éœ€è¦åˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„æ—¶å¾ˆæœ‰ç”¨ã€‚

onchange -ç›‘è§†æ–‡ä»¶ï¼Œç„¶ååœ¨æ·»åŠ ã€æ›´æ”¹æˆ–åˆ é™¤ä»»ä½•å†…å®¹æ—¶è¿è¡Œä»»åŠ¡ã€‚

[npm-run-all](https://www.npmjs.com/package/npm-run-all) -è®©æ‚¨ä¾æ¬¡æˆ–å¹¶è¡Œè¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚

[rimraf](https://www.npmjs.com/package/rimraf) -é€’å½’è¿è¡Œåˆ é™¤å‘½ä»¤ï¼ŒåŒ…æ‹¬åªè¯»æ–‡ä»¶ã€‚

å½“æ£€æµ‹åˆ°å˜åŒ–æ—¶åˆ·æ–°ä½ çš„æµè§ˆå™¨ã€‚

### [](#css)CSS

[node-sass](https://www.npmjs.com/package/node-sass) -å°† scss æ–‡ä»¶ç¼–è¯‘æˆ cssã€‚

[postcss-cli](https://www.npmjs.com/package/postcss-cli) -è¿è¡Œä¸Šè¿°ä»»åŠ¡åï¼Œ [PostCSS](https://github.com/postcss/postcss) å¯ç”¨äºè¿è¡Œæ›´å¤šä»»åŠ¡ï¼Œå¦‚ä¸‹æ‰€ç¤º:

[autoprefixer](https://www.npmjs.com/package/autoprefixer) -è‡ªåŠ¨æ·»åŠ å‚å•†å‰ç¼€åˆ°ä»»ä½•éœ€è¦å®ƒä»¬çš„æ ·å¼ä¸­ï¼Œä»¥ä¾¿åœ¨ä¸åŒçš„æµè§ˆå™¨ä¸­å·¥ä½œã€‚ä¾‹å¦‚`-webkit-`æˆ–`-ms-`å‰ç¼€ã€‚

[åƒç´ ](https://www.npmjs.com/package/pixrem) -ä¸º`rem`å•ä½æä¾›`px`çš„åæ´ã€‚

[cssnano](https://www.npmjs.com/package/cssnano) -å‹ç¼© css æ–‡ä»¶ã€‚

### [](#js)JS

å‹ç¼© js æ–‡ä»¶ã€‚

[ç´¯è®¡](https://www.npmjs.com/package/rollup) -å®é™…ä¸Šä¸åŒ…æ‹¬åœ¨æˆ‘çš„å›è´­ä¸­ï¼ä½†æ˜¯å®ƒæ˜¯å¤„ç† js çš„æ›¿ä»£æ–¹æ³•ï¼Œä¹Ÿå¤„ç† es6 æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±è‚¯å®šä¼šè€ƒè™‘ä½¿ç”¨å®ƒã€‚

### [](#other-stuff)å…¶ä»–ä¸œè¥¿

html-minifier -å‹ç¼© html æ–‡ä»¶ã€‚

[imagemin-cli](https://www.npmjs.com/package/imagemin-cli) -å‡å°å›¾åƒæ–‡ä»¶å¤§å°ã€‚è™½ç„¶è¿™å¯èƒ½å¾ˆè´¹æ—¶é—´ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå€™é€‰çš„åˆ é™¤ã€‚

[svgo](https://www.npmjs.com/package/svgo) -ä¼˜åŒ–å¹¶å‡å° SVG çš„æ–‡ä»¶å¤§å°ã€‚

## [](#thats-all-folks)è¿™å°±æ˜¯æ‰€æœ‰çš„ä¹¡äº²

å¸Œæœ›ï¼Œå¦‚æœä½ å·²ç»é˜…è¯»äº†è¿™ç¯‡æ–‡ç« ï¼Œä½ ä¼šå¯¹ npm è„šæœ¬èƒ½åšä»€ä¹ˆæœ‰æ›´å¤šçš„äº†è§£ã€‚ä¹Ÿè®¸è¿™ä¹Ÿè¯´æœäº†ä½ æ”¾å¼ƒä¸€ä¸ªæ›´å¤æ‚çš„æ„å»ºå·¥å…·ï¼Ÿ

ä¸ç®¡æ€æ ·ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œæˆ‘å¾ˆä¹æ„å¸®å¿™ã€‚ğŸ‘‹

### [](#further-reading)è¿›ä¸€æ­¥é˜…è¯»

ä»€ä¹ˆæ˜¯æ„å»ºå·¥å…·ï¼Ÿ
[css-tricks.com/why-npm-scripts](https://css-tricks.com/why-npm-scripts/)
[gablaxian.com/blog/using-npm-as-a-build-too](https://gablaxian.com/blog/using-npm-as-a-build-tool)
[keithcirkel.co.uk/how-to-use-npm-as-a-build-tool](https://www.keithcirkel.co.uk/how-to-use-npm-as-a-build-tool/)