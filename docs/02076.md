# ä½¿ç”¨ Python | NLP æ¯”è¾ƒæ–‡æ¡£ç›¸ä¼¼æ€§

> åŸæ–‡ï¼š<https://dev.to/thepylot/compare-documents-similarity-using-python-nlp-4odp>

å—¨ **DEV** ç½‘ç»œï¼

Youtube é¢‘é“æœ‰è§†é¢‘æ•™ç¨‹- [åå‘ Python Youtube](https://www.youtube.com/channel/UCEwYRHE5ZAOMfUaIpCQvjEQ)

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ª web åº”ç”¨ç¨‹åºæ¥æ¯”è¾ƒä¸¤ä¸ªæ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æˆ‘ä»¬å°†å­¦ä¹ è‡ªç„¶è¯­è¨€å¤„ç†(NLP)çš„åŸºç¡€çŸ¥è¯†ï¼ŒNLP æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå®ƒä½¿ç”¨è‡ªç„¶è¯­è¨€å¤„ç†è®¡ç®—æœºå’Œäººç±»ä¹‹é—´çš„äº¤äº’ã€‚

æœ¬å¸–æœ€åˆå‘è¡¨äºæˆ‘çš„å®éªŒå®¤[åå‘ Python](https://reversepython.net) ã€‚

è®©æˆ‘ä»¬ä»ç¨‹åºçš„åŸºæœ¬ç»“æ„å¼€å§‹ï¼Œç„¶åæˆ‘ä»¬å°†æ·»åŠ å›¾å½¢ç•Œé¢ï¼Œä½¿ç¨‹åºæ›´å®¹æ˜“ä½¿ç”¨ã€‚è¯·éšæ„åœ¨æˆ‘çš„ GitHub ä¸­è´¡çŒ®è¿™ä¸ªé¡¹ç›®ã€‚

#### NLTK å’Œ Gensim

**è‡ªç„¶è¯­è¨€å·¥å…·åŒ…(NLTK)** æ˜¯æœ€æµè¡Œçš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)åº“ï¼Œç”¨ Python ç¼–å†™ï¼ŒèƒŒåæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¤¾åŒºã€‚NLTK ä¹Ÿå¾ˆå®¹æ˜“å­¦ä¹ ï¼Œå®é™…ä¸Šï¼Œå®ƒæ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„æœ€ç®€å•çš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)åº“ã€‚å®ƒåŒ…å«ç”¨äºæ ‡è®°åŒ–ã€è§£æã€åˆ†ç±»ã€è¯å¹²ã€æ ‡è®°å’Œè¯­ä¹‰æ¨ç†çš„æ–‡æœ¬å¤„ç†åº“ã€‚

Gensim è¢«å®£ä¼ ä¸ºä¸€ä¸ªè‡ªç„¶è¯­è¨€å¤„ç†åŒ…ï¼Œä¸ºäººç±»åšä¸»é¢˜å»ºæ¨¡ã€‚ä½†å®é™…ä¸Šè¿œä¸æ­¢å¦‚æ­¤ã€‚å®ƒæ˜¯ç”¨äºå¤„ç†æ–‡æœ¬çš„é¢†å…ˆå’Œæœ€å…ˆè¿›çš„è½¯ä»¶åŒ…ï¼Œæ”¯æŒå•è¯å‘é‡æ¨¡å‹(å¦‚ Word2Vecã€FastText ç­‰)

ä¸»é¢˜æ¨¡å‹å’Œå•è¯åµŒå…¥åœ¨ scikitã€R ç­‰å…¶ä»–åŒ…ä¸­ä¹Ÿæœ‰ã€‚ä½†æ˜¯åœ¨ gensim ä¸­ï¼Œæ„å»ºå’Œè¯„ä¼°ä¸»é¢˜æ¨¡å‹çš„å·¥å…·çš„å®½åº¦å’ŒèŒƒå›´æ˜¯æ— ä¸ä¼¦æ¯”çš„ï¼Œæ­¤å¤–è¿˜æœ‰è®¸å¤šæ›´æ–¹ä¾¿çš„æ–‡æœ¬å¤„ç†å·¥å…·ã€‚gensim çš„å¦ä¸€ä¸ªé‡è¦å¥½å¤„æ˜¯ï¼Œå®ƒå…è®¸æ‚¨ç®¡ç†å¤§æ–‡æœ¬æ–‡ä»¶ï¼Œè€Œæ— éœ€å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… nltk å’Œ gensim:

```
pip install nltk
pip install gensim 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### è¯çš„æ ‡è®°åŒ–(NLTK)

æˆ‘ä»¬ä½¿ç”¨ word_tokenize()æ–¹æ³•å°†å¥å­æ‹†åˆ†æˆå•è¯ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­

```
from nltk.tokenize import word_tokenize

data = "Mars is approximately half the diameter of Earth."
print(word_tokenize(data)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
['Mars', 'is', 'approximately', 'half', 'the', 'diameter', 'of', 'Earth'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

#### å¥å­çš„æ ‡è®°åŒ–

ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é—®é¢˜æ˜¯ï¼Œå½“æˆ‘ä»¬å¯ä»¥é€‰æ‹©å•è¯æ ‡è®°åŒ–æ—¶ï¼Œä¸ºä»€ä¹ˆéœ€è¦å¥å­æ ‡è®°åŒ–ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸ªå¥å­çš„å¹³å‡å­—æ•°ï¼Œæ‰€ä»¥ä¸ºäº†å®Œæˆè¿™æ ·çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ä½¿ç”¨å¥å­æ ‡è®°åŒ–å’Œå•è¯æ¥è®¡ç®—æ¯”ç‡ã€‚

```
from nltk.tokenize import sent_tokenize

data = "Mars is a cold desert world. It is half the size of Earth. "
print(sent_tokenize(data)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
['Mars is a cold desert world', 'It is half the size of Earth '] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæ‚¨çŸ¥é“è¿™äº›æ–¹æ³•åœ¨å¤„ç†æ–‡æœ¬åˆ†ç±»æ—¶æ˜¯å¦‚ä½•æœ‰ç”¨çš„äº†ã€‚è®©æˆ‘ä»¬åœ¨ç›¸ä¼¼åº¦ç®—æ³•ä¸­å®ç°å®ƒã€‚

#### æ‰“å¼€æ–‡ä»¶å¹¶æ ‡è®°å¥å­

åˆ›å»ºä¸€ä¸ª. txt æ–‡ä»¶ï¼Œåœ¨é‡Œé¢å†™ 4-5 å¥è¯ã€‚å°†è¯¥æ–‡ä»¶åŒ…å«åœ¨ Python ç¨‹åºçš„åŒä¸€ç›®å½•ä¸­ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦ç”¨ Python æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œæ‹†åˆ†å¥å­ã€‚

```
import nltk
from nltk.tokenize import word_tokenize, sent_tokenize

file_docs = []

with open ('demofile.txt') as f:
    tokens = sent_tokenize(f.read())
    for line in tokens:
        file_docs.append(line)

print("Number of documents:",len(file_docs)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç¨‹åºå°†æ‰“å¼€æ–‡ä»¶å¹¶è¯»å–å…¶å†…å®¹ã€‚ç„¶åï¼Œå®ƒä¼šå°†æ ‡è®°åŒ–çš„å¥å­æ·»åŠ åˆ°æ•°ç»„ä¸­è¿›è¡Œå•è¯æ ‡è®°åŒ–ã€‚

#### å¯¹å•è¯è¿›è¡Œæ ‡è®°å¹¶åˆ›å»ºè¯å…¸

ä¸€æ—¦æˆ‘ä»¬åœ¨æ•°ç»„ä¸­æ·»åŠ äº†æ ‡è®°åŒ–çš„å¥å­ï¼Œå°±è¯¥ä¸ºæ¯ä¸ªå¥å­æ ‡è®°å•è¯äº†ã€‚

```
gen_docs = [[w.lower() for w in word_tokenize(text)] 
            for text in file_docs] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
[['mars', 'is', 'a', 'cold', 'desert', 'world', '.'],
 ['it', 'is', 'half', 'the', 'size', 'of', 'earth', '.']] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†å¤„ç†æ–‡æœ¬æ–‡æ¡£ï¼ŒGensim è¦æ±‚å°†å•è¯(åˆåè®°å·)è½¬æ¢æˆå”¯ä¸€çš„ idã€‚å› æ­¤ï¼ŒGensim å…è®¸æ‚¨åˆ›å»ºä¸€ä¸ª Dictionary å¯¹è±¡ï¼Œå°†æ¯ä¸ªå•è¯æ˜ å°„åˆ°ä¸€ä¸ªæƒŸä¸€çš„ idã€‚è®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„å¥å­è½¬æ¢æˆä¸€ä¸ª[å•è¯åˆ—è¡¨]å¹¶å°†å…¶ä¼ é€’ç»™è¯­æ–™åº“ã€‚å­—å…¸()å¯¹è±¡ã€‚

```
dictionary = gensim.corpora.Dictionary(gen_docs)
print(dictionary.token2id) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
{'.': 0, 'a': 1, 'cold': 2, 'desert': 3, 'is': 4, 'mars': 5,
 'world': 6, 'earth': 7, 'half': 8, 'it': 9, 'of': 10, 'size': 11, 'the': 12} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å­—å…¸æŠŠæ¯ä¸ªå•è¯éƒ½æ˜ å°„æˆä¸€ä¸ªæ•°å­—ã€‚Gensim å…è®¸æ‚¨è¯»å–æ–‡æœ¬å¹¶æ›´æ–°å­—å…¸ï¼Œä¸€æ¬¡ä¸€è¡Œï¼Œè€Œæ— éœ€å°†æ•´ä¸ªæ–‡æœ¬æ–‡ä»¶åŠ è½½åˆ°ç³»ç»Ÿå†…å­˜ä¸­ã€‚

#### åˆ›é€ ä¸€ä¸ªå•è¯åŒ…

ä¸ºäº†åœ¨ gensim ä¸­å·¥ä½œï¼Œæ‚¨éœ€è¦ç†Ÿæ‚‰çš„ä¸‹ä¸€ä¸ªé‡è¦å¯¹è±¡æ˜¯è¯­æ–™åº“(ä¸€åŒ…å•è¯)ã€‚å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«å•è¯ id åŠå…¶åœ¨æ¯ä¸ªæ–‡æ¡£ä¸­çš„å‡ºç°é¢‘ç‡(åªåˆ—å‡ºæ¯ä¸ªå•è¯åœ¨å¥å­ä¸­å‡ºç°çš„æ¬¡æ•°)ã€‚

è¯·æ³¨æ„,â€œä»¤ç‰Œâ€é€šå¸¸æ„å‘³ç€â€œå•è¯â€ã€‚â€œæ–‡æ¡£â€é€šå¸¸å¯ä»¥æŒ‡â€œå¥å­â€æˆ–â€œæ®µè½â€ï¼Œè€Œâ€œè¯­æ–™åº“â€é€šå¸¸æ˜¯â€œä½œä¸ºå•è¯åŒ…çš„æ–‡æ¡£é›†åˆâ€ã€‚

ç°åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªå•è¯è¯­æ–™åº“ï¼Œå¹¶å°†å•è¯çš„æ ‡è®°åŒ–åˆ—è¡¨ä¼ é€’ç»™ Dictionary.doc2bow()

è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬çš„æ–‡æ¡£æ˜¯:

```
Mars is a cold desert world. It is half the size of the Earth. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
corpus = [dictionary.doc2bow(gen_doc) for gen_doc in gen_docs] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
{'.': 0, 'a': 1, 'cold': 2, 'desert': 3, 'is': 4, 
'mars': 5, 'world': 6, 'earth': 7, 'half': 8, 'it': 9, 
'of': 10, 'size': 11,'the': 12}
[[(0, 1), (1, 1), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1)],
 [(0, 1), (4, 1), (7, 1), (8, 1), (9, 1), (10, 1), (11, 1), (12, 2)]] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒå¥ä¸­ä½¿ç”¨äº†â€œtheâ€ä¸¤æ¬¡ï¼Œå¦‚æœä½ æŸ¥æ‰¾ id=12 çš„å•è¯(the ),ä½ ä¼šçœ‹åˆ°å®ƒçš„é¢‘ç‡æ˜¯ 2(åœ¨å¥å­ä¸­å‡ºç°äº†ä¸¤æ¬¡)

#### TFIDF

è¯é¢‘-é€†æ–‡æ¡£é¢‘ç‡(TF-IDF)ä¹Ÿæ˜¯ä¸€ä¸ªè¯è¢‹æ¨¡å‹ï¼Œä½†ä¸å¸¸è§„è¯­æ–™åº“ä¸åŒï¼ŒTFIDF é™ä½äº†æ–‡æ¡£ä¸­é¢‘ç¹å‡ºç°çš„æ ‡è®°(è¯)çš„æƒé‡ã€‚

Tf-Idf çš„è®¡ç®—æ–¹æ³•æ˜¯å°†å±€éƒ¨åˆ†é‡(Tf)ä¹˜ä»¥æ•´ä½“åˆ†é‡(Idf ),å¹¶æ ¹æ®éœ€è¦å°†ç»“æœå½’ä¸€åŒ–ä¸ºå•ä½é•¿åº¦ã€‚æœ¯è¯­é¢‘ç‡æ˜¯å•è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„é¢‘ç‡ï¼Œè€Œé€†æ–‡æ¡£é¢‘ç‡é€šè¿‡å•è¯åœ¨è¯­æ–™åº“ä¸­çš„ç¨€æœ‰ç¨‹åº¦æ¥è¡¡é‡è¯¥å€¼ã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨æ–‡æ¡£ä¸­å‡ºç°é¢‘ç‡è¾ƒé«˜çš„å•è¯æƒé‡è¾ƒå°ã€‚

```
This is the space. This is our planet. This is the Mars. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

```
tf_idf = gensim.models.TfidfModel(corpus)
for doc in tfidf[corpus]:
    print([[dictionary[id], np.around(freq, decimals=2)] for id, freq in doc]) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
[['space', 0.94], ['the', 0.35]]
[['our', 0.71], ['planet', 0.71]]
[['the', 0.35], ['mars', 0.94]] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å•è¯â€œTheâ€åœ¨ä¸¤ä¸ªæ–‡æ¡£ä¸­å‡ºç°ï¼Œæ‰€ä»¥å®ƒå˜è½»äº†ã€‚åœ¨è¿™ä¸‰ä»½æ–‡ä»¶ä¸­å‡ºç°çš„ã€Œthisã€å’Œã€Œisã€ä¸¤ä¸ªå­—å·²ä¸€å¹¶åˆ é™¤ã€‚

#### åˆ›å»ºç›¸ä¼¼æ€§åº¦é‡å¯¹è±¡

ç°åœ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºç›¸ä¼¼æ€§å¯¹è±¡ã€‚ä¸»è¦çš„ç±»æ˜¯ Similarityï¼Œå®ƒä¸ºä¸€ç»„ç»™å®šçš„æ–‡æ¡£å»ºç«‹ä¸€ä¸ªç´¢å¼•ã€‚ç›¸ä¼¼æ€§ç±»å°†ç´¢å¼•åˆ†æˆå‡ ä¸ªæ›´å°çš„å­ç´¢å¼•ï¼Œè¿™äº›å­ç´¢å¼•æ˜¯åŸºäºç£ç›˜çš„ã€‚è®©æˆ‘ä»¬åªåˆ›å»ºç›¸ä¼¼æ€§å¯¹è±¡ï¼Œç„¶åä½ ä¼šæ˜ç™½æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒè¿›è¡Œæ¯”è¾ƒã€‚

```
 # building the index
 sims = gensim.similarities.Similarity('workdir/',tf_idf[corpus],
                                        num_features=len(dictionary)) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†ç´¢å¼•çŸ©é˜µå­˜å‚¨åœ¨â€œworkdirâ€ç›®å½•ä¸­ï¼Œä½†æ˜¯æ‚¨å¯ä»¥éšæ„å‘½åå®ƒï¼Œå½“ç„¶æ‚¨å¿…é¡»ä½¿ç”¨æ‚¨ç¨‹åºçš„ç›¸åŒç›®å½•æ¥åˆ›å»ºå®ƒã€‚

#### åˆ›å»ºæŸ¥è¯¢æ–‡æ¡£

ä¸€æ—¦æ„å»ºäº†ç´¢å¼•ï¼Œæˆ‘ä»¬å°†è®¡ç®—è¿™ä¸ªæŸ¥è¯¢æ–‡æ¡£ä¸ç´¢å¼•ä¸­æ¯ä¸ªæ–‡æ¡£çš„ç›¸ä¼¼ç¨‹åº¦ã€‚æ‰€ä»¥ï¼Œåˆ›é€ ç¬¬äºŒã€‚txt æ–‡ä»¶ï¼Œå®ƒå°†åŒ…æ‹¬æŸ¥è¯¢æ–‡æ¡£æˆ–å¥å­ï¼Œå¹¶åƒæˆ‘ä»¬ä»¥å‰åšçš„é‚£æ ·æ ‡è®°å®ƒä»¬ã€‚

```
file2_docs = []

with open ('demofile2.txt') as f:
    tokens = sent_tokenize(f.read())
    for line in tokens:
        file2_docs.append(line)

print("Number of documents:",len(file2_docs))  
for line in file2_docs:
    query_doc = [w.lower() for w in word_tokenize(line)]
    query_doc_bow = dictionary.doc2bow(query_doc) #update an existing dictionary and create bag of words 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬è·å¾—æ–°çš„æ–‡æ¡£(æŸ¥è¯¢æ–‡æ¡£æˆ–å¥å­),å› æ­¤å¯ä»¥æ›´æ–°ç°æœ‰çš„å­—å…¸æ¥åŒ…å«æ–°å•è¯ã€‚

#### è®°å½•ä¸æŸ¥è¯¢çš„ç›¸ä¼¼ä¹‹å¤„

åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ‚¨å°†çœ‹åˆ°æŸ¥è¯¢å’Œæ‰€æœ‰ç´¢å¼•æ–‡æ¡£ä¹‹é—´çš„ç›¸ä¼¼ä¹‹å¤„ã€‚è¦è·å¾—æŸ¥è¯¢æ–‡æ¡£ä¸ç´¢å¼•æ–‡æ¡£çš„ç›¸ä¼¼æ€§:

```
# perform a similarity query against the corpus query_doc_tf_idf = tf_idf[query_doc_bow]
# print(document_number, document_similarity) print('Comparing Result:', sims[query_doc_tf_idf]) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä½™å¼¦åº¦é‡è¿”å›èŒƒå›´ä¸­çš„ç›¸ä¼¼åº¦(è¶Šå¤§ï¼Œè¶Šç›¸ä¼¼)ã€‚

å‡è®¾æˆ‘ä»¬çš„æ–‡æ¡£æ˜¯:

```
Mars is the fourth planet in our solar system.
It is second-smallest planet in the Solar System after Mercury. 
Saturn is yellow planet. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è€ŒæŸ¥è¯¢æ–‡æ¡£æ˜¯:

```
Saturn is the sixth planet from the Sun. 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
[0.11641413 0.10281226 0.56890744] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸‰ä¸ªæ–‡æ¡£æ˜¯æœ€ç›¸ä¼¼çš„

#### å¹³å‡ç›¸ä¼¼åº¦

ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘è®¤ä¸ºæœ€å¥½æ˜¯è®¡ç®—æŸ¥è¯¢æ–‡æ¡£çš„å¹³å‡ç›¸ä¼¼åº¦ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°†å¯¼å…¥ numpy æ¥è®¡ç®—è¿™äº›ç›¸ä¼¼æ€§è¾“å‡ºçš„æ€»å’Œã€‚

[![nlp](img/8d8966e451faf587cc56000795f71828.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--y2WfNRvq--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/vvritibxqymh7d3jk8vj.png)T3ã€‘

```
import numpy as np

sum_of_sims =(np.sum(sims[query_doc_tf_idf], dtype=np.float32))
print(sum_of_sims) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

Numpy å°†å¸®åŠ©æˆ‘ä»¬è®¡ç®—è¿™äº›æµ®ç‚¹æ•°çš„å’Œï¼Œè¾“å‡ºæ˜¯:

```
# [0.11641413 0.10281226 0.56890744] 0.78813386 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†è®¡ç®—å¹³å‡ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬å¿…é¡»ç”¨è¿™ä¸ªå€¼é™¤ä»¥æ–‡æ¡£æ•°

```
percentage_of_similarity = round(float((sum_of_sims / len(file_docs)) * 100))
print(f'Average similarity float: {float(sum_of_sims / len(file_docs))}')
print(f'Average similarity percentage: {float(sum_of_sims / len(file_docs)) * 100}')
print(f'Average similarity rounded percentage: {percentage_of_similarity}') 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
Average similarity float: 0.2627112865447998
Average similarity percentage: 26.27112865447998
Average similarity rounded percentage: 26 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¯´æŸ¥è¯¢æ–‡æ¡£(demofile2.txt)ä¸ä¸»æ–‡æ¡£(demofile.txt)æœ‰ 26%ç›¸ä¼¼

å¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªæŸ¥è¯¢æ–‡æ¡£æ€ä¹ˆåŠï¼Ÿ

ä½œä¸ºä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—æ¯ä¸ªæŸ¥è¯¢æ–‡æ¡£çš„å¹³å‡å€¼ä¹‹å’Œï¼Œå®ƒå°†ç»™å‡ºæˆ‘ä»¬æ•´ä½“çš„ç›¸ä¼¼æ€§ç™¾åˆ†æ¯”ã€‚

[![nlp2](img/2f7e957ff31398435993c51217a6e7c5.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--I0qY7KP6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/onxj2fpums94wh1lho5a.png)

å‡è®¾æˆ‘ä»¬ä¸»è¦æ–‡æ¡£æ˜¯:

```
Malls are great places to shop, I can find everything I need under one roof.
I love eating toasted cheese and tuna sandwiches.
Should we start class now, or should we wait for everyone to get here? 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘æ­£åœ¨ä½¿ç”¨éšæœºå•è¯ç”Ÿæˆå™¨å·¥å…·æ¥åˆ›å»ºè¿™äº›æ–‡æ¡£ã€‚ä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬çš„æŸ¥è¯¢æ–‡æ¡£æ˜¯:

```
Malls are goog for shopping. What kind of bread is used for sandwiches? Do we have to start class now, or should we wait for
everyone to come here? 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç :

```
avg_sims = [] # array of averages 
# for line in query documents for line in file2_docs:
        # tokenize words
        query_doc = [w.lower() for w in word_tokenize(line)]
        # create bag of words
        query_doc_bow = dictionary.doc2bow(query_doc)
        # find similarity for each document
        query_doc_tf_idf = tf_idf[query_doc_bow]
        # print (document_number, document_similarity)
        print('Comparing Result:', sims[query_doc_tf_idf]) 
        # calculate sum of similarities for each query doc
        sum_of_sims =(np.sum(sims[query_doc_tf_idf], dtype=np.float32))
        # calculate average of similarity for each query doc
        avg = sum_of_sims / len(file_docs)
        # print average of similarity for each query doc
        print(f'avg: {sum_of_sims / len(file_docs)}')
        # add average values into array
        avg_sims.append(avg)  
   # calculate total average
    total_avg = np.sum(avg_sims, dtype=np.float)
    # round the value and multiply by 100 to format it as percentage
    percentage_of_similarity = round(float(total_avg) * 100)
    # if percentage is greater than 100
    # that means documents are almost same
    if percentage_of_similarity >= 100:
        percentage_of_similarity = 100 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¾“å‡º:

```
Comparing Result: [0.33515707 0.02852172 0.13209888]
avg: 0.16525922218958536
Comparing Result: [0.         0.21409164 0.27012902]
avg: 0.16140689452489218
Comparing Result: [0.02963242 0.         0.9407785 ]
avg: 0.3234703143437703 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬æœ‰ 3 ä¸ªæŸ¥è¯¢æ–‡æ¡£ï¼Œç¨‹åºè®¡ç®—æ¯ä¸ªæ–‡æ¡£çš„å¹³å‡ç›¸ä¼¼åº¦ã€‚å¦‚æœæˆ‘ä»¬è®¡ç®—è¿™äº›å€¼ï¼Œç»“æœå°†æ˜¯:

```
0.6501364310582478 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬å°†è¯¥å€¼ä¹˜ä»¥ 100 å¹¶å››èˆäº”å…¥ï¼Œä½¿å…¶æ›´ç®€å•ï¼Œä»è€Œå°†å…¶æ ¼å¼åŒ–ä¸ºç™¾åˆ†æ¯”ã€‚å§œæˆˆçš„æœ€ç»ˆç»“æœæ˜¯:

[![similarity](img/01dc73ffe0038d7de8b68959dcb352a9.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--Mh8cDgAu--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/jsfk53a2t4r586bi39jz.png)

#### ä»»åŠ¡å®Œæˆï¼

å¤ªå¥½äº†ï¼æˆ‘å¸Œæœ›ä½ ä»è¿™ä¸ªé¡¹ç›®ä¸­å­¦åˆ°äº†ä¸€äº› NLP çš„åŸºç¡€çŸ¥è¯†ã€‚å¦å¤–ï¼Œæˆ‘åœ¨ Django ä¸­å®ç°äº†è¿™ä¸ªç®—æ³•æ¥åˆ›å»ºå›¾å½¢ç•Œé¢ã€‚è¯·éšæ„åœ¨æˆ‘çš„ GitHub ä¸­è´¡çŒ®é¡¹ç›®ã€‚

## ![GitHub logo](img/75095a8afc1e0f207cda715962e75c8d.png) [ thepylot ](https://github.com/thepylot) / [é…·è‚–](https://github.com/thepylot/Resemblance)

### [ä¸å†æ”¯æŒæ— æ•ˆé¡¹ç›®]

<article class="markdown-body entry-content container-lg" itemprop="text">

# ç›¸ä¼¼

æµ‹é‡ä¸¤ä¸ª txt æ–‡ä»¶ä¹‹é—´çš„ç›¸ä¼¼æ€§(Python)

## å…¥é—¨æŒ‡å—

ç›¸ä¼¼å¹³è¡¡åœ¨ **python 3+** å’Œ django 2+ä¸Šå·¥ä½œã€‚

å®‰è£…ä¾èµ–é¡¹:

```
python3 -m pip3 install -r requirements.txt 
```

ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤:

```
python3 manage.py makemigrations sim
python3 manage.py migrate
python3 manage.py runserver 
```

</article>

[View on GitHub](https://github.com/thepylot/Resemblance)

æˆ‘å¸Œæœ›ä½ èƒ½ä»è¿™ä¸ªå®éªŒä¸­å­¦åˆ°ä¸€äº›ä¸œè¥¿ğŸ˜ƒå¦‚æœä½ è§‰å¾—æœ‰ç”¨ï¼Œè¯·åœ¨ç¤¾äº¤åª’ä½“ä¸Šåˆ†äº«å¹¶åŠ å…¥æˆ‘ï¼ä¸€å¦‚æ—¢å¾€åœ°ä¿æŒè”ç³»ï¼ğŸš€

å¦è¯·å‚è§[åå‘ Python](https://reversepython.net)

[Instagram](https://www.instagram.com/coderasha/?hl=en)
[æ¨ç‰¹](https://twitter.com/coderasha?lang=en)

å‚è€ƒèµ„æ–™:

[æœºæ¢°ç“¶é¢ˆ](https://www.machinelearningplus.com/nlp/gensim-tutorial/)
[ã€genimã€‘](https://radimrehurek.com/gensim/)