# ç¬¬ä¸€å­£ç¬¬ä¸€é›†

> åŸæ–‡:[https://dev . to/tiagobnobrega/s4srd-s01e 01-hooked-on-using-hooks-in-svelte-3m1i](https://dev.to/tiagobnobrega/s4srd-s01e01-hooked-on-using-hooks-in-svelte-3m1i)

æˆ‘åœ¨æ¨ç‰¹ä¸Šè®¤è¯†äº† dev.toï¼Œæ‰€ä»¥æˆ‘å†³å®šå†™ç¬¬ä¸€ç¯‡å…³äº@sveltejs çš„æ–‡ç« ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå¦‚ä½•*ååº”*ä½ è‹—æ¡çš„åº”ç”¨ç¨‹åº(æˆ‘ç›¸ä¿¡å“ˆé‡Œæ–¯ä¼šå–œæ¬¢çš„ï¼Œå¯¹ä¸å¯¹ï¼Ÿ).ä¸ä»…å¦‚æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ªç³»åˆ—ã€‚

**ç°åœ¨è¯·å¿è€ä¸€ä¸‹**æš‚æ—¶ä¸è¦å†²åŠ¨åœ°å…³é—­æµè§ˆå™¨çª—å£ï¼Œæ¬¢è¿æ¥åˆ°:

# 

<center>ğŸ™ƒ</center>

# [](#svelte-for-the-stubborn-react-developer)èº«æè‹—æ¡ï¼Œé€‚åˆå›ºæ‰§å·±è§çš„å¼€å‘è€…

#### [](#abstract)æ‘˜è¦

è¡Œ...ç©ç¬‘å½’ç©ç¬‘ï¼Œè¿™é‡Œçš„æƒ³æ³•æ˜¯å±•ç¤º React å¼€å‘äººå‘˜ç†Ÿæ‚‰çš„ä¸€äº›æ¦‚å¿µæ˜¯å¦‚ä½•è¢«å®ç°çš„ã€‚ç»ä¸æ˜¯*è°åšå¾—æ›´å¥½*(æ— è¯„åˆ¤åŒº)çš„è¾ƒé‡ã€‚æ­¤å¤–ï¼Œæ‰€å±•ç¤ºçš„ä»£ç æ²¡æœ‰ç»è¿‡æˆ˜åœºæµ‹è¯•ï¼Œæ²¡æœ‰ç»è¿‡å‹åŠ›æµ‹è¯•ï¼Œä¹Ÿä¸æ˜¯å†›ç”¨çº§åˆ«çš„æŠ€æœ¯ã€‚è¿™åªæ˜¯æˆ‘åˆ°ç›®å‰ä¸ºæ­¢å‘ç°çš„å®ç°äº‹æƒ…çš„æ–¹æ³•ï¼Œè¯·éšæ„å¯¹ä»»ä½•äº‹æƒ…å‘è¡¨è¯„è®ºã€‚

#### TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)

è‹—æ¡çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°å¯ä»¥ä»ä»»ä½•åœ°æ–¹è¢«è°ƒç”¨ï¼Œå¹¶è¢«éš”ç¦»åœ¨éš”ç¦»çš„æ¨¡å—ä¸­ã€‚ç„¶åå¯ä»¥å¯¼å…¥å®ƒï¼Œä¾›ä»»æ„å¤šä¸ªç»„ä»¶ä½¿ç”¨ã€‚å®ƒä»¬å¿…é¡»åœ¨ç»„ä»¶åˆå§‹åŒ–æœŸé—´è¢«è°ƒç”¨ï¼Œä½†æ˜¯ä½ ä¸å¿…æ‹…å¿ƒæ’åºå’Œæ¡ä»¶è°ƒç”¨ã€‚

å¦‚æœä½ æœ‰å…´è¶£å¼„æ¸…æ¥šå¦‚ä½•ç”¨ä¸€ä¸ªè‹—æ¡çš„é’©å­æ¥ä½¿ç”¨çŠ¶æ€æˆ–ä¸Šä¸‹æ–‡ï¼Œè¯·ç»§ç»­å…³æ³¨ä¸‹ä¸€é›†ã€‚

#### é’©å­åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œå®ƒæ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ

å€Ÿç”¨ **[@dan_abramov](https://dev.to/dan_abramov)** æ­¤å¤„:

> å¦‚æœä¸é‡ç»„ä»£ç æˆ–å¼•å…¥ Observables è¿™æ ·çš„æŠ½è±¡ï¼Œå°±æ— æ³•ä»ç±»ç»„ä»¶ä¸­æå–â€œè§‚å¯Ÿçª—å£å¤§å°å¹¶æ›´æ–°çŠ¶æ€â€æˆ–â€œéšæ—¶é—´åŠ¨ç”»åŒ–å€¼â€è¿™æ ·çš„è¡Œä¸ºã€‚è¿™ä¸¤ç§æ–¹æ³•éƒ½ä¼¤å®³äº†æˆ‘ä»¬å–œæ¬¢çš„ React çš„ç®€å•æ€§ã€‚é’©å­æ­£å¥½è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚é’©å­å…è®¸ä½ é€šè¿‡ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ¥ä½¿ç”¨å‡½æ•°çš„ååº”ç‰¹æ€§(æ¯”å¦‚çŠ¶æ€)ã€‚React æä¾›äº†ä¸€äº›å†…ç½®çš„æŒ‚é’©ï¼Œå…¬å¼€äº† React çš„â€œæ„å»ºå—â€:çŠ¶æ€ã€ç”Ÿå‘½å‘¨æœŸå’Œä¸Šä¸‹æ–‡ã€‚>

æ‰€ä»¥ä¸€ä¸ªé’©å­æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª**å‡½æ•°**åˆ°**æå–è¡Œä¸º**ï¼Œå…è®¸ä½ **å¯¹ç”Ÿå‘½å‘¨æœŸ**åšå‡ºååº”**è®¿é—®çŠ¶æ€å’Œä¸Šä¸‹æ–‡**ã€‚

#### [](#how-to-achieve-that-in-svelte)å¦‚ä½•åšåˆ°èº«æè‹—æ¡ï¼Ÿ

**æå–è¡Œä¸º**æ˜¯æ‰€æœ‰å‡½æ•°éƒ½è¦åšçš„ï¼Œè¿™æ˜¯æœ€ç®€å•çš„éƒ¨åˆ†ã€‚âœ”ï¸Done.ä½†æ˜¯å¯¹ç”Ÿå‘½å‘¨æœŸçš„ååº”å‘¢ï¼Ÿ

Svelte ä¸ºæ­¤å…¬å¼€äº†å‡ ä¸ªåŠ©æ‰‹å‡½æ•°: *OnMountï¼ŒbeforeUpdateï¼ŒafterUpdateï¼ŒonDestroyï¼Œtick* ã€‚å®ƒä»¬çš„å·¥ä½œæ–¹å¼å®Œå…¨ä¸€æ ·(é™¤äº† tickâ€”â€”é‚£ä¸ªä»¤äººæ¯›éª¨æ‚šç„¶çš„å°å®¶ä¼™)ã€‚å› æ­¤ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬åšæŒä½¿ç”¨ onMount & onDestroyã€‚

ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬å¸Œæœ›åœ¨ç»„ä»¶è¢«å®‰è£…æˆ–ç ´åæ—¶è®°å½•ä¸€äº›ä¸œè¥¿ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬é’ˆå¯¹å•ä¸ªç»„ä»¶:

```
<!-- componentA.svelte -->
<script>
import { onMount, onDestroy } from 'svelte';

onMount(()=>console.log('A component was mounted'))
onDestroy(()=>console.log('A component was destroyed'))
</script>

<h1>Hi, I'm component componentA.svelte</h1> 
```

è¿™å¾ˆç®€å•ï¼Œä½†å®ƒå¯ä»¥å˜å¾—æ›´å¥½ã€‚(è¿™æ˜¯æˆ‘èŠ±äº†ä¸€æ®µæ—¶é—´æ‰æ‰¾åˆ°çš„ï¼Œå°½ç®¡å®ƒåœ¨æ–‡æ¡£ä¸­)ã€‚æ¥è‡ªè‹—æ¡çš„åŒ»ç”Ÿ:

> å¦‚æœä» onMount è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå½“ç»„ä»¶è¢«å¸è½½æ—¶ï¼Œå®ƒå°†è¢«è°ƒç”¨ã€‚>

å¹¶é‡æ„äº†ä¸Šé¢çš„ä»£ç :

```
<!-- componentA.svelte -->
<script>
import { onMount } from 'svelte';

onMount(()=>{
    console.log('A component was mounted')
    return ()=>console.log('A component was destroyed')//â¬…ï¸ onDestroy
})
</script>

<h1>Hi, I'm component componentA.svelte</h1> 
```

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å°†è¿™ä¸ª**è¡Œä¸º**å¤åˆ¶åˆ°å¦ä¸€ä¸ªç»„ä»¶ï¼Œä¸ºäº†ä¿æŒä»£ç å¹²ç‡¥ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæå–åˆ°ä¸€ä¸ªå¯é‡ç”¨çš„æ¨¡å—ï¼Œæ¯”å¦‚(ä½ çŒœå¯¹äº†)ä¸€ä¸ª**å‡½æ•°**ã€‚ä½†æ˜¯ä¸€ä¸ªéš”ç¦»çš„å‡½æ•°å¦‚ä½•ä½¿ç”¨ç»„ä»¶çš„ onMount å’Œ onDestroy å‘¢ï¼Ÿæˆ–è€…æ¢å¥è¯è¯´ï¼Œå¦‚ä½•å°† onMount å’Œ onDestroy æ³¨å…¥åˆ°ä¸€ä¸ªéš”ç¦»çš„å‡½æ•°ä¸­ï¼Ÿ

æˆ‘çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯å°†å®ƒä½œä¸ºå‚æ•°ä¼ é€’ã€‚ä½†æ˜¯äº‹å®è¯æ˜ä½ ä¸éœ€è¦è¿™ä¹ˆåšã€‚onMount å’Œ onDestroy åªæ˜¯å‡½æ•°ã€‚ä½ å¯ä»¥ä»ä»»ä½•åœ°æ–¹ç»™ä»–ä»¬æ‰“ç”µè¯ã€‚æ‰€ä»¥æˆ‘ä»¬çš„**è¡Œä¸ºåŠŸèƒ½æ¨¡å—**å¯ä»¥è¿™æ ·å®ç°:

```
//useLogger.js
import { onMount } from 'svelte';
export default function useLogger(){
    onMount(()=>{
        console.log('A component was mounted')
        return ()=>console.log('A component was destroyed')//â¬…ï¸ onDestroy
    })
} 
```

å¹¶ä¸”ç”¨åœ¨æˆ‘ä»¬æ‰€æœ‰çš„ç»„ä»¶ä¸­ï¼Œå°±åƒè¿™æ ·:

```
<!-- componentA.svelte -->
<script>
import useLogger from './useLogger';
useLogger();
</script>
<h1>Hi, I'm component componentA.svelte</h1>

<!-- componentB.svelte -->
<script>
import useLogger from './useLogger';
useLogger();
</script>
<h1>Hi, I'm component componentB.svelte</h1> 
```

å¦‚æœæˆ‘ä»¬æƒ³è®©è®°å½•çš„æ¶ˆæ¯æ›´ä¸ªæ€§åŒ–ä¸€ç‚¹:

```
//useLogger.js
import { onMount } from 'svelte';
export default function useLogger(componentName='A component'){
    onMount(()=>{
        console.log(`${componentName} was mounted`)
        return ()=>console.log(`${componentName} was destroyed`)//â¬…ï¸ onDestroy
    })
} 
```

```
<!-- componentA.svelte -->
<script>
import useLogger from './useLogger';
useLogger('Component A');
</script>
<h1>Hi, I'm component componentA.svelte</h1>

<!-- componentB.svelte -->
<script>
import useLogger from './useLogger';
useLogger('Component B');
</script>
<h1>Hi, I'm component componentB.svelte</h1> 
```

ç°åœ¨å®ƒçœ‹èµ·æ¥å¤šæ±ï¼æ³¨æ„ä¸€ç‚¹:*â€œå¿…é¡»åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶è°ƒç”¨â€*ã€‚æ‰€ä»¥ä½ ä¸èƒ½åœ¨ç‚¹å‡»å¤„ç†ç¨‹åºä¸Šä½¿ç”¨å®ƒã€‚å¥½çš„ä¸€é¢æ˜¯ä½ ä¸å¿…æ‹…å¿ƒä½ çš„é’©å­çš„æ’åºæˆ–æ¡ä»¶è°ƒç”¨ã€‚

å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬åˆšåˆšå®ç°äº†ä¸€ä¸ª**å‡½æ•°**æ¥**æå–è¡Œä¸º**ï¼Œå…è®¸ä½ **å¯¹ç”Ÿå‘½å‘¨æœŸ**åšå‡ºååº”ã€‚ä½†æ˜¯â€œ**è®¿é—®çŠ¶æ€å’Œä¸Šä¸‹æ–‡**éƒ¨åˆ†å‘¢ï¼Ÿè¿™æ˜¯ç¬¬ä¸€å­£ç¬¬äºŒé›†çš„è¯é¢˜ã€‚æ•¬è¯·æœŸå¾…ï¼

æ‰°æµæ¿è­¦æŠ¥

æˆ‘å¬åˆ°ä¸€äº›ä¼ è¨€è¯´ S02 æ˜¯å…³äº HOC çš„

æ‰°æµæ¿è­¦æŠ¥