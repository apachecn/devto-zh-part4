# ä½¿ç”¨ setuptools æ‰“åŒ…æ‚¨çš„ Python åº”ç”¨ç¨‹åº

> åŸæ–‡:[https://dev . to/wangonya/using-setup tools-to-package-your-python-app-18 P4](https://dev.to/wangonya/using-setuptools-to-package-your-python-app-18p4)

åœ¨æˆ‘ä»¬ä¹‹å‰çš„å¸–å­ä¸­ï¼Œæˆ‘ä»¬åˆ¶ä½œäº†ä¸€ä¸ª Hello Worldï¼è®©æˆ‘ä»¬å¼€å§‹ç‚¹å‡»çš„åº”ç”¨ç¨‹åºã€‚ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬éœ€è¦åš`python hello-world.py`æ¥è¿è¡Œå®ƒã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨æ„å»º CLI åº”ç”¨ç¨‹åºï¼Œè¿™ä¸€ç‚¹ä¹Ÿä¸é…·ğŸ˜…è€Œä¸” CLI åº”ç”¨ç¨‹åºä¹Ÿä¸æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚æˆ‘ä»¬éœ€è¦èƒ½å¤Ÿè¿è¡Œå•ä¸ªå‘½ä»¤ï¼Œæ¯”å¦‚:

```
(venv) $ hello
Hello World! 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°±æ˜¯[è®¾ç½®å·¥å…·](https://setuptools.readthedocs.io/en/latest/)çš„ç”¨æ­¦ä¹‹åœ°ã€‚Setuptools å¸®åŠ©æˆ‘ä»¬æ†ç»‘æˆ‘ä»¬çš„è„šæœ¬ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥åƒå®‰è£…åº”ç”¨ç¨‹åº(`$ hello`)ä¸€æ ·å®‰è£…å’Œè¿è¡Œå®ƒï¼Œè€Œä¸æ˜¯åƒè„šæœ¬(`$ python hello-world.py`)ã€‚

> Setuptools æ˜¯ Python distutils çš„ä¸€ä¸ªå¢å¼ºé›†åˆï¼Œå®ƒå…è®¸å¼€å‘äººå‘˜æ›´å®¹æ˜“åœ°æ„å»ºå’Œåˆ†å‘ Python åŒ…ï¼Œå°¤å…¶æ˜¯é‚£äº›ä¾èµ–äºå…¶ä»–åŒ…çš„åŒ…ã€‚- <small>[æ–‡æ¡£](https://setuptools.readthedocs.io/en/latest/setuptools.html)</small>

å¥½äº†ï¼Œé—²èŠå¤Ÿäº†ã€‚è®©æˆ‘ä»¬å¼€å§‹å·¥ä½œå§ã€‚æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å‘æˆ‘ä»¬çš„é¡¹ç›®æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¹¶å°†å…¶å‘½åä¸º`setup.py`ã€‚æˆ‘ä»¬ä¹Ÿå°†æŠŠ`hello-world.py`é‡å‘½åä¸º`helloworld.py`(å»æ‰ç ´æŠ˜å·)ã€‚å½“æˆ‘ä»¬åˆ°è¾¾`setup()`éƒ¨åˆ†æ—¶ï¼Œæˆ‘ä¼šè§£é‡Šä¸ºä»€ä¹ˆè¿™æ˜¯å¿…è¦çš„ã€‚æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„ç°åœ¨åº”è¯¥æ˜¯è¿™æ ·çš„:

```
hello-world-cli
    |- helloworld.py  # renamed from hello-world.py
    |- setup.py  # new file 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`helloworld.py`ä¸­ï¼Œç§»é™¤`if __name__ == '__main__':`éƒ¨åˆ†ã€‚ä»£ç ç°åœ¨åº”è¯¥æ˜¯è¿™æ ·çš„:

```
import click

@click.command()
def hello():
    click.echo('Hello World!') 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

åœ¨`setup.py`æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»£ç :

```
from setuptools import setup

setup(
    name='hello-world-cli',
    py_modules=['helloworld'],
    install_requires=[
        'Click',
    ],
    entry_points='''
        [console_scripts]
        hello=helloworld:hello
    ''',
) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¯ä¸€è¡Œä»£ç éƒ½åšäº†ä»€ä¹ˆã€‚

```
from setuptools import setup 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ä¸ºäº†ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬éœ€è¦ä»`setuptools`å¯¼å…¥`setup`ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è°ƒç”¨`setup()`å‡½æ•°å¹¶ä¼ é€’ä¸€äº›å‚æ•°:

```
name='hello-world-cli' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å°†æ˜¯æˆ‘ä»¬ CLI åº”ç”¨ç¨‹åºçš„åç§°ã€‚

```
py_modules=['helloworld'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™å‘Šè¯‰`setup()`åœ¨å“ªé‡Œæ‰¾åˆ°æˆ‘ä»¬è¦æ‰§è¡Œçš„ä¸»æ¨¡å—ã€‚æˆ‘ä»¬è¿™é‡Œçš„ä¸»æ–‡ä»¶æ˜¯`helloworld.py`ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†`helloworld`è®¾ç½®ä¸ºæ¨¡å—ã€‚æˆ‘ä»¬å¯ä»¥ä¿æŒç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬ç°åœ¨åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†éšç€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„å¢é•¿ï¼Œæˆ‘ä»¬å°†ç”¨`packages=find_packages()`æ›¿æ¢`py_modules`ã€‚ç¨åä¼šè¯¦ç»†ä»‹ç»ã€‚

```
install_requires=['Click'] 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¾èµ– Clickï¼Œæ‰€ä»¥éœ€è¦å®‰è£…å®ƒæ‰èƒ½å·¥ä½œã€‚éœ€è¦çŸ¥é“è¿™ä¸€ç‚¹ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥åœ¨æ‰“åŒ…æˆ‘ä»¬çš„é¡¹ç›®æ—¶åŒ…å«å®ƒã€‚`install_requires`æ¥å—ä¸€ä¸ªå€¼åˆ—è¡¨ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æœ‰æ›´å¤šçš„ä¾èµ–é¡¹ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™é‡Œåˆ—å‡ºæ‰€æœ‰çš„ä¾èµ–é¡¹ã€‚

```
entry_points='''
          [console_scripts]
          hello=helloworld:hello
      ''' 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

è¿™ä¸ºæˆ‘ä»¬çœå»äº†æ¯æ¬¡éƒ½å¿…é¡»ç”¨`python ...`è¿è¡Œåº”ç”¨ç¨‹åºçš„éº»çƒ¦ï¼Œå¹¶ä½¿æˆ‘ä»¬èƒ½å¤Ÿåªæ‰§è¡Œ`hello`æ¥è¿è¡Œå®ƒã€‚

[![entry_points-image](../Images/c5fa524175bbc8bbcbbe246466f75dad.png)T2ã€‘](https://res.cloudinary.com/practicaldev/image/fetch/s--clXGLLIK--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/tdz86n85skubae5ypycq.png)

<small>**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬ç»´æŒä»¥å‰çš„åå­—** ( `hello-world.py` ) **ï¼Œ** `setup` **åœ¨** `entry_points`å°±å¤±è´¥äº†ã€‚**è¿™æ˜¯å› ä¸º python æ¨¡å—åä¸åº”è¯¥æœ‰ç ´æŠ˜å·ã€‚**T12ã€‘</small>

æˆ‘ä»¬ç°åœ¨å¯ä»¥åœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­å®‰è£…å¹¶è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚è¦å®‰è£…å®ƒï¼Œè¿è¡Œ:

```
(venv) $ pip install --editable . 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

ç„¶åæ‰§è¡Œåˆ›å»ºçš„å‘½ä»¤:

```
(venv) $ hello
Hello World! 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

å¾ˆæ¼‚äº®ï¼Œå¯¹å§ï¼ŸğŸ˜ƒ

åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»”ç»†çœ‹çœ‹ç‚¹å‡»å‘½ä»¤ã€é€‰é¡¹å’Œå‚æ•°ï¼Œä»¥åŠæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒä»¬æ¥ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå˜å¾—æ›´å¥½ã€‚